var ae=Object.defineProperty,se=Object.defineProperties;var ne=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var Q=(u,t,o)=>t in u?ae(u,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):u[t]=o,A=(u,t)=>{for(var o in t||(t={}))re.call(t,o)&&Q(u,o,t[o]);if(H)for(var o of H(t))le.call(t,o)&&Q(u,o,t[o]);return u},q=(u,t)=>se(u,ne(t));import{_ as J,e as Y,r as P,u as I,s as V,a as ue}from"./app.ceb68814.js";import{_ as oe,a as ie}from"./option.1bb6cb04.js";import{d as Z,h as _,j as f,m as g,v as $,Q as ce,s as j,t as a,S as ee,r as U,p as O,L as X,$ as pe,a0 as me,aj as de,ak as _e,o as ve,ad as ge,w as D,al as fe,x as K,n as S,F as T,U as F,y as G,R as W}from"./vendor.bea6da78.js";const he={class:"mt-2 text-sm"},ye={class:"pl-2 font-bold"},be={display:"mt-1 grid"},ke=Z({props:{categoryName:null},setup(u){const t=u;return(o,i)=>(_(),f("div",he,[g("span",ye,$(t.categoryName),1),g("div",be,[ce(o.$slots,"default")])]))}});const ze={class:"mt-4 px-2 text-center"},$e={class:"text-sm text-gray-700 dark:text-gray-300"},Ce=ee(" Photo by "),we=["href"],xe={class:"text-sm text-gray-700 dark:text-gray-300"},Se=ee(" on "),je=["href"],Ee={class:"text-xs text-gray-500"},Ne=Z({props:{selectedImage:null},setup(u){const t=u,{t:o}=Y();return(i,c)=>{var d,h,b,p,k,C;return _(),f("div",ze,[g("span",$e,[Ce,g("a",{class:j([((d=t.selectedImage.creator)==null?void 0:d.url)?"link__active":"link__inactive"]),href:(h=t.selectedImage.creator)==null?void 0:h.url,target:"_blank",rel:"noopener"},$((b=t.selectedImage.creator)==null?void 0:b.name),11,we)]),g("span",xe,[Se,g("a",{class:j([((p=t.selectedImage.provider)==null?void 0:p.url)?"link__active":"link__inactive"]),href:(k=t.selectedImage.provider)==null?void 0:k.url,target:"_blank",rel:"noopener"},$((C=t.selectedImage.provider)==null?void 0:C.name),11,je)]),g("p",Ee,$(a(o)("all_rights_of_the_image_belong_to_the_creator")),1)])}}});var Te=J(Ne,[["__scopeId","data-v-67efb78c"]]);const Ue=Z({props:{shuffleCount:null,clickCount:null,score:null},setup(u){const t=u;return(o,i)=>(_(),f("div",null,[g("div",null,$(t.clickCount),1),g("div",{class:j([t.score<0?"text-green-500":t.score<t.shuffleCount?"text-yellow-500":"text-red-500"])},$(t.score>0?`+${t.score}`:t.score)+" moves ",3)]))}});function Be(){const{t:u,locale:t}=Y(),o=U(!1),i=O(()=>o.value?[{categoryName:u("fate_series"),options:[{label:u("jean_alter"),url:"https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images/jean-alter.jpg"},{label:"",url:""}]},{categoryName:u("eighty_six"),options:[{label:u("vladilena_milize"),url:"https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images/vladilena-milize.jpg"}]},{categoryName:u("attack_on_titan"),options:[{label:u("eren_yeager"),url:"https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images/eren-yeager.jpg"}]}]:[{categoryName:u("nature"),options:[{label:"Kamran Ch",url:"https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images/mountain.jpg",provider:{name:"Unsplash",url:"https://unsplash.com/t/act-for-nature?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"},creator:{name:"Kamran Ch",url:"https://unsplash.com/@kamranch?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"}},{label:"David Scanlon",url:"https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images/gorilla.jpg",provider:{name:"Unsplash",url:"https://unsplash.com/t/nature?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"},creator:{name:"David Scanlon",url:"https://unsplash.com/@dsartwork?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"}}]},{categoryName:u("cat",2),options:[{label:"Pacto Visual",url:"https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images/cat_pacto-visual.jpg",provider:{name:"Unsplash",url:"https://unsplash.com/s/photos/cat?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"},creator:{name:"Pacto Visual",url:"https://unsplash.com/@pactovisual?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"}},{label:"Georgi Benev",url:"https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images/cat_georgi-benev.jpg",provider:{name:"Unsplash",url:"https://unsplash.com/s/photos/cat-box?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"},creator:{name:"georgi benev",url:"https://unsplash.com/@georgibenev97?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"}}]}]),c=U(d());function d(){return P(1,P(1,i.value)[0].options)[0]}function h(){o.value=!0}return X(o,()=>{c.value=d()}),X(t,()=>{const b=i.value.flatMap(({options:p})=>p).find(({url:p})=>p===c.value.url);!b||(c.value=b)}),{selectedImage:c,images:i,openBackDoor:h}}function De(){const u=me(),{data:t}=I();return pe(async({score:o})=>{if(!t.value)return null;const{data:i}=await V.from("sliding-puzzle-records").select("*").eq("user_id",t.value.id).order("score",{ascending:!0});if(!i)return null;switch(i.length<=10){case!0:return(await V.from("sliding-puzzle-records").insert({score:o,user_id:t.value.id}).single()).data;case!1:{const c=i[i.length-1];return c.score<o?null:(await V.from("sliding-puzzle-records").update({id:c.id,score:o}).single()).data}}},{onSuccess:o=>{if(!t.value)return;const{user_name:i=t.value.email,avatar_url:c=""}=t.value.user_metadata;if(!o)return;const d=u.getQueryData("sliding-puzzle-records");!d||u.setQueryData("sliding-puzzle-records",()=>(d.push(q(A({},o),{user:{user_name:i,avatar_url:c}})),d.sort((h,b)=>h.score-b.score)))}})}function Fe(){const i=O(()=>b.value?160:h.value?120:80),c=De(),d=de(_e),h=d.greater("sm"),b=d.greater("lg"),p=U("shuffle"),k=U(0),C=O(()=>k.value-32),l=U([[0,0,0,0,0,0],[0,1,2,3,4,0],[0,5,6,7,8,0],[0,9,10,11,12,0],[0,13,14,15,16,0],[0,0,0,0,-1,0],[0,0,0,0,0,0]]);ve(async()=>B());function L(r,e,s){let n=[];const m=l.value[r-1][e],v=l.value[r+1][e],y=l.value[r][e+1],N=l.value[r][e-1];return 0<m&&m!==s&&n.push(m),0<v&&v!==s&&n.push(v),0<y&&y!==s&&n.push(y),0<N&&N!==s&&n.push(N),s&&(n=n.filter(te=>te!==16)),P(1,n)[0]}async function B(){l.value=[[0,0,0,0,0,0],[0,1,2,3,4,0],[0,5,6,7,8,0],[0,9,10,11,12,0],[0,13,14,15,16,0],[0,0,0,0,-1,0],[0,0,0,0,0,0]],await ge(),k.value=0,p.value="shuffle";let r;for(let e=0;e<32;e++){const s=document.getElementById("void");if(!s)return;const n=Number(s.dataset.rowidx),m=Number(s.dataset.colidx),v=L(n,m,r),y=document.getElementById(v.toString());if(!y)return;await E(y,Number(y.dataset.rowidx),Number(y.dataset.colidx),!1),r=v}p.value="ready"}function z(){let r=0;for(let e=0;e<l.value.length;e++)for(let s=0;s<l.value[e].length;s++){const n=l.value[e][s];if(n!==0){if(r===16&&n===-1)return!0;if(r+1!==n)return!1;r++}}return!0}async function E(r,e,s,n=!0){const m=M(e,s);return n&&(r.style.transition="transform linear 0.1s"),m==="top"&&(n&&(r.style.transform=`translateY(-${i.value}px)`,await w(100)),[l.value[e][s],l.value[e-1][s]]=[l.value[e-1][s],l.value[e][s]]),m==="bottom"&&(n&&(r.style.transform=`translateY(${i.value}px)`,await w(100)),[l.value[e][s],l.value[e+1][s]]=[l.value[e+1][s],l.value[e][s]]),m==="right"&&(n&&(r.style.transform=`translateX(${i.value}px)`,await w(100)),[l.value[e][s],l.value[e][s+1]]=[l.value[e][s+1],l.value[e][s]]),m==="left"&&(n&&(r.style.transform=`translateX(-${i.value}px)`,await w(100)),[l.value[e][s],l.value[e][s-1]]=[l.value[e][s-1],l.value[e][s]]),n&&(r.style.transition=""),!!m}async function w(r){await new Promise(e=>setTimeout(()=>e(!0),r))}function M(r,e){return l.value[r-1][e]===-1?"top":l.value[r+1][e]===-1?"bottom":l.value[r][e+1]===-1?"right":l.value[r][e-1]===-1?"left":null}async function x(r,e,s){if(p.value==="shuffle"||p.value==="done")return;const n=r.currentTarget;!n||(await E(n,e,s)&&(k.value+=1),p.value==="ready"&&(p.value="playing"),!!z()&&(p.value="done",c.mutate({score:C.value})))}function R(r){const e=(r-1)%4*i.value*-1,s=Math.floor((r-1)/4)*i.value*-1;return`${e}px ${s}px`}return{SHUFFLE_COUNT:32,SIZE_NODE:i,SIZE_X:4,SIZE_Y:4,clickCount:k,status:p,nodes:l,score:C,computeBgPosition:R,onClickNode:x,initialize:B}}const Ze={class:"my-10 grid gap-5 place-items-center"},Le={class:"w-52"},Re={key:0,class:"w-0 h-0"},Ve=["data-rowIdx","data-colIdx"],Pe=["id","data-rowIdx","data-colIdx","onClick"],Oe={key:0,class:"mt-2 w-96 text-rose-300 text-sm"},Xe={key:1},Ye=Z({setup(u){const{data:t}=I(),{t:o}=Y(),{SHUFFLE_COUNT:i,SIZE_NODE:c,SIZE_X:d,SIZE_Y:h,clickCount:b,status:p,nodes:k,score:C,computeBgPosition:l,onClickNode:L,initialize:B}=Fe(),{selectedImage:z,openBackDoor:E,images:w}=Be();return X(()=>z.value.url,()=>B(),{deep:!0}),(M,x)=>{const R=ie,r=ke,e=oe,s=ue;return _(),f(T,null,[g("div",Ze,[g("button",{onClick:x[0]||(x[0]=(...n)=>a(E)&&a(E)(...n))},"Back Door"),g("div",Le,[D(e,{modelValue:a(z),"onUpdate:modelValue":x[1]||(x[1]=n=>fe(z)?z.value=n:null),label:"Image",class:"w-56"},{default:K(()=>[(_(!0),f(T,null,F(a(w),({categoryName:n,options:m})=>(_(),W(r,{key:n,"category-name":n},{default:K(()=>[(_(!0),f(T,null,F(m,v=>(_(),W(R,{key:v.url,value:v},null,8,["value"]))),128))]),_:2},1032,["category-name"]))),128))]),_:1},8,["modelValue"])]),D(Ue,{"shuffle-count":a(i),"click-count":a(b),score:a(C)},null,8,["shuffle-count","click-count","score"])]),g("div",{class:"relative grid gap-px transition-all duration-1000 ease-linear",style:S({gridTemplateRows:`auto repeat(${a(h)}, ${a(c)}px) auto`})},[g("div",{class:j(["absolute top-0 left-1/2 transform -translate-x-1/2 z-1 pointer-events-none",[a(p)==="done"?"shadow-2xl":"shadow"]]),style:S({width:`${a(d)*a(c)+a(d)}px`,height:`${a(h)*a(c)+a(h)}px`})},[g("div",{class:j(["absolute top-0 left-0 z-1 w-full h-full bg-white opacity-0",{"done__anim-mask":a(p)==="done"}])},null,2),g("div",{class:j(["w-full h-full bg-cover",[a(p)==="done"?"done__anim-image opacity-100":"opacity-0"]]),style:S({backgroundImage:`url(${a(z).url})`})},null,6)],6),(_(!0),f(T,null,F(a(k),(n,m)=>(_(),f("div",{key:m,class:"grid gap-px transition-all duration-1000 ease-linear",style:S({gridTemplateColumns:`auto repeat(${a(d)}, ${a(c)}px) auto`})},[(_(!0),f(T,null,F(n,(v,y)=>(_(),f("div",{key:v},[v===0?(_(),f("div",Re)):v===-1?(_(),f("div",{key:1,id:"void","data-rowIdx":m,"data-colIdx":y,style:S({width:`${a(c)}px`,height:`${a(c)}px`})},null,12,Ve)):(_(),f("button",{key:2,id:v.toString(),"data-rowIdx":m,"data-colIdx":y,class:"text-white",style:S({width:`${a(c)}px`,height:`${a(c)}px`,backgroundImage:`url(${a(z).url})`,backgroundSize:`${a(c)*a(d)}px ${a(c)*a(h)}px`,backgroundPosition:a(l)(v),transform:"translate(0px)"}),onClick:N=>a(L)(N,m,y)},$(a(p)==="done"?"":v),13,Pe))]))),128))],4))),128))],4),D(Te,{"selected-image":a(z)},null,8,["selected-image"]),a(t)?G("",!0):(_(),f("div",Oe,$(a(o)("games_auth_warning")),1)),a(p)==="done"?(_(),f("div",Xe,"Congratulations!")):G("",!0),D(s)],64)}}});var qe=J(Ye,[["__scopeId","data-v-f1e043b8"]]);export{qe as default};
