var se=Object.defineProperty,ne=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var q=(o,a,u)=>a in o?se(o,a,{enumerable:!0,configurable:!0,writable:!0,value:u}):o[a]=u,K=(o,a)=>{for(var u in a||(a={}))le.call(a,u)&&q(o,u,a[u]);if(A)for(var u of A(a))oe.call(a,u)&&q(o,u,a[u]);return o},G=(o,a)=>ne(o,re(a));import{_ as ee,e as H,r as M,u as Q,s as O,a as ue}from"./app.c8b6e23b.js";import{_ as ie,a as ce}from"./option.6f23ee7e.js";import{d as L,h as d,j as v,m as _,v as C,Q as pe,s as j,t as s,S as te,r as E,p as X,L as Y,$ as me,a0 as de,aj as _e,ak as ve,o as ge,ad as fe,w as B,al as he,x as W,n as x,F as N,U as F,y as J,R as I}from"./vendor.bea6da78.js";const ye={class:"mt-2 text-sm"},be={class:"pl-2 font-bold"},ke={display:"mt-1 grid"},ze=L({props:{categoryName:null},setup(o){const a=o;return(u,c)=>(d(),v("div",ye,[_("span",be,C(a.categoryName),1),_("div",ke,[pe(u.$slots,"default")])]))}});const $e={class:"mt-4 px-2 text-center"},Ce={class:"text-sm text-gray-700 dark:text-gray-300"},we=te(" Photo by "),xe=["href"],je={class:"text-sm text-gray-700 dark:text-gray-300"},Se=te(" on "),Ne=["href"],Ee={class:"text-xs text-gray-500"},Te=L({props:{selectedImage:null},setup(o){const a=o,{t:u}=H();return(c,i)=>{var m,g,y,f,h,$;return d(),v("div",$e,[_("span",Ce,[we,_("a",{class:j([((m=a.selectedImage.creator)==null?void 0:m.url)?"link__active":"link__inactive"]),href:(g=a.selectedImage.creator)==null?void 0:g.url,target:"_blank",rel:"noopener"},C((y=a.selectedImage.creator)==null?void 0:y.name),11,xe)]),_("span",je,[Se,_("a",{class:j([((f=a.selectedImage.provider)==null?void 0:f.url)?"link__active":"link__inactive"]),href:(h=a.selectedImage.provider)==null?void 0:h.url,target:"_blank",rel:"noopener"},C(($=a.selectedImage.provider)==null?void 0:$.name),11,Ne)]),_("p",Ee,C(s(u)("all_rights_of_the_image_belong_to_the_creator")),1)])}}});var Ue=ee(Te,[["__scopeId","data-v-67efb78c"]]);const De=L({props:{shuffleCount:null,clickCount:null,score:null},setup(o){const a=o;return(u,c)=>(d(),v("div",null,[_("div",null,C(a.clickCount),1),_("div",{class:j([a.score<0?"text-green-500":a.score<a.shuffleCount?"text-yellow-500":"text-red-500"])},C(a.score>0?`+${a.score}`:a.score)+" moves ",3)]))}});function Be(){const{t:o,locale:a}=H(),u=E(!1),c=X(()=>u.value?[{categoryName:o("fate_series"),options:[{label:o("jean_alter"),url:"https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images/jean-alter.jpg"},{label:"",url:""}]},{categoryName:o("eighty_six"),options:[{label:o("vladilena_milize"),url:"https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images/vladilena-milize.jpg"}]},{categoryName:o("attack_on_titan"),options:[{label:o("eren_yeager"),url:"https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images/eren-yeager.jpg"}]}]:[{categoryName:o("nature"),options:[{label:"Kamran Ch",url:"https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images/mountain.jpg",provider:{name:"Unsplash",url:"https://unsplash.com/t/act-for-nature?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"},creator:{name:"Kamran Ch",url:"https://unsplash.com/@kamranch?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"}},{label:"David Scanlon",url:"https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images/gorilla.jpg",provider:{name:"Unsplash",url:"https://unsplash.com/t/nature?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"},creator:{name:"David Scanlon",url:"https://unsplash.com/@dsartwork?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"}}]},{categoryName:o("cat",2),options:[{label:"Pacto Visual",url:"https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images/cat_pacto-visual.jpg",provider:{name:"Unsplash",url:"https://unsplash.com/s/photos/cat?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"},creator:{name:"Pacto Visual",url:"https://unsplash.com/@pactovisual?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"}},{label:"Georgi Benev",url:"https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images/cat_georgi-benev.jpg",provider:{name:"Unsplash",url:"https://unsplash.com/s/photos/cat-box?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"},creator:{name:"georgi benev",url:"https://unsplash.com/@georgibenev97?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"}}]}]),i=E(m());function m(){return M(1,M(1,c.value)[0].options)[0]}function g(){u.value=!0}return Y(u,()=>{i.value=m()}),Y(a,()=>{const y=c.value.flatMap(({options:f})=>f).find(({url:f})=>f===i.value.url);!y||(i.value=y)}),{selectedImage:i,images:c,openBackDoor:g}}function Fe(){const o=de(),{data:a}=Q();return me(async({score:u})=>{if(!a.value)return null;const{data:c}=await O.from("sliding-puzzle-records").select("*").eq("user_id",a.value.id).order("score",{ascending:!0});if(!c)return null;switch(c.length<=10){case!0:{const{data:i}=await O.from("mine-sweeper-records").insert({score:u,user_id:a.value.id}).single();return console.log(i),i}case!1:{const i=c[c.length-1];if(i.score<u)return null;const{data:m}=await O.from("mine-sweeper-records").update({id:i.id,score:u}).single();return m}}},{onSuccess:u=>{if(!u)return;const c=o.getQueryData("sliding-puzzle-records");!c||o.setQueryData("sliding-puzzle-records",()=>{var i,m;return c.push(G(K({},u),{user:{user_name:(i=a.value)==null?void 0:i.user_metadata.user_name,avatar_url:(m=a.value)==null?void 0:m.user_metadata.avatar_url}})),c.sort((g,y)=>g.score-y.score)})}})}function Le(){const c=X(()=>f.value?160:y.value?120:80),i=Fe(),{data:m}=Q(),g=_e(ve),y=g.greater("sm"),f=g.greater("lg"),h=E("shuffle"),$=E(0),T=X(()=>$.value-2),r=E([[0,0,0,0,0,0],[0,1,2,3,4,0],[0,5,6,7,8,0],[0,9,10,11,12,0],[0,13,14,15,16,0],[0,0,0,0,-1,0],[0,0,0,0,0,0]]);ge(async()=>b());function R(n,t,e){let l=[];const p=r.value[n-1][t],k=r.value[n+1][t],z=r.value[n][t+1],P=r.value[n][t-1];return 0<p&&p!==e&&l.push(p),0<k&&k!==e&&l.push(k),0<z&&z!==e&&l.push(z),0<P&&P!==e&&l.push(P),e&&(l=l.filter(ae=>ae!==16)),M(1,l)[0]}async function b(){r.value=[[0,0,0,0,0,0],[0,1,2,3,4,0],[0,5,6,7,8,0],[0,9,10,11,12,0],[0,13,14,15,16,0],[0,0,0,0,-1,0],[0,0,0,0,0,0]],await fe(),$.value=0,h.value="shuffle";let n;for(let t=0;t<2;t++){const e=document.getElementById("void");if(!e)return;const l=Number(e.dataset.rowidx),p=Number(e.dataset.colidx),k=R(l,p,n),z=document.getElementById(k.toString());if(!z)return;await D(z,Number(z.dataset.rowidx),Number(z.dataset.colidx),!1),n=k}h.value="ready"}function U(){let n=0;for(let t=0;t<r.value.length;t++)for(let e=0;e<r.value[t].length;e++){const l=r.value[t][e];if(l!==0){if(n===16&&l===-1)return!0;if(n+1!==l)return!1;n++}}return!0}async function D(n,t,e,l=!0){const p=w(t,e);return l&&(n.style.transition="transform linear 0.1s"),p==="top"&&(l&&(n.style.transform=`translateY(-${c.value}px)`,await S(100)),[r.value[t][e],r.value[t-1][e]]=[r.value[t-1][e],r.value[t][e]]),p==="bottom"&&(l&&(n.style.transform=`translateY(${c.value}px)`,await S(100)),[r.value[t][e],r.value[t+1][e]]=[r.value[t+1][e],r.value[t][e]]),p==="right"&&(l&&(n.style.transform=`translateX(${c.value}px)`,await S(100)),[r.value[t][e],r.value[t][e+1]]=[r.value[t][e+1],r.value[t][e]]),p==="left"&&(l&&(n.style.transform=`translateX(-${c.value}px)`,await S(100)),[r.value[t][e],r.value[t][e-1]]=[r.value[t][e-1],r.value[t][e]]),l&&(n.style.transition=""),!!p}async function S(n){await new Promise(t=>setTimeout(()=>t(!0),n))}function w(n,t){return r.value[n-1][t]===-1?"top":r.value[n+1][t]===-1?"bottom":r.value[n][t+1]===-1?"right":r.value[n][t-1]===-1?"left":null}async function Z(n,t,e){if(h.value==="shuffle"||h.value==="done")return;const l=n.currentTarget;!l||(await D(l,t,e)&&($.value+=1),h.value==="ready"&&(h.value="playing"),!!U()&&(h.value="done",!!m.value&&i.mutate({userId:m.value.id,score:T.value})))}function V(n){const t=(n-1)%4*c.value*-1,e=Math.floor((n-1)/4)*c.value*-1;return`${t}px ${e}px`}return{SHUFFLE_COUNT:2,SIZE_NODE:c,SIZE_X:4,SIZE_Y:4,clickCount:$,status:h,nodes:r,score:T,computeBgPosition:V,onClickNode:Z,initialize:b}}const Re={class:"my-10 grid gap-5 place-items-center"},Ze={class:"w-52"},Ve={key:0,class:"w-0 h-0"},Pe=["data-rowIdx","data-colIdx"],Oe=["id","data-rowIdx","data-colIdx","onClick"],Me={key:0,class:"mt-2 w-96 text-rose-300 text-sm"},Xe={key:1},Ye=L({setup(o){const{data:a}=Q(),{t:u}=H(),{SHUFFLE_COUNT:c,SIZE_NODE:i,SIZE_X:m,SIZE_Y:g,clickCount:y,status:f,nodes:h,score:$,computeBgPosition:T,onClickNode:r,initialize:R}=Le(),{selectedImage:b,openBackDoor:U,images:D}=Be();return Y(()=>b.value.url,()=>R(),{deep:!0}),(S,w)=>{const Z=ce,V=ze,n=ie,t=ue;return d(),v(N,null,[_("div",Re,[_("button",{onClick:w[0]||(w[0]=(...e)=>s(U)&&s(U)(...e))},"Back Door"),_("div",Ze,[B(n,{modelValue:s(b),"onUpdate:modelValue":w[1]||(w[1]=e=>he(b)?b.value=e:null),label:"Image",class:"w-56"},{default:W(()=>[(d(!0),v(N,null,F(s(D),({categoryName:e,options:l})=>(d(),I(V,{key:e,"category-name":e},{default:W(()=>[(d(!0),v(N,null,F(l,p=>(d(),I(Z,{key:p.url,value:p},null,8,["value"]))),128))]),_:2},1032,["category-name"]))),128))]),_:1},8,["modelValue"])]),B(De,{"shuffle-count":s(c),"click-count":s(y),score:s($)},null,8,["shuffle-count","click-count","score"])]),_("div",{class:"relative grid gap-px transition-all duration-1000 ease-linear",style:x({gridTemplateRows:`auto repeat(${s(g)}, ${s(i)}px) auto`})},[_("div",{class:j(["absolute top-0 left-1/2 transform -translate-x-1/2 z-1 pointer-events-none",[s(f)==="done"?"shadow-2xl":"shadow"]]),style:x({width:`${s(m)*s(i)+s(m)}px`,height:`${s(g)*s(i)+s(g)}px`})},[_("div",{class:j(["absolute top-0 left-0 z-1 w-full h-full bg-white opacity-0",{"done__anim-mask":s(f)==="done"}])},null,2),_("div",{class:j(["w-full h-full bg-cover",[s(f)==="done"?"done__anim-image opacity-100":"opacity-0"]]),style:x({backgroundImage:`url(${s(b).url})`})},null,6)],6),(d(!0),v(N,null,F(s(h),(e,l)=>(d(),v("div",{key:l,class:"grid gap-px transition-all duration-1000 ease-linear",style:x({gridTemplateColumns:`auto repeat(${s(m)}, ${s(i)}px) auto`})},[(d(!0),v(N,null,F(e,(p,k)=>(d(),v("div",{key:p},[p===0?(d(),v("div",Ve)):p===-1?(d(),v("div",{key:1,id:"void","data-rowIdx":l,"data-colIdx":k,style:x({width:`${s(i)}px`,height:`${s(i)}px`})},null,12,Pe)):(d(),v("button",{key:2,id:p.toString(),"data-rowIdx":l,"data-colIdx":k,class:"text-white",style:x({width:`${s(i)}px`,height:`${s(i)}px`,backgroundImage:`url(${s(b).url})`,backgroundSize:`${s(i)*s(m)}px ${s(i)*s(g)}px`,backgroundPosition:s(T)(p),transform:"translate(0px)"}),onClick:z=>s(r)(z,l,k)},C(s(f)==="done"?"":p),13,Oe))]))),128))],4))),128))],4),B(Ue,{"selected-image":s(b)},null,8,["selected-image"]),s(a)?J("",!0):(d(),v("div",Me,C(s(u)("games_auth_warning")),1)),s(f)==="done"?(d(),v("div",Xe,"Congratulations!")):J("",!0),B(t)],64)}}});var Ke=ee(Ye,[["__scopeId","data-v-f1e043b8"]]);export{Ke as default};
