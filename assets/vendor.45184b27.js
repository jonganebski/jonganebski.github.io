var Yk=Object.defineProperty,Qk=Object.defineProperties;var Jk=Object.getOwnPropertyDescriptors;var xm=Object.getOwnPropertySymbols;var rw=Object.prototype.hasOwnProperty,iw=Object.prototype.propertyIsEnumerable;var nw=(e,n,r)=>n in e?Yk(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r,Pt=(e,n)=>{for(var r in n||(n={}))rw.call(n,r)&&nw(e,r,n[r]);if(xm)for(var r of xm(n))iw.call(n,r)&&nw(e,r,n[r]);return e},Ei=(e,n)=>Qk(e,Jk(n));var cs=(e,n)=>{var r={};for(var s in e)rw.call(e,s)&&n.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&xm)for(var s of xm(e))n.indexOf(s)<0&&iw.call(e,s)&&(r[s]=e[s]);return r};/*!
  * shared v9.2.0-beta.30
  * (c) 2022 kazuya kawaguchi
  * Released under the MIT License.
  */const eP=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",El=e=>eP?Symbol(e):e,tP=(e,n,r)=>nP({l:e,k:n,s:r}),nP=e=>JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029").replace(/\u0027/g,"\\u0027"),mi=e=>typeof e=="number"&&isFinite(e),rP=e=>Lv(e)==="[object Date]",Gm=e=>Lv(e)==="[object RegExp]",z_=e=>Ln(e)&&Object.keys(e).length===0;function iP(e,n){typeof console!="undefined"&&(console.warn("[intlify] "+e),n&&console.warn(n.stack))}const Fi=Object.assign;let ow;const zv=()=>ow||(ow=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});function sw(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}const oP=Object.prototype.hasOwnProperty;function Ov(e,n){return oP.call(e,n)}const ni=Array.isArray,fi=e=>typeof e=="function",Vt=e=>typeof e=="string",Hr=e=>typeof e=="boolean",kr=e=>e!==null&&typeof e=="object",Y2=Object.prototype.toString,Lv=e=>Y2.call(e),Ln=e=>Lv(e)==="[object Object]",sP=e=>e==null?"":ni(e)||Ln(e)&&e.toString===Y2?JSON.stringify(e,null,2):String(e);/*!
  * message-compiler v9.2.0-beta.30
  * (c) 2022 kazuya kawaguchi
  * Released under the MIT License.
  */const Q2={EXPECTED_TOKEN:1,INVALID_TOKEN_IN_PLACEHOLDER:2,UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER:3,UNKNOWN_ESCAPE_SEQUENCE:4,INVALID_UNICODE_ESCAPE_SEQUENCE:5,UNBALANCED_CLOSING_BRACE:6,UNTERMINATED_CLOSING_BRACE:7,EMPTY_PLACEHOLDER:8,NOT_ALLOW_NEST_PLACEHOLDER:9,INVALID_LINKED_FORMAT:10,MUST_HAVE_MESSAGES_IN_PLURAL:11,UNEXPECTED_EMPTY_LINKED_MODIFIER:12,UNEXPECTED_EMPTY_LINKED_KEY:13,UNEXPECTED_LEXICAL_ANALYSIS:14,__EXTEND_POINT__:15};function J2(e,n,r={}){const{domain:s,messages:c,args:h}=r,m=e,a=new SyntaxError(String(m));return a.code=e,n&&(a.location=n),a.domain=s,a}/*!
  * devtools-if v9.2.0-beta.30
  * (c) 2022 kazuya kawaguchi
  * Released under the MIT License.
  */const eE={I18nInit:"i18n:init",FunctionTranslate:"function:translate"};/*!
  * core-base v9.2.0-beta.30
  * (c) 2022 kazuya kawaguchi
  * Released under the MIT License.
  */const Sl=[];Sl[0]={w:[0],i:[3,0],["["]:[4],o:[7]};Sl[1]={w:[1],["."]:[2],["["]:[4],o:[7]};Sl[2]={w:[2],i:[3,0],["0"]:[3,0]};Sl[3]={i:[3,0],["0"]:[3,0],w:[1,1],["."]:[2,1],["["]:[4,1],o:[7,1]};Sl[4]={["'"]:[5,0],['"']:[6,0],["["]:[4,2],["]"]:[1,3],o:8,l:[4,0]};Sl[5]={["'"]:[4,0],o:8,l:[5,0]};Sl[6]={['"']:[4,0],o:8,l:[6,0]};const aP=/^\s?(?:true|false|-?[\d.]+|'[^']*'|"[^"]*")\s?$/;function lP(e){return aP.test(e)}function cP(e){const n=e.charCodeAt(0),r=e.charCodeAt(e.length-1);return n===r&&(n===34||n===39)?e.slice(1,-1):e}function uP(e){if(e==null)return"o";switch(e.charCodeAt(0)){case 91:case 93:case 46:case 34:case 39:return e;case 95:case 36:case 45:return"i";case 9:case 10:case 13:case 160:case 65279:case 8232:case 8233:return"w"}return"i"}function hP(e){const n=e.trim();return e.charAt(0)==="0"&&isNaN(parseInt(e))?!1:lP(n)?cP(n):"*"+n}function fP(e){const n=[];let r=-1,s=0,c=0,h,m,a,v,w,E,I;const M=[];M[0]=()=>{m===void 0?m=a:m+=a},M[1]=()=>{m!==void 0&&(n.push(m),m=void 0)},M[2]=()=>{M[0](),c++},M[3]=()=>{if(c>0)c--,s=4,M[0]();else{if(c=0,m===void 0||(m=hP(m),m===!1))return!1;M[1]()}};function P(){const j=e[r+1];if(s===5&&j==="'"||s===6&&j==='"')return r++,a="\\"+j,M[0](),!0}for(;s!==null;)if(r++,h=e[r],!(h==="\\"&&P())){if(v=uP(h),I=Sl[s],w=I[v]||I.l||8,w===8||(s=w[0],w[1]!==void 0&&(E=M[w[1]],E&&(a=h,E()===!1))))return;if(s===7)return n}}const aw=new Map;function dP(e,n){return kr(e)?e[n]:null}function pP(e,n){if(!kr(e))return null;let r=aw.get(n);if(r||(r=fP(n),r&&aw.set(n,r)),!r)return null;const s=r.length;let c=e,h=0;for(;h<s;){const m=c[r[h]];if(m===void 0)return null;c=m,h++}return c}const mP=e=>e,_P=e=>"",gP="text",yP=e=>e.length===0?"":e.join(""),vP=sP;function lw(e,n){return e=Math.abs(e),n===2?e?e>1?1:0:1:e?Math.min(e,2):0}function xP(e){const n=mi(e.pluralIndex)?e.pluralIndex:-1;return e.named&&(mi(e.named.count)||mi(e.named.n))?mi(e.named.count)?e.named.count:mi(e.named.n)?e.named.n:n:n}function bP(e,n){n.count||(n.count=e),n.n||(n.n=e)}function wP(e={}){const n=e.locale,r=xP(e),s=kr(e.pluralRules)&&Vt(n)&&fi(e.pluralRules[n])?e.pluralRules[n]:lw,c=kr(e.pluralRules)&&Vt(n)&&fi(e.pluralRules[n])?lw:void 0,h=q=>q[s(r,q.length,c)],m=e.list||[],a=q=>m[q],v=e.named||{};mi(e.pluralIndex)&&bP(r,v);const w=q=>v[q];function E(q){const V=fi(e.messages)?e.messages(q):kr(e.messages)?e.messages[q]:!1;return V||(e.parent?e.parent.message(q):_P)}const I=q=>e.modifiers?e.modifiers[q]:mP,M=Ln(e.processor)&&fi(e.processor.normalize)?e.processor.normalize:yP,P=Ln(e.processor)&&fi(e.processor.interpolate)?e.processor.interpolate:vP,j=Ln(e.processor)&&Vt(e.processor.type)?e.processor.type:gP,N={list:a,named:w,plural:h,linked:(q,V)=>{const ee=E(q)(N);return Vt(V)?I(V)(ee):ee},message:E,type:j,interpolate:P,normalize:M};return N}let wd=null;function TP(e){wd=e}function EP(e,n,r){wd&&wd.emit(eE.I18nInit,{timestamp:Date.now(),i18n:e,version:n,meta:r})}const SP=AP(eE.FunctionTranslate);function AP(e){return n=>wd&&wd.emit(e,n)}const CP={NOT_FOUND_KEY:1,FALLBACK_TO_TRANSLATE:2,CANNOT_FORMAT_NUMBER:3,FALLBACK_TO_NUMBER_FORMAT:4,CANNOT_FORMAT_DATE:5,FALLBACK_TO_DATE_FORMAT:6,__EXTEND_POINT__:7};function IP(e,n,r){return[...new Set([r,...ni(n)?n:kr(n)?Object.keys(n):Vt(n)?[n]:[r]])]}function tE(e,n,r){const s=Vt(r)?r:Fv,c=e;c.__localeChainCache||(c.__localeChainCache=new Map);let h=c.__localeChainCache.get(s);if(!h){h=[];let m=[r];for(;ni(m);)m=cw(h,m,n);const a=ni(n)||!Ln(n)?n:n.default?n.default:null;m=Vt(a)?[a]:a,ni(m)&&cw(h,m,!1),c.__localeChainCache.set(s,h)}return h}function cw(e,n,r){let s=!0;for(let c=0;c<n.length&&Hr(s);c++){const h=n[c];Vt(h)&&(s=MP(e,n[c],r))}return s}function MP(e,n,r){let s;const c=n.split("-");do{const h=c.join("-");s=kP(e,h,r),c.splice(-1,1)}while(c.length&&s===!0);return s}function kP(e,n,r){let s=!1;if(!e.includes(n)&&(s=!0,n)){s=n[n.length-1]!=="!";const c=n.replace(/!/g,"");e.push(c),(ni(r)||Ln(r))&&r[c]&&(s=r[c])}return s}const PP="9.2.0-beta.30",O_=-1,Fv="en-US",uw="";function DP(){return{upper:e=>Vt(e)?e.toUpperCase():e,lower:e=>Vt(e)?e.toLowerCase():e,capitalize:e=>Vt(e)?`${e.charAt(0).toLocaleUpperCase()}${e.substr(1)}`:e}}let RP,nE;function zP(e){nE=e}let rE;function OP(e){rE=e}let iE=null;const hw=e=>{iE=e},LP=()=>iE;let fw=0;function FP(e={}){const n=Vt(e.version)?e.version:PP,r=Vt(e.locale)?e.locale:Fv,s=ni(e.fallbackLocale)||Ln(e.fallbackLocale)||Vt(e.fallbackLocale)||e.fallbackLocale===!1?e.fallbackLocale:r,c=Ln(e.messages)?e.messages:{[r]:{}},h=Ln(e.datetimeFormats)?e.datetimeFormats:{[r]:{}},m=Ln(e.numberFormats)?e.numberFormats:{[r]:{}},a=Fi({},e.modifiers||{},DP()),v=e.pluralRules||{},w=fi(e.missing)?e.missing:null,E=Hr(e.missingWarn)||Gm(e.missingWarn)?e.missingWarn:!0,I=Hr(e.fallbackWarn)||Gm(e.fallbackWarn)?e.fallbackWarn:!0,M=!!e.fallbackFormat,P=!!e.unresolving,j=fi(e.postTranslation)?e.postTranslation:null,N=Ln(e.processor)?e.processor:null,q=Hr(e.warnHtmlMessage)?e.warnHtmlMessage:!0,V=!!e.escapeParameter,ee=fi(e.messageCompiler)?e.messageCompiler:RP,oe=fi(e.messageResolver)?e.messageResolver:nE||dP,pe=fi(e.localeFallbacker)?e.localeFallbacker:rE||IP,se=fi(e.onWarn)?e.onWarn:iP,xe=e,Te=kr(xe.__datetimeFormatters)?xe.__datetimeFormatters:new Map,De=kr(xe.__numberFormatters)?xe.__numberFormatters:new Map,Me=kr(xe.__meta)?xe.__meta:{};fw++;const Be={version:n,cid:fw,locale:r,fallbackLocale:s,messages:c,modifiers:a,pluralRules:v,missing:w,missingWarn:E,fallbackWarn:I,fallbackFormat:M,unresolving:P,postTranslation:j,processor:N,warnHtmlMessage:q,escapeParameter:V,messageCompiler:ee,messageResolver:oe,localeFallbacker:pe,onWarn:se,__meta:Me};return Be.datetimeFormats=h,Be.numberFormats=m,Be.__datetimeFormatters=Te,Be.__numberFormatters=De,__INTLIFY_PROD_DEVTOOLS__&&EP(Be,n,Me),Be}function Bv(e,n,r,s,c){const{missing:h,onWarn:m}=e;if(h!==null){const a=h(e,r,n,c);return Vt(a)?a:n}else return n}function $f(e,n,r){const s=e;s.__localeChainCache=new Map,e.localeFallbacker(e,r,n)}let oE=Q2.__EXTEND_POINT__;const R0=()=>++oE,ih={INVALID_ARGUMENT:oE,INVALID_DATE_ARGUMENT:R0(),INVALID_ISO_DATE_ARGUMENT:R0(),__EXTEND_POINT__:R0()};function oh(e){return J2(e,null,void 0)}const dw=()=>"",Us=e=>fi(e);function pw(e,...n){const{fallbackFormat:r,postTranslation:s,unresolving:c,messageCompiler:h,fallbackLocale:m,messages:a}=e,[v,w]=my(...n),E=Hr(w.missingWarn)?w.missingWarn:e.missingWarn,I=Hr(w.fallbackWarn)?w.fallbackWarn:e.fallbackWarn,M=Hr(w.escapeParameter)?w.escapeParameter:e.escapeParameter,P=!!w.resolvedMessage,j=Vt(w.default)||Hr(w.default)?Hr(w.default)?v:w.default:r?h?v:()=>v:"",N=r||j!=="",q=Vt(w.locale)?w.locale:e.locale;M&&BP(w);let[V,ee,oe]=P?[v,q,a[q]||{}]:UP(e,v,q,m,I,E),pe=V,se=v;if(!P&&!(Vt(pe)||Us(pe))&&N&&(pe=j,se=pe),!P&&(!(Vt(pe)||Us(pe))||!Vt(ee)))return c?O_:v;let xe=!1;const Te=()=>{xe=!0},De=Us(pe)?pe:sE(e,v,ee,pe,se,Te);if(xe)return pe;const Me=$P(e,ee,oe,w),Be=wP(Me),ze=NP(e,De,Be),Fe=s?s(ze):ze;if(__INTLIFY_PROD_DEVTOOLS__){const Je={timestamp:Date.now(),key:Vt(v)?v:Us(pe)?pe.key:"",locale:ee||(Us(pe)?pe.locale:""),format:Vt(pe)?pe:Us(pe)?pe.source:"",message:Fe};Je.meta=Fi({},e.__meta,LP()||{}),SP(Je)}return Fe}function BP(e){ni(e.list)?e.list=e.list.map(n=>Vt(n)?sw(n):n):kr(e.named)&&Object.keys(e.named).forEach(n=>{Vt(e.named[n])&&(e.named[n]=sw(e.named[n]))})}function UP(e,n,r,s,c,h){const{messages:m,onWarn:a,messageResolver:v,localeFallbacker:w}=e,E=w(e,s,r);let I={},M,P=null;const j="translate";for(let N=0;N<E.length&&(M=E[N],I=m[M]||{},(P=v(I,n))===null&&(P=I[n]),!(Vt(P)||fi(P)));N++){const q=Bv(e,n,M,h,j);q!==n&&(P=q)}return[P,M,I]}function sE(e,n,r,s,c,h){const{messageCompiler:m,warnHtmlMessage:a}=e;if(Us(s)){const w=s;return w.locale=w.locale||r,w.key=w.key||n,w}const v=m(s,jP(e,r,c,s,a,h));return v.locale=r,v.key=n,v.source=s,v}function NP(e,n,r){return n(r)}function my(...e){const[n,r,s]=e,c={};if(!Vt(n)&&!mi(n)&&!Us(n))throw oh(ih.INVALID_ARGUMENT);const h=mi(n)?String(n):(Us(n),n);return mi(r)?c.plural=r:Vt(r)?c.default=r:Ln(r)&&!z_(r)?c.named=r:ni(r)&&(c.list=r),mi(s)?c.plural=s:Vt(s)?c.default=s:Ln(s)&&Fi(c,s),[h,c]}function jP(e,n,r,s,c,h){return{warnHtmlMessage:c,onError:m=>{throw h&&h(m),m},onCacheKey:m=>tP(n,r,m)}}function $P(e,n,r,s){const{modifiers:c,pluralRules:h,messageResolver:m}=e,v={locale:n,modifiers:c,pluralRules:h,messages:w=>{const E=m(r,w);if(Vt(E)){let I=!1;const P=sE(e,w,n,E,w,()=>{I=!0});return I?dw:P}else return Us(E)?E:dw}};return e.processor&&(v.processor=e.processor),s.list&&(v.list=s.list),s.named&&(v.named=s.named),mi(s.plural)&&(v.pluralIndex=s.plural),v}function mw(e,...n){const{datetimeFormats:r,unresolving:s,fallbackLocale:c,onWarn:h,localeFallbacker:m}=e,{__datetimeFormatters:a}=e,[v,w,E,I]=_y(...n),M=Hr(E.missingWarn)?E.missingWarn:e.missingWarn;Hr(E.fallbackWarn)?E.fallbackWarn:e.fallbackWarn;const P=!!E.part,j=Vt(E.locale)?E.locale:e.locale,N=m(e,c,j);if(!Vt(v)||v==="")return new Intl.DateTimeFormat(j).format(w);let q={},V,ee=null;const oe="datetime format";for(let xe=0;xe<N.length&&(V=N[xe],q=r[V]||{},ee=q[v],!Ln(ee));xe++)Bv(e,v,V,M,oe);if(!Ln(ee)||!Vt(V))return s?O_:v;let pe=`${V}__${v}`;z_(I)||(pe=`${pe}__${JSON.stringify(I)}`);let se=a.get(pe);return se||(se=new Intl.DateTimeFormat(V,Fi({},ee,I)),a.set(pe,se)),P?se.formatToParts(w):se.format(w)}function _y(...e){const[n,r,s,c]=e;let h={},m={},a;if(Vt(n)){const v=n.match(/(\d{4}-\d{2}-\d{2})(T|\s)?(.*)/);if(!v)throw oh(ih.INVALID_ISO_DATE_ARGUMENT);const w=v[3]?v[3].trim().startsWith("T")?`${v[1].trim()}${v[3].trim()}`:`${v[1].trim()}T${v[3].trim()}`:v[1].trim();a=new Date(w);try{a.toISOString()}catch{throw oh(ih.INVALID_ISO_DATE_ARGUMENT)}}else if(rP(n)){if(isNaN(n.getTime()))throw oh(ih.INVALID_DATE_ARGUMENT);a=n}else if(mi(n))a=n;else throw oh(ih.INVALID_ARGUMENT);return Vt(r)?h.key=r:Ln(r)&&(h=r),Vt(s)?h.locale=s:Ln(s)&&(m=s),Ln(c)&&(m=c),[h.key||"",a,h,m]}function _w(e,n,r){const s=e;for(const c in r){const h=`${n}__${c}`;!s.__datetimeFormatters.has(h)||s.__datetimeFormatters.delete(h)}}function gw(e,...n){const{numberFormats:r,unresolving:s,fallbackLocale:c,onWarn:h,localeFallbacker:m}=e,{__numberFormatters:a}=e,[v,w,E,I]=gy(...n),M=Hr(E.missingWarn)?E.missingWarn:e.missingWarn;Hr(E.fallbackWarn)?E.fallbackWarn:e.fallbackWarn;const P=!!E.part,j=Vt(E.locale)?E.locale:e.locale,N=m(e,c,j);if(!Vt(v)||v==="")return new Intl.NumberFormat(j).format(w);let q={},V,ee=null;const oe="number format";for(let xe=0;xe<N.length&&(V=N[xe],q=r[V]||{},ee=q[v],!Ln(ee));xe++)Bv(e,v,V,M,oe);if(!Ln(ee)||!Vt(V))return s?O_:v;let pe=`${V}__${v}`;z_(I)||(pe=`${pe}__${JSON.stringify(I)}`);let se=a.get(pe);return se||(se=new Intl.NumberFormat(V,Fi({},ee,I)),a.set(pe,se)),P?se.formatToParts(w):se.format(w)}function gy(...e){const[n,r,s,c]=e;let h={},m={};if(!mi(n))throw oh(ih.INVALID_ARGUMENT);const a=n;return Vt(r)?h.key=r:Ln(r)&&(h=r),Vt(s)?h.locale=s:Ln(s)&&(m=s),Ln(c)&&(m=c),[h.key||"",a,h,m]}function yw(e,n,r){const s=e;for(const c in r){const h=`${n}__${c}`;!s.__numberFormatters.has(h)||s.__numberFormatters.delete(h)}}typeof __INTLIFY_PROD_DEVTOOLS__!="boolean"&&(zv().__INTLIFY_PROD_DEVTOOLS__=!1);function Uv(e,n){const r=Object.create(null),s=e.split(",");for(let c=0;c<s.length;c++)r[s[c]]=!0;return n?c=>!!r[c.toLowerCase()]:c=>!!r[c]}const VP="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",GP=Uv(VP);function aE(e){return!!e||e===""}function Nv(e){if(en(e)){const n={};for(let r=0;r<e.length;r++){const s=e[r],c=$r(s)?WP(s):Nv(s);if(c)for(const h in c)n[h]=c[h]}return n}else{if($r(e))return e;if(Vr(e))return e}}const qP=/;(?![^(]*\))/g,ZP=/:(.+)/;function WP(e){const n={};return e.split(qP).forEach(r=>{if(r){const s=r.split(ZP);s.length>1&&(n[s[0].trim()]=s[1].trim())}}),n}function jv(e){let n="";if($r(e))n=e;else if(en(e))for(let r=0;r<e.length;r++){const s=jv(e[r]);s&&(n+=s+" ")}else if(Vr(e))for(const r in e)e[r]&&(n+=r+" ");return n.trim()}const g8=e=>$r(e)?e:e==null?"":en(e)||Vr(e)&&(e.toString===hE||!mn(e.toString))?JSON.stringify(e,lE,2):String(e),lE=(e,n)=>n&&n.__v_isRef?lE(e,n.value):hh(n)?{[`Map(${n.size})`]:[...n.entries()].reduce((r,[s,c])=>(r[`${s} =>`]=c,r),{})}:cE(n)?{[`Set(${n.size})`]:[...n.values()]}:Vr(n)&&!en(n)&&!fE(n)?String(n):n,ir={},uh=[],ms=()=>{},HP=()=>!1,XP=/^on[^a-z]/,$d=e=>XP.test(e),$v=e=>e.startsWith("onUpdate:"),ii=Object.assign,Vv=(e,n)=>{const r=e.indexOf(n);r>-1&&e.splice(r,1)},KP=Object.prototype.hasOwnProperty,Un=(e,n)=>KP.call(e,n),en=Array.isArray,hh=e=>L_(e)==="[object Map]",cE=e=>L_(e)==="[object Set]",mn=e=>typeof e=="function",$r=e=>typeof e=="string",Gv=e=>typeof e=="symbol",Vr=e=>e!==null&&typeof e=="object",uE=e=>Vr(e)&&mn(e.then)&&mn(e.catch),hE=Object.prototype.toString,L_=e=>hE.call(e),YP=e=>L_(e).slice(8,-1),fE=e=>L_(e)==="[object Object]",qv=e=>$r(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,ld=Uv(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),F_=e=>{const n=Object.create(null);return r=>n[r]||(n[r]=e(r))},QP=/-(\w)/g,Ws=F_(e=>e.replace(QP,(n,r)=>r?r.toUpperCase():"")),JP=/\B([A-Z])/g,zh=F_(e=>e.replace(JP,"-$1").toLowerCase()),B_=F_(e=>e.charAt(0).toUpperCase()+e.slice(1)),z0=F_(e=>e?`on${B_(e)}`:""),Td=(e,n)=>!Object.is(e,n),O0=(e,n)=>{for(let r=0;r<e.length;r++)e[r](n)},qm=(e,n,r)=>{Object.defineProperty(e,n,{configurable:!0,enumerable:!1,value:r})},dE=e=>{const n=parseFloat(e);return isNaN(n)?e:n};let vw;const eD=()=>vw||(vw=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let No;class tD{constructor(n=!1){this.active=!0,this.effects=[],this.cleanups=[],!n&&No&&(this.parent=No,this.index=(No.scopes||(No.scopes=[])).push(this)-1)}run(n){if(this.active)try{return No=this,n()}finally{No=this.parent}}on(){No=this}off(){No=this.parent}stop(n){if(this.active){let r,s;for(r=0,s=this.effects.length;r<s;r++)this.effects[r].stop();for(r=0,s=this.cleanups.length;r<s;r++)this.cleanups[r]();if(this.scopes)for(r=0,s=this.scopes.length;r<s;r++)this.scopes[r].stop(!0);if(this.parent&&!n){const c=this.parent.scopes.pop();c&&c!==this&&(this.parent.scopes[this.index]=c,c.index=this.index)}this.active=!1}}}function nD(e,n=No){n&&n.active&&n.effects.push(e)}function rD(){return No}function iD(e){No&&No.cleanups.push(e)}const Zv=e=>{const n=new Set(e);return n.w=0,n.n=0,n},pE=e=>(e.w&xl)>0,mE=e=>(e.n&xl)>0,oD=({deps:e})=>{if(e.length)for(let n=0;n<e.length;n++)e[n].w|=xl},sD=e=>{const{deps:n}=e;if(n.length){let r=0;for(let s=0;s<n.length;s++){const c=n[s];pE(c)&&!mE(c)?c.delete(e):n[r++]=c,c.w&=~xl,c.n&=~xl}n.length=r}},yy=new WeakMap;let Yf=0,xl=1;const vy=30;let qs;const kc=Symbol(""),xy=Symbol("");class Wv{constructor(n,r=null,s){this.fn=n,this.scheduler=r,this.active=!0,this.deps=[],this.parent=void 0,nD(this,s)}run(){if(!this.active)return this.fn();let n=qs,r=_l;for(;n;){if(n===this)return;n=n.parent}try{return this.parent=qs,qs=this,_l=!0,xl=1<<++Yf,Yf<=vy?oD(this):xw(this),this.fn()}finally{Yf<=vy&&sD(this),xl=1<<--Yf,qs=this.parent,_l=r,this.parent=void 0}}stop(){this.active&&(xw(this),this.onStop&&this.onStop(),this.active=!1)}}function xw(e){const{deps:n}=e;if(n.length){for(let r=0;r<n.length;r++)n[r].delete(e);n.length=0}}let _l=!0;const _E=[];function Oh(){_E.push(_l),_l=!1}function Lh(){const e=_E.pop();_l=e===void 0?!0:e}function wo(e,n,r){if(_l&&qs){let s=yy.get(e);s||yy.set(e,s=new Map);let c=s.get(r);c||s.set(r,c=Zv()),gE(c)}}function gE(e,n){let r=!1;Yf<=vy?mE(e)||(e.n|=xl,r=!pE(e)):r=!e.has(qs),r&&(e.add(qs),qs.deps.push(e))}function _a(e,n,r,s,c,h){const m=yy.get(e);if(!m)return;let a=[];if(n==="clear")a=[...m.values()];else if(r==="length"&&en(e))m.forEach((v,w)=>{(w==="length"||w>=s)&&a.push(v)});else switch(r!==void 0&&a.push(m.get(r)),n){case"add":en(e)?qv(r)&&a.push(m.get("length")):(a.push(m.get(kc)),hh(e)&&a.push(m.get(xy)));break;case"delete":en(e)||(a.push(m.get(kc)),hh(e)&&a.push(m.get(xy)));break;case"set":hh(e)&&a.push(m.get(kc));break}if(a.length===1)a[0]&&by(a[0]);else{const v=[];for(const w of a)w&&v.push(...w);by(Zv(v))}}function by(e,n){for(const r of en(e)?e:[...e])(r!==qs||r.allowRecurse)&&(r.scheduler?r.scheduler():r.run())}const aD=Uv("__proto__,__v_isRef,__isVue"),yE=new Set(Object.getOwnPropertyNames(Symbol).map(e=>Symbol[e]).filter(Gv)),lD=Hv(),cD=Hv(!1,!0),uD=Hv(!0),bw=hD();function hD(){const e={};return["includes","indexOf","lastIndexOf"].forEach(n=>{e[n]=function(...r){const s=un(this);for(let h=0,m=this.length;h<m;h++)wo(s,"get",h+"");const c=s[n](...r);return c===-1||c===!1?s[n](...r.map(un)):c}}),["push","pop","shift","unshift","splice"].forEach(n=>{e[n]=function(...r){Oh();const s=un(this)[n].apply(this,r);return Lh(),s}}),e}function Hv(e=!1,n=!1){return function(s,c,h){if(c==="__v_isReactive")return!e;if(c==="__v_isReadonly")return e;if(c==="__v_isShallow")return n;if(c==="__v_raw"&&h===(e?n?CD:TE:n?wE:bE).get(s))return s;const m=en(s);if(!e&&m&&Un(bw,c))return Reflect.get(bw,c,h);const a=Reflect.get(s,c,h);return(Gv(c)?yE.has(c):aD(c))||(e||wo(s,"get",c),n)?a:Ar(a)?!m||!qv(c)?a.value:a:Vr(a)?e?N_(a):Al(a):a}}const fD=vE(),dD=vE(!0);function vE(e=!1){return function(r,s,c,h){let m=r[s];if(Ed(m)&&Ar(m)&&!Ar(c))return!1;if(!e&&!Ed(c)&&(EE(c)||(c=un(c),m=un(m)),!en(r)&&Ar(m)&&!Ar(c)))return m.value=c,!0;const a=en(r)&&qv(s)?Number(s)<r.length:Un(r,s),v=Reflect.set(r,s,c,h);return r===un(h)&&(a?Td(c,m)&&_a(r,"set",s,c):_a(r,"add",s,c)),v}}function pD(e,n){const r=Un(e,n);e[n];const s=Reflect.deleteProperty(e,n);return s&&r&&_a(e,"delete",n,void 0),s}function mD(e,n){const r=Reflect.has(e,n);return(!Gv(n)||!yE.has(n))&&wo(e,"has",n),r}function _D(e){return wo(e,"iterate",en(e)?"length":kc),Reflect.ownKeys(e)}const xE={get:lD,set:fD,deleteProperty:pD,has:mD,ownKeys:_D},gD={get:uD,set(e,n){return!0},deleteProperty(e,n){return!0}},yD=ii({},xE,{get:cD,set:dD}),Xv=e=>e,U_=e=>Reflect.getPrototypeOf(e);function bm(e,n,r=!1,s=!1){e=e.__v_raw;const c=un(e),h=un(n);n!==h&&!r&&wo(c,"get",n),!r&&wo(c,"get",h);const{has:m}=U_(c),a=s?Xv:r?Qv:Sd;if(m.call(c,n))return a(e.get(n));if(m.call(c,h))return a(e.get(h));e!==c&&e.get(n)}function wm(e,n=!1){const r=this.__v_raw,s=un(r),c=un(e);return e!==c&&!n&&wo(s,"has",e),!n&&wo(s,"has",c),e===c?r.has(e):r.has(e)||r.has(c)}function Tm(e,n=!1){return e=e.__v_raw,!n&&wo(un(e),"iterate",kc),Reflect.get(e,"size",e)}function ww(e){e=un(e);const n=un(this);return U_(n).has.call(n,e)||(n.add(e),_a(n,"add",e,e)),this}function Tw(e,n){n=un(n);const r=un(this),{has:s,get:c}=U_(r);let h=s.call(r,e);h||(e=un(e),h=s.call(r,e));const m=c.call(r,e);return r.set(e,n),h?Td(n,m)&&_a(r,"set",e,n):_a(r,"add",e,n),this}function Ew(e){const n=un(this),{has:r,get:s}=U_(n);let c=r.call(n,e);c||(e=un(e),c=r.call(n,e)),s&&s.call(n,e);const h=n.delete(e);return c&&_a(n,"delete",e,void 0),h}function Sw(){const e=un(this),n=e.size!==0,r=e.clear();return n&&_a(e,"clear",void 0,void 0),r}function Em(e,n){return function(s,c){const h=this,m=h.__v_raw,a=un(m),v=n?Xv:e?Qv:Sd;return!e&&wo(a,"iterate",kc),m.forEach((w,E)=>s.call(c,v(w),v(E),h))}}function Sm(e,n,r){return function(...s){const c=this.__v_raw,h=un(c),m=hh(h),a=e==="entries"||e===Symbol.iterator&&m,v=e==="keys"&&m,w=c[e](...s),E=r?Xv:n?Qv:Sd;return!n&&wo(h,"iterate",v?xy:kc),{next(){const{value:I,done:M}=w.next();return M?{value:I,done:M}:{value:a?[E(I[0]),E(I[1])]:E(I),done:M}},[Symbol.iterator](){return this}}}}function Qa(e){return function(...n){return e==="delete"?!1:this}}function vD(){const e={get(h){return bm(this,h)},get size(){return Tm(this)},has:wm,add:ww,set:Tw,delete:Ew,clear:Sw,forEach:Em(!1,!1)},n={get(h){return bm(this,h,!1,!0)},get size(){return Tm(this)},has:wm,add:ww,set:Tw,delete:Ew,clear:Sw,forEach:Em(!1,!0)},r={get(h){return bm(this,h,!0)},get size(){return Tm(this,!0)},has(h){return wm.call(this,h,!0)},add:Qa("add"),set:Qa("set"),delete:Qa("delete"),clear:Qa("clear"),forEach:Em(!0,!1)},s={get(h){return bm(this,h,!0,!0)},get size(){return Tm(this,!0)},has(h){return wm.call(this,h,!0)},add:Qa("add"),set:Qa("set"),delete:Qa("delete"),clear:Qa("clear"),forEach:Em(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(h=>{e[h]=Sm(h,!1,!1),r[h]=Sm(h,!0,!1),n[h]=Sm(h,!1,!0),s[h]=Sm(h,!0,!0)}),[e,r,n,s]}const[xD,bD,wD,TD]=vD();function Kv(e,n){const r=n?e?TD:wD:e?bD:xD;return(s,c,h)=>c==="__v_isReactive"?!e:c==="__v_isReadonly"?e:c==="__v_raw"?s:Reflect.get(Un(r,c)&&c in s?r:s,c,h)}const ED={get:Kv(!1,!1)},SD={get:Kv(!1,!0)},AD={get:Kv(!0,!1)},bE=new WeakMap,wE=new WeakMap,TE=new WeakMap,CD=new WeakMap;function ID(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function MD(e){return e.__v_skip||!Object.isExtensible(e)?0:ID(YP(e))}function Al(e){return Ed(e)?e:Yv(e,!1,xE,ED,bE)}function kD(e){return Yv(e,!1,yD,SD,wE)}function N_(e){return Yv(e,!0,gD,AD,TE)}function Yv(e,n,r,s,c){if(!Vr(e)||e.__v_raw&&!(n&&e.__v_isReactive))return e;const h=c.get(e);if(h)return h;const m=MD(e);if(m===0)return e;const a=new Proxy(e,m===2?s:r);return c.set(e,a),a}function fh(e){return Ed(e)?fh(e.__v_raw):!!(e&&e.__v_isReactive)}function Ed(e){return!!(e&&e.__v_isReadonly)}function EE(e){return!!(e&&e.__v_isShallow)}function SE(e){return fh(e)||Ed(e)}function un(e){const n=e&&e.__v_raw;return n?un(n):e}function AE(e){return qm(e,"__v_skip",!0),e}const Sd=e=>Vr(e)?Al(e):e,Qv=e=>Vr(e)?N_(e):e;function CE(e){_l&&qs&&(e=un(e),gE(e.dep||(e.dep=Zv())))}function IE(e,n){e=un(e),e.dep&&by(e.dep)}function Ar(e){return!!(e&&e.__v_isRef===!0)}function ft(e){return kE(e,!1)}function ME(e){return kE(e,!0)}function kE(e,n){return Ar(e)?e:new PD(e,n)}class PD{constructor(n,r){this.__v_isShallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?n:un(n),this._value=r?n:Sd(n)}get value(){return CE(this),this._value}set value(n){n=this.__v_isShallow?n:un(n),Td(n,this._rawValue)&&(this._rawValue=n,this._value=this.__v_isShallow?n:Sd(n),IE(this))}}function qo(e){return Ar(e)?e.value:e}const DD={get:(e,n,r)=>qo(Reflect.get(e,n,r)),set:(e,n,r,s)=>{const c=e[n];return Ar(c)&&!Ar(r)?(c.value=r,!0):Reflect.set(e,n,r,s)}};function PE(e){return fh(e)?e:new Proxy(e,DD)}function DE(e){const n=en(e)?new Array(e.length):{};for(const r in e)n[r]=zD(e,r);return n}class RD{constructor(n,r,s){this._object=n,this._key=r,this._defaultValue=s,this.__v_isRef=!0}get value(){const n=this._object[this._key];return n===void 0?this._defaultValue:n}set value(n){this._object[this._key]=n}}function zD(e,n,r){const s=e[n];return Ar(s)?s:new RD(e,n,r)}class OD{constructor(n,r,s,c){this._setter=r,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new Wv(n,()=>{this._dirty||(this._dirty=!0,IE(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!c,this.__v_isReadonly=s}get value(){const n=un(this);return CE(n),(n._dirty||!n._cacheable)&&(n._dirty=!1,n._value=n.effect.run()),n._value}set value(n){this._setter(n)}}function LD(e,n,r=!1){let s,c;const h=mn(e);return h?(s=e,c=ms):(s=e.get,c=e.set),new OD(s,c,h||!c,r)}Promise.resolve();function gl(e,n,r,s){let c;try{c=s?e(...s):e()}catch(h){j_(h,n,r)}return c}function Zo(e,n,r,s){if(mn(e)){const h=gl(e,n,r,s);return h&&uE(h)&&h.catch(m=>{j_(m,n,r)}),h}const c=[];for(let h=0;h<e.length;h++)c.push(Zo(e[h],n,r,s));return c}function j_(e,n,r,s=!0){const c=n?n.vnode:null;if(n){let h=n.parent;const m=n.proxy,a=r;for(;h;){const w=h.ec;if(w){for(let E=0;E<w.length;E++)if(w[E](e,m,a)===!1)return}h=h.parent}const v=n.appContext.config.errorHandler;if(v){gl(v,null,10,[e,m,a]);return}}FD(e,r,c,s)}function FD(e,n,r,s=!0){console.error(e)}let Zm=!1,wy=!1;const _o=[];let da=0;const cd=[];let Qf=null,eh=0;const ud=[];let ol=null,th=0;const RE=Promise.resolve();let Jv=null,Ty=null;function Yn(e){const n=Jv||RE;return e?n.then(this?e.bind(this):e):n}function BD(e){let n=da+1,r=_o.length;for(;n<r;){const s=n+r>>>1;Ad(_o[s])<e?n=s+1:r=s}return n}function zE(e){(!_o.length||!_o.includes(e,Zm&&e.allowRecurse?da+1:da))&&e!==Ty&&(e.id==null?_o.push(e):_o.splice(BD(e.id),0,e),OE())}function OE(){!Zm&&!wy&&(wy=!0,Jv=RE.then(FE))}function UD(e){const n=_o.indexOf(e);n>da&&_o.splice(n,1)}function LE(e,n,r,s){en(e)?r.push(...e):(!n||!n.includes(e,e.allowRecurse?s+1:s))&&r.push(e),OE()}function ND(e){LE(e,Qf,cd,eh)}function jD(e){LE(e,ol,ud,th)}function ex(e,n=null){if(cd.length){for(Ty=n,Qf=[...new Set(cd)],cd.length=0,eh=0;eh<Qf.length;eh++)Qf[eh]();Qf=null,eh=0,Ty=null,ex(e,n)}}function Wm(e){if(ud.length){const n=[...new Set(ud)];if(ud.length=0,ol){ol.push(...n);return}for(ol=n,ol.sort((r,s)=>Ad(r)-Ad(s)),th=0;th<ol.length;th++)ol[th]();ol=null,th=0}}const Ad=e=>e.id==null?1/0:e.id;function FE(e){wy=!1,Zm=!0,ex(e),_o.sort((r,s)=>Ad(r)-Ad(s));const n=ms;try{for(da=0;da<_o.length;da++){const r=_o[da];r&&r.active!==!1&&gl(r,null,14)}}finally{da=0,_o.length=0,Wm(),Zm=!1,Jv=null,(_o.length||cd.length||ud.length)&&FE(e)}}function $D(e,n,...r){const s=e.vnode.props||ir;let c=r;const h=n.startsWith("update:"),m=h&&n.slice(7);if(m&&m in s){const E=`${m==="modelValue"?"model":m}Modifiers`,{number:I,trim:M}=s[E]||ir;M?c=r.map(P=>P.trim()):I&&(c=r.map(dE))}let a,v=s[a=z0(n)]||s[a=z0(Ws(n))];!v&&h&&(v=s[a=z0(zh(n))]),v&&Zo(v,e,6,c);const w=s[a+"Once"];if(w){if(!e.emitted)e.emitted={};else if(e.emitted[a])return;e.emitted[a]=!0,Zo(w,e,6,c)}}function BE(e,n,r=!1){const s=n.emitsCache,c=s.get(e);if(c!==void 0)return c;const h=e.emits;let m={},a=!1;if(!mn(e)){const v=w=>{const E=BE(w,n,!0);E&&(a=!0,ii(m,E))};!r&&n.mixins.length&&n.mixins.forEach(v),e.extends&&v(e.extends),e.mixins&&e.mixins.forEach(v)}return!h&&!a?(s.set(e,null),null):(en(h)?h.forEach(v=>m[v]=null):ii(m,h),s.set(e,m),m)}function tx(e,n){return!e||!$d(n)?!1:(n=n.slice(2).replace(/Once$/,""),Un(e,n[0].toLowerCase()+n.slice(1))||Un(e,zh(n))||Un(e,n))}let go=null,$_=null;function Hm(e){const n=go;return go=e,$_=e&&e.type.__scopeId||null,n}function y8(e){$_=e}function v8(){$_=null}const x8=e=>UE;function UE(e,n=go,r){if(!n||e._n)return e;const s=(...c)=>{s._d&&Fw(-1);const h=Hm(n),m=e(...c);return Hm(h),s._d&&Fw(1),m};return s._n=!0,s._c=!0,s._d=!0,s}function L0(e){const{type:n,vnode:r,proxy:s,withProxy:c,props:h,propsOptions:[m],slots:a,attrs:v,emit:w,render:E,renderCache:I,data:M,setupState:P,ctx:j,inheritAttrs:N}=e;let q,V;const ee=Hm(e);try{if(r.shapeFlag&4){const pe=c||s;q=hs(E.call(pe,pe,I,h,P,M,j)),V=v}else{const pe=n;q=hs(pe.length>1?pe(h,{attrs:v,slots:a,emit:w}):pe(h,null)),V=n.props?v:VD(v)}}catch(pe){fd.length=0,j_(pe,e,1),q=Xr(Ho)}let oe=q;if(V&&N!==!1){const pe=Object.keys(V),{shapeFlag:se}=oe;pe.length&&se&7&&(m&&pe.some($v)&&(V=GD(V,m)),oe=Bc(oe,V))}return r.dirs&&(oe.dirs=oe.dirs?oe.dirs.concat(r.dirs):r.dirs),r.transition&&(oe.transition=r.transition),q=oe,Hm(ee),q}const VD=e=>{let n;for(const r in e)(r==="class"||r==="style"||$d(r))&&((n||(n={}))[r]=e[r]);return n},GD=(e,n)=>{const r={};for(const s in e)(!$v(s)||!(s.slice(9)in n))&&(r[s]=e[s]);return r};function qD(e,n,r){const{props:s,children:c,component:h}=e,{props:m,children:a,patchFlag:v}=n,w=h.emitsOptions;if(n.dirs||n.transition)return!0;if(r&&v>=0){if(v&1024)return!0;if(v&16)return s?Aw(s,m,w):!!m;if(v&8){const E=n.dynamicProps;for(let I=0;I<E.length;I++){const M=E[I];if(m[M]!==s[M]&&!tx(w,M))return!0}}}else return(c||a)&&(!a||!a.$stable)?!0:s===m?!1:s?m?Aw(s,m,w):!0:!!m;return!1}function Aw(e,n,r){const s=Object.keys(n);if(s.length!==Object.keys(e).length)return!0;for(let c=0;c<s.length;c++){const h=s[c];if(n[h]!==e[h]&&!tx(r,h))return!0}return!1}function ZD({vnode:e,parent:n},r){for(;n&&n.subTree===e;)(e=n.vnode).el=r,n=n.parent}const WD=e=>e.__isSuspense;function NE(e,n){n&&n.pendingBranch?en(e)?n.effects.push(...e):n.effects.push(e):jD(e)}function fr(e,n){if(ti){let r=ti.provides;const s=ti.parent&&ti.parent.provides;s===r&&(r=ti.provides=Object.create(s)),r[e]=n}}function kn(e,n,r=!1){const s=ti||go;if(s){const c=s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides;if(c&&e in c)return c[e];if(arguments.length>1)return r&&mn(n)?n.call(s.proxy):n}}function dr(e,n){return V_(e,null,n)}function HD(e,n){return V_(e,null,{flush:"post"})}const Cw={};function gi(e,n,r){return V_(e,n,r)}function V_(e,n,{immediate:r,deep:s,flush:c,onTrack:h,onTrigger:m}=ir){const a=ti;let v,w=!1,E=!1;if(Ar(e)?(v=()=>e.value,w=EE(e)):fh(e)?(v=()=>e,s=!0):en(e)?(E=!0,w=e.some(fh),v=()=>e.map(V=>{if(Ar(V))return V.value;if(fh(V))return Cc(V);if(mn(V))return gl(V,a,2)})):mn(e)?n?v=()=>gl(e,a,2):v=()=>{if(!(a&&a.isUnmounted))return I&&I(),Zo(e,a,3,[M])}:v=ms,n&&s){const V=v;v=()=>Cc(V())}let I,M=V=>{I=q.onStop=()=>{gl(V,a,4)}};if(Md)return M=ms,n?r&&Zo(n,a,3,[v(),E?[]:void 0,M]):v(),ms;let P=E?[]:Cw;const j=()=>{if(!!q.active)if(n){const V=q.run();(s||w||(E?V.some((ee,oe)=>Td(ee,P[oe])):Td(V,P)))&&(I&&I(),Zo(n,a,3,[V,P===Cw?void 0:P,M]),P=V)}else q.run()};j.allowRecurse=!!n;let N;c==="sync"?N=j:c==="post"?N=()=>Yi(j,a&&a.suspense):N=()=>{!a||a.isMounted?ND(j):j()};const q=new Wv(v,N);return n?r?j():P=q.run():c==="post"?Yi(q.run.bind(q),a&&a.suspense):q.run(),()=>{q.stop(),a&&a.scope&&Vv(a.scope.effects,q)}}function XD(e,n,r){const s=this.proxy,c=$r(e)?e.includes(".")?jE(s,e):()=>s[e]:e.bind(s,s);let h;mn(n)?h=n:(h=n.handler,r=n);const m=ti;vh(this);const a=V_(c,h.bind(s),r);return m?vh(m):Dc(),a}function jE(e,n){const r=n.split(".");return()=>{let s=e;for(let c=0;c<r.length&&s;c++)s=s[r[c]];return s}}function Cc(e,n){if(!Vr(e)||e.__v_skip||(n=n||new Set,n.has(e)))return e;if(n.add(e),Ar(e))Cc(e.value,n);else if(en(e))for(let r=0;r<e.length;r++)Cc(e[r],n);else if(cE(e)||hh(e))e.forEach(r=>{Cc(r,n)});else if(fE(e))for(const r in e)Cc(e[r],n);return e}function $E(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return cr(()=>{e.isMounted=!0}),rx(()=>{e.isUnmounting=!0}),e}const Lo=[Function,Array],KD={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Lo,onEnter:Lo,onAfterEnter:Lo,onEnterCancelled:Lo,onBeforeLeave:Lo,onLeave:Lo,onAfterLeave:Lo,onLeaveCancelled:Lo,onBeforeAppear:Lo,onAppear:Lo,onAfterAppear:Lo,onAppearCancelled:Lo},setup(e,{slots:n}){const r=Cl(),s=$E();let c;return()=>{const h=n.default&&nx(n.default(),!0);if(!h||!h.length)return;const m=un(e),{mode:a}=m,v=h[0];if(s.isLeaving)return F0(v);const w=Iw(v);if(!w)return F0(v);const E=Cd(w,m,s,r);Id(w,E);const I=r.subTree,M=I&&Iw(I);let P=!1;const{getTransitionKey:j}=w.type;if(j){const N=j();c===void 0?c=N:N!==c&&(c=N,P=!0)}if(M&&M.type!==Ho&&(!Ec(w,M)||P)){const N=Cd(M,m,s,r);if(Id(M,N),a==="out-in")return s.isLeaving=!0,N.afterLeave=()=>{s.isLeaving=!1,r.update()},F0(v);a==="in-out"&&w.type!==Ho&&(N.delayLeave=(q,V,ee)=>{const oe=GE(s,M);oe[String(M.key)]=M,q._leaveCb=()=>{V(),q._leaveCb=void 0,delete E.delayedLeave},E.delayedLeave=ee})}return v}}},VE=KD;function GE(e,n){const{leavingVNodes:r}=e;let s=r.get(n.type);return s||(s=Object.create(null),r.set(n.type,s)),s}function Cd(e,n,r,s){const{appear:c,mode:h,persisted:m=!1,onBeforeEnter:a,onEnter:v,onAfterEnter:w,onEnterCancelled:E,onBeforeLeave:I,onLeave:M,onAfterLeave:P,onLeaveCancelled:j,onBeforeAppear:N,onAppear:q,onAfterAppear:V,onAppearCancelled:ee}=n,oe=String(e.key),pe=GE(r,e),se=(Te,De)=>{Te&&Zo(Te,s,9,De)},xe={mode:h,persisted:m,beforeEnter(Te){let De=a;if(!r.isMounted)if(c)De=N||a;else return;Te._leaveCb&&Te._leaveCb(!0);const Me=pe[oe];Me&&Ec(e,Me)&&Me.el._leaveCb&&Me.el._leaveCb(),se(De,[Te])},enter(Te){let De=v,Me=w,Be=E;if(!r.isMounted)if(c)De=q||v,Me=V||w,Be=ee||E;else return;let ze=!1;const Fe=Te._enterCb=Je=>{ze||(ze=!0,Je?se(Be,[Te]):se(Me,[Te]),xe.delayedLeave&&xe.delayedLeave(),Te._enterCb=void 0)};De?(De(Te,Fe),De.length<=1&&Fe()):Fe()},leave(Te,De){const Me=String(e.key);if(Te._enterCb&&Te._enterCb(!0),r.isUnmounting)return De();se(I,[Te]);let Be=!1;const ze=Te._leaveCb=Fe=>{Be||(Be=!0,De(),Fe?se(j,[Te]):se(P,[Te]),Te._leaveCb=void 0,pe[Me]===e&&delete pe[Me])};pe[Me]=e,M?(M(Te,ze),M.length<=1&&ze()):ze()},clone(Te){return Cd(Te,n,r,s)}};return xe}function F0(e){if(G_(e))return e=Bc(e),e.children=null,e}function Iw(e){return G_(e)?e.children?e.children[0]:void 0:e}function Id(e,n){e.shapeFlag&6&&e.component?Id(e.component.subTree,n):e.shapeFlag&128?(e.ssContent.transition=n.clone(e.ssContent),e.ssFallback.transition=n.clone(e.ssFallback)):e.transition=n}function nx(e,n=!1){let r=[],s=0;for(let c=0;c<e.length;c++){const h=e[c];h.type===di?(h.patchFlag&128&&s++,r=r.concat(nx(h.children,n))):(n||h.type!==Ho)&&r.push(h)}if(s>1)for(let c=0;c<r.length;c++)r[c].patchFlag=-2;return r}function Yt(e){return mn(e)?{setup:e,name:e.name}:e}const Xm=e=>!!e.type.__asyncLoader,G_=e=>e.type.__isKeepAlive;function qE(e,n){WE(e,"a",n)}function ZE(e,n){WE(e,"da",n)}function WE(e,n,r=ti){const s=e.__wdc||(e.__wdc=()=>{let c=r;for(;c;){if(c.isDeactivated)return;c=c.parent}return e()});if(q_(n,s,r),r){let c=r.parent;for(;c&&c.parent;)G_(c.parent.vnode)&&YD(s,n,r,c),c=c.parent}}function YD(e,n,r,s){const c=q_(n,e,s,!0);Cr(()=>{Vv(s[n],c)},r)}function q_(e,n,r=ti,s=!1){if(r){const c=r[e]||(r[e]=[]),h=n.__weh||(n.__weh=(...m)=>{if(r.isUnmounted)return;Oh(),vh(r);const a=Zo(n,r,e,m);return Dc(),Lh(),a});return s?c.unshift(h):c.push(h),h}}const xa=e=>(n,r=ti)=>(!Md||e==="sp")&&q_(e,n,r),QD=xa("bm"),cr=xa("m"),JD=xa("bu"),Z_=xa("u"),rx=xa("bum"),Cr=xa("um"),e3=xa("sp"),t3=xa("rtg"),n3=xa("rtc");function r3(e,n=ti){q_("ec",e,n)}let Ey=!0;function i3(e){const n=XE(e),r=e.proxy,s=e.ctx;Ey=!1,n.beforeCreate&&Mw(n.beforeCreate,e,"bc");const{data:c,computed:h,methods:m,watch:a,provide:v,inject:w,created:E,beforeMount:I,mounted:M,beforeUpdate:P,updated:j,activated:N,deactivated:q,beforeDestroy:V,beforeUnmount:ee,destroyed:oe,unmounted:pe,render:se,renderTracked:xe,renderTriggered:Te,errorCaptured:De,serverPrefetch:Me,expose:Be,inheritAttrs:ze,components:Fe,directives:Je,filters:be}=n;if(w&&o3(w,s,null,e.appContext.config.unwrapInjectedRef),m)for(const _t in m){const It=m[_t];mn(It)&&(s[_t]=It.bind(r))}if(c){const _t=c.call(r,r);Vr(_t)&&(e.data=Al(_t))}if(Ey=!0,h)for(const _t in h){const It=h[_t],Tt=mn(It)?It.bind(r,r):mn(It.get)?It.get.bind(r,r):ms,Dn=!mn(It)&&mn(It.set)?It.set.bind(r):ms,Ot=Et({get:Tt,set:Dn});Object.defineProperty(s,_t,{enumerable:!0,configurable:!0,get:()=>Ot.value,set:Zn=>Ot.value=Zn})}if(a)for(const _t in a)HE(a[_t],s,r,_t);if(v){const _t=mn(v)?v.call(r):v;Reflect.ownKeys(_t).forEach(It=>{fr(It,_t[It])})}E&&Mw(E,e,"c");function Ke(_t,It){en(It)?It.forEach(Tt=>_t(Tt.bind(r))):It&&_t(It.bind(r))}if(Ke(QD,I),Ke(cr,M),Ke(JD,P),Ke(Z_,j),Ke(qE,N),Ke(ZE,q),Ke(r3,De),Ke(n3,xe),Ke(t3,Te),Ke(rx,ee),Ke(Cr,pe),Ke(e3,Me),en(Be))if(Be.length){const _t=e.exposed||(e.exposed={});Be.forEach(It=>{Object.defineProperty(_t,It,{get:()=>r[It],set:Tt=>r[It]=Tt})})}else e.exposed||(e.exposed={});se&&e.render===ms&&(e.render=se),ze!=null&&(e.inheritAttrs=ze),Fe&&(e.components=Fe),Je&&(e.directives=Je)}function o3(e,n,r=ms,s=!1){en(e)&&(e=Sy(e));for(const c in e){const h=e[c];let m;Vr(h)?"default"in h?m=kn(h.from||c,h.default,!0):m=kn(h.from||c):m=kn(h),Ar(m)&&s?Object.defineProperty(n,c,{enumerable:!0,configurable:!0,get:()=>m.value,set:a=>m.value=a}):n[c]=m}}function Mw(e,n,r){Zo(en(e)?e.map(s=>s.bind(n.proxy)):e.bind(n.proxy),n,r)}function HE(e,n,r,s){const c=s.includes(".")?jE(r,s):()=>r[s];if($r(e)){const h=n[e];mn(h)&&gi(c,h)}else if(mn(e))gi(c,e.bind(r));else if(Vr(e))if(en(e))e.forEach(h=>HE(h,n,r,s));else{const h=mn(e.handler)?e.handler.bind(r):n[e.handler];mn(h)&&gi(c,h,e)}}function XE(e){const n=e.type,{mixins:r,extends:s}=n,{mixins:c,optionsCache:h,config:{optionMergeStrategies:m}}=e.appContext,a=h.get(n);let v;return a?v=a:!c.length&&!r&&!s?v=n:(v={},c.length&&c.forEach(w=>Km(v,w,m,!0)),Km(v,n,m)),h.set(n,v),v}function Km(e,n,r,s=!1){const{mixins:c,extends:h}=n;h&&Km(e,h,r,!0),c&&c.forEach(m=>Km(e,m,r,!0));for(const m in n)if(!(s&&m==="expose")){const a=s3[m]||r&&r[m];e[m]=a?a(e[m],n[m]):n[m]}return e}const s3={data:kw,props:vc,emits:vc,methods:vc,computed:vc,beforeCreate:Li,created:Li,beforeMount:Li,mounted:Li,beforeUpdate:Li,updated:Li,beforeDestroy:Li,beforeUnmount:Li,destroyed:Li,unmounted:Li,activated:Li,deactivated:Li,errorCaptured:Li,serverPrefetch:Li,components:vc,directives:vc,watch:l3,provide:kw,inject:a3};function kw(e,n){return n?e?function(){return ii(mn(e)?e.call(this,this):e,mn(n)?n.call(this,this):n)}:n:e}function a3(e,n){return vc(Sy(e),Sy(n))}function Sy(e){if(en(e)){const n={};for(let r=0;r<e.length;r++)n[e[r]]=e[r];return n}return e}function Li(e,n){return e?[...new Set([].concat(e,n))]:n}function vc(e,n){return e?ii(ii(Object.create(null),e),n):n}function l3(e,n){if(!e)return n;if(!n)return e;const r=ii(Object.create(null),e);for(const s in n)r[s]=Li(e[s],n[s]);return r}function c3(e,n,r,s=!1){const c={},h={};qm(h,W_,1),e.propsDefaults=Object.create(null),KE(e,n,c,h);for(const m in e.propsOptions[0])m in c||(c[m]=void 0);r?e.props=s?c:kD(c):e.type.props?e.props=c:e.props=h,e.attrs=h}function u3(e,n,r,s){const{props:c,attrs:h,vnode:{patchFlag:m}}=e,a=un(c),[v]=e.propsOptions;let w=!1;if((s||m>0)&&!(m&16)){if(m&8){const E=e.vnode.dynamicProps;for(let I=0;I<E.length;I++){let M=E[I];const P=n[M];if(v)if(Un(h,M))P!==h[M]&&(h[M]=P,w=!0);else{const j=Ws(M);c[j]=Ay(v,a,j,P,e,!1)}else P!==h[M]&&(h[M]=P,w=!0)}}}else{KE(e,n,c,h)&&(w=!0);let E;for(const I in a)(!n||!Un(n,I)&&((E=zh(I))===I||!Un(n,E)))&&(v?r&&(r[I]!==void 0||r[E]!==void 0)&&(c[I]=Ay(v,a,I,void 0,e,!0)):delete c[I]);if(h!==a)for(const I in h)(!n||!Un(n,I)&&!0)&&(delete h[I],w=!0)}w&&_a(e,"set","$attrs")}function KE(e,n,r,s){const[c,h]=e.propsOptions;let m=!1,a;if(n)for(let v in n){if(ld(v))continue;const w=n[v];let E;c&&Un(c,E=Ws(v))?!h||!h.includes(E)?r[E]=w:(a||(a={}))[E]=w:tx(e.emitsOptions,v)||(!(v in s)||w!==s[v])&&(s[v]=w,m=!0)}if(h){const v=un(r),w=a||ir;for(let E=0;E<h.length;E++){const I=h[E];r[I]=Ay(c,v,I,w[I],e,!Un(w,I))}}return m}function Ay(e,n,r,s,c,h){const m=e[r];if(m!=null){const a=Un(m,"default");if(a&&s===void 0){const v=m.default;if(m.type!==Function&&mn(v)){const{propsDefaults:w}=c;r in w?s=w[r]:(vh(c),s=w[r]=v.call(null,n),Dc())}else s=v}m[0]&&(h&&!a?s=!1:m[1]&&(s===""||s===zh(r))&&(s=!0))}return s}function YE(e,n,r=!1){const s=n.propsCache,c=s.get(e);if(c)return c;const h=e.props,m={},a=[];let v=!1;if(!mn(e)){const E=I=>{v=!0;const[M,P]=YE(I,n,!0);ii(m,M),P&&a.push(...P)};!r&&n.mixins.length&&n.mixins.forEach(E),e.extends&&E(e.extends),e.mixins&&e.mixins.forEach(E)}if(!h&&!v)return s.set(e,uh),uh;if(en(h))for(let E=0;E<h.length;E++){const I=Ws(h[E]);Pw(I)&&(m[I]=ir)}else if(h)for(const E in h){const I=Ws(E);if(Pw(I)){const M=h[E],P=m[I]=en(M)||mn(M)?{type:M}:M;if(P){const j=zw(Boolean,P.type),N=zw(String,P.type);P[0]=j>-1,P[1]=N<0||j<N,(j>-1||Un(P,"default"))&&a.push(I)}}}const w=[m,a];return s.set(e,w),w}function Pw(e){return e[0]!=="$"}function Dw(e){const n=e&&e.toString().match(/^\s*function (\w+)/);return n?n[1]:e===null?"null":""}function Rw(e,n){return Dw(e)===Dw(n)}function zw(e,n){return en(n)?n.findIndex(r=>Rw(r,e)):mn(n)&&Rw(n,e)?0:-1}const QE=e=>e[0]==="_"||e==="$stable",ix=e=>en(e)?e.map(hs):[hs(e)],h3=(e,n,r)=>{const s=UE((...c)=>ix(n(...c)),r);return s._c=!1,s},JE=(e,n,r)=>{const s=e._ctx;for(const c in e){if(QE(c))continue;const h=e[c];if(mn(h))n[c]=h3(c,h,s);else if(h!=null){const m=ix(h);n[c]=()=>m}}},eS=(e,n)=>{const r=ix(n);e.slots.default=()=>r},f3=(e,n)=>{if(e.vnode.shapeFlag&32){const r=n._;r?(e.slots=un(n),qm(n,"_",r)):JE(n,e.slots={})}else e.slots={},n&&eS(e,n);qm(e.slots,W_,1)},d3=(e,n,r)=>{const{vnode:s,slots:c}=e;let h=!0,m=ir;if(s.shapeFlag&32){const a=n._;a?r&&a===1?h=!1:(ii(c,n),!r&&a===1&&delete c._):(h=!n.$stable,JE(n,c)),m=n}else n&&(eS(e,n),m={default:1});if(h)for(const a in c)!QE(a)&&!(a in m)&&delete c[a]};function b8(e,n){const r=go;if(r===null)return e;const s=r.proxy,c=e.dirs||(e.dirs=[]);for(let h=0;h<n.length;h++){let[m,a,v,w=ir]=n[h];mn(m)&&(m={mounted:m,updated:m}),m.deep&&Cc(a),c.push({dir:m,instance:s,value:a,oldValue:void 0,arg:v,modifiers:w})}return e}function Bs(e,n,r,s){const c=e.dirs,h=n&&n.dirs;for(let m=0;m<c.length;m++){const a=c[m];h&&(a.oldValue=h[m].value);let v=a.dir[s];v&&(Oh(),Zo(v,r,8,[e.el,a,e,n]),Lh())}}function tS(){return{app:null,config:{isNativeTag:HP,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let p3=0;function m3(e,n){return function(s,c=null){c!=null&&!Vr(c)&&(c=null);const h=tS(),m=new Set;let a=!1;const v=h.app={_uid:p3++,_component:s,_props:c,_container:null,_context:h,_instance:null,version:B3,get config(){return h.config},set config(w){},use(w,...E){return m.has(w)||(w&&mn(w.install)?(m.add(w),w.install(v,...E)):mn(w)&&(m.add(w),w(v,...E))),v},mixin(w){return h.mixins.includes(w)||h.mixins.push(w),v},component(w,E){return E?(h.components[w]=E,v):h.components[w]},directive(w,E){return E?(h.directives[w]=E,v):h.directives[w]},mount(w,E,I){if(!a){const M=Xr(s,c);return M.appContext=h,E&&n?n(M,w):e(M,w,I),a=!0,v._container=w,w.__vue_app__=v,lx(M.component)||M.component.proxy}},unmount(){a&&(e(null,v._container),delete v._container.__vue_app__)},provide(w,E){return h.provides[w]=E,v}};return v}}function Ym(e,n,r,s,c=!1){if(en(e)){e.forEach((M,P)=>Ym(M,n&&(en(n)?n[P]:n),r,s,c));return}if(Xm(s)&&!c)return;const h=s.shapeFlag&4?lx(s.component)||s.component.proxy:s.el,m=c?null:h,{i:a,r:v}=e,w=n&&n.r,E=a.refs===ir?a.refs={}:a.refs,I=a.setupState;if(w!=null&&w!==v&&($r(w)?(E[w]=null,Un(I,w)&&(I[w]=null)):Ar(w)&&(w.value=null)),mn(v))gl(v,a,12,[m,E]);else{const M=$r(v),P=Ar(v);if(M||P){const j=()=>{if(e.f){const N=M?E[v]:v.value;c?en(N)&&Vv(N,h):en(N)?N.includes(h)||N.push(h):M?E[v]=[h]:(v.value=[h],e.k&&(E[e.k]=v.value))}else M?(E[v]=m,Un(I,v)&&(I[v]=m)):Ar(v)&&(v.value=m,e.k&&(E[e.k]=m))};m?(j.id=-1,Yi(j,r)):j()}}}let Ja=!1;const Am=e=>/svg/.test(e.namespaceURI)&&e.tagName!=="foreignObject",B0=e=>e.nodeType===8;function _3(e){const{mt:n,p:r,o:{patchProp:s,nextSibling:c,parentNode:h,remove:m,insert:a,createComment:v}}=e,w=(q,V)=>{if(!V.hasChildNodes()){r(null,q,V),Wm();return}Ja=!1,E(V.firstChild,q,null,null,null),Wm(),Ja&&console.error("Hydration completed but contains mismatches.")},E=(q,V,ee,oe,pe,se=!1)=>{const xe=B0(q)&&q.data==="[",Te=()=>j(q,V,ee,oe,pe,xe),{type:De,ref:Me,shapeFlag:Be}=V,ze=q.nodeType;V.el=q;let Fe=null;switch(De){case yh:ze!==3?Fe=Te():(q.data!==V.children&&(Ja=!0,q.data=V.children),Fe=c(q));break;case Ho:ze!==8||xe?Fe=Te():Fe=c(q);break;case dh:if(ze!==1)Fe=Te();else{Fe=q;const Je=!V.children.length;for(let be=0;be<V.staticCount;be++)Je&&(V.children+=Fe.outerHTML),be===V.staticCount-1&&(V.anchor=Fe),Fe=c(Fe);return Fe}break;case di:xe?Fe=P(q,V,ee,oe,pe,se):Fe=Te();break;default:if(Be&1)ze!==1||V.type.toLowerCase()!==q.tagName.toLowerCase()?Fe=Te():Fe=I(q,V,ee,oe,pe,se);else if(Be&6){V.slotScopeIds=pe;const Je=h(q);if(n(V,Je,null,ee,oe,Am(Je),se),Fe=xe?N(q):c(q),Xm(V)){let be;xe?(be=Xr(di),be.anchor=Fe?Fe.previousSibling:Je.lastChild):be=q.nodeType===3?uS(""):Xr("div"),be.el=q,V.component.subTree=be}}else Be&64?ze!==8?Fe=Te():Fe=V.type.hydrate(q,V,ee,oe,pe,se,e,M):Be&128&&(Fe=V.type.hydrate(q,V,ee,oe,Am(h(q)),pe,se,e,E))}return Me!=null&&Ym(Me,null,oe,V),Fe},I=(q,V,ee,oe,pe,se)=>{se=se||!!V.dynamicChildren;const{type:xe,props:Te,patchFlag:De,shapeFlag:Me,dirs:Be}=V,ze=xe==="input"&&Be||xe==="option";if(ze||De!==-1){if(Be&&Bs(V,null,ee,"created"),Te)if(ze||!se||De&48)for(const Je in Te)(ze&&Je.endsWith("value")||$d(Je)&&!ld(Je))&&s(q,Je,null,Te[Je],!1,void 0,ee);else Te.onClick&&s(q,"onClick",null,Te.onClick,!1,void 0,ee);let Fe;if((Fe=Te&&Te.onVnodeBeforeMount)&&Bo(Fe,ee,V),Be&&Bs(V,null,ee,"beforeMount"),((Fe=Te&&Te.onVnodeMounted)||Be)&&NE(()=>{Fe&&Bo(Fe,ee,V),Be&&Bs(V,null,ee,"mounted")},oe),Me&16&&!(Te&&(Te.innerHTML||Te.textContent))){let Je=M(q.firstChild,V,q,ee,oe,pe,se);for(;Je;){Ja=!0;const be=Je;Je=Je.nextSibling,m(be)}}else Me&8&&q.textContent!==V.children&&(Ja=!0,q.textContent=V.children)}return q.nextSibling},M=(q,V,ee,oe,pe,se,xe)=>{xe=xe||!!V.dynamicChildren;const Te=V.children,De=Te.length;for(let Me=0;Me<De;Me++){const Be=xe?Te[Me]:Te[Me]=hs(Te[Me]);if(q)q=E(q,Be,oe,pe,se,xe);else{if(Be.type===yh&&!Be.children)continue;Ja=!0,r(null,Be,ee,null,oe,pe,Am(ee),se)}}return q},P=(q,V,ee,oe,pe,se)=>{const{slotScopeIds:xe}=V;xe&&(pe=pe?pe.concat(xe):xe);const Te=h(q),De=M(c(q),V,Te,ee,oe,pe,se);return De&&B0(De)&&De.data==="]"?c(V.anchor=De):(Ja=!0,a(V.anchor=v("]"),Te,De),De)},j=(q,V,ee,oe,pe,se)=>{if(Ja=!0,V.el=null,se){const De=N(q);for(;;){const Me=c(q);if(Me&&Me!==De)m(Me);else break}}const xe=c(q),Te=h(q);return m(q),r(null,V,Te,xe,ee,oe,Am(Te),pe),xe},N=q=>{let V=0;for(;q;)if(q=c(q),q&&B0(q)&&(q.data==="["&&V++,q.data==="]")){if(V===0)return c(q);V--}return q};return[w,E]}const Yi=NE;function g3(e){return nS(e)}function y3(e){return nS(e,_3)}function nS(e,n){const r=eD();r.__VUE__=!0;const{insert:s,remove:c,patchProp:h,createElement:m,createText:a,createComment:v,setText:w,setElementText:E,parentNode:I,nextSibling:M,setScopeId:P=ms,cloneNode:j,insertStaticContent:N}=e,q=(fe,_e,Oe,rt=null,ot=null,vt=null,St=!1,Ye=null,at=!!_e.dynamicChildren)=>{if(fe===_e)return;fe&&!Ec(fe,_e)&&(rt=Lt(fe),Rn(fe,ot,vt,!0),fe=null),_e.patchFlag===-2&&(at=!1,_e.dynamicChildren=null);const{type:we,ref:Ue,shapeFlag:At}=_e;switch(we){case yh:V(fe,_e,Oe,rt);break;case Ho:ee(fe,_e,Oe,rt);break;case dh:fe==null&&oe(_e,Oe,rt,St);break;case di:Je(fe,_e,Oe,rt,ot,vt,St,Ye,at);break;default:At&1?xe(fe,_e,Oe,rt,ot,vt,St,Ye,at):At&6?be(fe,_e,Oe,rt,ot,vt,St,Ye,at):(At&64||At&128)&&we.process(fe,_e,Oe,rt,ot,vt,St,Ye,at,Cn)}Ue!=null&&ot&&Ym(Ue,fe&&fe.ref,vt,_e||fe,!_e)},V=(fe,_e,Oe,rt)=>{if(fe==null)s(_e.el=a(_e.children),Oe,rt);else{const ot=_e.el=fe.el;_e.children!==fe.children&&w(ot,_e.children)}},ee=(fe,_e,Oe,rt)=>{fe==null?s(_e.el=v(_e.children||""),Oe,rt):_e.el=fe.el},oe=(fe,_e,Oe,rt)=>{[fe.el,fe.anchor]=N(fe.children,_e,Oe,rt,fe.el,fe.anchor)},pe=({el:fe,anchor:_e},Oe,rt)=>{let ot;for(;fe&&fe!==_e;)ot=M(fe),s(fe,Oe,rt),fe=ot;s(_e,Oe,rt)},se=({el:fe,anchor:_e})=>{let Oe;for(;fe&&fe!==_e;)Oe=M(fe),c(fe),fe=Oe;c(_e)},xe=(fe,_e,Oe,rt,ot,vt,St,Ye,at)=>{St=St||_e.type==="svg",fe==null?Te(_e,Oe,rt,ot,vt,St,Ye,at):Be(fe,_e,ot,vt,St,Ye,at)},Te=(fe,_e,Oe,rt,ot,vt,St,Ye)=>{let at,we;const{type:Ue,props:At,shapeFlag:mt,transition:Gt,patchFlag:Qt,dirs:_n}=fe;if(fe.el&&j!==void 0&&Qt===-1)at=fe.el=j(fe.el);else{if(at=fe.el=m(fe.type,vt,At&&At.is,At),mt&8?E(at,fe.children):mt&16&&Me(fe.children,at,null,rt,ot,vt&&Ue!=="foreignObject",St,Ye),_n&&Bs(fe,null,rt,"created"),At){for(const zn in At)zn!=="value"&&!ld(zn)&&h(at,zn,null,At[zn],vt,fe.children,rt,ot,yt);"value"in At&&h(at,"value",null,At.value),(we=At.onVnodeBeforeMount)&&Bo(we,rt,fe)}De(at,fe,fe.scopeId,St,rt)}_n&&Bs(fe,null,rt,"beforeMount");const tn=(!ot||ot&&!ot.pendingBranch)&&Gt&&!Gt.persisted;tn&&Gt.beforeEnter(at),s(at,_e,Oe),((we=At&&At.onVnodeMounted)||tn||_n)&&Yi(()=>{we&&Bo(we,rt,fe),tn&&Gt.enter(at),_n&&Bs(fe,null,rt,"mounted")},ot)},De=(fe,_e,Oe,rt,ot)=>{if(Oe&&P(fe,Oe),rt)for(let vt=0;vt<rt.length;vt++)P(fe,rt[vt]);if(ot){let vt=ot.subTree;if(_e===vt){const St=ot.vnode;De(fe,St,St.scopeId,St.slotScopeIds,ot.parent)}}},Me=(fe,_e,Oe,rt,ot,vt,St,Ye,at=0)=>{for(let we=at;we<fe.length;we++){const Ue=fe[we]=Ye?al(fe[we]):hs(fe[we]);q(null,Ue,_e,Oe,rt,ot,vt,St,Ye)}},Be=(fe,_e,Oe,rt,ot,vt,St)=>{const Ye=_e.el=fe.el;let{patchFlag:at,dynamicChildren:we,dirs:Ue}=_e;at|=fe.patchFlag&16;const At=fe.props||ir,mt=_e.props||ir;let Gt;Oe&&dc(Oe,!1),(Gt=mt.onVnodeBeforeUpdate)&&Bo(Gt,Oe,_e,fe),Ue&&Bs(_e,fe,Oe,"beforeUpdate"),Oe&&dc(Oe,!0);const Qt=ot&&_e.type!=="foreignObject";if(we?ze(fe.dynamicChildren,we,Ye,Oe,rt,Qt,vt):St||Tt(fe,_e,Ye,null,Oe,rt,Qt,vt,!1),at>0){if(at&16)Fe(Ye,_e,At,mt,Oe,rt,ot);else if(at&2&&At.class!==mt.class&&h(Ye,"class",null,mt.class,ot),at&4&&h(Ye,"style",At.style,mt.style,ot),at&8){const _n=_e.dynamicProps;for(let tn=0;tn<_n.length;tn++){const zn=_n[tn],Dr=At[zn],Ii=mt[zn];(Ii!==Dr||zn==="value")&&h(Ye,zn,Dr,Ii,ot,fe.children,Oe,rt,yt)}}at&1&&fe.children!==_e.children&&E(Ye,_e.children)}else!St&&we==null&&Fe(Ye,_e,At,mt,Oe,rt,ot);((Gt=mt.onVnodeUpdated)||Ue)&&Yi(()=>{Gt&&Bo(Gt,Oe,_e,fe),Ue&&Bs(_e,fe,Oe,"updated")},rt)},ze=(fe,_e,Oe,rt,ot,vt,St)=>{for(let Ye=0;Ye<_e.length;Ye++){const at=fe[Ye],we=_e[Ye],Ue=at.el&&(at.type===di||!Ec(at,we)||at.shapeFlag&70)?I(at.el):Oe;q(at,we,Ue,null,rt,ot,vt,St,!0)}},Fe=(fe,_e,Oe,rt,ot,vt,St)=>{if(Oe!==rt){for(const Ye in rt){if(ld(Ye))continue;const at=rt[Ye],we=Oe[Ye];at!==we&&Ye!=="value"&&h(fe,Ye,we,at,St,_e.children,ot,vt,yt)}if(Oe!==ir)for(const Ye in Oe)!ld(Ye)&&!(Ye in rt)&&h(fe,Ye,Oe[Ye],null,St,_e.children,ot,vt,yt);"value"in rt&&h(fe,"value",Oe.value,rt.value)}},Je=(fe,_e,Oe,rt,ot,vt,St,Ye,at)=>{const we=_e.el=fe?fe.el:a(""),Ue=_e.anchor=fe?fe.anchor:a("");let{patchFlag:At,dynamicChildren:mt,slotScopeIds:Gt}=_e;Gt&&(Ye=Ye?Ye.concat(Gt):Gt),fe==null?(s(we,Oe,rt),s(Ue,Oe,rt),Me(_e.children,Oe,Ue,ot,vt,St,Ye,at)):At>0&&At&64&&mt&&fe.dynamicChildren?(ze(fe.dynamicChildren,mt,Oe,ot,vt,St,Ye),(_e.key!=null||ot&&_e===ot.subTree)&&ox(fe,_e,!0)):Tt(fe,_e,Oe,Ue,ot,vt,St,Ye,at)},be=(fe,_e,Oe,rt,ot,vt,St,Ye,at)=>{_e.slotScopeIds=Ye,fe==null?_e.shapeFlag&512?ot.ctx.activate(_e,Oe,rt,St,at):qe(_e,Oe,rt,ot,vt,St,at):Ke(fe,_e,at)},qe=(fe,_e,Oe,rt,ot,vt,St)=>{const Ye=fe.component=P3(fe,rt,ot);if(G_(fe)&&(Ye.ctx.renderer=Cn),D3(Ye),Ye.asyncDep){if(ot&&ot.registerDep(Ye,_t),!fe.el){const at=Ye.subTree=Xr(Ho);ee(null,at,_e,Oe)}return}_t(Ye,fe,_e,Oe,ot,vt,St)},Ke=(fe,_e,Oe)=>{const rt=_e.component=fe.component;if(qD(fe,_e,Oe))if(rt.asyncDep&&!rt.asyncResolved){It(rt,_e,Oe);return}else rt.next=_e,UD(rt.update),rt.update();else _e.component=fe.component,_e.el=fe.el,rt.vnode=_e},_t=(fe,_e,Oe,rt,ot,vt,St)=>{const Ye=()=>{if(fe.isMounted){let{next:Ue,bu:At,u:mt,parent:Gt,vnode:Qt}=fe,_n=Ue,tn;dc(fe,!1),Ue?(Ue.el=Qt.el,It(fe,Ue,St)):Ue=Qt,At&&O0(At),(tn=Ue.props&&Ue.props.onVnodeBeforeUpdate)&&Bo(tn,Gt,Ue,Qt),dc(fe,!0);const zn=L0(fe),Dr=fe.subTree;fe.subTree=zn,q(Dr,zn,I(Dr.el),Lt(Dr),fe,ot,vt),Ue.el=zn.el,_n===null&&ZD(fe,zn.el),mt&&Yi(mt,ot),(tn=Ue.props&&Ue.props.onVnodeUpdated)&&Yi(()=>Bo(tn,Gt,Ue,Qt),ot)}else{let Ue;const{el:At,props:mt}=_e,{bm:Gt,m:Qt,parent:_n}=fe,tn=Xm(_e);if(dc(fe,!1),Gt&&O0(Gt),!tn&&(Ue=mt&&mt.onVnodeBeforeMount)&&Bo(Ue,_n,_e),dc(fe,!0),At&&Ht){const zn=()=>{fe.subTree=L0(fe),Ht(At,fe.subTree,fe,ot,null)};tn?_e.type.__asyncLoader().then(()=>!fe.isUnmounted&&zn()):zn()}else{const zn=fe.subTree=L0(fe);q(null,zn,Oe,rt,fe,ot,vt),_e.el=zn.el}if(Qt&&Yi(Qt,ot),!tn&&(Ue=mt&&mt.onVnodeMounted)){const zn=_e;Yi(()=>Bo(Ue,_n,zn),ot)}_e.shapeFlag&256&&fe.a&&Yi(fe.a,ot),fe.isMounted=!0,_e=Oe=rt=null}},at=fe.effect=new Wv(Ye,()=>zE(fe.update),fe.scope),we=fe.update=at.run.bind(at);we.id=fe.uid,dc(fe,!0),we()},It=(fe,_e,Oe)=>{_e.component=fe;const rt=fe.vnode.props;fe.vnode=_e,fe.next=null,u3(fe,_e.props,rt,Oe),d3(fe,_e.children,Oe),Oh(),ex(void 0,fe.update),Lh()},Tt=(fe,_e,Oe,rt,ot,vt,St,Ye,at=!1)=>{const we=fe&&fe.children,Ue=fe?fe.shapeFlag:0,At=_e.children,{patchFlag:mt,shapeFlag:Gt}=_e;if(mt>0){if(mt&128){Ot(we,At,Oe,rt,ot,vt,St,Ye,at);return}else if(mt&256){Dn(we,At,Oe,rt,ot,vt,St,Ye,at);return}}Gt&8?(Ue&16&&yt(we,ot,vt),At!==we&&E(Oe,At)):Ue&16?Gt&16?Ot(we,At,Oe,rt,ot,vt,St,Ye,at):yt(we,ot,vt,!0):(Ue&8&&E(Oe,""),Gt&16&&Me(At,Oe,rt,ot,vt,St,Ye,at))},Dn=(fe,_e,Oe,rt,ot,vt,St,Ye,at)=>{fe=fe||uh,_e=_e||uh;const we=fe.length,Ue=_e.length,At=Math.min(we,Ue);let mt;for(mt=0;mt<At;mt++){const Gt=_e[mt]=at?al(_e[mt]):hs(_e[mt]);q(fe[mt],Gt,Oe,null,ot,vt,St,Ye,at)}we>Ue?yt(fe,ot,vt,!0,!1,At):Me(_e,Oe,rt,ot,vt,St,Ye,at,At)},Ot=(fe,_e,Oe,rt,ot,vt,St,Ye,at)=>{let we=0;const Ue=_e.length;let At=fe.length-1,mt=Ue-1;for(;we<=At&&we<=mt;){const Gt=fe[we],Qt=_e[we]=at?al(_e[we]):hs(_e[we]);if(Ec(Gt,Qt))q(Gt,Qt,Oe,null,ot,vt,St,Ye,at);else break;we++}for(;we<=At&&we<=mt;){const Gt=fe[At],Qt=_e[mt]=at?al(_e[mt]):hs(_e[mt]);if(Ec(Gt,Qt))q(Gt,Qt,Oe,null,ot,vt,St,Ye,at);else break;At--,mt--}if(we>At){if(we<=mt){const Gt=mt+1,Qt=Gt<Ue?_e[Gt].el:rt;for(;we<=mt;)q(null,_e[we]=at?al(_e[we]):hs(_e[we]),Oe,Qt,ot,vt,St,Ye,at),we++}}else if(we>mt)for(;we<=At;)Rn(fe[we],ot,vt,!0),we++;else{const Gt=we,Qt=we,_n=new Map;for(we=Qt;we<=mt;we++){const Rr=_e[we]=at?al(_e[we]):hs(_e[we]);Rr.key!=null&&_n.set(Rr.key,we)}let tn,zn=0;const Dr=mt-Qt+1;let Ii=!1,io=0;const Bi=new Array(Dr);for(we=0;we<Dr;we++)Bi[we]=0;for(we=Gt;we<=At;we++){const Rr=fe[we];if(zn>=Dr){Rn(Rr,ot,vt,!0);continue}let wn;if(Rr.key!=null)wn=_n.get(Rr.key);else for(tn=Qt;tn<=mt;tn++)if(Bi[tn-Qt]===0&&Ec(Rr,_e[tn])){wn=tn;break}wn===void 0?Rn(Rr,ot,vt,!0):(Bi[wn-Qt]=we+1,wn>=io?io=wn:Ii=!0,q(Rr,_e[wn],Oe,null,ot,vt,St,Ye,at),zn++)}const si=Ii?v3(Bi):uh;for(tn=si.length-1,we=Dr-1;we>=0;we--){const Rr=Qt+we,wn=_e[Rr],ai=Rr+1<Ue?_e[Rr+1].el:rt;Bi[we]===0?q(null,wn,Oe,ai,ot,vt,St,Ye,at):Ii&&(tn<0||we!==si[tn]?Zn(wn,Oe,ai,2):tn--)}}},Zn=(fe,_e,Oe,rt,ot=null)=>{const{el:vt,type:St,transition:Ye,children:at,shapeFlag:we}=fe;if(we&6){Zn(fe.component.subTree,_e,Oe,rt);return}if(we&128){fe.suspense.move(_e,Oe,rt);return}if(we&64){St.move(fe,_e,Oe,Cn);return}if(St===di){s(vt,_e,Oe);for(let At=0;At<at.length;At++)Zn(at[At],_e,Oe,rt);s(fe.anchor,_e,Oe);return}if(St===dh){pe(fe,_e,Oe);return}if(rt!==2&&we&1&&Ye)if(rt===0)Ye.beforeEnter(vt),s(vt,_e,Oe),Yi(()=>Ye.enter(vt),ot);else{const{leave:At,delayLeave:mt,afterLeave:Gt}=Ye,Qt=()=>s(vt,_e,Oe),_n=()=>{At(vt,()=>{Qt(),Gt&&Gt()})};mt?mt(vt,Qt,_n):_n()}else s(vt,_e,Oe)},Rn=(fe,_e,Oe,rt=!1,ot=!1)=>{const{type:vt,props:St,ref:Ye,children:at,dynamicChildren:we,shapeFlag:Ue,patchFlag:At,dirs:mt}=fe;if(Ye!=null&&Ym(Ye,null,Oe,fe,!0),Ue&256){_e.ctx.deactivate(fe);return}const Gt=Ue&1&&mt,Qt=!Xm(fe);let _n;if(Qt&&(_n=St&&St.onVnodeBeforeUnmount)&&Bo(_n,_e,fe),Ue&6)Dt(fe.component,Oe,rt);else{if(Ue&128){fe.suspense.unmount(Oe,rt);return}Gt&&Bs(fe,null,_e,"beforeUnmount"),Ue&64?fe.type.remove(fe,_e,Oe,ot,Cn,rt):we&&(vt!==di||At>0&&At&64)?yt(we,_e,Oe,!1,!0):(vt===di&&At&384||!ot&&Ue&16)&&yt(at,_e,Oe),rt&&_r(fe)}(Qt&&(_n=St&&St.onVnodeUnmounted)||Gt)&&Yi(()=>{_n&&Bo(_n,_e,fe),Gt&&Bs(fe,null,_e,"unmounted")},Oe)},_r=fe=>{const{type:_e,el:Oe,anchor:rt,transition:ot}=fe;if(_e===di){it(Oe,rt);return}if(_e===dh){se(fe);return}const vt=()=>{c(Oe),ot&&!ot.persisted&&ot.afterLeave&&ot.afterLeave()};if(fe.shapeFlag&1&&ot&&!ot.persisted){const{leave:St,delayLeave:Ye}=ot,at=()=>St(Oe,vt);Ye?Ye(fe.el,vt,at):at()}else vt()},it=(fe,_e)=>{let Oe;for(;fe!==_e;)Oe=M(fe),c(fe),fe=Oe;c(_e)},Dt=(fe,_e,Oe)=>{const{bum:rt,scope:ot,update:vt,subTree:St,um:Ye}=fe;rt&&O0(rt),ot.stop(),vt&&(vt.active=!1,Rn(St,fe,_e,Oe)),Ye&&Yi(Ye,_e),Yi(()=>{fe.isUnmounted=!0},_e),_e&&_e.pendingBranch&&!_e.isUnmounted&&fe.asyncDep&&!fe.asyncResolved&&fe.suspenseId===_e.pendingId&&(_e.deps--,_e.deps===0&&_e.resolve())},yt=(fe,_e,Oe,rt=!1,ot=!1,vt=0)=>{for(let St=vt;St<fe.length;St++)Rn(fe[St],_e,Oe,rt,ot)},Lt=fe=>fe.shapeFlag&6?Lt(fe.component.subTree):fe.shapeFlag&128?fe.suspense.next():M(fe.anchor||fe.el),Tn=(fe,_e,Oe)=>{fe==null?_e._vnode&&Rn(_e._vnode,null,null,!0):q(_e._vnode||null,fe,_e,null,null,null,Oe),Wm(),_e._vnode=fe},Cn={p:q,um:Rn,m:Zn,r:_r,mt:qe,mc:Me,pc:Tt,pbc:ze,n:Lt,o:e};let Kt,Ht;return n&&([Kt,Ht]=n(Cn)),{render:Tn,hydrate:Kt,createApp:m3(Tn,Kt)}}function dc({effect:e,update:n},r){e.allowRecurse=n.allowRecurse=r}function ox(e,n,r=!1){const s=e.children,c=n.children;if(en(s)&&en(c))for(let h=0;h<s.length;h++){const m=s[h];let a=c[h];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=c[h]=al(c[h]),a.el=m.el),r||ox(m,a))}}function v3(e){const n=e.slice(),r=[0];let s,c,h,m,a;const v=e.length;for(s=0;s<v;s++){const w=e[s];if(w!==0){if(c=r[r.length-1],e[c]<w){n[s]=c,r.push(s);continue}for(h=0,m=r.length-1;h<m;)a=h+m>>1,e[r[a]]<w?h=a+1:m=a;w<e[r[h]]&&(h>0&&(n[s]=r[h-1]),r[h]=s)}}for(h=r.length,m=r[h-1];h-- >0;)r[h]=m,m=n[m];return r}const x3=e=>e.__isTeleport,hd=e=>e&&(e.disabled||e.disabled===""),Ow=e=>typeof SVGElement!="undefined"&&e instanceof SVGElement,Cy=(e,n)=>{const r=e&&e.to;return $r(r)?n?n(r):null:r},b3={__isTeleport:!0,process(e,n,r,s,c,h,m,a,v,w){const{mc:E,pc:I,pbc:M,o:{insert:P,querySelector:j,createText:N,createComment:q}}=w,V=hd(n.props);let{shapeFlag:ee,children:oe,dynamicChildren:pe}=n;if(e==null){const se=n.el=N(""),xe=n.anchor=N("");P(se,r,s),P(xe,r,s);const Te=n.target=Cy(n.props,j),De=n.targetAnchor=N("");Te&&(P(De,Te),m=m||Ow(Te));const Me=(Be,ze)=>{ee&16&&E(oe,Be,ze,c,h,m,a,v)};V?Me(r,xe):Te&&Me(Te,De)}else{n.el=e.el;const se=n.anchor=e.anchor,xe=n.target=e.target,Te=n.targetAnchor=e.targetAnchor,De=hd(e.props),Me=De?r:xe,Be=De?se:Te;if(m=m||Ow(xe),pe?(M(e.dynamicChildren,pe,Me,c,h,m,a),ox(e,n,!0)):v||I(e,n,Me,Be,c,h,m,a,!1),V)De||Cm(n,r,se,w,1);else if((n.props&&n.props.to)!==(e.props&&e.props.to)){const ze=n.target=Cy(n.props,j);ze&&Cm(n,ze,null,w,0)}else De&&Cm(n,xe,Te,w,1)}},remove(e,n,r,s,{um:c,o:{remove:h}},m){const{shapeFlag:a,children:v,anchor:w,targetAnchor:E,target:I,props:M}=e;if(I&&h(E),(m||!hd(M))&&(h(w),a&16))for(let P=0;P<v.length;P++){const j=v[P];c(j,n,r,!0,!!j.dynamicChildren)}},move:Cm,hydrate:w3};function Cm(e,n,r,{o:{insert:s},m:c},h=2){h===0&&s(e.targetAnchor,n,r);const{el:m,anchor:a,shapeFlag:v,children:w,props:E}=e,I=h===2;if(I&&s(m,n,r),(!I||hd(E))&&v&16)for(let M=0;M<w.length;M++)c(w[M],n,r,2);I&&s(a,n,r)}function w3(e,n,r,s,c,h,{o:{nextSibling:m,parentNode:a,querySelector:v}},w){const E=n.target=Cy(n.props,v);if(E){const I=E._lpa||E.firstChild;n.shapeFlag&16&&(hd(n.props)?(n.anchor=w(m(e),n,a(e),r,s,c,h),n.targetAnchor=I):(n.anchor=m(e),n.targetAnchor=w(I,n,E,r,s,c,h)),E._lpa=n.targetAnchor&&m(n.targetAnchor))}return n.anchor&&m(n.anchor)}const T3=b3,sx="components";function w8(e,n){return iS(sx,e,!0,n)||e}const rS=Symbol();function T8(e){return $r(e)?iS(sx,e,!1)||e:e||rS}function iS(e,n,r=!0,s=!1){const c=go||ti;if(c){const h=c.type;if(e===sx){const a=L3(h);if(a&&(a===n||a===Ws(n)||a===B_(Ws(n))))return h}const m=Lw(c[e]||h[e],n)||Lw(c.appContext[e],n);return!m&&s?h:m}}function Lw(e,n){return e&&(e[n]||e[Ws(n)]||e[B_(Ws(n))])}const di=Symbol(void 0),yh=Symbol(void 0),Ho=Symbol(void 0),dh=Symbol(void 0),fd=[];let Pc=null;function oS(e=!1){fd.push(Pc=e?null:[])}function E3(){fd.pop(),Pc=fd[fd.length-1]||null}let Qm=1;function Fw(e){Qm+=e}function sS(e){return e.dynamicChildren=Qm>0?Pc||uh:null,E3(),Qm>0&&Pc&&Pc.push(e),e}function E8(e,n,r,s,c,h){return sS(cS(e,n,r,s,c,h,!0))}function aS(e,n,r,s,c){return sS(Xr(e,n,r,s,c,!0))}function Jm(e){return e?e.__v_isVNode===!0:!1}function Ec(e,n){return e.type===n.type&&e.key===n.key}const W_="__vInternal",lS=({key:e})=>e!=null?e:null,Lm=({ref:e,ref_key:n,ref_for:r})=>e!=null?$r(e)||Ar(e)||mn(e)?{i:go,r:e,k:n,f:!!r}:e:null;function cS(e,n=null,r=null,s=0,c=null,h=e===di?0:1,m=!1,a=!1){const v={__v_isVNode:!0,__v_skip:!0,type:e,props:n,key:n&&lS(n),ref:n&&Lm(n),scopeId:$_,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:h,patchFlag:s,dynamicProps:c,dynamicChildren:null,appContext:null};return a?(ax(v,r),h&128&&e.normalize(v)):r&&(v.shapeFlag|=$r(r)?8:16),Qm>0&&!m&&Pc&&(v.patchFlag>0||h&6)&&v.patchFlag!==32&&Pc.push(v),v}const Xr=S3;function S3(e,n=null,r=null,s=0,c=null,h=!1){if((!e||e===rS)&&(e=Ho),Jm(e)){const a=Bc(e,n,!0);return r&&ax(a,r),a}if(F3(e)&&(e=e.__vccOpts),n){n=A3(n);let{class:a,style:v}=n;a&&!$r(a)&&(n.class=jv(a)),Vr(v)&&(SE(v)&&!en(v)&&(v=ii({},v)),n.style=Nv(v))}const m=$r(e)?1:WD(e)?128:x3(e)?64:Vr(e)?4:mn(e)?2:0;return cS(e,n,r,s,c,m,h,!0)}function A3(e){return e?SE(e)||W_ in e?ii({},e):e:null}function Bc(e,n,r=!1){const{props:s,ref:c,patchFlag:h,children:m}=e,a=n?C3(s||{},n):s;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:a,key:a&&lS(a),ref:n&&n.ref?r&&c?en(c)?c.concat(Lm(n)):[c,Lm(n)]:Lm(n):c,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:m,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:n&&e.type!==di?h===-1?16:h|16:h,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Bc(e.ssContent),ssFallback:e.ssFallback&&Bc(e.ssFallback),el:e.el,anchor:e.anchor}}function uS(e=" ",n=0){return Xr(yh,null,e,n)}function S8(e,n){const r=Xr(dh,null,e);return r.staticCount=n,r}function A8(e="",n=!1){return n?(oS(),aS(Ho,null,e)):Xr(Ho,null,e)}function hs(e){return e==null||typeof e=="boolean"?Xr(Ho):en(e)?Xr(di,null,e.slice()):typeof e=="object"?al(e):Xr(yh,null,String(e))}function al(e){return e.el===null||e.memo?e:Bc(e)}function ax(e,n){let r=0;const{shapeFlag:s}=e;if(n==null)n=null;else if(en(n))r=16;else if(typeof n=="object")if(s&65){const c=n.default;c&&(c._c&&(c._d=!1),ax(e,c()),c._c&&(c._d=!0));return}else{r=32;const c=n._;!c&&!(W_ in n)?n._ctx=go:c===3&&go&&(go.slots._===1?n._=1:(n._=2,e.patchFlag|=1024))}else mn(n)?(n={default:n,_ctx:go},r=32):(n=String(n),s&64?(r=16,n=[uS(n)]):r=8);e.children=n,e.shapeFlag|=r}function C3(...e){const n={};for(let r=0;r<e.length;r++){const s=e[r];for(const c in s)if(c==="class")n.class!==s.class&&(n.class=jv([n.class,s.class]));else if(c==="style")n.style=Nv([n.style,s.style]);else if($d(c)){const h=n[c],m=s[c];m&&h!==m&&!(en(h)&&h.includes(m))&&(n[c]=h?[].concat(h,m):m)}else c!==""&&(n[c]=s[c])}return n}function Bo(e,n,r,s=null){Zo(e,n,7,[r,s])}function C8(e,n,r,s){let c;const h=r&&r[s];if(en(e)||$r(e)){c=new Array(e.length);for(let m=0,a=e.length;m<a;m++)c[m]=n(e[m],m,void 0,h&&h[m])}else if(typeof e=="number"){c=new Array(e);for(let m=0;m<e;m++)c[m]=n(m+1,m,void 0,h&&h[m])}else if(Vr(e))if(e[Symbol.iterator])c=Array.from(e,(m,a)=>n(m,a,void 0,h&&h[a]));else{const m=Object.keys(e);c=new Array(m.length);for(let a=0,v=m.length;a<v;a++){const w=m[a];c[a]=n(e[w],w,a,h&&h[a])}}else c=[];return r&&(r[s]=c),c}function I8(e,n,r={},s,c){if(go.isCE)return Xr("slot",n==="default"?null:{name:n},s&&s());let h=e[n];h&&h._c&&(h._d=!1),oS();const m=h&&hS(h(r)),a=aS(di,{key:r.key||`_${n}`},m||(s?s():[]),m&&e._===1?64:-2);return!c&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),h&&h._c&&(h._d=!0),a}function hS(e){return e.some(n=>Jm(n)?!(n.type===Ho||n.type===di&&!hS(n.children)):!0)?e:null}const Iy=e=>e?fS(e)?lx(e)||e.proxy:Iy(e.parent):null,e_=ii(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Iy(e.parent),$root:e=>Iy(e.root),$emit:e=>e.emit,$options:e=>XE(e),$forceUpdate:e=>()=>zE(e.update),$nextTick:e=>Yn.bind(e.proxy),$watch:e=>XD.bind(e)}),I3={get({_:e},n){const{ctx:r,setupState:s,data:c,props:h,accessCache:m,type:a,appContext:v}=e;let w;if(n[0]!=="$"){const P=m[n];if(P!==void 0)switch(P){case 1:return s[n];case 2:return c[n];case 4:return r[n];case 3:return h[n]}else{if(s!==ir&&Un(s,n))return m[n]=1,s[n];if(c!==ir&&Un(c,n))return m[n]=2,c[n];if((w=e.propsOptions[0])&&Un(w,n))return m[n]=3,h[n];if(r!==ir&&Un(r,n))return m[n]=4,r[n];Ey&&(m[n]=0)}}const E=e_[n];let I,M;if(E)return n==="$attrs"&&wo(e,"get",n),E(e);if((I=a.__cssModules)&&(I=I[n]))return I;if(r!==ir&&Un(r,n))return m[n]=4,r[n];if(M=v.config.globalProperties,Un(M,n))return M[n]},set({_:e},n,r){const{data:s,setupState:c,ctx:h}=e;return c!==ir&&Un(c,n)?(c[n]=r,!0):s!==ir&&Un(s,n)?(s[n]=r,!0):Un(e.props,n)||n[0]==="$"&&n.slice(1)in e?!1:(h[n]=r,!0)},has({_:{data:e,setupState:n,accessCache:r,ctx:s,appContext:c,propsOptions:h}},m){let a;return!!r[m]||e!==ir&&Un(e,m)||n!==ir&&Un(n,m)||(a=h[0])&&Un(a,m)||Un(s,m)||Un(e_,m)||Un(c.config.globalProperties,m)},defineProperty(e,n,r){return r.get!=null?this.set(e,n,r.get(),null):r.value!=null&&this.set(e,n,r.value,null),Reflect.defineProperty(e,n,r)}},M3=tS();let k3=0;function P3(e,n,r){const s=e.type,c=(n?n.appContext:e.appContext)||M3,h={uid:k3++,vnode:e,type:s,parent:n,appContext:c,root:null,next:null,subTree:null,effect:null,update:null,scope:new tD(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:n?n.provides:Object.create(c.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:YE(s,c),emitsOptions:BE(s,c),emit:null,emitted:null,propsDefaults:ir,inheritAttrs:s.inheritAttrs,ctx:ir,data:ir,props:ir,attrs:ir,slots:ir,refs:ir,setupState:ir,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return h.ctx={_:h},h.root=n?n.root:h,h.emit=$D.bind(null,h),e.ce&&e.ce(h),h}let ti=null;const Cl=()=>ti||go,vh=e=>{ti=e,e.scope.on()},Dc=()=>{ti&&ti.scope.off(),ti=null};function fS(e){return e.vnode.shapeFlag&4}let Md=!1;function D3(e,n=!1){Md=n;const{props:r,children:s}=e.vnode,c=fS(e);c3(e,r,c,n),f3(e,s);const h=c?R3(e,n):void 0;return Md=!1,h}function R3(e,n){const r=e.type;e.accessCache=Object.create(null),e.proxy=AE(new Proxy(e.ctx,I3));const{setup:s}=r;if(s){const c=e.setupContext=s.length>1?O3(e):null;vh(e),Oh();const h=gl(s,e,0,[e.props,c]);if(Lh(),Dc(),uE(h)){if(h.then(Dc,Dc),n)return h.then(m=>{Bw(e,m,n)}).catch(m=>{j_(m,e,0)});e.asyncDep=h}else Bw(e,h,n)}else dS(e,n)}function Bw(e,n,r){mn(n)?e.type.__ssrInlineRender?e.ssrRender=n:e.render=n:Vr(n)&&(e.setupState=PE(n)),dS(e,r)}let Uw;function dS(e,n,r){const s=e.type;if(!e.render){if(!n&&Uw&&!s.render){const c=s.template;if(c){const{isCustomElement:h,compilerOptions:m}=e.appContext.config,{delimiters:a,compilerOptions:v}=s,w=ii(ii({isCustomElement:h,delimiters:a},m),v);s.render=Uw(c,w)}}e.render=s.render||ms}vh(e),Oh(),i3(e),Lh(),Dc()}function z3(e){return new Proxy(e.attrs,{get(n,r){return wo(e,"get","$attrs"),n[r]}})}function O3(e){const n=s=>{e.exposed=s||{}};let r;return{get attrs(){return r||(r=z3(e))},slots:e.slots,emit:e.emit,expose:n}}function lx(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(PE(AE(e.exposed)),{get(n,r){if(r in n)return n[r];if(r in e_)return e_[r](e)}}))}function L3(e){return mn(e)&&e.displayName||e.name}function F3(e){return mn(e)&&"__vccOpts"in e}const Et=(e,n)=>LD(e,n,Md);function yo(e,n,r){const s=arguments.length;return s===2?Vr(n)&&!en(n)?Jm(n)?Xr(e,null,[n]):Xr(e,n):Xr(e,null,n):(s>3?r=Array.prototype.slice.call(arguments,2):s===3&&Jm(r)&&(r=[r]),Xr(e,n,r))}const B3="3.2.31",U3="http://www.w3.org/2000/svg",Sc=typeof document!="undefined"?document:null,Nw=Sc&&Sc.createElement("template"),N3={insert:(e,n,r)=>{n.insertBefore(e,r||null)},remove:e=>{const n=e.parentNode;n&&n.removeChild(e)},createElement:(e,n,r,s)=>{const c=n?Sc.createElementNS(U3,e):Sc.createElement(e,r?{is:r}:void 0);return e==="select"&&s&&s.multiple!=null&&c.setAttribute("multiple",s.multiple),c},createText:e=>Sc.createTextNode(e),createComment:e=>Sc.createComment(e),setText:(e,n)=>{e.nodeValue=n},setElementText:(e,n)=>{e.textContent=n},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Sc.querySelector(e),setScopeId(e,n){e.setAttribute(n,"")},cloneNode(e){const n=e.cloneNode(!0);return"_value"in e&&(n._value=e._value),n},insertStaticContent(e,n,r,s,c,h){const m=r?r.previousSibling:n.lastChild;if(c&&(c===h||c.nextSibling))for(;n.insertBefore(c.cloneNode(!0),r),!(c===h||!(c=c.nextSibling)););else{Nw.innerHTML=s?`<svg>${e}</svg>`:e;const a=Nw.content;if(s){const v=a.firstChild;for(;v.firstChild;)a.appendChild(v.firstChild);a.removeChild(v)}n.insertBefore(a,r)}return[m?m.nextSibling:n.firstChild,r?r.previousSibling:n.lastChild]}};function j3(e,n,r){const s=e._vtc;s&&(n=(n?[n,...s]:[...s]).join(" ")),n==null?e.removeAttribute("class"):r?e.setAttribute("class",n):e.className=n}function $3(e,n,r){const s=e.style,c=$r(r);if(r&&!c){for(const h in r)My(s,h,r[h]);if(n&&!$r(n))for(const h in n)r[h]==null&&My(s,h,"")}else{const h=s.display;c?n!==r&&(s.cssText=r):n&&e.removeAttribute("style"),"_vod"in e&&(s.display=h)}}const jw=/\s*!important$/;function My(e,n,r){if(en(r))r.forEach(s=>My(e,n,s));else if(n.startsWith("--"))e.setProperty(n,r);else{const s=V3(e,n);jw.test(r)?e.setProperty(zh(s),r.replace(jw,""),"important"):e[s]=r}}const $w=["Webkit","Moz","ms"],U0={};function V3(e,n){const r=U0[n];if(r)return r;let s=Ws(n);if(s!=="filter"&&s in e)return U0[n]=s;s=B_(s);for(let c=0;c<$w.length;c++){const h=$w[c]+s;if(h in e)return U0[n]=h}return n}const Vw="http://www.w3.org/1999/xlink";function G3(e,n,r,s,c){if(s&&n.startsWith("xlink:"))r==null?e.removeAttributeNS(Vw,n.slice(6,n.length)):e.setAttributeNS(Vw,n,r);else{const h=GP(n);r==null||h&&!aE(r)?e.removeAttribute(n):e.setAttribute(n,h?"":r)}}function q3(e,n,r,s,c,h,m){if(n==="innerHTML"||n==="textContent"){s&&m(s,c,h),e[n]=r==null?"":r;return}if(n==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=r;const a=r==null?"":r;(e.value!==a||e.tagName==="OPTION")&&(e.value=a),r==null&&e.removeAttribute(n);return}if(r===""||r==null){const a=typeof e[n];if(a==="boolean"){e[n]=aE(r);return}else if(r==null&&a==="string"){e[n]="",e.removeAttribute(n);return}else if(a==="number"){try{e[n]=0}catch{}e.removeAttribute(n);return}}try{e[n]=r}catch{}}let t_=Date.now,pS=!1;if(typeof window!="undefined"){t_()>document.createEvent("Event").timeStamp&&(t_=()=>performance.now());const e=navigator.userAgent.match(/firefox\/(\d+)/i);pS=!!(e&&Number(e[1])<=53)}let ky=0;const Z3=Promise.resolve(),W3=()=>{ky=0},H3=()=>ky||(Z3.then(W3),ky=t_());function X3(e,n,r,s){e.addEventListener(n,r,s)}function K3(e,n,r,s){e.removeEventListener(n,r,s)}function Y3(e,n,r,s,c=null){const h=e._vei||(e._vei={}),m=h[n];if(s&&m)m.value=s;else{const[a,v]=Q3(n);if(s){const w=h[n]=J3(s,c);X3(e,a,w,v)}else m&&(K3(e,a,m,v),h[n]=void 0)}}const Gw=/(?:Once|Passive|Capture)$/;function Q3(e){let n;if(Gw.test(e)){n={};let r;for(;r=e.match(Gw);)e=e.slice(0,e.length-r[0].length),n[r[0].toLowerCase()]=!0}return[zh(e.slice(2)),n]}function J3(e,n){const r=s=>{const c=s.timeStamp||t_();(pS||c>=r.attached-1)&&Zo(eR(s,r.value),n,5,[s])};return r.value=e,r.attached=H3(),r}function eR(e,n){if(en(n)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},n.map(s=>c=>!c._stopped&&s&&s(c))}else return n}const qw=/^on[a-z]/,tR=(e,n,r,s,c=!1,h,m,a,v)=>{n==="class"?j3(e,s,c):n==="style"?$3(e,r,s):$d(n)?$v(n)||Y3(e,n,r,s,m):(n[0]==="."?(n=n.slice(1),!0):n[0]==="^"?(n=n.slice(1),!1):nR(e,n,s,c))?q3(e,n,s,h,m,a,v):(n==="true-value"?e._trueValue=s:n==="false-value"&&(e._falseValue=s),G3(e,n,s,c))};function nR(e,n,r,s){return s?!!(n==="innerHTML"||n==="textContent"||n in e&&qw.test(n)&&mn(r)):n==="spellcheck"||n==="draggable"||n==="form"||n==="list"&&e.tagName==="INPUT"||n==="type"&&e.tagName==="TEXTAREA"||qw.test(n)&&$r(r)?!1:n in e}function M8(e){const n=Cl();if(!n)return;const r=()=>Py(n.subTree,e(n.proxy));HD(r),cr(()=>{const s=new MutationObserver(r);s.observe(n.subTree.el.parentNode,{childList:!0}),Cr(()=>s.disconnect())})}function Py(e,n){if(e.shapeFlag&128){const r=e.suspense;e=r.activeBranch,r.pendingBranch&&!r.isHydrating&&r.effects.push(()=>{Py(r.activeBranch,n)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)Zw(e.el,n);else if(e.type===di)e.children.forEach(r=>Py(r,n));else if(e.type===dh){let{el:r,anchor:s}=e;for(;r&&(Zw(r,n),r!==s);)r=r.nextSibling}}function Zw(e,n){if(e.nodeType===1){const r=e.style;for(const s in n)r.setProperty(`--${s}`,n[s])}}const el="transition",Vf="animation",mS=(e,{slots:n})=>yo(VE,gS(e),n);mS.displayName="Transition";const _S={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},rR=mS.props=ii({},VE.props,_S),pc=(e,n=[])=>{en(e)?e.forEach(r=>r(...n)):e&&e(...n)},Ww=e=>e?en(e)?e.some(n=>n.length>1):e.length>1:!1;function gS(e){const n={};for(const Fe in e)Fe in _S||(n[Fe]=e[Fe]);if(e.css===!1)return n;const{name:r="v",type:s,duration:c,enterFromClass:h=`${r}-enter-from`,enterActiveClass:m=`${r}-enter-active`,enterToClass:a=`${r}-enter-to`,appearFromClass:v=h,appearActiveClass:w=m,appearToClass:E=a,leaveFromClass:I=`${r}-leave-from`,leaveActiveClass:M=`${r}-leave-active`,leaveToClass:P=`${r}-leave-to`}=e,j=iR(c),N=j&&j[0],q=j&&j[1],{onBeforeEnter:V,onEnter:ee,onEnterCancelled:oe,onLeave:pe,onLeaveCancelled:se,onBeforeAppear:xe=V,onAppear:Te=ee,onAppearCancelled:De=oe}=n,Me=(Fe,Je,be)=>{xc(Fe,Je?E:a),xc(Fe,Je?w:m),be&&be()},Be=(Fe,Je)=>{xc(Fe,P),xc(Fe,M),Je&&Je()},ze=Fe=>(Je,be)=>{const qe=Fe?Te:ee,Ke=()=>Me(Je,Fe,be);pc(qe,[Je,Ke]),Hw(()=>{xc(Je,Fe?v:h),ha(Je,Fe?E:a),Ww(qe)||Xw(Je,s,N,Ke)})};return ii(n,{onBeforeEnter(Fe){pc(V,[Fe]),ha(Fe,h),ha(Fe,m)},onBeforeAppear(Fe){pc(xe,[Fe]),ha(Fe,v),ha(Fe,w)},onEnter:ze(!1),onAppear:ze(!0),onLeave(Fe,Je){const be=()=>Be(Fe,Je);ha(Fe,I),vS(),ha(Fe,M),Hw(()=>{xc(Fe,I),ha(Fe,P),Ww(pe)||Xw(Fe,s,q,be)}),pc(pe,[Fe,be])},onEnterCancelled(Fe){Me(Fe,!1),pc(oe,[Fe])},onAppearCancelled(Fe){Me(Fe,!0),pc(De,[Fe])},onLeaveCancelled(Fe){Be(Fe),pc(se,[Fe])}})}function iR(e){if(e==null)return null;if(Vr(e))return[N0(e.enter),N0(e.leave)];{const n=N0(e);return[n,n]}}function N0(e){return dE(e)}function ha(e,n){n.split(/\s+/).forEach(r=>r&&e.classList.add(r)),(e._vtc||(e._vtc=new Set)).add(n)}function xc(e,n){n.split(/\s+/).forEach(s=>s&&e.classList.remove(s));const{_vtc:r}=e;r&&(r.delete(n),r.size||(e._vtc=void 0))}function Hw(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let oR=0;function Xw(e,n,r,s){const c=e._endId=++oR,h=()=>{c===e._endId&&s()};if(r)return setTimeout(h,r);const{type:m,timeout:a,propCount:v}=yS(e,n);if(!m)return s();const w=m+"end";let E=0;const I=()=>{e.removeEventListener(w,M),h()},M=P=>{P.target===e&&++E>=v&&I()};setTimeout(()=>{E<v&&I()},a+1),e.addEventListener(w,M)}function yS(e,n){const r=window.getComputedStyle(e),s=j=>(r[j]||"").split(", "),c=s(el+"Delay"),h=s(el+"Duration"),m=Kw(c,h),a=s(Vf+"Delay"),v=s(Vf+"Duration"),w=Kw(a,v);let E=null,I=0,M=0;n===el?m>0&&(E=el,I=m,M=h.length):n===Vf?w>0&&(E=Vf,I=w,M=v.length):(I=Math.max(m,w),E=I>0?m>w?el:Vf:null,M=E?E===el?h.length:v.length:0);const P=E===el&&/\b(transform|all)(,|$)/.test(r[el+"Property"]);return{type:E,timeout:I,propCount:M,hasTransform:P}}function Kw(e,n){for(;e.length<n.length;)e=e.concat(e);return Math.max(...n.map((r,s)=>Yw(r)+Yw(e[s])))}function Yw(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function vS(){return document.body.offsetHeight}const xS=new WeakMap,bS=new WeakMap,sR={name:"TransitionGroup",props:ii({},rR,{tag:String,moveClass:String}),setup(e,{slots:n}){const r=Cl(),s=$E();let c,h;return Z_(()=>{if(!c.length)return;const m=e.moveClass||`${e.name||"v"}-move`;if(!uR(c[0].el,r.vnode.el,m))return;c.forEach(aR),c.forEach(lR);const a=c.filter(cR);vS(),a.forEach(v=>{const w=v.el,E=w.style;ha(w,m),E.transform=E.webkitTransform=E.transitionDuration="";const I=w._moveCb=M=>{M&&M.target!==w||(!M||/transform$/.test(M.propertyName))&&(w.removeEventListener("transitionend",I),w._moveCb=null,xc(w,m))};w.addEventListener("transitionend",I)})}),()=>{const m=un(e),a=gS(m);let v=m.tag||di;c=h,h=n.default?nx(n.default()):[];for(let w=0;w<h.length;w++){const E=h[w];E.key!=null&&Id(E,Cd(E,a,s,r))}if(c)for(let w=0;w<c.length;w++){const E=c[w];Id(E,Cd(E,a,s,r)),xS.set(E,E.el.getBoundingClientRect())}return Xr(v,null,h)}}},k8=sR;function aR(e){const n=e.el;n._moveCb&&n._moveCb(),n._enterCb&&n._enterCb()}function lR(e){bS.set(e,e.el.getBoundingClientRect())}function cR(e){const n=xS.get(e),r=bS.get(e),s=n.left-r.left,c=n.top-r.top;if(s||c){const h=e.el.style;return h.transform=h.webkitTransform=`translate(${s}px,${c}px)`,h.transitionDuration="0s",e}}function uR(e,n,r){const s=e.cloneNode();e._vtc&&e._vtc.forEach(m=>{m.split(/\s+/).forEach(a=>a&&s.classList.remove(a))}),r.split(/\s+/).forEach(m=>m&&s.classList.add(m)),s.style.display="none";const c=n.nodeType===1?n:n.parentNode;c.appendChild(s);const{hasTransform:h}=yS(s);return c.removeChild(s),h}const hR=["ctrl","shift","alt","meta"],fR={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,n)=>hR.some(r=>e[`${r}Key`]&&!n.includes(r))},P8=(e,n)=>(r,...s)=>{for(let c=0;c<n.length;c++){const h=fR[n[c]];if(h&&h(r,n))return}return e(r,...s)},D8={beforeMount(e,{value:n},{transition:r}){e._vod=e.style.display==="none"?"":e.style.display,r&&n?r.beforeEnter(e):Gf(e,n)},mounted(e,{value:n},{transition:r}){r&&n&&r.enter(e)},updated(e,{value:n,oldValue:r},{transition:s}){!n!=!r&&(s?n?(s.beforeEnter(e),Gf(e,!0),s.enter(e)):s.leave(e,()=>{Gf(e,!1)}):Gf(e,n))},beforeUnmount(e,{value:n}){Gf(e,n)}};function Gf(e,n){e.style.display=n?e._vod:"none"}const wS=ii({patchProp:tR},N3);let dd,Qw=!1;function dR(){return dd||(dd=g3(wS))}function pR(){return dd=Qw?dd:y3(wS),Qw=!0,dd}const mR=(...e)=>{const n=dR().createApp(...e),{mount:r}=n;return n.mount=s=>{const c=TS(s);if(!c)return;const h=n._component;!mn(h)&&!h.render&&!h.template&&(h.template=c.innerHTML),c.innerHTML="";const m=r(c,!1,c instanceof SVGElement);return c instanceof Element&&(c.removeAttribute("v-cloak"),c.setAttribute("data-v-app","")),m},n},_R=(...e)=>{const n=pR().createApp(...e),{mount:r}=n;return n.mount=s=>{const c=TS(s);if(c)return r(c,!0,c instanceof SVGElement)},n};function TS(e){return $r(e)?document.querySelector(e):e}/*!
  * vue-i18n v9.2.0-beta.30
  * (c) 2022 kazuya kawaguchi
  * Released under the MIT License.
  */const gR="9.2.0-beta.30";function yR(){typeof __INTLIFY_PROD_DEVTOOLS__!="boolean"&&(zv().__INTLIFY_PROD_DEVTOOLS__=!1)}CP.__EXTEND_POINT__;let ES=Q2.__EXTEND_POINT__;const Fo=()=>++ES,xo={UNEXPECTED_RETURN_TYPE:ES,INVALID_ARGUMENT:Fo(),MUST_BE_CALL_SETUP_TOP:Fo(),NOT_INSLALLED:Fo(),NOT_AVAILABLE_IN_LEGACY_MODE:Fo(),REQUIRED_VALUE:Fo(),INVALID_VALUE:Fo(),CANNOT_SETUP_VUE_DEVTOOLS_PLUGIN:Fo(),NOT_INSLALLED_WITH_PROVIDE:Fo(),UNEXPECTED_ERROR:Fo(),NOT_COMPATIBLE_LEGACY_VUE_I18N:Fo(),BRIDGE_SUPPORT_VUE_2_ONLY:Fo(),__EXTEND_POINT__:Fo()};function Wo(e,...n){return J2(e,null,void 0)}const Dy=El("__transrateVNode"),Ry=El("__datetimeParts"),zy=El("__numberParts"),vR=El("__setPluralRules");El("__intlifyMeta");const xR=El("__injectWithOption");function Oy(e){if(!kr(e))return e;for(const n in e)if(!!Ov(e,n))if(!n.includes("."))kr(e[n])&&Oy(e[n]);else{const r=n.split("."),s=r.length-1;let c=e;for(let h=0;h<s;h++)r[h]in c||(c[r[h]]={}),c=c[r[h]];c[r[s]]=e[n],delete e[n],kr(c[r[s]])&&Oy(c[r[s]])}return e}function SS(e,n){const{messages:r,__i18n:s,messageResolver:c,flatJson:h}=n,m=Ln(r)?r:ni(s)?{}:{[e]:{}};if(ni(s)&&s.forEach(a=>{if("locale"in a&&"resource"in a){const{locale:v,resource:w}=a;v?(m[v]=m[v]||{},pd(w,m[v])):pd(w,m)}else Vt(a)&&pd(JSON.parse(a),m)}),c==null&&h)for(const a in m)Ov(m,a)&&Oy(m[a]);return m}const Im=e=>!kr(e)||ni(e);function pd(e,n){if(Im(e)||Im(n))throw Wo(xo.INVALID_VALUE);for(const r in e)Ov(e,r)&&(Im(e[r])||Im(n[r])?n[r]=e[r]:pd(e[r],n[r]))}function AS(e){return e.type}function bR(e,n,r){let s=kr(n.messages)?n.messages:{};"__i18nGlobal"in r&&(s=SS(e.locale.value,{messages:s,__i18n:r.__i18nGlobal}));const c=Object.keys(s);c.length&&c.forEach(h=>{e.mergeLocaleMessage(h,s[h])});{if(kr(n.datetimeFormats)){const h=Object.keys(n.datetimeFormats);h.length&&h.forEach(m=>{e.mergeDateTimeFormat(m,n.datetimeFormats[m])})}if(kr(n.numberFormats)){const h=Object.keys(n.numberFormats);h.length&&h.forEach(m=>{e.mergeNumberFormat(m,n.numberFormats[m])})}}}function Jw(e){return Xr(yh,null,e,0)}const eT="__INTLIFY_META__";let tT=0;function nT(e){return(n,r,s,c)=>e(r,s,Cl()||void 0,c)}const wR=()=>{const e=Cl();let n=null;return e&&(n=AS(e)[eT])?{[eT]:n}:null};function CS(e={},n){const{__root:r}=e,s=r===void 0;let c=Hr(e.inheritLocale)?e.inheritLocale:!0;const h=ft(r&&c?r.locale.value:Vt(e.locale)?e.locale:Fv),m=ft(r&&c?r.fallbackLocale.value:Vt(e.fallbackLocale)||ni(e.fallbackLocale)||Ln(e.fallbackLocale)||e.fallbackLocale===!1?e.fallbackLocale:h.value),a=ft(SS(h.value,e)),v=ft(Ln(e.datetimeFormats)?e.datetimeFormats:{[h.value]:{}}),w=ft(Ln(e.numberFormats)?e.numberFormats:{[h.value]:{}});let E=r?r.missingWarn:Hr(e.missingWarn)||Gm(e.missingWarn)?e.missingWarn:!0,I=r?r.fallbackWarn:Hr(e.fallbackWarn)||Gm(e.fallbackWarn)?e.fallbackWarn:!0,M=r?r.fallbackRoot:Hr(e.fallbackRoot)?e.fallbackRoot:!0,P=!!e.fallbackFormat,j=fi(e.missing)?e.missing:null,N=fi(e.missing)?nT(e.missing):null,q=fi(e.postTranslation)?e.postTranslation:null,V=r?r.warnHtmlMessage:Hr(e.warnHtmlMessage)?e.warnHtmlMessage:!0,ee=!!e.escapeParameter;const oe=r?r.modifiers:Ln(e.modifiers)?e.modifiers:{};let pe=e.pluralRules||r&&r.pluralRules,se;function xe(){const we={version:gR,locale:h.value,fallbackLocale:m.value,messages:a.value,modifiers:oe,pluralRules:pe,missing:N===null?void 0:N,missingWarn:E,fallbackWarn:I,fallbackFormat:P,unresolving:!0,postTranslation:q===null?void 0:q,warnHtmlMessage:V,escapeParameter:ee,messageResolver:e.messageResolver,__meta:{framework:"vue"}};return we.datetimeFormats=v.value,we.numberFormats=w.value,we.__datetimeFormatters=Ln(se)?se.__datetimeFormatters:void 0,we.__numberFormatters=Ln(se)?se.__numberFormatters:void 0,FP(we)}se=xe(),$f(se,h.value,m.value);function Te(){return[h.value,m.value,a.value,v.value,w.value]}const De=Et({get:()=>h.value,set:we=>{h.value=we,se.locale=h.value}}),Me=Et({get:()=>m.value,set:we=>{m.value=we,se.fallbackLocale=m.value,$f(se,h.value,we)}}),Be=Et(()=>a.value),ze=Et(()=>v.value),Fe=Et(()=>w.value);function Je(){return fi(q)?q:null}function be(we){q=we,se.postTranslation=we}function qe(){return j}function Ke(we){we!==null&&(N=nT(we)),j=we,se.missing=N}function _t(we,Ue,At,mt,Gt,Qt){Te();let _n;if(__INTLIFY_PROD_DEVTOOLS__)try{hw(wR()),_n=we(se)}finally{hw(null)}else _n=we(se);if(mi(_n)&&_n===O_){const[tn,zn]=Ue();return r&&M?mt(r):Gt(tn)}else{if(Qt(_n))return _n;throw Wo(xo.UNEXPECTED_RETURN_TYPE)}}function It(...we){return _t(Ue=>Reflect.apply(pw,null,[Ue,...we]),()=>my(...we),"translate",Ue=>Reflect.apply(Ue.t,Ue,[...we]),Ue=>Ue,Ue=>Vt(Ue))}function Tt(...we){const[Ue,At,mt]=we;if(mt&&!kr(mt))throw Wo(xo.INVALID_ARGUMENT);return It(Ue,At,Fi({resolvedMessage:!0},mt||{}))}function Dn(...we){return _t(Ue=>Reflect.apply(mw,null,[Ue,...we]),()=>_y(...we),"datetime format",Ue=>Reflect.apply(Ue.d,Ue,[...we]),()=>uw,Ue=>Vt(Ue))}function Ot(...we){return _t(Ue=>Reflect.apply(gw,null,[Ue,...we]),()=>gy(...we),"number format",Ue=>Reflect.apply(Ue.n,Ue,[...we]),()=>uw,Ue=>Vt(Ue))}function Zn(we){return we.map(Ue=>Vt(Ue)?Jw(Ue):Ue)}const _r={normalize:Zn,interpolate:we=>we,type:"vnode"};function it(...we){return _t(Ue=>{let At;const mt=Ue;try{mt.processor=_r,At=Reflect.apply(pw,null,[mt,...we])}finally{mt.processor=null}return At},()=>my(...we),"translate",Ue=>Ue[Dy](...we),Ue=>[Jw(Ue)],Ue=>ni(Ue))}function Dt(...we){return _t(Ue=>Reflect.apply(gw,null,[Ue,...we]),()=>gy(...we),"number format",Ue=>Ue[zy](...we),()=>[],Ue=>Vt(Ue)||ni(Ue))}function yt(...we){return _t(Ue=>Reflect.apply(mw,null,[Ue,...we]),()=>_y(...we),"datetime format",Ue=>Ue[Ry](...we),()=>[],Ue=>Vt(Ue)||ni(Ue))}function Lt(we){pe=we,se.pluralRules=pe}function Tn(we,Ue){const At=Vt(Ue)?Ue:h.value,mt=Ht(At);return se.messageResolver(mt,we)!==null}function Cn(we){let Ue=null;const At=tE(se,m.value,h.value);for(let mt=0;mt<At.length;mt++){const Gt=a.value[At[mt]]||{},Qt=se.messageResolver(Gt,we);if(Qt!=null){Ue=Qt;break}}return Ue}function Kt(we){const Ue=Cn(we);return Ue!=null?Ue:r?r.tm(we)||{}:{}}function Ht(we){return a.value[we]||{}}function fe(we,Ue){a.value[we]=Ue,se.messages=a.value}function _e(we,Ue){a.value[we]=a.value[we]||{},pd(Ue,a.value[we]),se.messages=a.value}function Oe(we){return v.value[we]||{}}function rt(we,Ue){v.value[we]=Ue,se.datetimeFormats=v.value,_w(se,we,Ue)}function ot(we,Ue){v.value[we]=Fi(v.value[we]||{},Ue),se.datetimeFormats=v.value,_w(se,we,Ue)}function vt(we){return w.value[we]||{}}function St(we,Ue){w.value[we]=Ue,se.numberFormats=w.value,yw(se,we,Ue)}function Ye(we,Ue){w.value[we]=Fi(w.value[we]||{},Ue),se.numberFormats=w.value,yw(se,we,Ue)}tT++,r&&(gi(r.locale,we=>{c&&(h.value=we,se.locale=we,$f(se,h.value,m.value))}),gi(r.fallbackLocale,we=>{c&&(m.value=we,se.fallbackLocale=we,$f(se,h.value,m.value))}));const at={id:tT,locale:De,fallbackLocale:Me,get inheritLocale(){return c},set inheritLocale(we){c=we,we&&r&&(h.value=r.locale.value,m.value=r.fallbackLocale.value,$f(se,h.value,m.value))},get availableLocales(){return Object.keys(a.value).sort()},messages:Be,get modifiers(){return oe},get pluralRules(){return pe||{}},get isGlobal(){return s},get missingWarn(){return E},set missingWarn(we){E=we,se.missingWarn=E},get fallbackWarn(){return I},set fallbackWarn(we){I=we,se.fallbackWarn=I},get fallbackRoot(){return M},set fallbackRoot(we){M=we},get fallbackFormat(){return P},set fallbackFormat(we){P=we,se.fallbackFormat=P},get warnHtmlMessage(){return V},set warnHtmlMessage(we){V=we,se.warnHtmlMessage=we},get escapeParameter(){return ee},set escapeParameter(we){ee=we,se.escapeParameter=we},t:It,getLocaleMessage:Ht,setLocaleMessage:fe,mergeLocaleMessage:_e,getPostTranslationHandler:Je,setPostTranslationHandler:be,getMissingHandler:qe,setMissingHandler:Ke,[vR]:Lt};return at.datetimeFormats=ze,at.numberFormats=Fe,at.rt=Tt,at.te=Tn,at.tm=Kt,at.d=Dn,at.n=Ot,at.getDateTimeFormat=Oe,at.setDateTimeFormat=rt,at.mergeDateTimeFormat=ot,at.getNumberFormat=vt,at.setNumberFormat=St,at.mergeNumberFormat=Ye,at[xR]=e.__injectWithOption,at[Dy]=it,at[Ry]=yt,at[zy]=Dt,at}const cx={tag:{type:[String,Object]},locale:{type:String},scope:{type:String,validator:e=>e==="parent"||e==="global",default:"parent"},i18n:{type:Object}};function TR({slots:e},n){return n.length===1&&n[0]==="default"?(e.default?e.default():[]).reduce((s,c)=>s=[...s,...ni(c.children)?c.children:[c]],[]):n.reduce((r,s)=>{const c=e[s];return c&&(r[s]=c()),r},{})}function IS(e){return di}const rT={name:"i18n-t",props:Fi({keypath:{type:String,required:!0},plural:{type:[Number,String],validator:e=>mi(e)||!isNaN(e)}},cx),setup(e,n){const{slots:r,attrs:s}=n,c=e.i18n||ux({useScope:e.scope,__useComponent:!0}),h=Object.keys(r).filter(m=>m!=="_");return()=>{const m={};e.locale&&(m.locale=e.locale),e.plural!==void 0&&(m.plural=Vt(e.plural)?+e.plural:e.plural);const a=TR(n,h),v=c[Dy](e.keypath,a,m),w=Fi({},s),E=Vt(e.tag)||kr(e.tag)?e.tag:IS();return yo(E,w,v)}}};function MS(e,n,r,s){const{slots:c,attrs:h}=n;return()=>{const m={part:!0};let a={};e.locale&&(m.locale=e.locale),Vt(e.format)?m.key=e.format:kr(e.format)&&(Vt(e.format.key)&&(m.key=e.format.key),a=Object.keys(e.format).reduce((M,P)=>r.includes(P)?Fi({},M,{[P]:e.format[P]}):M,{}));const v=s(e.value,m,a);let w=[m.key];ni(v)?w=v.map((M,P)=>{const j=c[M.type];return j?j({[M.type]:M.value,index:P,parts:v}):[M.value]}):Vt(v)&&(w=[v]);const E=Fi({},h),I=Vt(e.tag)||kr(e.tag)?e.tag:IS();return yo(I,E,w)}}const ER=["localeMatcher","style","unit","unitDisplay","currency","currencyDisplay","useGrouping","numberingSystem","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","notation","formatMatcher"],iT={name:"i18n-n",props:Fi({value:{type:Number,required:!0},format:{type:[String,Object]}},cx),setup(e,n){const r=e.i18n||ux({useScope:"parent",__useComponent:!0});return MS(e,n,ER,(...s)=>r[zy](...s))}},SR=["dateStyle","timeStyle","fractionalSecondDigits","calendar","dayPeriod","numberingSystem","localeMatcher","timeZone","hour12","hourCycle","formatMatcher","weekday","era","year","month","day","hour","minute","second","timeZoneName"],oT={name:"i18n-d",props:Fi({value:{type:[Number,Date],required:!0},format:{type:[String,Object]}},cx),setup(e,n){const r=e.i18n||ux({useScope:"parent",__useComponent:!0});return MS(e,n,SR,(...s)=>r[Ry](...s))}};function AR(e,n){const r=e;if(e.mode==="composition")return r.__getInstance(n)||e.global;{const s=r.__getInstance(n);return s!=null?s.__composer:e.global.__composer}}function CR(e){const n=(r,{instance:s,value:c,modifiers:h})=>{if(!s||!s.$)throw Wo(xo.UNEXPECTED_ERROR);const m=AR(e,s.$),a=IR(c);r.textContent=Reflect.apply(m.t,m,[...MR(a)])};return{beforeMount:n,beforeUpdate:n}}function IR(e){if(Vt(e))return{path:e};if(Ln(e)){if(!("path"in e))throw Wo(xo.REQUIRED_VALUE,"path");return e}else throw Wo(xo.INVALID_VALUE)}function MR(e){const{path:n,locale:r,args:s,choice:c,plural:h}=e,m={},a=s||{};return Vt(r)&&(m.locale=r),mi(c)&&(m.plural=c),mi(h)&&(m.plural=h),[n,a,m]}function kR(e,n,...r){const s=Ln(r[0])?r[0]:{},c=!!s.useI18nComponentName;(Hr(s.globalInstall)?s.globalInstall:!0)&&(e.component(c?"i18n":rT.name,rT),e.component(iT.name,iT),e.component(oT.name,oT)),e.directive("t",CR(n))}const PR=El("global-vue-i18n");function R8(e={},n){const r=!!e.globalInjection,s=new Map,c=DR(e),h=El("");function m(w){return s.get(w)||null}function a(w,E){s.set(w,E)}function v(w){s.delete(w)}{const w={get mode(){return"composition"},async install(E,...I){E.__VUE_I18N_SYMBOL__=h,E.provide(E.__VUE_I18N_SYMBOL__,w),r&&NR(E,w.global),kR(E,w,...I)},get global(){return c},__instances:s,__getInstance:m,__setInstance:a,__deleteInstance:v};return w}}function ux(e={}){const n=Cl();if(n==null)throw Wo(xo.MUST_BE_CALL_SETUP_TOP);if(!n.isCE&&n.appContext.app!=null&&!n.appContext.app.__VUE_I18N_SYMBOL__)throw Wo(xo.NOT_INSLALLED);const r=RR(n),s=OR(r),c=AS(n),h=zR(e,c);if(h==="global")return bR(s,e,c),s;if(h==="parent"){let v=LR(r,n,e.__useComponent);return v==null&&(v=s),v}if(r.mode==="legacy")throw Wo(xo.NOT_AVAILABLE_IN_LEGACY_MODE);const m=r;let a=m.__getInstance(n);if(a==null){const v=Fi({},e);"__i18n"in c&&(v.__i18n=c.__i18n),s&&(v.__root=s),a=CS(v),FR(m,n),m.__setInstance(n,a)}return a}function DR(e,n,r){return CS(e)}function RR(e){{const n=kn(e.isCE?PR:e.appContext.app.__VUE_I18N_SYMBOL__);if(!n)throw Wo(e.isCE?xo.NOT_INSLALLED_WITH_PROVIDE:xo.UNEXPECTED_ERROR);return n}}function zR(e,n){return z_(e)?"__i18n"in n?"local":"global":e.useScope?e.useScope:"local"}function OR(e){return e.mode==="composition"?e.global:e.global.__composer}function LR(e,n,r=!1){let s=null;const c=n.root;let h=n.parent;for(;h!=null;){const m=e;if(e.mode==="composition"&&(s=m.__getInstance(h)),s!=null||c===h)break;h=h.parent}return s}function FR(e,n,r){cr(()=>{},n),Cr(()=>{e.__deleteInstance(n)},n)}const BR=["locale","fallbackLocale","availableLocales"],UR=["t","rt","d","n","tm"];function NR(e,n){const r=Object.create(null);BR.forEach(s=>{const c=Object.getOwnPropertyDescriptor(n,s);if(!c)throw Wo(xo.UNEXPECTED_ERROR);const h=Ar(c.value)?{get(){return c.value.value},set(m){c.value.value=m}}:{get(){return c.get&&c.get()}};Object.defineProperty(r,s,h)}),e.config.globalProperties.$i18n=r,UR.forEach(s=>{const c=Object.getOwnPropertyDescriptor(n,s);if(!c||!c.value)throw Wo(xo.UNEXPECTED_ERROR);Object.defineProperty(e.config.globalProperties,`$${s}`,c)})}zP(pP);OP(tE);yR();if(__INTLIFY_PROD_DEVTOOLS__){const e=zv();e.__INTLIFY__=!0,TP(e.__INTLIFY_DEVTOOLS_GLOBAL_HOOK__)}function Ly(e,n){return Ly=Object.setPrototypeOf||function(s,c){return s.__proto__=c,s},Ly(e,n)}function Fh(e,n){e.prototype=Object.create(n.prototype),e.prototype.constructor=e,Ly(e,n)}var Bh=function(){function e(){this.listeners=[]}var n=e.prototype;return n.subscribe=function(s){var c=this,h=s||function(){};return this.listeners.push(h),this.onSubscribe(),function(){c.listeners=c.listeners.filter(function(m){return m!==h}),c.onUnsubscribe()}},n.hasListeners=function(){return this.listeners.length>0},n.onSubscribe=function(){},n.onUnsubscribe=function(){},e}();function On(){return On=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},On.apply(this,arguments)}var n_=typeof window=="undefined";function Si(){}function jR(e,n){return typeof e=="function"?e(n):e}function Fy(e){return typeof e=="number"&&e>=0&&e!==1/0}function r_(e){return Array.isArray(e)?e:[e]}function kS(e,n){return Math.max(e+(n||0)-Date.now(),0)}function j0(e,n,r){return H_(e)?typeof n=="function"?On({},r,{queryKey:e,queryFn:n}):On({},n,{queryKey:e}):e}function ll(e,n,r){return H_(e)?[On({},n,{queryKey:e}),r]:[e||{},n]}function $R(e,n){if(e===!0&&n===!0||e==null&&n==null)return"all";if(e===!1&&n===!1)return"none";var r=e!=null?e:!n;return r?"active":"inactive"}function sT(e,n){var r=e.active,s=e.exact,c=e.fetching,h=e.inactive,m=e.predicate,a=e.queryKey,v=e.stale;if(H_(a)){if(s){if(n.queryHash!==hx(a,n.options))return!1}else if(!i_(n.queryKey,a))return!1}var w=$R(r,h);if(w==="none")return!1;if(w!=="all"){var E=n.isActive();if(w==="active"&&!E||w==="inactive"&&E)return!1}return!(typeof v=="boolean"&&n.isStale()!==v||typeof c=="boolean"&&n.isFetching()!==c||m&&!m(n))}function aT(e,n){var r=e.exact,s=e.fetching,c=e.predicate,h=e.mutationKey;if(H_(h)){if(!n.options.mutationKey)return!1;if(r){if(Ic(n.options.mutationKey)!==Ic(h))return!1}else if(!i_(n.options.mutationKey,h))return!1}return!(typeof s=="boolean"&&n.state.status==="loading"!==s||c&&!c(n))}function hx(e,n){var r=(n==null?void 0:n.queryKeyHashFn)||Ic;return r(e)}function Ic(e){var n=r_(e);return VR(n)}function VR(e){return JSON.stringify(e,function(n,r){return By(r)?Object.keys(r).sort().reduce(function(s,c){return s[c]=r[c],s},{}):r})}function i_(e,n){return PS(r_(e),r_(n))}function PS(e,n){return e===n?!0:typeof e!=typeof n?!1:e&&n&&typeof e=="object"&&typeof n=="object"?!Object.keys(n).some(function(r){return!PS(e[r],n[r])}):!1}function o_(e,n){if(e===n)return e;var r=Array.isArray(e)&&Array.isArray(n);if(r||By(e)&&By(n)){for(var s=r?e.length:Object.keys(e).length,c=r?n:Object.keys(n),h=c.length,m=r?[]:{},a=0,v=0;v<h;v++){var w=r?v:c[v];m[w]=o_(e[w],n[w]),m[w]===e[w]&&a++}return s===h&&a===s?e:m}return n}function GR(e,n){if(e&&!n||n&&!e)return!1;for(var r in e)if(e[r]!==n[r])return!1;return!0}function By(e){if(!lT(e))return!1;var n=e.constructor;if(typeof n=="undefined")return!0;var r=n.prototype;return!(!lT(r)||!r.hasOwnProperty("isPrototypeOf"))}function lT(e){return Object.prototype.toString.call(e)==="[object Object]"}function H_(e){return typeof e=="string"||Array.isArray(e)}function qR(e){return new Promise(function(n){setTimeout(n,e)})}function cT(e){Promise.resolve().then(e).catch(function(n){return setTimeout(function(){throw n})})}function DS(){if(typeof AbortController=="function")return new AbortController}var ZR=function(e){Fh(n,e);function n(){var s;return s=e.call(this)||this,s.setup=function(c){var h;if(!n_&&((h=window)==null?void 0:h.addEventListener)){var m=function(){return c()};return window.addEventListener("visibilitychange",m,!1),window.addEventListener("focus",m,!1),function(){window.removeEventListener("visibilitychange",m),window.removeEventListener("focus",m)}}},s}var r=n.prototype;return r.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},r.onUnsubscribe=function(){if(!this.hasListeners()){var c;(c=this.cleanup)==null||c.call(this),this.cleanup=void 0}},r.setEventListener=function(c){var h,m=this;this.setup=c,(h=this.cleanup)==null||h.call(this),this.cleanup=c(function(a){typeof a=="boolean"?m.setFocused(a):m.onFocus()})},r.setFocused=function(c){this.focused=c,c&&this.onFocus()},r.onFocus=function(){this.listeners.forEach(function(c){c()})},r.isFocused=function(){return typeof this.focused=="boolean"?this.focused:typeof document=="undefined"?!0:[void 0,"visible","prerender"].includes(document.visibilityState)},n}(Bh),md=new ZR,WR=function(e){Fh(n,e);function n(){var s;return s=e.call(this)||this,s.setup=function(c){var h;if(!n_&&((h=window)==null?void 0:h.addEventListener)){var m=function(){return c()};return window.addEventListener("online",m,!1),window.addEventListener("offline",m,!1),function(){window.removeEventListener("online",m),window.removeEventListener("offline",m)}}},s}var r=n.prototype;return r.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},r.onUnsubscribe=function(){if(!this.hasListeners()){var c;(c=this.cleanup)==null||c.call(this),this.cleanup=void 0}},r.setEventListener=function(c){var h,m=this;this.setup=c,(h=this.cleanup)==null||h.call(this),this.cleanup=c(function(a){typeof a=="boolean"?m.setOnline(a):m.onOnline()})},r.setOnline=function(c){this.online=c,c&&this.onOnline()},r.onOnline=function(){this.listeners.forEach(function(c){c()})},r.isOnline=function(){return typeof this.online=="boolean"?this.online:typeof navigator=="undefined"||typeof navigator.onLine=="undefined"?!0:navigator.onLine},n}(Bh),Fm=new WR;function HR(e){return Math.min(1e3*Math.pow(2,e),3e4)}function s_(e){return typeof(e==null?void 0:e.cancel)=="function"}var RS=function(n){this.revert=n==null?void 0:n.revert,this.silent=n==null?void 0:n.silent};function Bm(e){return e instanceof RS}var zS=function(n){var r=this,s=!1,c,h,m,a;this.abort=n.abort,this.cancel=function(M){return c==null?void 0:c(M)},this.cancelRetry=function(){s=!0},this.continueRetry=function(){s=!1},this.continue=function(){return h==null?void 0:h()},this.failureCount=0,this.isPaused=!1,this.isResolved=!1,this.isTransportCancelable=!1,this.promise=new Promise(function(M,P){m=M,a=P});var v=function(P){r.isResolved||(r.isResolved=!0,n.onSuccess==null||n.onSuccess(P),h==null||h(),m(P))},w=function(P){r.isResolved||(r.isResolved=!0,n.onError==null||n.onError(P),h==null||h(),a(P))},E=function(){return new Promise(function(P){h=P,r.isPaused=!0,n.onPause==null||n.onPause()}).then(function(){h=void 0,r.isPaused=!1,n.onContinue==null||n.onContinue()})},I=function M(){if(!r.isResolved){var P;try{P=n.fn()}catch(j){P=Promise.reject(j)}c=function(N){if(!r.isResolved&&(w(new RS(N)),r.abort==null||r.abort(),s_(P)))try{P.cancel()}catch{}},r.isTransportCancelable=s_(P),Promise.resolve(P).then(v).catch(function(j){var N,q;if(!r.isResolved){var V=(N=n.retry)!=null?N:3,ee=(q=n.retryDelay)!=null?q:HR,oe=typeof ee=="function"?ee(r.failureCount,j):ee,pe=V===!0||typeof V=="number"&&r.failureCount<V||typeof V=="function"&&V(r.failureCount,j);if(s||!pe){w(j);return}r.failureCount++,n.onFail==null||n.onFail(r.failureCount,j),qR(oe).then(function(){if(!md.isFocused()||!Fm.isOnline())return E()}).then(function(){s?w(j):M()})}})}};I()},XR=function(){function e(){this.queue=[],this.transactions=0,this.notifyFn=function(r){r()},this.batchNotifyFn=function(r){r()}}var n=e.prototype;return n.batch=function(s){var c;this.transactions++;try{c=s()}finally{this.transactions--,this.transactions||this.flush()}return c},n.schedule=function(s){var c=this;this.transactions?this.queue.push(s):cT(function(){c.notifyFn(s)})},n.batchCalls=function(s){var c=this;return function(){for(var h=arguments.length,m=new Array(h),a=0;a<h;a++)m[a]=arguments[a];c.schedule(function(){s.apply(void 0,m)})}},n.flush=function(){var s=this,c=this.queue;this.queue=[],c.length&&cT(function(){s.batchNotifyFn(function(){c.forEach(function(h){s.notifyFn(h)})})})},n.setNotifyFunction=function(s){this.notifyFn=s},n.setBatchNotifyFunction=function(s){this.batchNotifyFn=s},e}(),ei=new XR,KR=console;function a_(){return KR}var YR=function(){function e(r){this.abortSignalConsumed=!1,this.hadObservers=!1,this.defaultOptions=r.defaultOptions,this.setOptions(r.options),this.observers=[],this.cache=r.cache,this.queryKey=r.queryKey,this.queryHash=r.queryHash,this.initialState=r.state||this.getDefaultState(this.options),this.state=this.initialState,this.meta=r.meta,this.scheduleGc()}var n=e.prototype;return n.setOptions=function(s){var c;this.options=On({},this.defaultOptions,s),this.meta=s==null?void 0:s.meta,this.cacheTime=Math.max(this.cacheTime||0,(c=this.options.cacheTime)!=null?c:5*60*1e3)},n.setDefaultOptions=function(s){this.defaultOptions=s},n.scheduleGc=function(){var s=this;this.clearGcTimeout(),Fy(this.cacheTime)&&(this.gcTimeout=setTimeout(function(){s.optionalRemove()},this.cacheTime))},n.clearGcTimeout=function(){clearTimeout(this.gcTimeout),this.gcTimeout=void 0},n.optionalRemove=function(){this.observers.length||(this.state.isFetching?this.hadObservers&&this.scheduleGc():this.cache.remove(this))},n.setData=function(s,c){var h,m,a=this.state.data,v=jR(s,a);return((h=(m=this.options).isDataEqual)==null?void 0:h.call(m,a,v))?v=a:this.options.structuralSharing!==!1&&(v=o_(a,v)),this.dispatch({data:v,type:"success",dataUpdatedAt:c==null?void 0:c.updatedAt}),v},n.setState=function(s,c){this.dispatch({type:"setState",state:s,setStateOptions:c})},n.cancel=function(s){var c,h=this.promise;return(c=this.retryer)==null||c.cancel(s),h?h.then(Si).catch(Si):Promise.resolve()},n.destroy=function(){this.clearGcTimeout(),this.cancel({silent:!0})},n.reset=function(){this.destroy(),this.setState(this.initialState)},n.isActive=function(){return this.observers.some(function(s){return s.options.enabled!==!1})},n.isFetching=function(){return this.state.isFetching},n.isStale=function(){return this.state.isInvalidated||!this.state.dataUpdatedAt||this.observers.some(function(s){return s.getCurrentResult().isStale})},n.isStaleByTime=function(s){return s===void 0&&(s=0),this.state.isInvalidated||!this.state.dataUpdatedAt||!kS(this.state.dataUpdatedAt,s)},n.onFocus=function(){var s,c=this.observers.find(function(h){return h.shouldFetchOnWindowFocus()});c&&c.refetch(),(s=this.retryer)==null||s.continue()},n.onOnline=function(){var s,c=this.observers.find(function(h){return h.shouldFetchOnReconnect()});c&&c.refetch(),(s=this.retryer)==null||s.continue()},n.addObserver=function(s){this.observers.indexOf(s)===-1&&(this.observers.push(s),this.hadObservers=!0,this.clearGcTimeout(),this.cache.notify({type:"observerAdded",query:this,observer:s}))},n.removeObserver=function(s){this.observers.indexOf(s)!==-1&&(this.observers=this.observers.filter(function(c){return c!==s}),this.observers.length||(this.retryer&&(this.retryer.isTransportCancelable||this.abortSignalConsumed?this.retryer.cancel({revert:!0}):this.retryer.cancelRetry()),this.cacheTime?this.scheduleGc():this.cache.remove(this)),this.cache.notify({type:"observerRemoved",query:this,observer:s}))},n.getObserversCount=function(){return this.observers.length},n.invalidate=function(){this.state.isInvalidated||this.dispatch({type:"invalidate"})},n.fetch=function(s,c){var h=this,m,a,v;if(this.state.isFetching){if(this.state.dataUpdatedAt&&(c==null?void 0:c.cancelRefetch))this.cancel({silent:!0});else if(this.promise){var w;return(w=this.retryer)==null||w.continueRetry(),this.promise}}if(s&&this.setOptions(s),!this.options.queryFn){var E=this.observers.find(function(ee){return ee.options.queryFn});E&&this.setOptions(E.options)}var I=r_(this.queryKey),M=DS(),P={queryKey:I,pageParam:void 0,meta:this.meta};Object.defineProperty(P,"signal",{enumerable:!0,get:function(){if(M)return h.abortSignalConsumed=!0,M.signal}});var j=function(){return h.options.queryFn?(h.abortSignalConsumed=!1,h.options.queryFn(P)):Promise.reject("Missing queryFn")},N={fetchOptions:c,options:this.options,queryKey:I,state:this.state,fetchFn:j,meta:this.meta};if((m=this.options.behavior)==null?void 0:m.onFetch){var q;(q=this.options.behavior)==null||q.onFetch(N)}if(this.revertState=this.state,!this.state.isFetching||this.state.fetchMeta!==((a=N.fetchOptions)==null?void 0:a.meta)){var V;this.dispatch({type:"fetch",meta:(V=N.fetchOptions)==null?void 0:V.meta})}return this.retryer=new zS({fn:N.fetchFn,abort:M==null||(v=M.abort)==null?void 0:v.bind(M),onSuccess:function(oe){h.setData(oe),h.cache.config.onSuccess==null||h.cache.config.onSuccess(oe,h),h.cacheTime===0&&h.optionalRemove()},onError:function(oe){Bm(oe)&&oe.silent||h.dispatch({type:"error",error:oe}),Bm(oe)||(h.cache.config.onError==null||h.cache.config.onError(oe,h),a_().error(oe)),h.cacheTime===0&&h.optionalRemove()},onFail:function(){h.dispatch({type:"failed"})},onPause:function(){h.dispatch({type:"pause"})},onContinue:function(){h.dispatch({type:"continue"})},retry:N.options.retry,retryDelay:N.options.retryDelay}),this.promise=this.retryer.promise,this.promise},n.dispatch=function(s){var c=this;this.state=this.reducer(this.state,s),ei.batch(function(){c.observers.forEach(function(h){h.onQueryUpdate(s)}),c.cache.notify({query:c,type:"queryUpdated",action:s})})},n.getDefaultState=function(s){var c=typeof s.initialData=="function"?s.initialData():s.initialData,h=typeof s.initialData!="undefined",m=h?typeof s.initialDataUpdatedAt=="function"?s.initialDataUpdatedAt():s.initialDataUpdatedAt:0,a=typeof c!="undefined";return{data:c,dataUpdateCount:0,dataUpdatedAt:a?m!=null?m:Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchMeta:null,isFetching:!1,isInvalidated:!1,isPaused:!1,status:a?"success":"idle"}},n.reducer=function(s,c){var h,m;switch(c.type){case"failed":return On({},s,{fetchFailureCount:s.fetchFailureCount+1});case"pause":return On({},s,{isPaused:!0});case"continue":return On({},s,{isPaused:!1});case"fetch":return On({},s,{fetchFailureCount:0,fetchMeta:(h=c.meta)!=null?h:null,isFetching:!0,isPaused:!1},!s.dataUpdatedAt&&{error:null,status:"loading"});case"success":return On({},s,{data:c.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:(m=c.dataUpdatedAt)!=null?m:Date.now(),error:null,fetchFailureCount:0,isFetching:!1,isInvalidated:!1,isPaused:!1,status:"success"});case"error":var a=c.error;return Bm(a)&&a.revert&&this.revertState?On({},this.revertState):On({},s,{error:a,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,isFetching:!1,isPaused:!1,status:"error"});case"invalidate":return On({},s,{isInvalidated:!0});case"setState":return On({},s,c.state);default:return s}},e}(),QR=function(e){Fh(n,e);function n(s){var c;return c=e.call(this)||this,c.config=s||{},c.queries=[],c.queriesMap={},c}var r=n.prototype;return r.build=function(c,h,m){var a,v=h.queryKey,w=(a=h.queryHash)!=null?a:hx(v,h),E=this.get(w);return E||(E=new YR({cache:this,queryKey:v,queryHash:w,options:c.defaultQueryOptions(h),state:m,defaultOptions:c.getQueryDefaults(v),meta:h.meta}),this.add(E)),E},r.add=function(c){this.queriesMap[c.queryHash]||(this.queriesMap[c.queryHash]=c,this.queries.push(c),this.notify({type:"queryAdded",query:c}))},r.remove=function(c){var h=this.queriesMap[c.queryHash];h&&(c.destroy(),this.queries=this.queries.filter(function(m){return m!==c}),h===c&&delete this.queriesMap[c.queryHash],this.notify({type:"queryRemoved",query:c}))},r.clear=function(){var c=this;ei.batch(function(){c.queries.forEach(function(h){c.remove(h)})})},r.get=function(c){return this.queriesMap[c]},r.getAll=function(){return this.queries},r.find=function(c,h){var m=ll(c,h),a=m[0];return typeof a.exact=="undefined"&&(a.exact=!0),this.queries.find(function(v){return sT(a,v)})},r.findAll=function(c,h){var m=ll(c,h),a=m[0];return Object.keys(a).length>0?this.queries.filter(function(v){return sT(a,v)}):this.queries},r.notify=function(c){var h=this;ei.batch(function(){h.listeners.forEach(function(m){m(c)})})},r.onFocus=function(){var c=this;ei.batch(function(){c.queries.forEach(function(h){h.onFocus()})})},r.onOnline=function(){var c=this;ei.batch(function(){c.queries.forEach(function(h){h.onOnline()})})},n}(Bh),JR=function(){function e(r){this.options=On({},r.defaultOptions,r.options),this.mutationId=r.mutationId,this.mutationCache=r.mutationCache,this.observers=[],this.state=r.state||OS(),this.meta=r.meta}var n=e.prototype;return n.setState=function(s){this.dispatch({type:"setState",state:s})},n.addObserver=function(s){this.observers.indexOf(s)===-1&&this.observers.push(s)},n.removeObserver=function(s){this.observers=this.observers.filter(function(c){return c!==s})},n.cancel=function(){return this.retryer?(this.retryer.cancel(),this.retryer.promise.then(Si).catch(Si)):Promise.resolve()},n.continue=function(){return this.retryer?(this.retryer.continue(),this.retryer.promise):this.execute()},n.execute=function(){var s=this,c,h=this.state.status==="loading",m=Promise.resolve();return h||(this.dispatch({type:"loading",variables:this.options.variables}),m=m.then(function(){s.mutationCache.config.onMutate==null||s.mutationCache.config.onMutate(s.state.variables,s)}).then(function(){return s.options.onMutate==null?void 0:s.options.onMutate(s.state.variables)}).then(function(a){a!==s.state.context&&s.dispatch({type:"loading",context:a,variables:s.state.variables})})),m.then(function(){return s.executeMutation()}).then(function(a){c=a,s.mutationCache.config.onSuccess==null||s.mutationCache.config.onSuccess(c,s.state.variables,s.state.context,s)}).then(function(){return s.options.onSuccess==null?void 0:s.options.onSuccess(c,s.state.variables,s.state.context)}).then(function(){return s.options.onSettled==null?void 0:s.options.onSettled(c,null,s.state.variables,s.state.context)}).then(function(){return s.dispatch({type:"success",data:c}),c}).catch(function(a){return s.mutationCache.config.onError==null||s.mutationCache.config.onError(a,s.state.variables,s.state.context,s),a_().error(a),Promise.resolve().then(function(){return s.options.onError==null?void 0:s.options.onError(a,s.state.variables,s.state.context)}).then(function(){return s.options.onSettled==null?void 0:s.options.onSettled(void 0,a,s.state.variables,s.state.context)}).then(function(){throw s.dispatch({type:"error",error:a}),a})})},n.executeMutation=function(){var s=this,c;return this.retryer=new zS({fn:function(){return s.options.mutationFn?s.options.mutationFn(s.state.variables):Promise.reject("No mutationFn found")},onFail:function(){s.dispatch({type:"failed"})},onPause:function(){s.dispatch({type:"pause"})},onContinue:function(){s.dispatch({type:"continue"})},retry:(c=this.options.retry)!=null?c:0,retryDelay:this.options.retryDelay}),this.retryer.promise},n.dispatch=function(s){var c=this;this.state=ez(this.state,s),ei.batch(function(){c.observers.forEach(function(h){h.onMutationUpdate(s)}),c.mutationCache.notify(c)})},e}();function OS(){return{context:void 0,data:void 0,error:null,failureCount:0,isPaused:!1,status:"idle",variables:void 0}}function ez(e,n){switch(n.type){case"failed":return On({},e,{failureCount:e.failureCount+1});case"pause":return On({},e,{isPaused:!0});case"continue":return On({},e,{isPaused:!1});case"loading":return On({},e,{context:n.context,data:void 0,error:null,isPaused:!1,status:"loading",variables:n.variables});case"success":return On({},e,{data:n.data,error:null,status:"success",isPaused:!1});case"error":return On({},e,{data:void 0,error:n.error,failureCount:e.failureCount+1,isPaused:!1,status:"error"});case"setState":return On({},e,n.state);default:return e}}var tz=function(e){Fh(n,e);function n(s){var c;return c=e.call(this)||this,c.config=s||{},c.mutations=[],c.mutationId=0,c}var r=n.prototype;return r.build=function(c,h,m){var a=new JR({mutationCache:this,mutationId:++this.mutationId,options:c.defaultMutationOptions(h),state:m,defaultOptions:h.mutationKey?c.getMutationDefaults(h.mutationKey):void 0,meta:h.meta});return this.add(a),a},r.add=function(c){this.mutations.push(c),this.notify(c)},r.remove=function(c){this.mutations=this.mutations.filter(function(h){return h!==c}),c.cancel(),this.notify(c)},r.clear=function(){var c=this;ei.batch(function(){c.mutations.forEach(function(h){c.remove(h)})})},r.getAll=function(){return this.mutations},r.find=function(c){return typeof c.exact=="undefined"&&(c.exact=!0),this.mutations.find(function(h){return aT(c,h)})},r.findAll=function(c){return this.mutations.filter(function(h){return aT(c,h)})},r.notify=function(c){var h=this;ei.batch(function(){h.listeners.forEach(function(m){m(c)})})},r.onFocus=function(){this.resumePausedMutations()},r.onOnline=function(){this.resumePausedMutations()},r.resumePausedMutations=function(){var c=this.mutations.filter(function(h){return h.state.isPaused});return ei.batch(function(){return c.reduce(function(h,m){return h.then(function(){return m.continue().catch(Si)})},Promise.resolve())})},n}(Bh);function nz(){return{onFetch:function(n){n.fetchFn=function(){var r,s,c,h,m,a,v=(r=n.fetchOptions)==null||(s=r.meta)==null?void 0:s.refetchPage,w=(c=n.fetchOptions)==null||(h=c.meta)==null?void 0:h.fetchMore,E=w==null?void 0:w.pageParam,I=(w==null?void 0:w.direction)==="forward",M=(w==null?void 0:w.direction)==="backward",P=((m=n.state.data)==null?void 0:m.pages)||[],j=((a=n.state.data)==null?void 0:a.pageParams)||[],N=DS(),q=N==null?void 0:N.signal,V=j,ee=!1,oe=n.options.queryFn||function(){return Promise.reject("Missing queryFn")},pe=function(be,qe,Ke,_t){return V=_t?[qe].concat(V):[].concat(V,[qe]),_t?[Ke].concat(be):[].concat(be,[Ke])},se=function(be,qe,Ke,_t){if(ee)return Promise.reject("Cancelled");if(typeof Ke=="undefined"&&!qe&&be.length)return Promise.resolve(be);var It={queryKey:n.queryKey,signal:q,pageParam:Ke,meta:n.meta},Tt=oe(It),Dn=Promise.resolve(Tt).then(function(Zn){return pe(be,Ke,Zn,_t)});if(s_(Tt)){var Ot=Dn;Ot.cancel=Tt.cancel}return Dn},xe;if(!P.length)xe=se([]);else if(I){var Te=typeof E!="undefined",De=Te?E:uT(n.options,P);xe=se(P,Te,De)}else if(M){var Me=typeof E!="undefined",Be=Me?E:rz(n.options,P);xe=se(P,Me,Be,!0)}else(function(){V=[];var Je=typeof n.options.getNextPageParam=="undefined",be=v&&P[0]?v(P[0],0,P):!0;xe=be?se([],Je,j[0]):Promise.resolve(pe([],j[0],P[0]));for(var qe=function(It){xe=xe.then(function(Tt){var Dn=v&&P[It]?v(P[It],It,P):!0;if(Dn){var Ot=Je?j[It]:uT(n.options,Tt);return se(Tt,Je,Ot)}return Promise.resolve(pe(Tt,j[It],P[It]))})},Ke=1;Ke<P.length;Ke++)qe(Ke)})();var ze=xe.then(function(Je){return{pages:Je,pageParams:V}}),Fe=ze;return Fe.cancel=function(){ee=!0,N==null||N.abort(),s_(xe)&&xe.cancel()},ze}}}}function uT(e,n){return e.getNextPageParam==null?void 0:e.getNextPageParam(n[n.length-1],n)}function rz(e,n){return e.getPreviousPageParam==null?void 0:e.getPreviousPageParam(n[0],n)}var iz=function(){function e(r){r===void 0&&(r={}),this.queryCache=r.queryCache||new QR,this.mutationCache=r.mutationCache||new tz,this.defaultOptions=r.defaultOptions||{},this.queryDefaults=[],this.mutationDefaults=[]}var n=e.prototype;return n.mount=function(){var s=this;this.unsubscribeFocus=md.subscribe(function(){md.isFocused()&&Fm.isOnline()&&(s.mutationCache.onFocus(),s.queryCache.onFocus())}),this.unsubscribeOnline=Fm.subscribe(function(){md.isFocused()&&Fm.isOnline()&&(s.mutationCache.onOnline(),s.queryCache.onOnline())})},n.unmount=function(){var s,c;(s=this.unsubscribeFocus)==null||s.call(this),(c=this.unsubscribeOnline)==null||c.call(this)},n.isFetching=function(s,c){var h=ll(s,c),m=h[0];return m.fetching=!0,this.queryCache.findAll(m).length},n.isMutating=function(s){return this.mutationCache.findAll(On({},s,{fetching:!0})).length},n.getQueryData=function(s,c){var h;return(h=this.queryCache.find(s,c))==null?void 0:h.state.data},n.getQueriesData=function(s){return this.getQueryCache().findAll(s).map(function(c){var h=c.queryKey,m=c.state,a=m.data;return[h,a]})},n.setQueryData=function(s,c,h){var m=j0(s),a=this.defaultQueryOptions(m);return this.queryCache.build(this,a).setData(c,h)},n.setQueriesData=function(s,c,h){var m=this;return ei.batch(function(){return m.getQueryCache().findAll(s).map(function(a){var v=a.queryKey;return[v,m.setQueryData(v,c,h)]})})},n.getQueryState=function(s,c){var h;return(h=this.queryCache.find(s,c))==null?void 0:h.state},n.removeQueries=function(s,c){var h=ll(s,c),m=h[0],a=this.queryCache;ei.batch(function(){a.findAll(m).forEach(function(v){a.remove(v)})})},n.resetQueries=function(s,c,h){var m=this,a=ll(s,c,h),v=a[0],w=a[1],E=this.queryCache,I=On({},v,{active:!0});return ei.batch(function(){return E.findAll(v).forEach(function(M){M.reset()}),m.refetchQueries(I,w)})},n.cancelQueries=function(s,c,h){var m=this,a=ll(s,c,h),v=a[0],w=a[1],E=w===void 0?{}:w;typeof E.revert=="undefined"&&(E.revert=!0);var I=ei.batch(function(){return m.queryCache.findAll(v).map(function(M){return M.cancel(E)})});return Promise.all(I).then(Si).catch(Si)},n.invalidateQueries=function(s,c,h){var m,a,v,w=this,E=ll(s,c,h),I=E[0],M=E[1],P=On({},I,{active:(m=(a=I.refetchActive)!=null?a:I.active)!=null?m:!0,inactive:(v=I.refetchInactive)!=null?v:!1});return ei.batch(function(){return w.queryCache.findAll(I).forEach(function(j){j.invalidate()}),w.refetchQueries(P,M)})},n.refetchQueries=function(s,c,h){var m=this,a=ll(s,c,h),v=a[0],w=a[1],E=ei.batch(function(){return m.queryCache.findAll(v).map(function(M){return M.fetch(void 0,On({},w,{meta:{refetchPage:v==null?void 0:v.refetchPage}}))})}),I=Promise.all(E).then(Si);return(w==null?void 0:w.throwOnError)||(I=I.catch(Si)),I},n.fetchQuery=function(s,c,h){var m=j0(s,c,h),a=this.defaultQueryOptions(m);typeof a.retry=="undefined"&&(a.retry=!1);var v=this.queryCache.build(this,a);return v.isStaleByTime(a.staleTime)?v.fetch(a):Promise.resolve(v.state.data)},n.prefetchQuery=function(s,c,h){return this.fetchQuery(s,c,h).then(Si).catch(Si)},n.fetchInfiniteQuery=function(s,c,h){var m=j0(s,c,h);return m.behavior=nz(),this.fetchQuery(m)},n.prefetchInfiniteQuery=function(s,c,h){return this.fetchInfiniteQuery(s,c,h).then(Si).catch(Si)},n.cancelMutations=function(){var s=this,c=ei.batch(function(){return s.mutationCache.getAll().map(function(h){return h.cancel()})});return Promise.all(c).then(Si).catch(Si)},n.resumePausedMutations=function(){return this.getMutationCache().resumePausedMutations()},n.executeMutation=function(s){return this.mutationCache.build(this,s).execute()},n.getQueryCache=function(){return this.queryCache},n.getMutationCache=function(){return this.mutationCache},n.getDefaultOptions=function(){return this.defaultOptions},n.setDefaultOptions=function(s){this.defaultOptions=s},n.setQueryDefaults=function(s,c){var h=this.queryDefaults.find(function(m){return Ic(s)===Ic(m.queryKey)});h?h.defaultOptions=c:this.queryDefaults.push({queryKey:s,defaultOptions:c})},n.getQueryDefaults=function(s){var c;return s?(c=this.queryDefaults.find(function(h){return i_(s,h.queryKey)}))==null?void 0:c.defaultOptions:void 0},n.setMutationDefaults=function(s,c){var h=this.mutationDefaults.find(function(m){return Ic(s)===Ic(m.mutationKey)});h?h.defaultOptions=c:this.mutationDefaults.push({mutationKey:s,defaultOptions:c})},n.getMutationDefaults=function(s){var c;return s?(c=this.mutationDefaults.find(function(h){return i_(s,h.mutationKey)}))==null?void 0:c.defaultOptions:void 0},n.defaultQueryOptions=function(s){if(s==null?void 0:s._defaulted)return s;var c=On({},this.defaultOptions.queries,this.getQueryDefaults(s==null?void 0:s.queryKey),s,{_defaulted:!0});return!c.queryHash&&c.queryKey&&(c.queryHash=hx(c.queryKey,c)),c},n.defaultQueryObserverOptions=function(s){return this.defaultQueryOptions(s)},n.defaultMutationOptions=function(s){return(s==null?void 0:s._defaulted)?s:On({},this.defaultOptions.mutations,this.getMutationDefaults(s==null?void 0:s.mutationKey),s,{_defaulted:!0})},n.clear=function(){this.queryCache.clear(),this.mutationCache.clear()},e}(),oz=function(e){Fh(n,e);function n(s,c){var h;return h=e.call(this)||this,h.client=s,h.options=c,h.trackedProps=[],h.previousSelectError=null,h.bindMethods(),h.setOptions(c),h}var r=n.prototype;return r.bindMethods=function(){this.remove=this.remove.bind(this),this.refetch=this.refetch.bind(this)},r.onSubscribe=function(){this.listeners.length===1&&(this.currentQuery.addObserver(this),hT(this.currentQuery,this.options)&&this.executeFetch(),this.updateTimers())},r.onUnsubscribe=function(){this.listeners.length||this.destroy()},r.shouldFetchOnReconnect=function(){return lz(this.currentQuery,this.options)},r.shouldFetchOnWindowFocus=function(){return cz(this.currentQuery,this.options)},r.destroy=function(){this.listeners=[],this.clearTimers(),this.currentQuery.removeObserver(this)},r.setOptions=function(c,h){var m=this.options,a=this.currentQuery;if(this.options=this.client.defaultQueryObserverOptions(c),typeof this.options.enabled!="undefined"&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=m.queryKey),this.updateQuery();var v=this.hasListeners();v&&fT(this.currentQuery,a,this.options,m)&&this.executeFetch(),this.updateResult(h),v&&(this.currentQuery!==a||this.options.enabled!==m.enabled||this.options.staleTime!==m.staleTime)&&this.updateStaleTimeout();var w=this.computeRefetchInterval();v&&(this.currentQuery!==a||this.options.enabled!==m.enabled||w!==this.currentRefetchInterval)&&this.updateRefetchInterval(w)},r.getOptimisticResult=function(c){var h=this.client.defaultQueryObserverOptions(c),m=this.client.getQueryCache().build(this.client,h);return this.createResult(m,h)},r.getCurrentResult=function(){return this.currentResult},r.trackResult=function(c,h){var m=this,a={},v=function(E){m.trackedProps.includes(E)||m.trackedProps.push(E)};return Object.keys(c).forEach(function(w){Object.defineProperty(a,w,{configurable:!1,enumerable:!0,get:function(){return v(w),c[w]}})}),(h.useErrorBoundary||h.suspense)&&v("error"),a},r.getNextResult=function(c){var h=this;return new Promise(function(m,a){var v=h.subscribe(function(w){w.isFetching||(v(),w.isError&&(c==null?void 0:c.throwOnError)?a(w.error):m(w))})})},r.getCurrentQuery=function(){return this.currentQuery},r.remove=function(){this.client.getQueryCache().remove(this.currentQuery)},r.refetch=function(c){return this.fetch(On({},c,{meta:{refetchPage:c==null?void 0:c.refetchPage}}))},r.fetchOptimistic=function(c){var h=this,m=this.client.defaultQueryObserverOptions(c),a=this.client.getQueryCache().build(this.client,m);return a.fetch().then(function(){return h.createResult(a,m)})},r.fetch=function(c){var h=this;return this.executeFetch(c).then(function(){return h.updateResult(),h.currentResult})},r.executeFetch=function(c){this.updateQuery();var h=this.currentQuery.fetch(this.options,c);return(c==null?void 0:c.throwOnError)||(h=h.catch(Si)),h},r.updateStaleTimeout=function(){var c=this;if(this.clearStaleTimeout(),!(n_||this.currentResult.isStale||!Fy(this.options.staleTime))){var h=kS(this.currentResult.dataUpdatedAt,this.options.staleTime),m=h+1;this.staleTimeoutId=setTimeout(function(){c.currentResult.isStale||c.updateResult()},m)}},r.computeRefetchInterval=function(){var c;return typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.currentResult.data,this.currentQuery):(c=this.options.refetchInterval)!=null?c:!1},r.updateRefetchInterval=function(c){var h=this;this.clearRefetchInterval(),this.currentRefetchInterval=c,!(n_||this.options.enabled===!1||!Fy(this.currentRefetchInterval)||this.currentRefetchInterval===0)&&(this.refetchIntervalId=setInterval(function(){(h.options.refetchIntervalInBackground||md.isFocused())&&h.executeFetch()},this.currentRefetchInterval))},r.updateTimers=function(){this.updateStaleTimeout(),this.updateRefetchInterval(this.computeRefetchInterval())},r.clearTimers=function(){this.clearStaleTimeout(),this.clearRefetchInterval()},r.clearStaleTimeout=function(){clearTimeout(this.staleTimeoutId),this.staleTimeoutId=void 0},r.clearRefetchInterval=function(){clearInterval(this.refetchIntervalId),this.refetchIntervalId=void 0},r.createResult=function(c,h){var m=this.currentQuery,a=this.options,v=this.currentResult,w=this.currentResultState,E=this.currentResultOptions,I=c!==m,M=I?c.state:this.currentQueryInitialState,P=I?this.currentResult:this.previousQueryResult,j=c.state,N=j.dataUpdatedAt,q=j.error,V=j.errorUpdatedAt,ee=j.isFetching,oe=j.status,pe=!1,se=!1,xe;if(h.optimisticResults){var Te=this.hasListeners(),De=!Te&&hT(c,h),Me=Te&&fT(c,m,h,a);(De||Me)&&(ee=!0,N||(oe="loading"))}if(h.keepPreviousData&&!j.dataUpdateCount&&(P==null?void 0:P.isSuccess)&&oe!=="error")xe=P.data,N=P.dataUpdatedAt,oe=P.status,pe=!0;else if(h.select&&typeof j.data!="undefined"){var Be;if(v&&j.data===(w==null?void 0:w.data)&&h.select===((Be=this.previousSelect)==null?void 0:Be.fn)&&!this.previousSelectError)xe=this.previousSelect.result;else try{xe=h.select(j.data),h.structuralSharing!==!1&&(xe=o_(v==null?void 0:v.data,xe)),this.previousSelect={fn:h.select,result:xe},this.previousSelectError=null}catch(Je){a_().error(Je),q=Je,this.previousSelectError=Je,V=Date.now(),oe="error"}}else xe=j.data;if(typeof h.placeholderData!="undefined"&&typeof xe=="undefined"&&(oe==="loading"||oe==="idle")){var ze;if((v==null?void 0:v.isPlaceholderData)&&h.placeholderData===(E==null?void 0:E.placeholderData))ze=v.data;else if(ze=typeof h.placeholderData=="function"?h.placeholderData():h.placeholderData,h.select&&typeof ze!="undefined")try{ze=h.select(ze),h.structuralSharing!==!1&&(ze=o_(v==null?void 0:v.data,ze)),this.previousSelectError=null}catch(Je){a_().error(Je),q=Je,this.previousSelectError=Je,V=Date.now(),oe="error"}typeof ze!="undefined"&&(oe="success",xe=ze,se=!0)}var Fe={status:oe,isLoading:oe==="loading",isSuccess:oe==="success",isError:oe==="error",isIdle:oe==="idle",data:xe,dataUpdatedAt:N,error:q,errorUpdatedAt:V,failureCount:j.fetchFailureCount,isFetched:j.dataUpdateCount>0||j.errorUpdateCount>0,isFetchedAfterMount:j.dataUpdateCount>M.dataUpdateCount||j.errorUpdateCount>M.errorUpdateCount,isFetching:ee,isRefetching:ee&&oe!=="loading",isLoadingError:oe==="error"&&j.dataUpdatedAt===0,isPlaceholderData:se,isPreviousData:pe,isRefetchError:oe==="error"&&j.dataUpdatedAt!==0,isStale:Vd(c,h),refetch:this.refetch,remove:this.remove};return Fe},r.shouldNotifyListeners=function(c,h){if(!h)return!0;var m=this.options,a=m.notifyOnChangeProps,v=m.notifyOnChangePropsExclusions;if(!a&&!v||a==="tracked"&&!this.trackedProps.length)return!0;var w=a==="tracked"?this.trackedProps:a;return Object.keys(c).some(function(E){var I=E,M=c[I]!==h[I],P=w==null?void 0:w.some(function(N){return N===E}),j=v==null?void 0:v.some(function(N){return N===E});return M&&!j&&(!w||P)})},r.updateResult=function(c){var h=this.currentResult;if(this.currentResult=this.createResult(this.currentQuery,this.options),this.currentResultState=this.currentQuery.state,this.currentResultOptions=this.options,!GR(this.currentResult,h)){var m={cache:!0};(c==null?void 0:c.listeners)!==!1&&this.shouldNotifyListeners(this.currentResult,h)&&(m.listeners=!0),this.notify(On({},m,c))}},r.updateQuery=function(){var c=this.client.getQueryCache().build(this.client,this.options);if(c!==this.currentQuery){var h=this.currentQuery;this.currentQuery=c,this.currentQueryInitialState=c.state,this.previousQueryResult=this.currentResult,this.hasListeners()&&(h==null||h.removeObserver(this),c.addObserver(this))}},r.onQueryUpdate=function(c){var h={};c.type==="success"?h.onSuccess=!0:c.type==="error"&&!Bm(c.error)&&(h.onError=!0),this.updateResult(h),this.hasListeners()&&this.updateTimers()},r.notify=function(c){var h=this;ei.batch(function(){c.onSuccess?(h.options.onSuccess==null||h.options.onSuccess(h.currentResult.data),h.options.onSettled==null||h.options.onSettled(h.currentResult.data,null)):c.onError&&(h.options.onError==null||h.options.onError(h.currentResult.error),h.options.onSettled==null||h.options.onSettled(void 0,h.currentResult.error)),c.listeners&&h.listeners.forEach(function(m){m(h.currentResult)}),c.cache&&h.client.getQueryCache().notify({query:h.currentQuery,type:"observerResultsUpdated"})})},n}(Bh);function sz(e,n){return n.enabled!==!1&&!e.state.dataUpdatedAt&&!(e.state.status==="error"&&n.retryOnMount===!1)}function az(e,n){return n.enabled!==!1&&e.state.dataUpdatedAt>0&&(n.refetchOnMount==="always"||n.refetchOnMount!==!1&&Vd(e,n))}function hT(e,n){return sz(e,n)||az(e,n)}function lz(e,n){return n.enabled!==!1&&(n.refetchOnReconnect==="always"||n.refetchOnReconnect!==!1&&Vd(e,n))}function cz(e,n){return n.enabled!==!1&&(n.refetchOnWindowFocus==="always"||n.refetchOnWindowFocus!==!1&&Vd(e,n))}function fT(e,n,r,s){return r.enabled!==!1&&(e!==n||s.enabled===!1)&&(!r.suspense||e.state.status!=="error")&&Vd(e,r)}function Vd(e,n){return e.isStaleByTime(n.staleTime)}var uz=function(e){Fh(n,e);function n(s,c){var h;return h=e.call(this)||this,h.client=s,h.setOptions(c),h.bindMethods(),h.updateResult(),h}var r=n.prototype;return r.bindMethods=function(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)},r.setOptions=function(c){this.options=this.client.defaultMutationOptions(c)},r.onUnsubscribe=function(){if(!this.listeners.length){var c;(c=this.currentMutation)==null||c.removeObserver(this)}},r.onMutationUpdate=function(c){this.updateResult();var h={listeners:!0};c.type==="success"?h.onSuccess=!0:c.type==="error"&&(h.onError=!0),this.notify(h)},r.getCurrentResult=function(){return this.currentResult},r.reset=function(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})},r.mutate=function(c,h){return this.mutateOptions=h,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,On({},this.options,{variables:typeof c!="undefined"?c:this.options.variables})),this.currentMutation.addObserver(this),this.currentMutation.execute()},r.updateResult=function(){var c=this.currentMutation?this.currentMutation.state:OS(),h=On({},c,{isLoading:c.status==="loading",isSuccess:c.status==="success",isError:c.status==="error",isIdle:c.status==="idle",mutate:this.mutate,reset:this.reset});this.currentResult=h},r.notify=function(c){var h=this;ei.batch(function(){h.mutateOptions&&(c.onSuccess?(h.mutateOptions.onSuccess==null||h.mutateOptions.onSuccess(h.currentResult.data,h.currentResult.variables,h.currentResult.context),h.mutateOptions.onSettled==null||h.mutateOptions.onSettled(h.currentResult.data,null,h.currentResult.variables,h.currentResult.context)):c.onError&&(h.mutateOptions.onError==null||h.mutateOptions.onError(h.currentResult.error,h.currentResult.variables,h.currentResult.context),h.mutateOptions.onSettled==null||h.mutateOptions.onSettled(void 0,h.currentResult.error,h.currentResult.variables,h.currentResult.context))),c.listeners&&h.listeners.forEach(function(m){m(h.currentResult)})})},n}(Bh);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ns=function(){return Ns=Object.assign||function(n){for(var r,s=1,c=arguments.length;s<c;s++){r=arguments[s];for(var h in r)Object.prototype.hasOwnProperty.call(r,h)&&(n[h]=r[h])}return n},Ns.apply(this,arguments)},hz="VUE_QUERY_CLIENT";function Uy(e){var n=e?":".concat(e):"";return"".concat(hz).concat(n)}function LS(e){return typeof e=="string"||Array.isArray(e)}function fz(e,n,r){return n===void 0&&(n={}),r===void 0&&(r={}),LS(e)?typeof n=="function"?Object.assign(r,{mutationKey:e,mutationFn:n}):Object.assign(n,{mutationKey:e}):typeof e=="function"?Object.assign(n,{mutationFn:e}):e}function FS(e,n){Object.keys(e).forEach(function(r){e[r]=n[r]})}function Ny(e,n){if(n){var r=n(e);if(r!==void 0)return r}if(Array.isArray(e))return e.map(function(c){return Ny(c,n)});if(typeof e=="object"&&dz(e)){var s=Object.entries(e).map(function(c){var h=c[0],m=c[1];return[h,Ny(m,n)]});return Object.fromEntries(s)}return e}function BS(e){return Ny(e,function(n){if(Ar(n))return BS(qo(n))})}function dz(e){if(Object.prototype.toString.call(e)!=="[object Object]")return!1;var n=Object.getPrototypeOf(e);return n===null||n===Object.prototype}function US(e){var n;e===void 0&&(e="");var r=(n=Cl())===null||n===void 0?void 0:n.proxy;if(!r)throw new Error("vue-query hooks can only be used inside setup() function.");var s=Uy(e),c=kn(s);if(!c)throw new Error("No 'queryClient' found in Vue context, use 'VueQueryPlugin' to properly initialize the library.");return c}var z8={install:function(e,n){var r;n===void 0&&(n={});var s=Uy(n.queryClientKey),c;if("queryClient"in n&&n.queryClient)c=n.queryClient;else{var h="queryClientConfig"in n?n.queryClientConfig:void 0;c=new iz(h)}c.mount();var m=function(){var v;c.unmount(),(v=n.additionalClients)===null||v===void 0||v.forEach(function(w){w.queryClient.unmount()})};if(e.onUnmount)e.onUnmount(m);else{var a=e.unmount;e.unmount=function(){m(),a()}}e.provide(s,c),(r=n.additionalClients)===null||r===void 0||r.forEach(function(v){var w=Uy(v.queryClientKey);e.provide(w,v.queryClient),v.queryClient.mount()})}};function pz(e,n,r,s){r===void 0&&(r={}),s===void 0&&(s={});var c=E(),h=US(c.queryClientKey),m=h.defaultQueryObserverOptions(c),a=new e(h,m),v=Al(a.getCurrentResult()),w=a.subscribe(function(I){FS(v,I)});return gi([function(){return n},function(){return r},function(){return s}],function(){a.setOptions(h.defaultQueryObserverOptions(E()))},{deep:!0}),Cr(function(){w()}),Ns(Ns({},DE(N_(v))),{suspense:function(){return a.fetchOptimistic(m)}});function E(){var I;return LS(n)?typeof r=="function"?I=Ns(Ns({},s),{queryKey:n,queryFn:r}):I=Ns(Ns({},r),{queryKey:n}):I=n,BS(I)}}function O8(e,n,r){return pz(oz,e,n,r)}function L8(e,n,r){var s=fz(e,n,r),c=US(s.queryClientKey),h=new uz(c,s),m=Al(h.getCurrentResult()),a=h.subscribe(function(){FS(m,h.getCurrentResult())}),v=function(E,I){h.mutate(E,I).catch(function(){})};dr(function(){h.setOptions(s)}),Cr(function(){a()});var w=DE(N_(m));return Ns(Ns({},w),{mutate:v,mutateAsync:m.mutate})}/*!
  * vue-router v4.0.12
  * (c) 2021 Eduardo San Martin Morote
  * @license MIT
  */const NS=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",Uh=e=>NS?Symbol(e):"_vr_"+e,jS=Uh("rvlm"),dT=Uh("rvd"),X_=Uh("r"),fx=Uh("rl"),jy=Uh("rvl"),nh=typeof window!="undefined";function mz(e){return e.__esModule||NS&&e[Symbol.toStringTag]==="Module"}const rr=Object.assign;function $0(e,n){const r={};for(const s in n){const c=n[s];r[s]=Array.isArray(c)?c.map(e):e(c)}return r}const _d=()=>{},_z=/\/$/,gz=e=>e.replace(_z,"");function V0(e,n,r="/"){let s,c={},h="",m="";const a=n.indexOf("?"),v=n.indexOf("#",a>-1?a:0);return a>-1&&(s=n.slice(0,a),h=n.slice(a+1,v>-1?v:n.length),c=e(h)),v>-1&&(s=s||n.slice(0,v),m=n.slice(v,n.length)),s=bz(s!=null?s:n,r),{fullPath:s+(h&&"?")+h+m,path:s,query:c,hash:m}}function yz(e,n){const r=n.query?e(n.query):"";return n.path+(r&&"?")+r+(n.hash||"")}function pT(e,n){return!n||!e.toLowerCase().startsWith(n.toLowerCase())?e:e.slice(n.length)||"/"}function vz(e,n,r){const s=n.matched.length-1,c=r.matched.length-1;return s>-1&&s===c&&xh(n.matched[s],r.matched[c])&&$S(n.params,r.params)&&e(n.query)===e(r.query)&&n.hash===r.hash}function xh(e,n){return(e.aliasOf||e)===(n.aliasOf||n)}function $S(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(!xz(e[r],n[r]))return!1;return!0}function xz(e,n){return Array.isArray(e)?mT(e,n):Array.isArray(n)?mT(n,e):e===n}function mT(e,n){return Array.isArray(n)?e.length===n.length&&e.every((r,s)=>r===n[s]):e.length===1&&e[0]===n}function bz(e,n){if(e.startsWith("/"))return e;if(!e)return n;const r=n.split("/"),s=e.split("/");let c=r.length-1,h,m;for(h=0;h<s.length;h++)if(m=s[h],!(c===1||m==="."))if(m==="..")c--;else break;return r.slice(0,c).join("/")+"/"+s.slice(h-(h===s.length?1:0)).join("/")}var bh;(function(e){e.pop="pop",e.push="push"})(bh||(bh={}));var Rc;(function(e){e.back="back",e.forward="forward",e.unknown=""})(Rc||(Rc={}));const G0="";function VS(e){if(!e)if(nh){const n=document.querySelector("base");e=n&&n.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),gz(e)}const wz=/^[^#]+#/;function GS(e,n){return e.replace(wz,"#")+n}function Tz(e,n){const r=document.documentElement.getBoundingClientRect(),s=e.getBoundingClientRect();return{behavior:n.behavior,left:s.left-r.left-(n.left||0),top:s.top-r.top-(n.top||0)}}const K_=()=>({left:window.pageXOffset,top:window.pageYOffset});function Ez(e){let n;if("el"in e){const r=e.el,s=typeof r=="string"&&r.startsWith("#"),c=typeof r=="string"?s?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!c)return;n=Tz(c,e)}else n=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(n):window.scrollTo(n.left!=null?n.left:window.pageXOffset,n.top!=null?n.top:window.pageYOffset)}function _T(e,n){return(history.state?history.state.position-n:-1)+e}const $y=new Map;function Sz(e,n){$y.set(e,n)}function Az(e){const n=$y.get(e);return $y.delete(e),n}let Cz=()=>location.protocol+"//"+location.host;function qS(e,n){const{pathname:r,search:s,hash:c}=n,h=e.indexOf("#");if(h>-1){let a=c.includes(e.slice(h))?e.slice(h).length:1,v=c.slice(a);return v[0]!=="/"&&(v="/"+v),pT(v,"")}return pT(r,e)+s+c}function Iz(e,n,r,s){let c=[],h=[],m=null;const a=({state:M})=>{const P=qS(e,location),j=r.value,N=n.value;let q=0;if(M){if(r.value=P,n.value=M,m&&m===j){m=null;return}q=N?M.position-N.position:0}else s(P);c.forEach(V=>{V(r.value,j,{delta:q,type:bh.pop,direction:q?q>0?Rc.forward:Rc.back:Rc.unknown})})};function v(){m=r.value}function w(M){c.push(M);const P=()=>{const j=c.indexOf(M);j>-1&&c.splice(j,1)};return h.push(P),P}function E(){const{history:M}=window;!M.state||M.replaceState(rr({},M.state,{scroll:K_()}),"")}function I(){for(const M of h)M();h=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",E)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",E),{pauseListeners:v,listen:w,destroy:I}}function gT(e,n,r,s=!1,c=!1){return{back:e,current:n,forward:r,replaced:s,position:window.history.length,scroll:c?K_():null}}function Mz(e){const{history:n,location:r}=window,s={value:qS(e,r)},c={value:n.state};c.value||h(s.value,{back:null,current:s.value,forward:null,position:n.length-1,replaced:!0,scroll:null},!0);function h(v,w,E){const I=e.indexOf("#"),M=I>-1?(r.host&&document.querySelector("base")?e:e.slice(I))+v:Cz()+e+v;try{n[E?"replaceState":"pushState"](w,"",M),c.value=w}catch(P){console.error(P),r[E?"replace":"assign"](M)}}function m(v,w){const E=rr({},n.state,gT(c.value.back,v,c.value.forward,!0),w,{position:c.value.position});h(v,E,!0),s.value=v}function a(v,w){const E=rr({},c.value,n.state,{forward:v,scroll:K_()});h(E.current,E,!0);const I=rr({},gT(s.value,v,null),{position:E.position+1},w);h(v,I,!1),s.value=v}return{location:s,state:c,push:a,replace:m}}function kz(e){e=VS(e);const n=Mz(e),r=Iz(e,n.state,n.location,n.replace);function s(h,m=!0){m||r.pauseListeners(),history.go(h)}const c=rr({location:"",base:e,go:s,createHref:GS.bind(null,e)},n,r);return Object.defineProperty(c,"location",{enumerable:!0,get:()=>n.location.value}),Object.defineProperty(c,"state",{enumerable:!0,get:()=>n.state.value}),c}function Pz(e=""){let n=[],r=[G0],s=0;e=VS(e);function c(a){s++,s===r.length||r.splice(s),r.push(a)}function h(a,v,{direction:w,delta:E}){const I={direction:w,delta:E,type:bh.pop};for(const M of n)M(a,v,I)}const m={location:G0,state:{},base:e,createHref:GS.bind(null,e),replace(a){r.splice(s--,1),c(a)},push(a,v){c(a)},listen(a){return n.push(a),()=>{const v=n.indexOf(a);v>-1&&n.splice(v,1)}},destroy(){n=[],r=[G0],s=0},go(a,v=!0){const w=this.location,E=a<0?Rc.back:Rc.forward;s=Math.max(0,Math.min(s+a,r.length-1)),v&&h(this.location,w,{direction:E,delta:a})}};return Object.defineProperty(m,"location",{enumerable:!0,get:()=>r[s]}),m}function Dz(e){return typeof e=="string"||e&&typeof e=="object"}function ZS(e){return typeof e=="string"||typeof e=="symbol"}const tl={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},WS=Uh("nf");var yT;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(yT||(yT={}));function wh(e,n){return rr(new Error,{type:e,[WS]:!0},n)}function mc(e,n){return e instanceof Error&&WS in e&&(n==null||!!(e.type&n))}const vT="[^/]+?",Rz={sensitive:!1,strict:!1,start:!0,end:!0},zz=/[.+*?^${}()[\]/\\]/g;function Oz(e,n){const r=rr({},Rz,n),s=[];let c=r.start?"^":"";const h=[];for(const w of e){const E=w.length?[]:[90];r.strict&&!w.length&&(c+="/");for(let I=0;I<w.length;I++){const M=w[I];let P=40+(r.sensitive?.25:0);if(M.type===0)I||(c+="/"),c+=M.value.replace(zz,"\\$&"),P+=40;else if(M.type===1){const{value:j,repeatable:N,optional:q,regexp:V}=M;h.push({name:j,repeatable:N,optional:q});const ee=V||vT;if(ee!==vT){P+=10;try{new RegExp(`(${ee})`)}catch(pe){throw new Error(`Invalid custom RegExp for param "${j}" (${ee}): `+pe.message)}}let oe=N?`((?:${ee})(?:/(?:${ee}))*)`:`(${ee})`;I||(oe=q&&w.length<2?`(?:/${oe})`:"/"+oe),q&&(oe+="?"),c+=oe,P+=20,q&&(P+=-8),N&&(P+=-20),ee===".*"&&(P+=-50)}E.push(P)}s.push(E)}if(r.strict&&r.end){const w=s.length-1;s[w][s[w].length-1]+=.7000000000000001}r.strict||(c+="/?"),r.end?c+="$":r.strict&&(c+="(?:/|$)");const m=new RegExp(c,r.sensitive?"":"i");function a(w){const E=w.match(m),I={};if(!E)return null;for(let M=1;M<E.length;M++){const P=E[M]||"",j=h[M-1];I[j.name]=P&&j.repeatable?P.split("/"):P}return I}function v(w){let E="",I=!1;for(const M of e){(!I||!E.endsWith("/"))&&(E+="/"),I=!1;for(const P of M)if(P.type===0)E+=P.value;else if(P.type===1){const{value:j,repeatable:N,optional:q}=P,V=j in w?w[j]:"";if(Array.isArray(V)&&!N)throw new Error(`Provided param "${j}" is an array but it is not repeatable (* or + modifiers)`);const ee=Array.isArray(V)?V.join("/"):V;if(!ee)if(q)M.length<2&&(E.endsWith("/")?E=E.slice(0,-1):I=!0);else throw new Error(`Missing required param "${j}"`);E+=ee}}return E}return{re:m,score:s,keys:h,parse:a,stringify:v}}function Lz(e,n){let r=0;for(;r<e.length&&r<n.length;){const s=n[r]-e[r];if(s)return s;r++}return e.length<n.length?e.length===1&&e[0]===40+40?-1:1:e.length>n.length?n.length===1&&n[0]===40+40?1:-1:0}function Fz(e,n){let r=0;const s=e.score,c=n.score;for(;r<s.length&&r<c.length;){const h=Lz(s[r],c[r]);if(h)return h;r++}return c.length-s.length}const Bz={type:0,value:""},Uz=/[a-zA-Z0-9_]/;function Nz(e){if(!e)return[[]];if(e==="/")return[[Bz]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function n(P){throw new Error(`ERR (${r})/"${w}": ${P}`)}let r=0,s=r;const c=[];let h;function m(){h&&c.push(h),h=[]}let a=0,v,w="",E="";function I(){!w||(r===0?h.push({type:0,value:w}):r===1||r===2||r===3?(h.length>1&&(v==="*"||v==="+")&&n(`A repeatable param (${w}) must be alone in its segment. eg: '/:ids+.`),h.push({type:1,value:w,regexp:E,repeatable:v==="*"||v==="+",optional:v==="*"||v==="?"})):n("Invalid state to consume buffer"),w="")}function M(){w+=v}for(;a<e.length;){if(v=e[a++],v==="\\"&&r!==2){s=r,r=4;continue}switch(r){case 0:v==="/"?(w&&I(),m()):v===":"?(I(),r=1):M();break;case 4:M(),r=s;break;case 1:v==="("?r=2:Uz.test(v)?M():(I(),r=0,v!=="*"&&v!=="?"&&v!=="+"&&a--);break;case 2:v===")"?E[E.length-1]=="\\"?E=E.slice(0,-1)+v:r=3:E+=v;break;case 3:I(),r=0,v!=="*"&&v!=="?"&&v!=="+"&&a--,E="";break;default:n("Unknown state");break}}return r===2&&n(`Unfinished custom RegExp for param "${w}"`),I(),m(),c}function jz(e,n,r){const s=Oz(Nz(e.path),r),c=rr(s,{record:e,parent:n,children:[],alias:[]});return n&&!c.record.aliasOf==!n.record.aliasOf&&n.children.push(c),c}function $z(e,n){const r=[],s=new Map;n=bT({strict:!1,end:!0,sensitive:!1},n);function c(E){return s.get(E)}function h(E,I,M){const P=!M,j=Gz(E);j.aliasOf=M&&M.record;const N=bT(n,E),q=[j];if("alias"in E){const oe=typeof E.alias=="string"?[E.alias]:E.alias;for(const pe of oe)q.push(rr({},j,{components:M?M.record.components:j.components,path:pe,aliasOf:M?M.record:j}))}let V,ee;for(const oe of q){const{path:pe}=oe;if(I&&pe[0]!=="/"){const se=I.record.path,xe=se[se.length-1]==="/"?"":"/";oe.path=I.record.path+(pe&&xe+pe)}if(V=jz(oe,I,N),M?M.alias.push(V):(ee=ee||V,ee!==V&&ee.alias.push(V),P&&E.name&&!xT(V)&&m(E.name)),"children"in j){const se=j.children;for(let xe=0;xe<se.length;xe++)h(se[xe],V,M&&M.children[xe])}M=M||V,v(V)}return ee?()=>{m(ee)}:_d}function m(E){if(ZS(E)){const I=s.get(E);I&&(s.delete(E),r.splice(r.indexOf(I),1),I.children.forEach(m),I.alias.forEach(m))}else{const I=r.indexOf(E);I>-1&&(r.splice(I,1),E.record.name&&s.delete(E.record.name),E.children.forEach(m),E.alias.forEach(m))}}function a(){return r}function v(E){let I=0;for(;I<r.length&&Fz(E,r[I])>=0;)I++;r.splice(I,0,E),E.record.name&&!xT(E)&&s.set(E.record.name,E)}function w(E,I){let M,P={},j,N;if("name"in E&&E.name){if(M=s.get(E.name),!M)throw wh(1,{location:E});N=M.record.name,P=rr(Vz(I.params,M.keys.filter(ee=>!ee.optional).map(ee=>ee.name)),E.params),j=M.stringify(P)}else if("path"in E)j=E.path,M=r.find(ee=>ee.re.test(j)),M&&(P=M.parse(j),N=M.record.name);else{if(M=I.name?s.get(I.name):r.find(ee=>ee.re.test(I.path)),!M)throw wh(1,{location:E,currentLocation:I});N=M.record.name,P=rr({},I.params,E.params),j=M.stringify(P)}const q=[];let V=M;for(;V;)q.unshift(V.record),V=V.parent;return{name:N,path:j,params:P,matched:q,meta:Zz(q)}}return e.forEach(E=>h(E)),{addRoute:h,resolve:w,removeRoute:m,getRoutes:a,getRecordMatcher:c}}function Vz(e,n){const r={};for(const s of n)s in e&&(r[s]=e[s]);return r}function Gz(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:qz(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||{}:{default:e.component}}}function qz(e){const n={},r=e.props||!1;if("component"in e)n.default=r;else for(const s in e.components)n[s]=typeof r=="boolean"?r:r[s];return n}function xT(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function Zz(e){return e.reduce((n,r)=>rr(n,r.meta),{})}function bT(e,n){const r={};for(const s in e)r[s]=s in n?n[s]:e[s];return r}const HS=/#/g,Wz=/&/g,Hz=/\//g,Xz=/=/g,Kz=/\?/g,XS=/\+/g,Yz=/%5B/g,Qz=/%5D/g,KS=/%5E/g,Jz=/%60/g,YS=/%7B/g,e5=/%7C/g,QS=/%7D/g,t5=/%20/g;function dx(e){return encodeURI(""+e).replace(e5,"|").replace(Yz,"[").replace(Qz,"]")}function n5(e){return dx(e).replace(YS,"{").replace(QS,"}").replace(KS,"^")}function Vy(e){return dx(e).replace(XS,"%2B").replace(t5,"+").replace(HS,"%23").replace(Wz,"%26").replace(Jz,"`").replace(YS,"{").replace(QS,"}").replace(KS,"^")}function r5(e){return Vy(e).replace(Xz,"%3D")}function i5(e){return dx(e).replace(HS,"%23").replace(Kz,"%3F")}function o5(e){return e==null?"":i5(e).replace(Hz,"%2F")}function l_(e){try{return decodeURIComponent(""+e)}catch{}return""+e}function s5(e){const n={};if(e===""||e==="?")return n;const s=(e[0]==="?"?e.slice(1):e).split("&");for(let c=0;c<s.length;++c){const h=s[c].replace(XS," "),m=h.indexOf("="),a=l_(m<0?h:h.slice(0,m)),v=m<0?null:l_(h.slice(m+1));if(a in n){let w=n[a];Array.isArray(w)||(w=n[a]=[w]),w.push(v)}else n[a]=v}return n}function wT(e){let n="";for(let r in e){const s=e[r];if(r=r5(r),s==null){s!==void 0&&(n+=(n.length?"&":"")+r);continue}(Array.isArray(s)?s.map(h=>h&&Vy(h)):[s&&Vy(s)]).forEach(h=>{h!==void 0&&(n+=(n.length?"&":"")+r,h!=null&&(n+="="+h))})}return n}function a5(e){const n={};for(const r in e){const s=e[r];s!==void 0&&(n[r]=Array.isArray(s)?s.map(c=>c==null?null:""+c):s==null?s:""+s)}return n}function qf(){let e=[];function n(s){return e.push(s),()=>{const c=e.indexOf(s);c>-1&&e.splice(c,1)}}function r(){e=[]}return{add:n,list:()=>e,reset:r}}function l5(e,n,r){const s=()=>{e[n].delete(r)};Cr(s),ZE(s),qE(()=>{e[n].add(r)}),e[n].add(r)}function F8(e){const n=kn(jS,{}).value;!n||l5(n,"leaveGuards",e)}function cl(e,n,r,s,c){const h=s&&(s.enterCallbacks[c]=s.enterCallbacks[c]||[]);return()=>new Promise((m,a)=>{const v=I=>{I===!1?a(wh(4,{from:r,to:n})):I instanceof Error?a(I):Dz(I)?a(wh(2,{from:n,to:I})):(h&&s.enterCallbacks[c]===h&&typeof I=="function"&&h.push(I),m())},w=e.call(s&&s.instances[c],n,r,v);let E=Promise.resolve(w);e.length<3&&(E=E.then(v)),E.catch(I=>a(I))})}function q0(e,n,r,s){const c=[];for(const h of e)for(const m in h.components){let a=h.components[m];if(!(n!=="beforeRouteEnter"&&!h.instances[m]))if(c5(a)){const w=(a.__vccOpts||a)[n];w&&c.push(cl(w,r,s,h,m))}else{let v=a();c.push(()=>v.then(w=>{if(!w)return Promise.reject(new Error(`Couldn't resolve component "${m}" at "${h.path}"`));const E=mz(w)?w.default:w;h.components[m]=E;const M=(E.__vccOpts||E)[n];return M&&cl(M,r,s,h,m)()}))}}return c}function c5(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function TT(e){const n=kn(X_),r=kn(fx),s=Et(()=>n.resolve(qo(e.to))),c=Et(()=>{const{matched:v}=s.value,{length:w}=v,E=v[w-1],I=r.matched;if(!E||!I.length)return-1;const M=I.findIndex(xh.bind(null,E));if(M>-1)return M;const P=ET(v[w-2]);return w>1&&ET(E)===P&&I[I.length-1].path!==P?I.findIndex(xh.bind(null,v[w-2])):M}),h=Et(()=>c.value>-1&&d5(r.params,s.value.params)),m=Et(()=>c.value>-1&&c.value===r.matched.length-1&&$S(r.params,s.value.params));function a(v={}){return f5(v)?n[qo(e.replace)?"replace":"push"](qo(e.to)).catch(_d):Promise.resolve()}return{route:s,href:Et(()=>s.value.href),isActive:h,isExactActive:m,navigate:a}}const u5=Yt({name:"RouterLink",props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:TT,setup(e,{slots:n}){const r=Al(TT(e)),{options:s}=kn(X_),c=Et(()=>({[ST(e.activeClass,s.linkActiveClass,"router-link-active")]:r.isActive,[ST(e.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const h=n.default&&n.default(r);return e.custom?h:yo("a",{"aria-current":r.isExactActive?e.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:c.value},h)}}}),h5=u5;function f5(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const n=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(n))return}return e.preventDefault&&e.preventDefault(),!0}}function d5(e,n){for(const r in n){const s=n[r],c=e[r];if(typeof s=="string"){if(s!==c)return!1}else if(!Array.isArray(c)||c.length!==s.length||s.some((h,m)=>h!==c[m]))return!1}return!0}function ET(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const ST=(e,n,r)=>e!=null?e:n!=null?n:r,p5=Yt({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},setup(e,{attrs:n,slots:r}){const s=kn(jy),c=Et(()=>e.route||s.value),h=kn(dT,0),m=Et(()=>c.value.matched[h]);fr(dT,h+1),fr(jS,m),fr(jy,c);const a=ft();return gi(()=>[a.value,m.value,e.name],([v,w,E],[I,M,P])=>{w&&(w.instances[E]=v,M&&M!==w&&v&&v===I&&(w.leaveGuards.size||(w.leaveGuards=M.leaveGuards),w.updateGuards.size||(w.updateGuards=M.updateGuards))),v&&w&&(!M||!xh(w,M)||!I)&&(w.enterCallbacks[E]||[]).forEach(j=>j(v))},{flush:"post"}),()=>{const v=c.value,w=m.value,E=w&&w.components[e.name],I=e.name;if(!E)return AT(r.default,{Component:E,route:v});const M=w.props[e.name],P=M?M===!0?v.params:typeof M=="function"?M(v):M:null,N=yo(E,rr({},P,n,{onVnodeUnmounted:q=>{q.component.isUnmounted&&(w.instances[I]=null)},ref:a}));return AT(r.default,{Component:N,route:v})||N}}});function AT(e,n){if(!e)return null;const r=e(n);return r.length===1?r[0]:r}const m5=p5;function _5(e){const n=$z(e.routes,e),r=e.parseQuery||s5,s=e.stringifyQuery||wT,c=e.history,h=qf(),m=qf(),a=qf(),v=ME(tl);let w=tl;nh&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const E=$0.bind(null,it=>""+it),I=$0.bind(null,o5),M=$0.bind(null,l_);function P(it,Dt){let yt,Lt;return ZS(it)?(yt=n.getRecordMatcher(it),Lt=Dt):Lt=it,n.addRoute(Lt,yt)}function j(it){const Dt=n.getRecordMatcher(it);Dt&&n.removeRoute(Dt)}function N(){return n.getRoutes().map(it=>it.record)}function q(it){return!!n.getRecordMatcher(it)}function V(it,Dt){if(Dt=rr({},Dt||v.value),typeof it=="string"){const Ht=V0(r,it,Dt.path),fe=n.resolve({path:Ht.path},Dt),_e=c.createHref(Ht.fullPath);return rr(Ht,fe,{params:M(fe.params),hash:l_(Ht.hash),redirectedFrom:void 0,href:_e})}let yt;if("path"in it)yt=rr({},it,{path:V0(r,it.path,Dt.path).path});else{const Ht=rr({},it.params);for(const fe in Ht)Ht[fe]==null&&delete Ht[fe];yt=rr({},it,{params:I(it.params)}),Dt.params=I(Dt.params)}const Lt=n.resolve(yt,Dt),Tn=it.hash||"";Lt.params=E(M(Lt.params));const Cn=yz(s,rr({},it,{hash:n5(Tn),path:Lt.path})),Kt=c.createHref(Cn);return rr({fullPath:Cn,hash:Tn,query:s===wT?a5(it.query):it.query||{}},Lt,{redirectedFrom:void 0,href:Kt})}function ee(it){return typeof it=="string"?V0(r,it,v.value.path):rr({},it)}function oe(it,Dt){if(w!==it)return wh(8,{from:Dt,to:it})}function pe(it){return Te(it)}function se(it){return pe(rr(ee(it),{replace:!0}))}function xe(it){const Dt=it.matched[it.matched.length-1];if(Dt&&Dt.redirect){const{redirect:yt}=Dt;let Lt=typeof yt=="function"?yt(it):yt;return typeof Lt=="string"&&(Lt=Lt.includes("?")||Lt.includes("#")?Lt=ee(Lt):{path:Lt},Lt.params={}),rr({query:it.query,hash:it.hash,params:it.params},Lt)}}function Te(it,Dt){const yt=w=V(it),Lt=v.value,Tn=it.state,Cn=it.force,Kt=it.replace===!0,Ht=xe(yt);if(Ht)return Te(rr(ee(Ht),{state:Tn,force:Cn,replace:Kt}),Dt||yt);const fe=yt;fe.redirectedFrom=Dt;let _e;return!Cn&&vz(s,Lt,yt)&&(_e=wh(16,{to:fe,from:Lt}),Dn(Lt,Lt,!0,!1)),(_e?Promise.resolve(_e):Me(fe,Lt)).catch(Oe=>mc(Oe)?Oe:_t(Oe,fe,Lt)).then(Oe=>{if(Oe){if(mc(Oe,2))return Te(rr(ee(Oe.to),{state:Tn,force:Cn,replace:Kt}),Dt||fe)}else Oe=ze(fe,Lt,!0,Kt,Tn);return Be(fe,Lt,Oe),Oe})}function De(it,Dt){const yt=oe(it,Dt);return yt?Promise.reject(yt):Promise.resolve()}function Me(it,Dt){let yt;const[Lt,Tn,Cn]=g5(it,Dt);yt=q0(Lt.reverse(),"beforeRouteLeave",it,Dt);for(const Ht of Lt)Ht.leaveGuards.forEach(fe=>{yt.push(cl(fe,it,Dt))});const Kt=De.bind(null,it,Dt);return yt.push(Kt),Hu(yt).then(()=>{yt=[];for(const Ht of h.list())yt.push(cl(Ht,it,Dt));return yt.push(Kt),Hu(yt)}).then(()=>{yt=q0(Tn,"beforeRouteUpdate",it,Dt);for(const Ht of Tn)Ht.updateGuards.forEach(fe=>{yt.push(cl(fe,it,Dt))});return yt.push(Kt),Hu(yt)}).then(()=>{yt=[];for(const Ht of it.matched)if(Ht.beforeEnter&&!Dt.matched.includes(Ht))if(Array.isArray(Ht.beforeEnter))for(const fe of Ht.beforeEnter)yt.push(cl(fe,it,Dt));else yt.push(cl(Ht.beforeEnter,it,Dt));return yt.push(Kt),Hu(yt)}).then(()=>(it.matched.forEach(Ht=>Ht.enterCallbacks={}),yt=q0(Cn,"beforeRouteEnter",it,Dt),yt.push(Kt),Hu(yt))).then(()=>{yt=[];for(const Ht of m.list())yt.push(cl(Ht,it,Dt));return yt.push(Kt),Hu(yt)}).catch(Ht=>mc(Ht,8)?Ht:Promise.reject(Ht))}function Be(it,Dt,yt){for(const Lt of a.list())Lt(it,Dt,yt)}function ze(it,Dt,yt,Lt,Tn){const Cn=oe(it,Dt);if(Cn)return Cn;const Kt=Dt===tl,Ht=nh?history.state:{};yt&&(Lt||Kt?c.replace(it.fullPath,rr({scroll:Kt&&Ht&&Ht.scroll},Tn)):c.push(it.fullPath,Tn)),v.value=it,Dn(it,Dt,yt,Kt),Tt()}let Fe;function Je(){Fe=c.listen((it,Dt,yt)=>{const Lt=V(it),Tn=xe(Lt);if(Tn){Te(rr(Tn,{replace:!0}),Lt).catch(_d);return}w=Lt;const Cn=v.value;nh&&Sz(_T(Cn.fullPath,yt.delta),K_()),Me(Lt,Cn).catch(Kt=>mc(Kt,12)?Kt:mc(Kt,2)?(Te(Kt.to,Lt).then(Ht=>{mc(Ht,20)&&!yt.delta&&yt.type===bh.pop&&c.go(-1,!1)}).catch(_d),Promise.reject()):(yt.delta&&c.go(-yt.delta,!1),_t(Kt,Lt,Cn))).then(Kt=>{Kt=Kt||ze(Lt,Cn,!1),Kt&&(yt.delta?c.go(-yt.delta,!1):yt.type===bh.pop&&mc(Kt,20)&&c.go(-1,!1)),Be(Lt,Cn,Kt)}).catch(_d)})}let be=qf(),qe=qf(),Ke;function _t(it,Dt,yt){Tt(it);const Lt=qe.list();return Lt.length?Lt.forEach(Tn=>Tn(it,Dt,yt)):console.error(it),Promise.reject(it)}function It(){return Ke&&v.value!==tl?Promise.resolve():new Promise((it,Dt)=>{be.add([it,Dt])})}function Tt(it){Ke||(Ke=!0,Je(),be.list().forEach(([Dt,yt])=>it?yt(it):Dt()),be.reset())}function Dn(it,Dt,yt,Lt){const{scrollBehavior:Tn}=e;if(!nh||!Tn)return Promise.resolve();const Cn=!yt&&Az(_T(it.fullPath,0))||(Lt||!yt)&&history.state&&history.state.scroll||null;return Yn().then(()=>Tn(it,Dt,Cn)).then(Kt=>Kt&&Ez(Kt)).catch(Kt=>_t(Kt,it,Dt))}const Ot=it=>c.go(it);let Zn;const Rn=new Set;return{currentRoute:v,addRoute:P,removeRoute:j,hasRoute:q,getRoutes:N,resolve:V,options:e,push:pe,replace:se,go:Ot,back:()=>Ot(-1),forward:()=>Ot(1),beforeEach:h.add,beforeResolve:m.add,afterEach:a.add,onError:qe.add,isReady:It,install(it){const Dt=this;it.component("RouterLink",h5),it.component("RouterView",m5),it.config.globalProperties.$router=Dt,Object.defineProperty(it.config.globalProperties,"$route",{enumerable:!0,get:()=>qo(v)}),nh&&!Zn&&v.value===tl&&(Zn=!0,pe(c.location).catch(Tn=>{}));const yt={};for(const Tn in tl)yt[Tn]=Et(()=>v.value[Tn]);it.provide(X_,Dt),it.provide(fx,Al(yt)),it.provide(jy,v);const Lt=it.unmount;Rn.add(it),it.unmount=function(){Rn.delete(it),Rn.size<1&&(w=tl,Fe&&Fe(),v.value=tl,Zn=!1,Ke=!1),Lt()}}}}function Hu(e){return e.reduce((n,r)=>n.then(()=>r()),Promise.resolve())}function g5(e,n){const r=[],s=[],c=[],h=Math.max(n.matched.length,e.matched.length);for(let m=0;m<h;m++){const a=n.matched[m];a&&(e.matched.find(w=>xh(w,a))?s.push(a):r.push(a));const v=e.matched[m];v&&(n.matched.find(w=>xh(w,v))||c.push(v))}return[r,s,c]}function B8(){return kn(X_)}function U8(){return kn(fx)}var y5=Object.defineProperty,v5=Object.defineProperties,x5=Object.getOwnPropertyDescriptors,CT=Object.getOwnPropertySymbols,b5=Object.prototype.hasOwnProperty,w5=Object.prototype.propertyIsEnumerable,IT=(e,n,r)=>n in e?y5(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r,JS=(e,n)=>{for(var r in n||(n={}))b5.call(n,r)&&IT(e,r,n[r]);if(CT)for(var r of CT(n))w5.call(n,r)&&IT(e,r,n[r]);return e},T5=(e,n)=>v5(e,x5(n)),eA="usehead",MT="head:count",Z0="data-head-attrs",E5=(e,n,r)=>{const s=r.createElement(e);for(const c of Object.keys(n)){let h=n[c];c==="key"||h===!1||(c==="children"?s.textContent=h:s.setAttribute(c,h))}return s};function S5(e,n){if(e instanceof HTMLElement&&n instanceof HTMLElement){const r=n.getAttribute("nonce");if(r&&!e.getAttribute("nonce")){const s=n.cloneNode(!0);return s.setAttribute("nonce",""),s.nonce=r,r===e.nonce&&e.isEqualNode(s)}}return e.isEqualNode(n)}var A5=e=>{const n=["key","id","name","property"];for(const r of n){const s=typeof e.getAttribute=="function"?e.hasAttribute(r)?e.getAttribute(r):void 0:e[r];if(s!==void 0)return{name:r,value:s}}},C5=()=>{const e=kn(eA);if(!e)throw new Error("You may forget to apply app.use(head)");return e},I5=["title","meta","link","base","style","script","htmlAttrs","bodyAttrs"],M5=e=>{const n=[];for(const r of Object.keys(e))if(e[r]!=null){if(r==="title")n.push({tag:r,props:{children:e[r]}});else if(r==="base")n.push({tag:r,props:JS({key:"default"},e[r])});else if(I5.includes(r)){const s=e[r];Array.isArray(s)?s.forEach(c=>{n.push({tag:r,props:c})}):s&&n.push({tag:r,props:s})}}return n},kT=(e,n)=>{const r=e.getAttribute(Z0);if(r)for(const c of r.split(","))c in n||e.removeAttribute(c);const s=[];for(const c in n){const h=n[c];h!=null&&(h===!1?e.removeAttribute(c):e.setAttribute(c,h),s.push(c))}s.length?e.setAttribute(Z0,s.join(",")):e.removeAttribute(Z0)},k5=(e=window.document,n,r)=>{var s;const c=e.head;let h=c.querySelector(`meta[name="${MT}"]`);const m=h?Number(h.getAttribute("content")):0,a=[];if(h)for(let w=0,E=h.previousElementSibling;w<m;w++,E=(E==null?void 0:E.previousElementSibling)||null)((s=E==null?void 0:E.tagName)==null?void 0:s.toLowerCase())===n&&a.push(E);else h=e.createElement("meta"),h.setAttribute("name",MT),h.setAttribute("content","0"),c.append(h);let v=r.map(w=>E5(w.tag,w.props,e));v=v.filter(w=>{for(let E=0;E<a.length;E++){const I=a[E];if(S5(I,w))return a.splice(E,1),!1}return!0}),a.forEach(w=>{var E;return(E=w.parentNode)==null?void 0:E.removeChild(w)}),v.forEach(w=>{c.insertBefore(w,h)}),h.setAttribute("content",""+(m-a.length+v.length))},P5=()=>{let e=[];const n={install(r){r.config.globalProperties.$head=n,r.provide(eA,n)},get headTags(){const r=[];return e.forEach(s=>{M5(s.value).forEach(h=>{if(h.tag==="meta"||h.tag==="base"||h.tag==="script"){const m=A5(h.props);if(m){let a=-1;for(let v=0;v<r.length;v++){const w=r[v],E=w.props[m.name],I=h.props[m.name];if(w.tag===h.tag&&E===I){a=v;break}}a!==-1&&r.splice(a,1)}}r.push(h)})}),r},addHeadObjs(r){e.push(r)},removeHeadObjs(r){e=e.filter(s=>s!==r)},updateDOM(r=window.document){let s,c={},h={};const m={};for(const a of n.headTags){if(a.tag==="title"){s=a.props.children;continue}if(a.tag==="htmlAttrs"){Object.assign(c,a.props);continue}if(a.tag==="bodyAttrs"){Object.assign(h,a.props);continue}m[a.tag]=m[a.tag]||[],m[a.tag].push(a)}s!==void 0&&(r.title=s),kT(r.documentElement,c),kT(r.body,h);for(const a of Object.keys(m))k5(r,a,m[a])}};return n},D5=typeof window!="undefined",R5=e=>{const n={title:void 0,htmlAttrs:void 0,bodyAttrs:void 0,base:void 0,meta:[],link:[],style:[],script:[]};for(const r of e){const s=r.type==="html"?"htmlAttrs":r.type==="body"?"bodyAttrs":r.type;if(typeof s!="string"||!(s in n))continue;const c=T5(JS({},r.props),{children:Array.isArray(r.children)?r.children[0].children:r.children});Array.isArray(n[s])?n[s].push(c):s==="title"?n.title=c.children:n[s]=c}return n},N8=Yt({name:"Head",setup(e,{slots:n}){const r=C5();let s;return rx(()=>{s&&(r.removeHeadObjs(s),r.updateDOM())}),()=>(dr(()=>{!n.default||(s&&r.removeHeadObjs(s),s=ft(R5(n.default())),r.addHeadObjs(s),D5&&r.updateDOM())}),null)}});function z5(e){try{return JSON.parse(e||"{}")}catch(n){return console.error("[SSG] On state deserialization -",n,e),{}}}function O5(e){return document.readyState==="loading"?new Promise(n=>{document.addEventListener("DOMContentLoaded",()=>n(e))}):Promise.resolve(e)}const L5=Yt({setup(e,{slots:n}){const r=ft(!1);return cr(()=>r.value=!0),()=>r.value&&n.default&&n.default({})}});function j8(e,n,r,s={}){const{transformState:c,registerComponents:h=!0,useHead:m=!0,rootContainer:a="#app"}=s,v=typeof window!="undefined";async function w(E=!1,I){var Te,De;const M=E?mR(e):_R(e);let P;m&&(P=P5(),M.use(P));const j=_5(Pt({history:E?kz(n.base):Pz(n.base)},n)),{routes:N}=n;h&&M.component("ClientOnly",E?L5:{render:()=>null});const q=[],oe={app:M,head:P,isClient:v,router:j,routes:N,onSSRAppRendered:E?()=>{}:Me=>q.push(Me),triggerOnSSRAppRendered:()=>Promise.all(q.map(Me=>Me())),initialState:{},transformState:c,routePath:I};E&&(await O5(),oe.initialState=(c==null?void 0:c(window.__INITIAL_STATE__||{}))||z5(window.__INITIAL_STATE__)),await(r==null?void 0:r(oe)),M.use(j);let pe,se=!0;if(j.beforeEach((Me,Be,ze)=>{(se||pe&&pe===Me.path)&&(se=!1,pe=Me.path,Me.meta.state=oe.initialState),ze()}),!E){const Me=(De=(Te=oe.routePath)!=null?Te:n.base)!=null?De:"/";j.push(Me),await j.isReady(),oe.initialState=j.currentRoute.value.meta.state||{}}const xe=oe.initialState;return Ei(Pt({},oe),{initialState:xe})}return v&&(async()=>{const{app:E,router:I}=await w(!0);await I.isReady(),E.mount(a,!0)})(),w}function Gy(e,n){return e==null||n==null?NaN:e<n?-1:e>n?1:e>=n?0:NaN}function tA(e){let n=e,r=e,s=e;e.length!==2&&(n=(a,v)=>e(a)-v,r=Gy,s=(a,v)=>Gy(e(a),v));function c(a,v,w=0,E=a.length){if(w<E){if(r(v,v)!==0)return E;do{const I=w+E>>>1;s(a[I],v)<0?w=I+1:E=I}while(w<E)}return w}function h(a,v,w=0,E=a.length){if(w<E){if(r(v,v)!==0)return E;do{const I=w+E>>>1;s(a[I],v)<=0?w=I+1:E=I}while(w<E)}return w}function m(a,v,w=0,E=a.length){const I=c(a,v,w,E-1);return I>w&&n(a[I-1],v)>-n(a[I],v)?I-1:I}return{left:c,center:m,right:h}}function F5(e){return e===null?NaN:+e}const B5=tA(Gy),U5=B5.right;tA(F5).center;var N5=U5;function j5(e,n){let r=0;if(n===void 0)for(let s of e)s!=null&&(s=+s)>=s&&++r;else{let s=-1;for(let c of e)(c=n(c,++s,e))!=null&&(c=+c)>=c&&++r}return r}function $5(e,n){let r,s;if(n===void 0)for(const c of e)c!=null&&(r===void 0?c>=c&&(r=s=c):(r>c&&(r=c),s<c&&(s=c)));else{let c=-1;for(let h of e)(h=n(h,++c,e))!=null&&(r===void 0?h>=h&&(r=s=h):(r>h&&(r=h),s<h&&(s=h)))}return[r,s]}class Th{constructor(){this._partials=new Float64Array(32),this._n=0}add(n){const r=this._partials;let s=0;for(let c=0;c<this._n&&c<32;c++){const h=r[c],m=n+h,a=Math.abs(n)<Math.abs(h)?n-(m-h):h-(m-n);a&&(r[s++]=a),n=m}return r[s]=n,this._n=s+1,this}valueOf(){const n=this._partials;let r=this._n,s,c,h,m=0;if(r>0){for(m=n[--r];r>0&&(s=m,c=n[--r],m=s+c,h=c-(m-s),!h););r>0&&(h<0&&n[r-1]<0||h>0&&n[r-1]>0)&&(c=h*2,s=m+c,c==s-m&&(m=s))}return m}}var qy=Math.sqrt(50),Zy=Math.sqrt(10),Wy=Math.sqrt(2);function nA(e,n,r){var s,c=-1,h,m,a;if(n=+n,e=+e,r=+r,e===n&&r>0)return[e];if((s=n<e)&&(h=e,e=n,n=h),(a=rA(e,n,r))===0||!isFinite(a))return[];if(a>0){let v=Math.round(e/a),w=Math.round(n/a);for(v*a<e&&++v,w*a>n&&--w,m=new Array(h=w-v+1);++c<h;)m[c]=(v+c)*a}else{a=-a;let v=Math.round(e*a),w=Math.round(n*a);for(v/a<e&&++v,w/a>n&&--w,m=new Array(h=w-v+1);++c<h;)m[c]=(v+c)/a}return s&&m.reverse(),m}function rA(e,n,r){var s=(n-e)/Math.max(0,r),c=Math.floor(Math.log(s)/Math.LN10),h=s/Math.pow(10,c);return c>=0?(h>=qy?10:h>=Zy?5:h>=Wy?2:1)*Math.pow(10,c):-Math.pow(10,-c)/(h>=qy?10:h>=Zy?5:h>=Wy?2:1)}function px(e,n,r){var s=Math.abs(n-e)/Math.max(0,r),c=Math.pow(10,Math.floor(Math.log(s)/Math.LN10)),h=s/c;return h>=qy?c*=10:h>=Zy?c*=5:h>=Wy&&(c*=2),n<e?-c:c}function V5(e){return Math.ceil(Math.log(j5(e))/Math.LN2)+1}function G5(e,n){let r;if(n===void 0)for(const s of e)s!=null&&(r<s||r===void 0&&s>=s)&&(r=s);else{let s=-1;for(let c of e)(c=n(c,++s,e))!=null&&(r<c||r===void 0&&c>=c)&&(r=c)}return r}function q5(e,n,r){e=+e,n=+n,r=(c=arguments.length)<2?(n=e,e=0,1):c<3?1:+r;for(var s=-1,c=Math.max(0,Math.ceil((n-e)/r))|0,h=new Array(c);++s<c;)h[s]=e+s*r;return h}function $8(e,n){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");if(typeof n!="function")throw new TypeError("mapper is not a function");return Array.from(e,(r,s)=>n(r,s,e))}function Z5(e){return e}var W0=1,H0=2,Hy=3,Jf=4,PT=1e-6;function W5(e){return"translate("+e+",0)"}function H5(e){return"translate(0,"+e+")"}function X5(e){return n=>+e(n)}function K5(e,n){return n=Math.max(0,e.bandwidth()-n*2)/2,e.round()&&(n=Math.round(n)),r=>+e(r)+n}function Y5(){return!this.__axis}function iA(e,n){var r=[],s=null,c=null,h=6,m=6,a=3,v=typeof window!="undefined"&&window.devicePixelRatio>1?0:.5,w=e===W0||e===Jf?-1:1,E=e===Jf||e===H0?"x":"y",I=e===W0||e===Hy?W5:H5;function M(P){var j=s==null?n.ticks?n.ticks.apply(n,r):n.domain():s,N=c==null?n.tickFormat?n.tickFormat.apply(n,r):Z5:c,q=Math.max(h,0)+a,V=n.range(),ee=+V[0]+v,oe=+V[V.length-1]+v,pe=(n.bandwidth?K5:X5)(n.copy(),v),se=P.selection?P.selection():P,xe=se.selectAll(".domain").data([null]),Te=se.selectAll(".tick").data(j,n).order(),De=Te.exit(),Me=Te.enter().append("g").attr("class","tick"),Be=Te.select("line"),ze=Te.select("text");xe=xe.merge(xe.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),Te=Te.merge(Me),Be=Be.merge(Me.append("line").attr("stroke","currentColor").attr(E+"2",w*h)),ze=ze.merge(Me.append("text").attr("fill","currentColor").attr(E,w*q).attr("dy",e===W0?"0em":e===Hy?"0.71em":"0.32em")),P!==se&&(xe=xe.transition(P),Te=Te.transition(P),Be=Be.transition(P),ze=ze.transition(P),De=De.transition(P).attr("opacity",PT).attr("transform",function(Fe){return isFinite(Fe=pe(Fe))?I(Fe+v):this.getAttribute("transform")}),Me.attr("opacity",PT).attr("transform",function(Fe){var Je=this.parentNode.__axis;return I((Je&&isFinite(Je=Je(Fe))?Je:pe(Fe))+v)})),De.remove(),xe.attr("d",e===Jf||e===H0?m?"M"+w*m+","+ee+"H"+v+"V"+oe+"H"+w*m:"M"+v+","+ee+"V"+oe:m?"M"+ee+","+w*m+"V"+v+"H"+oe+"V"+w*m:"M"+ee+","+v+"H"+oe),Te.attr("opacity",1).attr("transform",function(Fe){return I(pe(Fe)+v)}),Be.attr(E+"2",w*h),ze.attr(E,w*q).text(N),se.filter(Y5).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===H0?"start":e===Jf?"end":"middle"),se.each(function(){this.__axis=pe})}return M.scale=function(P){return arguments.length?(n=P,M):n},M.ticks=function(){return r=Array.from(arguments),M},M.tickArguments=function(P){return arguments.length?(r=P==null?[]:Array.from(P),M):r.slice()},M.tickValues=function(P){return arguments.length?(s=P==null?null:Array.from(P),M):s&&s.slice()},M.tickFormat=function(P){return arguments.length?(c=P,M):c},M.tickSize=function(P){return arguments.length?(h=m=+P,M):h},M.tickSizeInner=function(P){return arguments.length?(h=+P,M):h},M.tickSizeOuter=function(P){return arguments.length?(m=+P,M):m},M.tickPadding=function(P){return arguments.length?(a=+P,M):a},M.offset=function(P){return arguments.length?(v=+P,M):v},M}function V8(e){return iA(Hy,e)}function G8(e){return iA(Jf,e)}var Q5={value:()=>{}};function oA(){for(var e=0,n=arguments.length,r={},s;e<n;++e){if(!(s=arguments[e]+"")||s in r||/[\s.]/.test(s))throw new Error("illegal type: "+s);r[s]=[]}return new Um(r)}function Um(e){this._=e}function J5(e,n){return e.trim().split(/^|\s+/).map(function(r){var s="",c=r.indexOf(".");if(c>=0&&(s=r.slice(c+1),r=r.slice(0,c)),r&&!n.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:s}})}Um.prototype=oA.prototype={constructor:Um,on:function(e,n){var r=this._,s=J5(e+"",r),c,h=-1,m=s.length;if(arguments.length<2){for(;++h<m;)if((c=(e=s[h]).type)&&(c=eO(r[c],e.name)))return c;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++h<m;)if(c=(e=s[h]).type)r[c]=DT(r[c],e.name,n);else if(n==null)for(c in r)r[c]=DT(r[c],e.name,null);return this},copy:function(){var e={},n=this._;for(var r in n)e[r]=n[r].slice();return new Um(e)},call:function(e,n){if((c=arguments.length-2)>0)for(var r=new Array(c),s=0,c,h;s<c;++s)r[s]=arguments[s+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(h=this._[e],s=0,c=h.length;s<c;++s)h[s].value.apply(n,r)},apply:function(e,n,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var s=this._[e],c=0,h=s.length;c<h;++c)s[c].value.apply(n,r)}};function eO(e,n){for(var r=0,s=e.length,c;r<s;++r)if((c=e[r]).name===n)return c.value}function DT(e,n,r){for(var s=0,c=e.length;s<c;++s)if(e[s].name===n){e[s]=Q5,e=e.slice(0,s).concat(e.slice(s+1));break}return r!=null&&e.push({name:n,value:r}),e}var Xy="http://www.w3.org/1999/xhtml",RT={svg:"http://www.w3.org/2000/svg",xhtml:Xy,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Y_(e){var n=e+="",r=n.indexOf(":");return r>=0&&(n=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),RT.hasOwnProperty(n)?{space:RT[n],local:e}:e}function tO(e){return function(){var n=this.ownerDocument,r=this.namespaceURI;return r===Xy&&n.documentElement.namespaceURI===Xy?n.createElement(e):n.createElementNS(r,e)}}function nO(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function mx(e){var n=Y_(e);return(n.local?nO:tO)(n)}function rO(){}function _x(e){return e==null?rO:function(){return this.querySelector(e)}}function iO(e){typeof e!="function"&&(e=_x(e));for(var n=this._groups,r=n.length,s=new Array(r),c=0;c<r;++c)for(var h=n[c],m=h.length,a=s[c]=new Array(m),v,w,E=0;E<m;++E)(v=h[E])&&(w=e.call(v,v.__data__,E,h))&&("__data__"in v&&(w.__data__=v.__data__),a[E]=w);return new To(s,this._parents)}function oO(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function sO(){return[]}function sA(e){return e==null?sO:function(){return this.querySelectorAll(e)}}function aO(e){return function(){return oO(e.apply(this,arguments))}}function lO(e){typeof e=="function"?e=aO(e):e=sA(e);for(var n=this._groups,r=n.length,s=[],c=[],h=0;h<r;++h)for(var m=n[h],a=m.length,v,w=0;w<a;++w)(v=m[w])&&(s.push(e.call(v,v.__data__,w,m)),c.push(v));return new To(s,c)}function aA(e){return function(){return this.matches(e)}}function lA(e){return function(n){return n.matches(e)}}var cO=Array.prototype.find;function uO(e){return function(){return cO.call(this.children,e)}}function hO(){return this.firstElementChild}function fO(e){return this.select(e==null?hO:uO(typeof e=="function"?e:lA(e)))}var dO=Array.prototype.filter;function pO(){return Array.from(this.children)}function mO(e){return function(){return dO.call(this.children,e)}}function _O(e){return this.selectAll(e==null?pO:mO(typeof e=="function"?e:lA(e)))}function gO(e){typeof e!="function"&&(e=aA(e));for(var n=this._groups,r=n.length,s=new Array(r),c=0;c<r;++c)for(var h=n[c],m=h.length,a=s[c]=[],v,w=0;w<m;++w)(v=h[w])&&e.call(v,v.__data__,w,h)&&a.push(v);return new To(s,this._parents)}function cA(e){return new Array(e.length)}function yO(){return new To(this._enter||this._groups.map(cA),this._parents)}function c_(e,n){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=n}c_.prototype={constructor:c_,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,n){return this._parent.insertBefore(e,n)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function vO(e){return function(){return e}}function xO(e,n,r,s,c,h){for(var m=0,a,v=n.length,w=h.length;m<w;++m)(a=n[m])?(a.__data__=h[m],s[m]=a):r[m]=new c_(e,h[m]);for(;m<v;++m)(a=n[m])&&(c[m]=a)}function bO(e,n,r,s,c,h,m){var a,v,w=new Map,E=n.length,I=h.length,M=new Array(E),P;for(a=0;a<E;++a)(v=n[a])&&(M[a]=P=m.call(v,v.__data__,a,n)+"",w.has(P)?c[a]=v:w.set(P,v));for(a=0;a<I;++a)P=m.call(e,h[a],a,h)+"",(v=w.get(P))?(s[a]=v,v.__data__=h[a],w.delete(P)):r[a]=new c_(e,h[a]);for(a=0;a<E;++a)(v=n[a])&&w.get(M[a])===v&&(c[a]=v)}function wO(e){return e.__data__}function TO(e,n){if(!arguments.length)return Array.from(this,wO);var r=n?bO:xO,s=this._parents,c=this._groups;typeof e!="function"&&(e=vO(e));for(var h=c.length,m=new Array(h),a=new Array(h),v=new Array(h),w=0;w<h;++w){var E=s[w],I=c[w],M=I.length,P=EO(e.call(E,E&&E.__data__,w,s)),j=P.length,N=a[w]=new Array(j),q=m[w]=new Array(j),V=v[w]=new Array(M);r(E,I,N,q,V,P,n);for(var ee=0,oe=0,pe,se;ee<j;++ee)if(pe=N[ee]){for(ee>=oe&&(oe=ee+1);!(se=q[oe])&&++oe<j;);pe._next=se||null}}return m=new To(m,s),m._enter=a,m._exit=v,m}function EO(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function SO(){return new To(this._exit||this._groups.map(cA),this._parents)}function AO(e,n,r){var s=this.enter(),c=this,h=this.exit();return typeof e=="function"?(s=e(s),s&&(s=s.selection())):s=s.append(e+""),n!=null&&(c=n(c),c&&(c=c.selection())),r==null?h.remove():r(h),s&&c?s.merge(c).order():c}function CO(e){for(var n=e.selection?e.selection():e,r=this._groups,s=n._groups,c=r.length,h=s.length,m=Math.min(c,h),a=new Array(c),v=0;v<m;++v)for(var w=r[v],E=s[v],I=w.length,M=a[v]=new Array(I),P,j=0;j<I;++j)(P=w[j]||E[j])&&(M[j]=P);for(;v<c;++v)a[v]=r[v];return new To(a,this._parents)}function IO(){for(var e=this._groups,n=-1,r=e.length;++n<r;)for(var s=e[n],c=s.length-1,h=s[c],m;--c>=0;)(m=s[c])&&(h&&m.compareDocumentPosition(h)^4&&h.parentNode.insertBefore(m,h),h=m);return this}function MO(e){e||(e=kO);function n(I,M){return I&&M?e(I.__data__,M.__data__):!I-!M}for(var r=this._groups,s=r.length,c=new Array(s),h=0;h<s;++h){for(var m=r[h],a=m.length,v=c[h]=new Array(a),w,E=0;E<a;++E)(w=m[E])&&(v[E]=w);v.sort(n)}return new To(c,this._parents).order()}function kO(e,n){return e<n?-1:e>n?1:e>=n?0:NaN}function PO(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function DO(){return Array.from(this)}function RO(){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var s=e[n],c=0,h=s.length;c<h;++c){var m=s[c];if(m)return m}return null}function zO(){let e=0;for(const n of this)++e;return e}function OO(){return!this.node()}function LO(e){for(var n=this._groups,r=0,s=n.length;r<s;++r)for(var c=n[r],h=0,m=c.length,a;h<m;++h)(a=c[h])&&e.call(a,a.__data__,h,c);return this}function FO(e){return function(){this.removeAttribute(e)}}function BO(e){return function(){this.removeAttributeNS(e.space,e.local)}}function UO(e,n){return function(){this.setAttribute(e,n)}}function NO(e,n){return function(){this.setAttributeNS(e.space,e.local,n)}}function jO(e,n){return function(){var r=n.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function $O(e,n){return function(){var r=n.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function VO(e,n){var r=Y_(e);if(arguments.length<2){var s=this.node();return r.local?s.getAttributeNS(r.space,r.local):s.getAttribute(r)}return this.each((n==null?r.local?BO:FO:typeof n=="function"?r.local?$O:jO:r.local?NO:UO)(r,n))}function uA(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function GO(e){return function(){this.style.removeProperty(e)}}function qO(e,n,r){return function(){this.style.setProperty(e,n,r)}}function ZO(e,n,r){return function(){var s=n.apply(this,arguments);s==null?this.style.removeProperty(e):this.style.setProperty(e,s,r)}}function WO(e,n,r){return arguments.length>1?this.each((n==null?GO:typeof n=="function"?ZO:qO)(e,n,r==null?"":r)):Eh(this.node(),e)}function Eh(e,n){return e.style.getPropertyValue(n)||uA(e).getComputedStyle(e,null).getPropertyValue(n)}function HO(e){return function(){delete this[e]}}function XO(e,n){return function(){this[e]=n}}function KO(e,n){return function(){var r=n.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function YO(e,n){return arguments.length>1?this.each((n==null?HO:typeof n=="function"?KO:XO)(e,n)):this.node()[e]}function hA(e){return e.trim().split(/^|\s+/)}function gx(e){return e.classList||new fA(e)}function fA(e){this._node=e,this._names=hA(e.getAttribute("class")||"")}fA.prototype={add:function(e){var n=this._names.indexOf(e);n<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var n=this._names.indexOf(e);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function dA(e,n){for(var r=gx(e),s=-1,c=n.length;++s<c;)r.add(n[s])}function pA(e,n){for(var r=gx(e),s=-1,c=n.length;++s<c;)r.remove(n[s])}function QO(e){return function(){dA(this,e)}}function JO(e){return function(){pA(this,e)}}function eL(e,n){return function(){(n.apply(this,arguments)?dA:pA)(this,e)}}function tL(e,n){var r=hA(e+"");if(arguments.length<2){for(var s=gx(this.node()),c=-1,h=r.length;++c<h;)if(!s.contains(r[c]))return!1;return!0}return this.each((typeof n=="function"?eL:n?QO:JO)(r,n))}function nL(){this.textContent=""}function rL(e){return function(){this.textContent=e}}function iL(e){return function(){var n=e.apply(this,arguments);this.textContent=n==null?"":n}}function oL(e){return arguments.length?this.each(e==null?nL:(typeof e=="function"?iL:rL)(e)):this.node().textContent}function sL(){this.innerHTML=""}function aL(e){return function(){this.innerHTML=e}}function lL(e){return function(){var n=e.apply(this,arguments);this.innerHTML=n==null?"":n}}function cL(e){return arguments.length?this.each(e==null?sL:(typeof e=="function"?lL:aL)(e)):this.node().innerHTML}function uL(){this.nextSibling&&this.parentNode.appendChild(this)}function hL(){return this.each(uL)}function fL(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function dL(){return this.each(fL)}function pL(e){var n=typeof e=="function"?e:mx(e);return this.select(function(){return this.appendChild(n.apply(this,arguments))})}function mL(){return null}function _L(e,n){var r=typeof e=="function"?e:mx(e),s=n==null?mL:typeof n=="function"?n:_x(n);return this.select(function(){return this.insertBefore(r.apply(this,arguments),s.apply(this,arguments)||null)})}function gL(){var e=this.parentNode;e&&e.removeChild(this)}function yL(){return this.each(gL)}function vL(){var e=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(e,this.nextSibling):e}function xL(){var e=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(e,this.nextSibling):e}function bL(e){return this.select(e?xL:vL)}function wL(e){return arguments.length?this.property("__data__",e):this.node().__data__}function TL(e){return function(n){e.call(this,n,this.__data__)}}function EL(e){return e.trim().split(/^|\s+/).map(function(n){var r="",s=n.indexOf(".");return s>=0&&(r=n.slice(s+1),n=n.slice(0,s)),{type:n,name:r}})}function SL(e){return function(){var n=this.__on;if(!!n){for(var r=0,s=-1,c=n.length,h;r<c;++r)h=n[r],(!e.type||h.type===e.type)&&h.name===e.name?this.removeEventListener(h.type,h.listener,h.options):n[++s]=h;++s?n.length=s:delete this.__on}}}function AL(e,n,r){return function(){var s=this.__on,c,h=TL(n);if(s){for(var m=0,a=s.length;m<a;++m)if((c=s[m]).type===e.type&&c.name===e.name){this.removeEventListener(c.type,c.listener,c.options),this.addEventListener(c.type,c.listener=h,c.options=r),c.value=n;return}}this.addEventListener(e.type,h,r),c={type:e.type,name:e.name,value:n,listener:h,options:r},s?s.push(c):this.__on=[c]}}function CL(e,n,r){var s=EL(e+""),c,h=s.length,m;if(arguments.length<2){var a=this.node().__on;if(a){for(var v=0,w=a.length,E;v<w;++v)for(c=0,E=a[v];c<h;++c)if((m=s[c]).type===E.type&&m.name===E.name)return E.value}return}for(a=n?AL:SL,c=0;c<h;++c)this.each(a(s[c],n,r));return this}function mA(e,n,r){var s=uA(e),c=s.CustomEvent;typeof c=="function"?c=new c(n,r):(c=s.document.createEvent("Event"),r?(c.initEvent(n,r.bubbles,r.cancelable),c.detail=r.detail):c.initEvent(n,!1,!1)),e.dispatchEvent(c)}function IL(e,n){return function(){return mA(this,e,n)}}function ML(e,n){return function(){return mA(this,e,n.apply(this,arguments))}}function kL(e,n){return this.each((typeof n=="function"?ML:IL)(e,n))}function*PL(){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var s=e[n],c=0,h=s.length,m;c<h;++c)(m=s[c])&&(yield m)}var _A=[null];function To(e,n){this._groups=e,this._parents=n}function Gd(){return new To([[document.documentElement]],_A)}function DL(){return this}To.prototype=Gd.prototype={constructor:To,select:iO,selectAll:lO,selectChild:fO,selectChildren:_O,filter:gO,data:TO,enter:yO,exit:SO,join:AO,merge:CO,selection:DL,order:IO,sort:MO,call:PO,nodes:DO,node:RO,size:zO,empty:OO,each:LO,attr:VO,style:WO,property:YO,classed:tL,text:oL,html:cL,raise:hL,lower:dL,append:pL,insert:_L,remove:yL,clone:bL,datum:wL,on:CL,dispatch:kL,[Symbol.iterator]:PL};function RL(e){return typeof e=="string"?new To([[document.querySelector(e)]],[document.documentElement]):new To([[e]],_A)}function q8(e){return RL(mx(e).call(document.documentElement))}function zL(e){let n;for(;n=e.sourceEvent;)e=n;return e}function Z8(e,n){if(e=zL(e),n===void 0&&(n=e.currentTarget),n){var r=n.ownerSVGElement||n;if(r.createSVGPoint){var s=r.createSVGPoint();return s.x=e.clientX,s.y=e.clientY,s=s.matrixTransform(n.getScreenCTM().inverse()),[s.x,s.y]}if(n.getBoundingClientRect){var c=n.getBoundingClientRect();return[e.clientX-c.left-n.clientLeft,e.clientY-c.top-n.clientTop]}}return[e.pageX,e.pageY]}function yx(e,n,r){e.prototype=n.prototype=r,r.constructor=e}function gA(e,n){var r=Object.create(e.prototype);for(var s in n)r[s]=n[s];return r}function qd(){}var kd=.7,u_=1/kd,ph="\\s*([+-]?\\d+)\\s*",Pd="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Zs="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",OL=/^#([0-9a-f]{3,8})$/,LL=new RegExp("^rgb\\("+[ph,ph,ph]+"\\)$"),FL=new RegExp("^rgb\\("+[Zs,Zs,Zs]+"\\)$"),BL=new RegExp("^rgba\\("+[ph,ph,ph,Pd]+"\\)$"),UL=new RegExp("^rgba\\("+[Zs,Zs,Zs,Pd]+"\\)$"),NL=new RegExp("^hsl\\("+[Pd,Zs,Zs]+"\\)$"),jL=new RegExp("^hsla\\("+[Pd,Zs,Zs,Pd]+"\\)$"),zT={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};yx(qd,Uc,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:OT,formatHex:OT,formatHsl:$L,formatRgb:LT,toString:LT});function OT(){return this.rgb().formatHex()}function $L(){return yA(this).formatHsl()}function LT(){return this.rgb().formatRgb()}function Uc(e){var n,r;return e=(e+"").trim().toLowerCase(),(n=OL.exec(e))?(r=n[1].length,n=parseInt(n[1],16),r===6?FT(n):r===3?new vo(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):r===8?Mm(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):r===4?Mm(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=LL.exec(e))?new vo(n[1],n[2],n[3],1):(n=FL.exec(e))?new vo(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=BL.exec(e))?Mm(n[1],n[2],n[3],n[4]):(n=UL.exec(e))?Mm(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=NL.exec(e))?NT(n[1],n[2]/100,n[3]/100,1):(n=jL.exec(e))?NT(n[1],n[2]/100,n[3]/100,n[4]):zT.hasOwnProperty(e)?FT(zT[e]):e==="transparent"?new vo(NaN,NaN,NaN,0):null}function FT(e){return new vo(e>>16&255,e>>8&255,e&255,1)}function Mm(e,n,r,s){return s<=0&&(e=n=r=NaN),new vo(e,n,r,s)}function VL(e){return e instanceof qd||(e=Uc(e)),e?(e=e.rgb(),new vo(e.r,e.g,e.b,e.opacity)):new vo}function Ky(e,n,r,s){return arguments.length===1?VL(e):new vo(e,n,r,s==null?1:s)}function vo(e,n,r,s){this.r=+e,this.g=+n,this.b=+r,this.opacity=+s}yx(vo,Ky,gA(qd,{brighter:function(e){return e=e==null?u_:Math.pow(u_,e),new vo(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?kd:Math.pow(kd,e),new vo(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:BT,formatHex:BT,formatRgb:UT,toString:UT}));function BT(){return"#"+X0(this.r)+X0(this.g)+X0(this.b)}function UT(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function X0(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function NT(e,n,r,s){return s<=0?e=n=r=NaN:r<=0||r>=1?e=n=NaN:n<=0&&(e=NaN),new js(e,n,r,s)}function yA(e){if(e instanceof js)return new js(e.h,e.s,e.l,e.opacity);if(e instanceof qd||(e=Uc(e)),!e)return new js;if(e instanceof js)return e;e=e.rgb();var n=e.r/255,r=e.g/255,s=e.b/255,c=Math.min(n,r,s),h=Math.max(n,r,s),m=NaN,a=h-c,v=(h+c)/2;return a?(n===h?m=(r-s)/a+(r<s)*6:r===h?m=(s-n)/a+2:m=(n-r)/a+4,a/=v<.5?h+c:2-h-c,m*=60):a=v>0&&v<1?0:m,new js(m,a,v,e.opacity)}function GL(e,n,r,s){return arguments.length===1?yA(e):new js(e,n,r,s==null?1:s)}function js(e,n,r,s){this.h=+e,this.s=+n,this.l=+r,this.opacity=+s}yx(js,GL,gA(qd,{brighter:function(e){return e=e==null?u_:Math.pow(u_,e),new js(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?kd:Math.pow(kd,e),new js(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,n=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,s=r+(r<.5?r:1-r)*n,c=2*r-s;return new vo(K0(e>=240?e-240:e+120,c,s),K0(e,c,s),K0(e<120?e+240:e-120,c,s),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function K0(e,n,r){return(e<60?n+(r-n)*e/60:e<180?r:e<240?n+(r-n)*(240-e)/60:n)*255}var vx=e=>()=>e;function qL(e,n){return function(r){return e+r*n}}function ZL(e,n,r){return e=Math.pow(e,r),n=Math.pow(n,r)-e,r=1/r,function(s){return Math.pow(e+s*n,r)}}function WL(e){return(e=+e)==1?vA:function(n,r){return r-n?ZL(n,r,e):vx(isNaN(n)?r:n)}}function vA(e,n){var r=n-e;return r?qL(e,r):vx(isNaN(e)?n:e)}var h_=function e(n){var r=WL(n);function s(c,h){var m=r((c=Ky(c)).r,(h=Ky(h)).r),a=r(c.g,h.g),v=r(c.b,h.b),w=vA(c.opacity,h.opacity);return function(E){return c.r=m(E),c.g=a(E),c.b=v(E),c.opacity=w(E),c+""}}return s.gamma=e,s}(1);function HL(e,n){n||(n=[]);var r=e?Math.min(n.length,e.length):0,s=n.slice(),c;return function(h){for(c=0;c<r;++c)s[c]=e[c]*(1-h)+n[c]*h;return s}}function XL(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function KL(e,n){var r=n?n.length:0,s=e?Math.min(r,e.length):0,c=new Array(s),h=new Array(r),m;for(m=0;m<s;++m)c[m]=xx(e[m],n[m]);for(;m<r;++m)h[m]=n[m];return function(a){for(m=0;m<s;++m)h[m]=c[m](a);return h}}function YL(e,n){var r=new Date;return e=+e,n=+n,function(s){return r.setTime(e*(1-s)+n*s),r}}function fs(e,n){return e=+e,n=+n,function(r){return e*(1-r)+n*r}}function QL(e,n){var r={},s={},c;(e===null||typeof e!="object")&&(e={}),(n===null||typeof n!="object")&&(n={});for(c in n)c in e?r[c]=xx(e[c],n[c]):s[c]=n[c];return function(h){for(c in r)s[c]=r[c](h);return s}}var Yy=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Y0=new RegExp(Yy.source,"g");function JL(e){return function(){return e}}function eF(e){return function(n){return e(n)+""}}function xA(e,n){var r=Yy.lastIndex=Y0.lastIndex=0,s,c,h,m=-1,a=[],v=[];for(e=e+"",n=n+"";(s=Yy.exec(e))&&(c=Y0.exec(n));)(h=c.index)>r&&(h=n.slice(r,h),a[m]?a[m]+=h:a[++m]=h),(s=s[0])===(c=c[0])?a[m]?a[m]+=c:a[++m]=c:(a[++m]=null,v.push({i:m,x:fs(s,c)})),r=Y0.lastIndex;return r<n.length&&(h=n.slice(r),a[m]?a[m]+=h:a[++m]=h),a.length<2?v[0]?eF(v[0].x):JL(n):(n=v.length,function(w){for(var E=0,I;E<n;++E)a[(I=v[E]).i]=I.x(w);return a.join("")})}function xx(e,n){var r=typeof n,s;return n==null||r==="boolean"?vx(n):(r==="number"?fs:r==="string"?(s=Uc(n))?(n=s,h_):xA:n instanceof Uc?h_:n instanceof Date?YL:XL(n)?HL:Array.isArray(n)?KL:typeof n.valueOf!="function"&&typeof n.toString!="function"||isNaN(n)?QL:fs)(e,n)}function tF(e,n){return e=+e,n=+n,function(r){return Math.round(e*(1-r)+n*r)}}var jT=180/Math.PI,Qy={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function bA(e,n,r,s,c,h){var m,a,v;return(m=Math.sqrt(e*e+n*n))&&(e/=m,n/=m),(v=e*r+n*s)&&(r-=e*v,s-=n*v),(a=Math.sqrt(r*r+s*s))&&(r/=a,s/=a,v/=a),e*s<n*r&&(e=-e,n=-n,v=-v,m=-m),{translateX:c,translateY:h,rotate:Math.atan2(n,e)*jT,skewX:Math.atan(v)*jT,scaleX:m,scaleY:a}}var km;function nF(e){const n=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return n.isIdentity?Qy:bA(n.a,n.b,n.c,n.d,n.e,n.f)}function rF(e){return e==null||(km||(km=document.createElementNS("http://www.w3.org/2000/svg","g")),km.setAttribute("transform",e),!(e=km.transform.baseVal.consolidate()))?Qy:(e=e.matrix,bA(e.a,e.b,e.c,e.d,e.e,e.f))}function wA(e,n,r,s){function c(w){return w.length?w.pop()+" ":""}function h(w,E,I,M,P,j){if(w!==I||E!==M){var N=P.push("translate(",null,n,null,r);j.push({i:N-4,x:fs(w,I)},{i:N-2,x:fs(E,M)})}else(I||M)&&P.push("translate("+I+n+M+r)}function m(w,E,I,M){w!==E?(w-E>180?E+=360:E-w>180&&(w+=360),M.push({i:I.push(c(I)+"rotate(",null,s)-2,x:fs(w,E)})):E&&I.push(c(I)+"rotate("+E+s)}function a(w,E,I,M){w!==E?M.push({i:I.push(c(I)+"skewX(",null,s)-2,x:fs(w,E)}):E&&I.push(c(I)+"skewX("+E+s)}function v(w,E,I,M,P,j){if(w!==I||E!==M){var N=P.push(c(P)+"scale(",null,",",null,")");j.push({i:N-4,x:fs(w,I)},{i:N-2,x:fs(E,M)})}else(I!==1||M!==1)&&P.push(c(P)+"scale("+I+","+M+")")}return function(w,E){var I=[],M=[];return w=e(w),E=e(E),h(w.translateX,w.translateY,E.translateX,E.translateY,I,M),m(w.rotate,E.rotate,I,M),a(w.skewX,E.skewX,I,M),v(w.scaleX,w.scaleY,E.scaleX,E.scaleY,I,M),w=E=null,function(P){for(var j=-1,N=M.length,q;++j<N;)I[(q=M[j]).i]=q.x(P);return I.join("")}}}var iF=wA(nF,"px, ","px)","deg)"),oF=wA(rF,", ",")",")"),Sh=0,ed=0,Zf=0,TA=1e3,f_,td,d_=0,Nc=0,Q_=0,Dd=typeof performance=="object"&&performance.now?performance:Date,EA=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function bx(){return Nc||(EA(sF),Nc=Dd.now()+Q_)}function sF(){Nc=0}function p_(){this._call=this._time=this._next=null}p_.prototype=SA.prototype={constructor:p_,restart:function(e,n,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?bx():+r)+(n==null?0:+n),!this._next&&td!==this&&(td?td._next=this:f_=this,td=this),this._call=e,this._time=r,Jy()},stop:function(){this._call&&(this._call=null,this._time=1/0,Jy())}};function SA(e,n,r){var s=new p_;return s.restart(e,n,r),s}function aF(){bx(),++Sh;for(var e=f_,n;e;)(n=Nc-e._time)>=0&&e._call.call(void 0,n),e=e._next;--Sh}function $T(){Nc=(d_=Dd.now())+Q_,Sh=ed=0;try{aF()}finally{Sh=0,cF(),Nc=0}}function lF(){var e=Dd.now(),n=e-d_;n>TA&&(Q_-=n,d_=e)}function cF(){for(var e,n=f_,r,s=1/0;n;)n._call?(s>n._time&&(s=n._time),e=n,n=n._next):(r=n._next,n._next=null,n=e?e._next=r:f_=r);td=e,Jy(s)}function Jy(e){if(!Sh){ed&&(ed=clearTimeout(ed));var n=e-Nc;n>24?(e<1/0&&(ed=setTimeout($T,e-Dd.now()-Q_)),Zf&&(Zf=clearInterval(Zf))):(Zf||(d_=Dd.now(),Zf=setInterval(lF,TA)),Sh=1,EA($T))}}function VT(e,n,r){var s=new p_;return n=n==null?0:+n,s.restart(c=>{s.stop(),e(c+n)},n,r),s}var uF=oA("start","end","cancel","interrupt"),hF=[],AA=0,GT=1,ev=2,Nm=3,qT=4,tv=5,jm=6;function J_(e,n,r,s,c,h){var m=e.__transition;if(!m)e.__transition={};else if(r in m)return;fF(e,r,{name:n,index:s,group:c,on:uF,tween:hF,time:h.time,delay:h.delay,duration:h.duration,ease:h.ease,timer:null,state:AA})}function wx(e,n){var r=_s(e,n);if(r.state>AA)throw new Error("too late; already scheduled");return r}function Xs(e,n){var r=_s(e,n);if(r.state>Nm)throw new Error("too late; already running");return r}function _s(e,n){var r=e.__transition;if(!r||!(r=r[n]))throw new Error("transition not found");return r}function fF(e,n,r){var s=e.__transition,c;s[n]=r,r.timer=SA(h,0,r.time);function h(w){r.state=GT,r.timer.restart(m,r.delay,r.time),r.delay<=w&&m(w-r.delay)}function m(w){var E,I,M,P;if(r.state!==GT)return v();for(E in s)if(P=s[E],P.name===r.name){if(P.state===Nm)return VT(m);P.state===qT?(P.state=jm,P.timer.stop(),P.on.call("interrupt",e,e.__data__,P.index,P.group),delete s[E]):+E<n&&(P.state=jm,P.timer.stop(),P.on.call("cancel",e,e.__data__,P.index,P.group),delete s[E])}if(VT(function(){r.state===Nm&&(r.state=qT,r.timer.restart(a,r.delay,r.time),a(w))}),r.state=ev,r.on.call("start",e,e.__data__,r.index,r.group),r.state===ev){for(r.state=Nm,c=new Array(M=r.tween.length),E=0,I=-1;E<M;++E)(P=r.tween[E].value.call(e,e.__data__,r.index,r.group))&&(c[++I]=P);c.length=I+1}}function a(w){for(var E=w<r.duration?r.ease.call(null,w/r.duration):(r.timer.restart(v),r.state=tv,1),I=-1,M=c.length;++I<M;)c[I].call(e,E);r.state===tv&&(r.on.call("end",e,e.__data__,r.index,r.group),v())}function v(){r.state=jm,r.timer.stop(),delete s[n];for(var w in s)return;delete e.__transition}}function dF(e,n){var r=e.__transition,s,c,h=!0,m;if(!!r){n=n==null?null:n+"";for(m in r){if((s=r[m]).name!==n){h=!1;continue}c=s.state>ev&&s.state<tv,s.state=jm,s.timer.stop(),s.on.call(c?"interrupt":"cancel",e,e.__data__,s.index,s.group),delete r[m]}h&&delete e.__transition}}function pF(e){return this.each(function(){dF(this,e)})}function mF(e,n){var r,s;return function(){var c=Xs(this,e),h=c.tween;if(h!==r){s=r=h;for(var m=0,a=s.length;m<a;++m)if(s[m].name===n){s=s.slice(),s.splice(m,1);break}}c.tween=s}}function _F(e,n,r){var s,c;if(typeof r!="function")throw new Error;return function(){var h=Xs(this,e),m=h.tween;if(m!==s){c=(s=m).slice();for(var a={name:n,value:r},v=0,w=c.length;v<w;++v)if(c[v].name===n){c[v]=a;break}v===w&&c.push(a)}h.tween=c}}function gF(e,n){var r=this._id;if(e+="",arguments.length<2){for(var s=_s(this.node(),r).tween,c=0,h=s.length,m;c<h;++c)if((m=s[c]).name===e)return m.value;return null}return this.each((n==null?mF:_F)(r,e,n))}function Tx(e,n,r){var s=e._id;return e.each(function(){var c=Xs(this,s);(c.value||(c.value={}))[n]=r.apply(this,arguments)}),function(c){return _s(c,s).value[n]}}function CA(e,n){var r;return(typeof n=="number"?fs:n instanceof Uc?h_:(r=Uc(n))?(n=r,h_):xA)(e,n)}function yF(e){return function(){this.removeAttribute(e)}}function vF(e){return function(){this.removeAttributeNS(e.space,e.local)}}function xF(e,n,r){var s,c=r+"",h;return function(){var m=this.getAttribute(e);return m===c?null:m===s?h:h=n(s=m,r)}}function bF(e,n,r){var s,c=r+"",h;return function(){var m=this.getAttributeNS(e.space,e.local);return m===c?null:m===s?h:h=n(s=m,r)}}function wF(e,n,r){var s,c,h;return function(){var m,a=r(this),v;return a==null?void this.removeAttribute(e):(m=this.getAttribute(e),v=a+"",m===v?null:m===s&&v===c?h:(c=v,h=n(s=m,a)))}}function TF(e,n,r){var s,c,h;return function(){var m,a=r(this),v;return a==null?void this.removeAttributeNS(e.space,e.local):(m=this.getAttributeNS(e.space,e.local),v=a+"",m===v?null:m===s&&v===c?h:(c=v,h=n(s=m,a)))}}function EF(e,n){var r=Y_(e),s=r==="transform"?oF:CA;return this.attrTween(e,typeof n=="function"?(r.local?TF:wF)(r,s,Tx(this,"attr."+e,n)):n==null?(r.local?vF:yF)(r):(r.local?bF:xF)(r,s,n))}function SF(e,n){return function(r){this.setAttribute(e,n.call(this,r))}}function AF(e,n){return function(r){this.setAttributeNS(e.space,e.local,n.call(this,r))}}function CF(e,n){var r,s;function c(){var h=n.apply(this,arguments);return h!==s&&(r=(s=h)&&AF(e,h)),r}return c._value=n,c}function IF(e,n){var r,s;function c(){var h=n.apply(this,arguments);return h!==s&&(r=(s=h)&&SF(e,h)),r}return c._value=n,c}function MF(e,n){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(n==null)return this.tween(r,null);if(typeof n!="function")throw new Error;var s=Y_(e);return this.tween(r,(s.local?CF:IF)(s,n))}function kF(e,n){return function(){wx(this,e).delay=+n.apply(this,arguments)}}function PF(e,n){return n=+n,function(){wx(this,e).delay=n}}function DF(e){var n=this._id;return arguments.length?this.each((typeof e=="function"?kF:PF)(n,e)):_s(this.node(),n).delay}function RF(e,n){return function(){Xs(this,e).duration=+n.apply(this,arguments)}}function zF(e,n){return n=+n,function(){Xs(this,e).duration=n}}function OF(e){var n=this._id;return arguments.length?this.each((typeof e=="function"?RF:zF)(n,e)):_s(this.node(),n).duration}function LF(e,n){if(typeof n!="function")throw new Error;return function(){Xs(this,e).ease=n}}function FF(e){var n=this._id;return arguments.length?this.each(LF(n,e)):_s(this.node(),n).ease}function BF(e,n){return function(){var r=n.apply(this,arguments);if(typeof r!="function")throw new Error;Xs(this,e).ease=r}}function UF(e){if(typeof e!="function")throw new Error;return this.each(BF(this._id,e))}function NF(e){typeof e!="function"&&(e=aA(e));for(var n=this._groups,r=n.length,s=new Array(r),c=0;c<r;++c)for(var h=n[c],m=h.length,a=s[c]=[],v,w=0;w<m;++w)(v=h[w])&&e.call(v,v.__data__,w,h)&&a.push(v);return new ga(s,this._parents,this._name,this._id)}function jF(e){if(e._id!==this._id)throw new Error;for(var n=this._groups,r=e._groups,s=n.length,c=r.length,h=Math.min(s,c),m=new Array(s),a=0;a<h;++a)for(var v=n[a],w=r[a],E=v.length,I=m[a]=new Array(E),M,P=0;P<E;++P)(M=v[P]||w[P])&&(I[P]=M);for(;a<s;++a)m[a]=n[a];return new ga(m,this._parents,this._name,this._id)}function $F(e){return(e+"").trim().split(/^|\s+/).every(function(n){var r=n.indexOf(".");return r>=0&&(n=n.slice(0,r)),!n||n==="start"})}function VF(e,n,r){var s,c,h=$F(n)?wx:Xs;return function(){var m=h(this,e),a=m.on;a!==s&&(c=(s=a).copy()).on(n,r),m.on=c}}function GF(e,n){var r=this._id;return arguments.length<2?_s(this.node(),r).on.on(e):this.each(VF(r,e,n))}function qF(e){return function(){var n=this.parentNode;for(var r in this.__transition)if(+r!==e)return;n&&n.removeChild(this)}}function ZF(){return this.on("end.remove",qF(this._id))}function WF(e){var n=this._name,r=this._id;typeof e!="function"&&(e=_x(e));for(var s=this._groups,c=s.length,h=new Array(c),m=0;m<c;++m)for(var a=s[m],v=a.length,w=h[m]=new Array(v),E,I,M=0;M<v;++M)(E=a[M])&&(I=e.call(E,E.__data__,M,a))&&("__data__"in E&&(I.__data__=E.__data__),w[M]=I,J_(w[M],n,r,M,w,_s(E,r)));return new ga(h,this._parents,n,r)}function HF(e){var n=this._name,r=this._id;typeof e!="function"&&(e=sA(e));for(var s=this._groups,c=s.length,h=[],m=[],a=0;a<c;++a)for(var v=s[a],w=v.length,E,I=0;I<w;++I)if(E=v[I]){for(var M=e.call(E,E.__data__,I,v),P,j=_s(E,r),N=0,q=M.length;N<q;++N)(P=M[N])&&J_(P,n,r,N,M,j);h.push(M),m.push(E)}return new ga(h,m,n,r)}var XF=Gd.prototype.constructor;function KF(){return new XF(this._groups,this._parents)}function YF(e,n){var r,s,c;return function(){var h=Eh(this,e),m=(this.style.removeProperty(e),Eh(this,e));return h===m?null:h===r&&m===s?c:c=n(r=h,s=m)}}function IA(e){return function(){this.style.removeProperty(e)}}function QF(e,n,r){var s,c=r+"",h;return function(){var m=Eh(this,e);return m===c?null:m===s?h:h=n(s=m,r)}}function JF(e,n,r){var s,c,h;return function(){var m=Eh(this,e),a=r(this),v=a+"";return a==null&&(v=a=(this.style.removeProperty(e),Eh(this,e))),m===v?null:m===s&&v===c?h:(c=v,h=n(s=m,a))}}function eB(e,n){var r,s,c,h="style."+n,m="end."+h,a;return function(){var v=Xs(this,e),w=v.on,E=v.value[h]==null?a||(a=IA(n)):void 0;(w!==r||c!==E)&&(s=(r=w).copy()).on(m,c=E),v.on=s}}function tB(e,n,r){var s=(e+="")=="transform"?iF:CA;return n==null?this.styleTween(e,YF(e,s)).on("end.style."+e,IA(e)):typeof n=="function"?this.styleTween(e,JF(e,s,Tx(this,"style."+e,n))).each(eB(this._id,e)):this.styleTween(e,QF(e,s,n),r).on("end.style."+e,null)}function nB(e,n,r){return function(s){this.style.setProperty(e,n.call(this,s),r)}}function rB(e,n,r){var s,c;function h(){var m=n.apply(this,arguments);return m!==c&&(s=(c=m)&&nB(e,m,r)),s}return h._value=n,h}function iB(e,n,r){var s="style."+(e+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(n==null)return this.tween(s,null);if(typeof n!="function")throw new Error;return this.tween(s,rB(e,n,r==null?"":r))}function oB(e){return function(){this.textContent=e}}function sB(e){return function(){var n=e(this);this.textContent=n==null?"":n}}function aB(e){return this.tween("text",typeof e=="function"?sB(Tx(this,"text",e)):oB(e==null?"":e+""))}function lB(e){return function(n){this.textContent=e.call(this,n)}}function cB(e){var n,r;function s(){var c=e.apply(this,arguments);return c!==r&&(n=(r=c)&&lB(c)),n}return s._value=e,s}function uB(e){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,cB(e))}function hB(){for(var e=this._name,n=this._id,r=MA(),s=this._groups,c=s.length,h=0;h<c;++h)for(var m=s[h],a=m.length,v,w=0;w<a;++w)if(v=m[w]){var E=_s(v,n);J_(v,e,r,w,m,{time:E.time+E.delay+E.duration,delay:0,duration:E.duration,ease:E.ease})}return new ga(s,this._parents,e,r)}function fB(){var e,n,r=this,s=r._id,c=r.size();return new Promise(function(h,m){var a={value:m},v={value:function(){--c===0&&h()}};r.each(function(){var w=Xs(this,s),E=w.on;E!==e&&(n=(e=E).copy(),n._.cancel.push(a),n._.interrupt.push(a),n._.end.push(v)),w.on=n}),c===0&&h()})}var dB=0;function ga(e,n,r,s){this._groups=e,this._parents=n,this._name=r,this._id=s}function MA(){return++dB}var ca=Gd.prototype;ga.prototype={constructor:ga,select:WF,selectAll:HF,selectChild:ca.selectChild,selectChildren:ca.selectChildren,filter:NF,merge:jF,selection:KF,transition:hB,call:ca.call,nodes:ca.nodes,node:ca.node,size:ca.size,empty:ca.empty,each:ca.each,on:GF,attr:EF,attrTween:MF,style:tB,styleTween:iB,text:aB,textTween:uB,remove:ZF,tween:gF,delay:DF,duration:OF,ease:FF,easeVarying:UF,end:fB,[Symbol.iterator]:ca[Symbol.iterator]};const W8=e=>+e;function pB(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var mB={time:null,delay:0,duration:250,ease:pB};function _B(e,n){for(var r;!(r=e.__transition)||!(r=r[n]);)if(!(e=e.parentNode))throw new Error(`transition ${n} not found`);return r}function gB(e){var n,r;e instanceof ga?(n=e._id,e=e._name):(n=MA(),(r=mB).time=bx(),e=e==null?null:e+"");for(var s=this._groups,c=s.length,h=0;h<c;++h)for(var m=s[h],a=m.length,v,w=0;w<a;++w)(v=m[w])&&J_(v,e,n,w,m,r||_B(v,n));return new ga(s,this._parents,e,n)}Gd.prototype.interrupt=pF;Gd.prototype.transition=gB;const nv=Math.PI,rv=2*nv,bc=1e-6,yB=rv-bc;function iv(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Ex(){return new iv}iv.prototype=Ex.prototype={constructor:iv,moveTo:function(e,n){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+n)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,n){this._+="L"+(this._x1=+e)+","+(this._y1=+n)},quadraticCurveTo:function(e,n,r,s){this._+="Q"+ +e+","+ +n+","+(this._x1=+r)+","+(this._y1=+s)},bezierCurveTo:function(e,n,r,s,c,h){this._+="C"+ +e+","+ +n+","+ +r+","+ +s+","+(this._x1=+c)+","+(this._y1=+h)},arcTo:function(e,n,r,s,c){e=+e,n=+n,r=+r,s=+s,c=+c;var h=this._x1,m=this._y1,a=r-e,v=s-n,w=h-e,E=m-n,I=w*w+E*E;if(c<0)throw new Error("negative radius: "+c);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=n);else if(I>bc)if(!(Math.abs(E*a-v*w)>bc)||!c)this._+="L"+(this._x1=e)+","+(this._y1=n);else{var M=r-h,P=s-m,j=a*a+v*v,N=M*M+P*P,q=Math.sqrt(j),V=Math.sqrt(I),ee=c*Math.tan((nv-Math.acos((j+I-N)/(2*q*V)))/2),oe=ee/V,pe=ee/q;Math.abs(oe-1)>bc&&(this._+="L"+(e+oe*w)+","+(n+oe*E)),this._+="A"+c+","+c+",0,0,"+ +(E*M>w*P)+","+(this._x1=e+pe*a)+","+(this._y1=n+pe*v)}},arc:function(e,n,r,s,c,h){e=+e,n=+n,r=+r,h=!!h;var m=r*Math.cos(s),a=r*Math.sin(s),v=e+m,w=n+a,E=1^h,I=h?s-c:c-s;if(r<0)throw new Error("negative radius: "+r);this._x1===null?this._+="M"+v+","+w:(Math.abs(this._x1-v)>bc||Math.abs(this._y1-w)>bc)&&(this._+="L"+v+","+w),!!r&&(I<0&&(I=I%rv+rv),I>yB?this._+="A"+r+","+r+",0,1,"+E+","+(e-m)+","+(n-a)+"A"+r+","+r+",0,1,"+E+","+(this._x1=v)+","+(this._y1=w):I>bc&&(this._+="A"+r+","+r+",0,"+ +(I>=nv)+","+E+","+(this._x1=e+r*Math.cos(c))+","+(this._y1=n+r*Math.sin(c))))},rect:function(e,n,r,s){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+n)+"h"+ +r+"v"+ +s+"h"+-r+"Z"},toString:function(){return this._}};var vB=Array.prototype,kA=vB.slice;function xB(e,n){return e-n}function bB(e){for(var n=0,r=e.length,s=e[r-1][1]*e[0][0]-e[r-1][0]*e[0][1];++n<r;)s+=e[n-1][1]*e[n][0]-e[n-1][0]*e[n][1];return s}var ul=e=>()=>e;function wB(e,n){for(var r=-1,s=n.length,c;++r<s;)if(c=TB(e,n[r]))return c;return 0}function TB(e,n){for(var r=n[0],s=n[1],c=-1,h=0,m=e.length,a=m-1;h<m;a=h++){var v=e[h],w=v[0],E=v[1],I=e[a],M=I[0],P=I[1];if(EB(v,I,n))return 0;E>s!=P>s&&r<(M-w)*(s-E)/(P-E)+w&&(c=-c)}return c}function EB(e,n,r){var s;return SB(e,n,r)&&AB(e[s=+(e[0]===n[0])],r[s],n[s])}function SB(e,n,r){return(n[0]-e[0])*(r[1]-e[1])===(r[0]-e[0])*(n[1]-e[1])}function AB(e,n,r){return e<=n&&n<=r||r<=n&&n<=e}function CB(){}var ua=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function IB(){var e=1,n=1,r=V5,s=v;function c(w){var E=r(w);if(Array.isArray(E))E=E.slice().sort(xB);else{const I=$5(w),M=px(I[0],I[1],E);E=nA(Math.floor(I[0]/M)*M,Math.floor(I[1]/M-1)*M,E)}return E.map(I=>h(w,I))}function h(w,E){var I=[],M=[];return m(w,E,function(P){s(P,w,E),bB(P)>0?I.push([P]):M.push(P)}),M.forEach(function(P){for(var j=0,N=I.length,q;j<N;++j)if(wB((q=I[j])[0],P)!==-1){q.push(P);return}}),{type:"MultiPolygon",value:E,coordinates:I}}function m(w,E,I){var M=new Array,P=new Array,j,N,q,V,ee,oe;for(j=N=-1,V=w[0]>=E,ua[V<<1].forEach(pe);++j<e-1;)q=V,V=w[j+1]>=E,ua[q|V<<1].forEach(pe);for(ua[V<<0].forEach(pe);++N<n-1;){for(j=-1,V=w[N*e+e]>=E,ee=w[N*e]>=E,ua[V<<1|ee<<2].forEach(pe);++j<e-1;)q=V,V=w[N*e+e+j+1]>=E,oe=ee,ee=w[N*e+j+1]>=E,ua[q|V<<1|ee<<2|oe<<3].forEach(pe);ua[V|ee<<3].forEach(pe)}for(j=-1,ee=w[N*e]>=E,ua[ee<<2].forEach(pe);++j<e-1;)oe=ee,ee=w[N*e+j+1]>=E,ua[ee<<2|oe<<3].forEach(pe);ua[ee<<3].forEach(pe);function pe(se){var xe=[se[0][0]+j,se[0][1]+N],Te=[se[1][0]+j,se[1][1]+N],De=a(xe),Me=a(Te),Be,ze;(Be=P[De])?(ze=M[Me])?(delete P[Be.end],delete M[ze.start],Be===ze?(Be.ring.push(Te),I(Be.ring)):M[Be.start]=P[ze.end]={start:Be.start,end:ze.end,ring:Be.ring.concat(ze.ring)}):(delete P[Be.end],Be.ring.push(Te),P[Be.end=Me]=Be):(Be=M[Me])?(ze=P[De])?(delete M[Be.start],delete P[ze.end],Be===ze?(Be.ring.push(Te),I(Be.ring)):M[ze.start]=P[Be.end]={start:ze.start,end:Be.end,ring:ze.ring.concat(Be.ring)}):(delete M[Be.start],Be.ring.unshift(xe),M[Be.start=De]=Be):M[De]=P[Me]={start:De,end:Me,ring:[xe,Te]}}}function a(w){return w[0]*2+w[1]*(e+1)*4}function v(w,E,I){w.forEach(function(M){var P=M[0],j=M[1],N=P|0,q=j|0,V,ee=E[q*e+N];P>0&&P<e&&N===P&&(V=E[q*e+N-1],M[0]=P+(I-V)/(ee-V)-.5),j>0&&j<n&&q===j&&(V=E[(q-1)*e+N],M[1]=j+(I-V)/(ee-V)-.5)})}return c.contour=h,c.size=function(w){if(!arguments.length)return[e,n];var E=Math.floor(w[0]),I=Math.floor(w[1]);if(!(E>=0&&I>=0))throw new Error("invalid size");return e=E,n=I,c},c.thresholds=function(w){return arguments.length?(r=typeof w=="function"?w:Array.isArray(w)?ul(kA.call(w)):ul(w),c):r},c.smooth=function(w){return arguments.length?(s=w?v:CB,c):s===v},c}function Q0(e,n,r){for(var s=e.width,c=e.height,h=(r<<1)+1,m=0;m<c;++m)for(var a=0,v=0;a<s+r;++a)a<s&&(v+=e.data[a+m*s]),a>=r&&(a>=h&&(v-=e.data[a-h+m*s]),n.data[a-r+m*s]=v/Math.min(a+1,s-1+h-a,h))}function J0(e,n,r){for(var s=e.width,c=e.height,h=(r<<1)+1,m=0;m<s;++m)for(var a=0,v=0;a<c+r;++a)a<c&&(v+=e.data[m+a*s]),a>=r&&(a>=h&&(v-=e.data[m+(a-h)*s]),n.data[m+(a-r)*s]=v/Math.min(a+1,c-1+h-a,h))}function MB(e){return e[0]}function kB(e){return e[1]}function PB(){return 1}function H8(){var e=MB,n=kB,r=PB,s=960,c=500,h=20,m=2,a=h*3,v=s+a*2>>m,w=c+a*2>>m,E=ul(20);function I(V){var ee=new Float32Array(v*w),oe=new Float32Array(v*w),pe=Math.pow(2,-m);V.forEach(function(Te,De,Me){var Be=(e(Te,De,Me)+a)*pe,ze=(n(Te,De,Me)+a)*pe,Fe=+r(Te,De,Me);if(Be>=0&&Be<v&&ze>=0&&ze<w){var Je=Math.floor(Be),be=Math.floor(ze),qe=Be-Je-.5,Ke=ze-be-.5;ee[Je+be*v]+=(1-qe)*(1-Ke)*Fe,ee[Je+1+be*v]+=qe*(1-Ke)*Fe,ee[Je+1+(be+1)*v]+=qe*Ke*Fe,ee[Je+(be+1)*v]+=(1-qe)*Ke*Fe}}),Q0({width:v,height:w,data:ee},{width:v,height:w,data:oe},h>>m),J0({width:v,height:w,data:oe},{width:v,height:w,data:ee},h>>m),Q0({width:v,height:w,data:ee},{width:v,height:w,data:oe},h>>m),J0({width:v,height:w,data:oe},{width:v,height:w,data:ee},h>>m),Q0({width:v,height:w,data:ee},{width:v,height:w,data:oe},h>>m),J0({width:v,height:w,data:oe},{width:v,height:w,data:ee},h>>m);var se=E(ee);if(!Array.isArray(se)){var xe=G5(ee);se=px(0,xe,se),se=q5(0,Math.floor(xe/se)*se,se),se.shift()}return IB().thresholds(se).size([v,w])(ee).map(M)}function M(V){return V.value*=Math.pow(2,-2*m),V.coordinates.forEach(P),V}function P(V){V.forEach(j)}function j(V){V.forEach(N)}function N(V){V[0]=V[0]*Math.pow(2,m)-a,V[1]=V[1]*Math.pow(2,m)-a}function q(){return a=h*3,v=s+a*2>>m,w=c+a*2>>m,I}return I.x=function(V){return arguments.length?(e=typeof V=="function"?V:ul(+V),I):e},I.y=function(V){return arguments.length?(n=typeof V=="function"?V:ul(+V),I):n},I.weight=function(V){return arguments.length?(r=typeof V=="function"?V:ul(+V),I):r},I.size=function(V){if(!arguments.length)return[s,c];var ee=+V[0],oe=+V[1];if(!(ee>=0&&oe>=0))throw new Error("invalid size");return s=ee,c=oe,q()},I.cellSize=function(V){if(!arguments.length)return 1<<m;if(!((V=+V)>=1))throw new Error("invalid cell size");return m=Math.floor(Math.log(V)/Math.LN2),q()},I.thresholds=function(V){return arguments.length?(E=typeof V=="function"?V:Array.isArray(V)?ul(kA.call(V)):ul(V),I):E},I.bandwidth=function(V){if(!arguments.length)return Math.sqrt(h*(h+1));if(!((V=+V)>=0))throw new Error("invalid bandwidth");return h=Math.round((Math.sqrt(4*V*V+1)-1)/2),q()},I}function DB(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function m_(e,n){if((r=(e=n?e.toExponential(n-1):e.toExponential()).indexOf("e"))<0)return null;var r,s=e.slice(0,r);return[s.length>1?s[0]+s.slice(2):s,+e.slice(r+1)]}function Ah(e){return e=m_(Math.abs(e)),e?e[1]:NaN}function RB(e,n){return function(r,s){for(var c=r.length,h=[],m=0,a=e[0],v=0;c>0&&a>0&&(v+a+1>s&&(a=Math.max(1,s-v)),h.push(r.substring(c-=a,c+a)),!((v+=a+1)>s));)a=e[m=(m+1)%e.length];return h.reverse().join(n)}}function zB(e){return function(n){return n.replace(/[0-9]/g,function(r){return e[+r]})}}var OB=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function __(e){if(!(n=OB.exec(e)))throw new Error("invalid format: "+e);var n;return new Sx({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}__.prototype=Sx.prototype;function Sx(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Sx.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function LB(e){e:for(var n=e.length,r=1,s=-1,c;r<n;++r)switch(e[r]){case".":s=c=r;break;case"0":s===0&&(s=r),c=r;break;default:if(!+e[r])break e;s>0&&(s=0);break}return s>0?e.slice(0,s)+e.slice(c+1):e}var PA;function FB(e,n){var r=m_(e,n);if(!r)return e+"";var s=r[0],c=r[1],h=c-(PA=Math.max(-8,Math.min(8,Math.floor(c/3)))*3)+1,m=s.length;return h===m?s:h>m?s+new Array(h-m+1).join("0"):h>0?s.slice(0,h)+"."+s.slice(h):"0."+new Array(1-h).join("0")+m_(e,Math.max(0,n+h-1))[0]}function ZT(e,n){var r=m_(e,n);if(!r)return e+"";var s=r[0],c=r[1];return c<0?"0."+new Array(-c).join("0")+s:s.length>c+1?s.slice(0,c+1)+"."+s.slice(c+1):s+new Array(c-s.length+2).join("0")}var WT={"%":(e,n)=>(e*100).toFixed(n),b:e=>Math.round(e).toString(2),c:e=>e+"",d:DB,e:(e,n)=>e.toExponential(n),f:(e,n)=>e.toFixed(n),g:(e,n)=>e.toPrecision(n),o:e=>Math.round(e).toString(8),p:(e,n)=>ZT(e*100,n),r:ZT,s:FB,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function HT(e){return e}var XT=Array.prototype.map,KT=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function BB(e){var n=e.grouping===void 0||e.thousands===void 0?HT:RB(XT.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",s=e.currency===void 0?"":e.currency[1]+"",c=e.decimal===void 0?".":e.decimal+"",h=e.numerals===void 0?HT:zB(XT.call(e.numerals,String)),m=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"\u2212":e.minus+"",v=e.nan===void 0?"NaN":e.nan+"";function w(I){I=__(I);var M=I.fill,P=I.align,j=I.sign,N=I.symbol,q=I.zero,V=I.width,ee=I.comma,oe=I.precision,pe=I.trim,se=I.type;se==="n"?(ee=!0,se="g"):WT[se]||(oe===void 0&&(oe=12),pe=!0,se="g"),(q||M==="0"&&P==="=")&&(q=!0,M="0",P="=");var xe=N==="$"?r:N==="#"&&/[boxX]/.test(se)?"0"+se.toLowerCase():"",Te=N==="$"?s:/[%p]/.test(se)?m:"",De=WT[se],Me=/[defgprs%]/.test(se);oe=oe===void 0?6:/[gprs]/.test(se)?Math.max(1,Math.min(21,oe)):Math.max(0,Math.min(20,oe));function Be(ze){var Fe=xe,Je=Te,be,qe,Ke;if(se==="c")Je=De(ze)+Je,ze="";else{ze=+ze;var _t=ze<0||1/ze<0;if(ze=isNaN(ze)?v:De(Math.abs(ze),oe),pe&&(ze=LB(ze)),_t&&+ze==0&&j!=="+"&&(_t=!1),Fe=(_t?j==="("?j:a:j==="-"||j==="("?"":j)+Fe,Je=(se==="s"?KT[8+PA/3]:"")+Je+(_t&&j==="("?")":""),Me){for(be=-1,qe=ze.length;++be<qe;)if(Ke=ze.charCodeAt(be),48>Ke||Ke>57){Je=(Ke===46?c+ze.slice(be+1):ze.slice(be))+Je,ze=ze.slice(0,be);break}}}ee&&!q&&(ze=n(ze,1/0));var It=Fe.length+ze.length+Je.length,Tt=It<V?new Array(V-It+1).join(M):"";switch(ee&&q&&(ze=n(Tt+ze,Tt.length?V-Je.length:1/0),Tt=""),P){case"<":ze=Fe+ze+Je+Tt;break;case"=":ze=Fe+Tt+ze+Je;break;case"^":ze=Tt.slice(0,It=Tt.length>>1)+Fe+ze+Je+Tt.slice(It);break;default:ze=Tt+Fe+ze+Je;break}return h(ze)}return Be.toString=function(){return I+""},Be}function E(I,M){var P=w((I=__(I),I.type="f",I)),j=Math.max(-8,Math.min(8,Math.floor(Ah(M)/3)))*3,N=Math.pow(10,-j),q=KT[8+j/3];return function(V){return P(N*V)+q}}return{format:w,formatPrefix:E}}var Pm,DA,RA;UB({thousands:",",grouping:[3],currency:["$",""]});function UB(e){return Pm=BB(e),DA=Pm.format,RA=Pm.formatPrefix,Pm}function NB(e){return Math.max(0,-Ah(Math.abs(e)))}function jB(e,n){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ah(n)/3)))*3-Ah(Math.abs(e)))}function $B(e,n){return e=Math.abs(e),n=Math.abs(n)-e,Math.max(0,Ah(n)-Ah(e))+1}var VB=Math.PI,GB=VB*2,qB=Math.abs,Ax=Math.sqrt;function ps(){}function g_(e,n){e&&QT.hasOwnProperty(e.type)&&QT[e.type](e,n)}var YT={Feature:function(e,n){g_(e.geometry,n)},FeatureCollection:function(e,n){for(var r=e.features,s=-1,c=r.length;++s<c;)g_(r[s].geometry,n)}},QT={Sphere:function(e,n){n.sphere()},Point:function(e,n){e=e.coordinates,n.point(e[0],e[1],e[2])},MultiPoint:function(e,n){for(var r=e.coordinates,s=-1,c=r.length;++s<c;)e=r[s],n.point(e[0],e[1],e[2])},LineString:function(e,n){ov(e.coordinates,n,0)},MultiLineString:function(e,n){for(var r=e.coordinates,s=-1,c=r.length;++s<c;)ov(r[s],n,0)},Polygon:function(e,n){JT(e.coordinates,n)},MultiPolygon:function(e,n){for(var r=e.coordinates,s=-1,c=r.length;++s<c;)JT(r[s],n)},GeometryCollection:function(e,n){for(var r=e.geometries,s=-1,c=r.length;++s<c;)g_(r[s],n)}};function ov(e,n,r){var s=-1,c=e.length-r,h;for(n.lineStart();++s<c;)h=e[s],n.point(h[0],h[1],h[2]);n.lineEnd()}function JT(e,n){var r=-1,s=e.length;for(n.polygonStart();++r<s;)ov(e[r],n,1);n.polygonEnd()}function Wf(e,n){e&&YT.hasOwnProperty(e.type)?YT[e.type](e,n):g_(e,n)}var ZB=e=>e,ey=new Th,sv=new Th,zA,OA,av,lv,hl={point:ps,lineStart:ps,lineEnd:ps,polygonStart:function(){hl.lineStart=WB,hl.lineEnd=XB},polygonEnd:function(){hl.lineStart=hl.lineEnd=hl.point=ps,ey.add(qB(sv)),sv=new Th},result:function(){var e=ey/2;return ey=new Th,e}};function WB(){hl.point=HB}function HB(e,n){hl.point=LA,zA=av=e,OA=lv=n}function LA(e,n){sv.add(lv*e-av*n),av=e,lv=n}function XB(){LA(zA,OA)}var e2=hl,Ch=1/0,y_=Ch,Rd=-Ch,v_=Rd,KB={point:YB,lineStart:ps,lineEnd:ps,polygonStart:ps,polygonEnd:ps,result:function(){var e=[[Ch,y_],[Rd,v_]];return Rd=v_=-(y_=Ch=1/0),e}};function YB(e,n){e<Ch&&(Ch=e),e>Rd&&(Rd=e),n<y_&&(y_=n),n>v_&&(v_=n)}var t2=KB,cv=0,uv=0,nd=0,x_=0,b_=0,sh=0,hv=0,fv=0,rd=0,FA,BA,$s,Vs,ds={point:jc,lineStart:n2,lineEnd:r2,polygonStart:function(){ds.lineStart=e4,ds.lineEnd=t4},polygonEnd:function(){ds.point=jc,ds.lineStart=n2,ds.lineEnd=r2},result:function(){var e=rd?[hv/rd,fv/rd]:sh?[x_/sh,b_/sh]:nd?[cv/nd,uv/nd]:[NaN,NaN];return cv=uv=nd=x_=b_=sh=hv=fv=rd=0,e}};function jc(e,n){cv+=e,uv+=n,++nd}function n2(){ds.point=QB}function QB(e,n){ds.point=JB,jc($s=e,Vs=n)}function JB(e,n){var r=e-$s,s=n-Vs,c=Ax(r*r+s*s);x_+=c*($s+e)/2,b_+=c*(Vs+n)/2,sh+=c,jc($s=e,Vs=n)}function r2(){ds.point=jc}function e4(){ds.point=n4}function t4(){UA(FA,BA)}function n4(e,n){ds.point=UA,jc(FA=$s=e,BA=Vs=n)}function UA(e,n){var r=e-$s,s=n-Vs,c=Ax(r*r+s*s);x_+=c*($s+e)/2,b_+=c*(Vs+n)/2,sh+=c,c=Vs*e-$s*n,hv+=c*($s+e),fv+=c*(Vs+n),rd+=c*3,jc($s=e,Vs=n)}var i2=ds;function NA(e){this._context=e}NA.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,n){switch(this._point){case 0:{this._context.moveTo(e,n),this._point=1;break}case 1:{this._context.lineTo(e,n);break}default:{this._context.moveTo(e+this._radius,n),this._context.arc(e,n,this._radius,0,GB);break}}},result:ps};var dv=new Th,ty,jA,$A,id,od,w_={point:ps,lineStart:function(){w_.point=r4},lineEnd:function(){ty&&VA(jA,$A),w_.point=ps},polygonStart:function(){ty=!0},polygonEnd:function(){ty=null},result:function(){var e=+dv;return dv=new Th,e}};function r4(e,n){w_.point=VA,jA=id=e,$A=od=n}function VA(e,n){id-=e,od-=n,dv.add(Ax(id*id+od*od)),id=e,od=n}var o2=w_;function GA(){this._string=[]}GA.prototype={_radius:4.5,_circle:s2(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(e,n){switch(this._point){case 0:{this._string.push("M",e,",",n),this._point=1;break}case 1:{this._string.push("L",e,",",n);break}default:{this._circle==null&&(this._circle=s2(this._radius)),this._string.push("M",e,",",n,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}else return null}};function s2(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function X8(e,n){var r=4.5,s,c;function h(m){return m&&(typeof r=="function"&&c.pointRadius(+r.apply(this,arguments)),Wf(m,s(c))),c.result()}return h.area=function(m){return Wf(m,s(e2)),e2.result()},h.measure=function(m){return Wf(m,s(o2)),o2.result()},h.bounds=function(m){return Wf(m,s(t2)),t2.result()},h.centroid=function(m){return Wf(m,s(i2)),i2.result()},h.projection=function(m){return arguments.length?(s=m==null?(e=null,ZB):(e=m).stream,h):e},h.context=function(m){return arguments.length?(c=m==null?(n=null,new GA):new NA(n=m),typeof r!="function"&&c.pointRadius(r),h):n},h.pointRadius=function(m){return arguments.length?(r=typeof m=="function"?m:(c.pointRadius(+m),+m),h):r},h.projection(e).context(n)}function i4(e,n){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(n).domain(e);break}return this}function o4(e){return function(){return e}}function s4(e){return+e}var a2=[0,1];function ah(e){return e}function pv(e,n){return(n-=e=+e)?function(r){return(r-e)/n}:o4(isNaN(n)?NaN:.5)}function a4(e,n){var r;return e>n&&(r=e,e=n,n=r),function(s){return Math.max(e,Math.min(n,s))}}function l4(e,n,r){var s=e[0],c=e[1],h=n[0],m=n[1];return c<s?(s=pv(c,s),h=r(m,h)):(s=pv(s,c),h=r(h,m)),function(a){return h(s(a))}}function c4(e,n,r){var s=Math.min(e.length,n.length)-1,c=new Array(s),h=new Array(s),m=-1;for(e[s]<e[0]&&(e=e.slice().reverse(),n=n.slice().reverse());++m<s;)c[m]=pv(e[m],e[m+1]),h[m]=r(n[m],n[m+1]);return function(a){var v=N5(e,a,1,s)-1;return h[v](c[v](a))}}function u4(e,n){return n.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function h4(){var e=a2,n=a2,r=xx,s,c,h,m=ah,a,v,w;function E(){var M=Math.min(e.length,n.length);return m!==ah&&(m=a4(e[0],e[M-1])),a=M>2?c4:l4,v=w=null,I}function I(M){return M==null||isNaN(M=+M)?h:(v||(v=a(e.map(s),n,r)))(s(m(M)))}return I.invert=function(M){return m(c((w||(w=a(n,e.map(s),fs)))(M)))},I.domain=function(M){return arguments.length?(e=Array.from(M,s4),E()):e.slice()},I.range=function(M){return arguments.length?(n=Array.from(M),E()):n.slice()},I.rangeRound=function(M){return n=Array.from(M),r=tF,E()},I.clamp=function(M){return arguments.length?(m=M?!0:ah,E()):m!==ah},I.interpolate=function(M){return arguments.length?(r=M,E()):r},I.unknown=function(M){return arguments.length?(h=M,I):h},function(M,P){return s=M,c=P,E()}}function f4(){return h4()(ah,ah)}function d4(e,n,r,s){var c=px(e,n,r),h;switch(s=__(s==null?",f":s),s.type){case"s":{var m=Math.max(Math.abs(e),Math.abs(n));return s.precision==null&&!isNaN(h=jB(c,m))&&(s.precision=h),RA(s,m)}case"":case"e":case"g":case"p":case"r":{s.precision==null&&!isNaN(h=$B(c,Math.max(Math.abs(e),Math.abs(n))))&&(s.precision=h-(s.type==="e"));break}case"f":case"%":{s.precision==null&&!isNaN(h=NB(c))&&(s.precision=h-(s.type==="%")*2);break}}return DA(s)}function p4(e){var n=e.domain;return e.ticks=function(r){var s=n();return nA(s[0],s[s.length-1],r==null?10:r)},e.tickFormat=function(r,s){var c=n();return d4(c[0],c[c.length-1],r==null?10:r,s)},e.nice=function(r){r==null&&(r=10);var s=n(),c=0,h=s.length-1,m=s[c],a=s[h],v,w,E=10;for(a<m&&(w=m,m=a,a=w,w=c,c=h,h=w);E-- >0;){if(w=rA(m,a,r),w===v)return s[c]=m,s[h]=a,n(s);if(w>0)m=Math.floor(m/w)*w,a=Math.ceil(a/w)*w;else if(w<0)m=Math.ceil(m*w)/w,a=Math.floor(a*w)/w;else break;v=w}return e},e}function m4(){var e=f4();return e.copy=function(){return u4(e,m4())},i4.apply(e,arguments),p4(e)}function Qr(e){return function(){return e}}function qA(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ZA(e){this._context=e}ZA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;default:this._context.lineTo(e,n);break}}};function WA(e){return new ZA(e)}function HA(e){return e[0]}function XA(e){return e[1]}function _4(e,n){var r=Qr(!0),s=null,c=WA,h=null;e=typeof e=="function"?e:e===void 0?HA:Qr(e),n=typeof n=="function"?n:n===void 0?XA:Qr(n);function m(a){var v,w=(a=qA(a)).length,E,I=!1,M;for(s==null&&(h=c(M=Ex())),v=0;v<=w;++v)!(v<w&&r(E=a[v],v,a))===I&&((I=!I)?h.lineStart():h.lineEnd()),I&&h.point(+e(E,v,a),+n(E,v,a));if(M)return h=null,M+""||null}return m.x=function(a){return arguments.length?(e=typeof a=="function"?a:Qr(+a),m):e},m.y=function(a){return arguments.length?(n=typeof a=="function"?a:Qr(+a),m):n},m.defined=function(a){return arguments.length?(r=typeof a=="function"?a:Qr(!!a),m):r},m.curve=function(a){return arguments.length?(c=a,s!=null&&(h=c(s)),m):c},m.context=function(a){return arguments.length?(a==null?s=h=null:h=c(s=a),m):s},m}function K8(e,n,r){var s=null,c=Qr(!0),h=null,m=WA,a=null;e=typeof e=="function"?e:e===void 0?HA:Qr(+e),n=typeof n=="function"?n:Qr(n===void 0?0:+n),r=typeof r=="function"?r:r===void 0?XA:Qr(+r);function v(E){var I,M,P,j=(E=qA(E)).length,N,q=!1,V,ee=new Array(j),oe=new Array(j);for(h==null&&(a=m(V=Ex())),I=0;I<=j;++I){if(!(I<j&&c(N=E[I],I,E))===q)if(q=!q)M=I,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),P=I-1;P>=M;--P)a.point(ee[P],oe[P]);a.lineEnd(),a.areaEnd()}q&&(ee[I]=+e(N,I,E),oe[I]=+n(N,I,E),a.point(s?+s(N,I,E):ee[I],r?+r(N,I,E):oe[I]))}if(V)return a=null,V+""||null}function w(){return _4().defined(c).curve(m).context(h)}return v.x=function(E){return arguments.length?(e=typeof E=="function"?E:Qr(+E),s=null,v):e},v.x0=function(E){return arguments.length?(e=typeof E=="function"?E:Qr(+E),v):e},v.x1=function(E){return arguments.length?(s=E==null?null:typeof E=="function"?E:Qr(+E),v):s},v.y=function(E){return arguments.length?(n=typeof E=="function"?E:Qr(+E),r=null,v):n},v.y0=function(E){return arguments.length?(n=typeof E=="function"?E:Qr(+E),v):n},v.y1=function(E){return arguments.length?(r=E==null?null:typeof E=="function"?E:Qr(+E),v):r},v.lineX0=v.lineY0=function(){return w().x(e).y(n)},v.lineY1=function(){return w().x(e).y(r)},v.lineX1=function(){return w().x(s).y(n)},v.defined=function(E){return arguments.length?(c=typeof E=="function"?E:Qr(!!E),v):c},v.curve=function(E){return arguments.length?(m=E,h!=null&&(a=m(h)),v):m},v.context=function(E){return arguments.length?(E==null?h=a=null:a=m(h=E),v):h},v}function $c(e){return rD()?(iD(e),!0):!1}const T_=typeof window!="undefined",g4=e=>typeof e=="string",l2=()=>+Date.now(),mh=()=>{};function y4(e,n){function r(...s){e(()=>n.apply(this,s),{fn:n,thisArg:this,args:s})}return r}const v4=e=>e();function x4(e,n){var r;if(typeof e=="number")return e+n;const s=((r=e.match(/^-?[0-9]+\.?[0-9]*/))==null?void 0:r[0])||"",c=e.slice(s.length),h=parseFloat(s)+n;return Number.isNaN(h)?e:h+c}var c2=Object.getOwnPropertySymbols,b4=Object.prototype.hasOwnProperty,w4=Object.prototype.propertyIsEnumerable,T4=(e,n)=>{var r={};for(var s in e)b4.call(e,s)&&n.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&c2)for(var s of c2(e))n.indexOf(s)<0&&w4.call(e,s)&&(r[s]=e[s]);return r};function E4(e,n,r={}){const s=r,{eventFilter:c=v4}=s,h=T4(s,["eventFilter"]);return gi(e,y4(c,n),h)}function zd(e,n=!0){Cl()?cr(e):n?e():Yn(e)}function S4(e,n=1e3,r={}){const{immediate:s=!0,immediateCallback:c=!1}=r;let h=null;const m=ft(!1);function a(){h&&(clearInterval(h),h=null)}function v(){m.value=!1,a()}function w(){n<=0||(m.value=!0,c&&e(),a(),h=setInterval(e,qo(n)))}if(s&&T_&&w(),Ar(n)){const E=gi(n,()=>{s&&T_&&w()});$c(E)}return $c(v),{isActive:m,pause:v,resume:w}}function Y8(e=!1){if(Ar(e))return n=>{e.value=typeof n=="boolean"?n:!e.value};{const n=ft(e);return[n,s=>{n.value=typeof s=="boolean"?s:!n.value}]}}function zc(e){var n;const r=qo(e);return(n=r==null?void 0:r.$el)!=null?n:r}const ro=T_?window:void 0;function Vc(...e){let n,r,s,c;if(g4(e[0])?([r,s,c]=e,n=ro):[n,r,s,c]=e,!n)return mh;let h=mh;const m=gi(()=>qo(n),v=>{h(),!!v&&(v.addEventListener(r,s,c),h=()=>{v.removeEventListener(r,s,c),h=mh})},{immediate:!0,flush:"post"}),a=()=>{m(),h()};return $c(a),a}function Q8(e,n,r={}){const{window:s=ro,ignore:c}=r;if(!s)return;const h=ft(!0),a=[Vc(s,"click",w=>{const E=zc(e),I=w.composedPath();!E||E===w.target||I.includes(E)||!h.value||c&&c.length>0&&c.some(M=>{const P=zc(M);return P&&(w.target===P||I.includes(P))})||n(w)},{passive:!0,capture:!0}),Vc(s,"pointerdown",w=>{const E=zc(e);h.value=!!E&&!w.composedPath().includes(E)},{passive:!0})];return()=>a.forEach(w=>w())}const A4=e=>typeof e=="function"?e:typeof e=="string"?n=>n.key===e:Array.isArray(e)?n=>e.includes(n.key):e?()=>!0:()=>!1;function J8(e,n,r={}){const{target:s=ro,eventName:c="keydown",passive:h=!1}=r,m=A4(e);return Vc(s,c,v=>{m(v)&&n(v)},h)}function $m(e,n={}){const{window:r=ro}=n;let s;const c=ft(!1),h=()=>{!r||(s||(s=r.matchMedia(e)),c.value=s.matches)};return zd(()=>{h(),!!s&&("addEventListener"in s?s.addEventListener("change",h):s.addListener(h),$c(()=>{"removeEventListener"in h?s.removeEventListener("change",h):s.removeListener(h)}))}),c}const ej={sm:640,md:768,lg:1024,xl:1280,"2xl":1536};var C4=Object.defineProperty,u2=Object.getOwnPropertySymbols,I4=Object.prototype.hasOwnProperty,M4=Object.prototype.propertyIsEnumerable,h2=(e,n,r)=>n in e?C4(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r,k4=(e,n)=>{for(var r in n||(n={}))I4.call(n,r)&&h2(e,r,n[r]);if(u2)for(var r of u2(n))M4.call(n,r)&&h2(e,r,n[r]);return e};function tj(e,n={}){function r(a,v){let w=e[a];return v!=null&&(w=x4(w,v)),typeof w=="number"&&(w=`${w}px`),w}const{window:s=ro}=n;function c(a){return s?s.matchMedia(a).matches:!1}const h=a=>$m(`(min-width: ${r(a)})`,n),m=Object.keys(e).reduce((a,v)=>(Object.defineProperty(a,v,{get:()=>h(v),enumerable:!0,configurable:!0}),a),{});return k4({greater:h,smaller(a){return $m(`(max-width: ${r(a,-.1)})`,n)},between(a,v){return $m(`(min-width: ${r(a)}) and (max-width: ${r(v,-.1)})`,n)},isGreater(a){return c(`(min-width: ${r(a)})`)},isSmaller(a){return c(`(max-width: ${r(a,-.1)})`)},isInBetween(a,v){return c(`(min-width: ${r(a)}) and (max-width: ${r(v,-.1)})`)}},m)}const mv=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},_v="__vueuse_ssr_handlers__";mv[_v]=mv[_v]||{};const P4=mv[_v];function KA(e,n){return P4[e]||n}function D4(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"||Array.isArray(e)?"object":Number.isNaN(e)?"any":"number"}const R4={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))}};function z4(e,n,r,s={}){var c;const{flush:h="pre",deep:m=!0,listenToStorageChanges:a=!0,writeDefaults:v=!0,shallow:w,window:E=ro,eventFilter:I,onError:M=ee=>{console.error(ee)}}=s,P=qo(n),j=D4(P),N=(w?ME:ft)(n),q=(c=s.serializer)!=null?c:R4[j];if(!r)try{r=KA("getDefaultStorage",()=>{var ee;return(ee=ro)==null?void 0:ee.localStorage})()}catch(ee){M(ee)}function V(ee){if(!(!r||ee&&ee.key!==e))try{const oe=ee?ee.newValue:r.getItem(e);oe==null?(N.value=P,v&&P!==null&&r.setItem(e,q.write(P))):typeof oe!="string"?N.value=oe:N.value=q.read(oe)}catch(oe){M(oe)}}return V(),E&&a&&Vc(E,"storage",ee=>setTimeout(()=>V(ee),0)),r&&E4(N,()=>{try{N.value==null?r.removeItem(e):r.setItem(e,q.write(N.value))}catch(ee){M(ee)}},{flush:h,deep:m,eventFilter:I}),N}function YA(e){return $m("(prefers-color-scheme: dark)",e)}var O4=Object.defineProperty,f2=Object.getOwnPropertySymbols,L4=Object.prototype.hasOwnProperty,F4=Object.prototype.propertyIsEnumerable,d2=(e,n,r)=>n in e?O4(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r,B4=(e,n)=>{for(var r in n||(n={}))L4.call(n,r)&&d2(e,r,n[r]);if(f2)for(var r of f2(n))F4.call(n,r)&&d2(e,r,n[r]);return e};function U4(e={}){const{selector:n="html",attribute:r="class",window:s=ro,storage:c,storageKey:h="vueuse-color-scheme",listenToStorageChanges:m=!0,storageRef:a}=e,v=B4({auto:"",light:"light",dark:"dark"},e.modes||{}),w=YA({window:s}),E=Et(()=>w.value?"dark":"light"),I=a||(h==null?ft("auto"):z4(h,"auto",c,{window:s,listenToStorageChanges:m})),M=Et({get(){return I.value==="auto"?E.value:I.value},set(q){I.value=q}}),P=KA("updateHTMLAttrs",(q,V,ee)=>{const oe=s==null?void 0:s.document.querySelector(q);if(!!oe)if(V==="class"){const pe=ee.split(/\s/g);Object.values(v).flatMap(se=>(se||"").split(/\s/g)).filter(Boolean).forEach(se=>{pe.includes(se)?oe.classList.add(se):oe.classList.remove(se)})}else oe.setAttribute(V,ee)});function j(q){var V;P(n,r,(V=v[q])!=null?V:q)}function N(q){e.onChanged?e.onChanged(q,j):j(q)}return gi(M,N,{flush:"post",immediate:!0}),zd(()=>N(M.value)),M}var N4=Object.defineProperty,j4=Object.defineProperties,$4=Object.getOwnPropertyDescriptors,p2=Object.getOwnPropertySymbols,V4=Object.prototype.hasOwnProperty,G4=Object.prototype.propertyIsEnumerable,m2=(e,n,r)=>n in e?N4(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r,q4=(e,n)=>{for(var r in n||(n={}))V4.call(n,r)&&m2(e,r,n[r]);if(p2)for(var r of p2(n))G4.call(n,r)&&m2(e,r,n[r]);return e},Z4=(e,n)=>j4(e,$4(n));function nj(e={}){const{valueDark:n="dark",valueLight:r="",window:s=ro}=e,c=U4(Z4(q4({},e),{onChanged:(a,v)=>{var w;e.onChanged?(w=e.onChanged)==null||w.call(e,a==="dark"):v(a)},modes:{dark:n,light:r}})),h=YA({window:s});return Et({get(){return c.value==="dark"},set(a){a===h.value?c.value="auto":c.value=a?"dark":"light"}})}var _2=Object.getOwnPropertySymbols,W4=Object.prototype.hasOwnProperty,H4=Object.prototype.propertyIsEnumerable,X4=(e,n)=>{var r={};for(var s in e)W4.call(e,s)&&n.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&_2)for(var s of _2(e))n.indexOf(s)<0&&H4.call(e,s)&&(r[s]=e[s]);return r};function K4(e,n,r={}){const s=r,{window:c=ro}=s,h=X4(s,["window"]);let m;const a=c&&"ResizeObserver"in c,v=()=>{m&&(m.disconnect(),m=void 0)},w=gi(()=>zc(e),I=>{v(),a&&c&&I&&(m=new c.ResizeObserver(n),m.observe(I,h))},{immediate:!0,flush:"post"}),E=()=>{v(),w()};return $c(E),{isSupported:a,stop:E}}function rj(e){const n=ft(0),r=ft(0),s=ft(0),c=ft(0),h=ft(0),m=ft(0),a=ft(0),v=ft(0);function w(){const E=zc(e);if(!E){n.value=0,r.value=0,s.value=0,c.value=0,h.value=0,m.value=0,a.value=0,v.value=0;return}const I=E.getBoundingClientRect();n.value=I.height,r.value=I.bottom,s.value=I.left,c.value=I.right,h.value=I.top,m.value=I.width,a.value=I.x,v.value=I.y}return Vc("scroll",w,!0),K4(e,w),{height:n,bottom:r,left:s,right:c,top:h,width:m,x:a,y:v,update:w}}function Y4(e,n={}){const{immediate:r=!0,window:s=ro}=n,c=ft(!1);function h(){!c.value||!s||(e(),s.requestAnimationFrame(h))}function m(){!c.value&&s&&(c.value=!0,h())}function a(){c.value=!1}return r&&m(),$c(a),{isActive:c,pause:a,resume:m}}function ij(e,{window:n=ro,scrollTarget:r}={}){const s=ft(!1),c=()=>{if(!n)return;const h=n.document;if(!e.value)s.value=!1;else{const m=e.value.getBoundingClientRect();s.value=m.top<=(n.innerHeight||h.documentElement.clientHeight)&&m.left<=(n.innerWidth||h.documentElement.clientWidth)&&m.bottom>=0&&m.right>=0}};return zd(c),n&&zd(()=>Vc((r==null?void 0:r.value)||n,"scroll",c,{capture:!1,passive:!0})),s}function oj(e,n,r={}){const{root:s,rootMargin:c="0px",threshold:h=.1,window:m=ro}=r,a=m&&"IntersectionObserver"in m;let v=mh;const w=a?gi(()=>({el:zc(e),root:zc(s)}),({el:I,root:M})=>{if(v(),!I)return;const P=new m.IntersectionObserver(n,{root:M,rootMargin:c,threshold:h});P.observe(I),v=()=>{P.disconnect(),v=mh}},{immediate:!0,flush:"post"}):mh,E=()=>{v(),w()};return $c(E),{isSupported:a,stop:E}}var g2,y2;T_&&(window==null?void 0:window.navigator)&&((g2=window==null?void 0:window.navigator)==null?void 0:g2.platform)&&/iP(ad|hone|od)/.test((y2=window==null?void 0:window.navigator)==null?void 0:y2.platform);var Q4=Object.defineProperty,v2=Object.getOwnPropertySymbols,J4=Object.prototype.hasOwnProperty,e6=Object.prototype.propertyIsEnumerable,x2=(e,n,r)=>n in e?Q4(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r,t6=(e,n)=>{for(var r in n||(n={}))J4.call(n,r)&&x2(e,r,n[r]);if(v2)for(var r of v2(n))e6.call(n,r)&&x2(e,r,n[r]);return e};const n6={top:0,left:0,bottom:0,right:0,height:0,width:0};t6({text:""},n6);var r6=Object.defineProperty,b2=Object.getOwnPropertySymbols,i6=Object.prototype.hasOwnProperty,o6=Object.prototype.propertyIsEnumerable,w2=(e,n,r)=>n in e?r6(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r,s6=(e,n)=>{for(var r in n||(n={}))i6.call(n,r)&&w2(e,r,n[r]);if(b2)for(var r of b2(n))o6.call(n,r)&&w2(e,r,n[r]);return e};function sj(e={}){const{controls:n=!1,offset:r=0,immediate:s=!0,interval:c="requestAnimationFrame"}=e,h=ft(l2()+r),m=()=>h.value=l2()+r,a=c==="requestAnimationFrame"?Y4(m,{immediate:s}):S4(m,c,{immediate:s});return n?s6({timestamp:h},a):h}function aj({window:e=ro,initialWidth:n=1/0,initialHeight:r=1/0}={}){const s=ft(n),c=ft(r),h=()=>{e&&(s.value=e.innerWidth,c.value=e.innerHeight)};return h(),zd(h),Vc("resize",h,{passive:!0}),{width:s,height:c}}function fa(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QA(e,n){e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n}/*!
 * GSAP 3.9.1
 * https://greensock.com
 *
 * @license Copyright 2008-2021, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var bo={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Ih={duration:.5,overwrite:!1,delay:0},Cx,$o=1e8,or=1/$o,gv=Math.PI*2,a6=gv/4,l6=0,JA=Math.sqrt,c6=Math.cos,u6=Math.sin,oi=function(n){return typeof n=="string"},ri=function(n){return typeof n=="function"},ya=function(n){return typeof n=="number"},Ix=function(n){return typeof n=="undefined"},va=function(n){return typeof n=="object"},eo=function(n){return n!==!1},eC=function(){return typeof window!="undefined"},Dm=function(n){return ri(n)||oi(n)},tC=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},Ci=Array.isArray,yv=/(?:-?\.?\d|\.)+/gi,nC=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,lh=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,ny=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,rC=/[+-]=-?[.\d]+/,iC=/[^,'"\[\]\s]+/gi,h6=/[\d.+\-=]+(?:e[-+]\d*)*/i,Tr,Fs,vv,Mx,Eo={},E_={},oC,sC=function(n){return(E_=Mh(n,Eo))&&Hs},kx=function(n,r){return console.warn("Invalid property",n,"set to",r,"Missing plugin? gsap.registerPlugin()")},S_=function(n,r){return!r&&console.warn(n)},aC=function(n,r){return n&&(Eo[n]=r)&&E_&&(E_[n]=r)||Eo},Od=function(){return 0},Px={},yl=[],xv={},lC,mo={},ry={},T2=30,Vm=[],Dx="",Rx=function(n){var r=n[0],s,c;if(va(r)||ri(r)||(n=[n]),!(s=(r._gsap||{}).harness)){for(c=Vm.length;c--&&!Vm[c].targetTest(r););s=Vm[c]}for(c=n.length;c--;)n[c]&&(n[c]._gsap||(n[c]._gsap=new kC(n[c],s)))||n.splice(c,1);return n},Oc=function(n){return n._gsap||Rx(Vo(n))[0]._gsap},cC=function(n,r,s){return(s=n[r])&&ri(s)?n[r]():Ix(s)&&n.getAttribute&&n.getAttribute(r)||s},to=function(n,r){return(n=n.split(",")).forEach(r)||n},jr=function(n){return Math.round(n*1e5)/1e5||0},Ai=function(n){return Math.round(n*1e7)/1e7||0},f6=function(n,r){for(var s=r.length,c=0;n.indexOf(r[c])<0&&++c<s;);return c<s},A_=function(){var n=yl.length,r=yl.slice(0),s,c;for(xv={},yl.length=0,s=0;s<n;s++)c=r[s],c&&c._lazy&&(c.render(c._lazy[0],c._lazy[1],!0)._lazy=0)},uC=function(n,r,s,c){yl.length&&A_(),n.render(r,s,c),yl.length&&A_()},hC=function(n){var r=parseFloat(n);return(r||r===0)&&(n+"").match(iC).length<2?r:oi(n)?n.trim():n},fC=function(n){return n},Xo=function(n,r){for(var s in r)s in n||(n[s]=r[s]);return n},d6=function(n){return function(r,s){for(var c in s)c in r||c==="duration"&&n||c==="ease"||(r[c]=s[c])}},Mh=function(n,r){for(var s in r)n[s]=r[s];return n},E2=function e(n,r){for(var s in r)s!=="__proto__"&&s!=="constructor"&&s!=="prototype"&&(n[s]=va(r[s])?e(n[s]||(n[s]={}),r[s]):r[s]);return n},C_=function(n,r){var s={},c;for(c in n)c in r||(s[c]=n[c]);return s},gd=function(n){var r=n.parent||Tr,s=n.keyframes?d6(Ci(n.keyframes)):Xo;if(eo(n.inherit))for(;r;)s(n,r.vars.defaults),r=r.parent||r._dp;return n},p6=function(n,r){for(var s=n.length,c=s===r.length;c&&s--&&n[s]===r[s];);return s<0},m6=function(n,r,s,c,h){s===void 0&&(s="_first"),c===void 0&&(c="_last");var m=n[c],a;if(h)for(a=r[h];m&&m[h]>a;)m=m._prev;return m?(r._next=m._next,m._next=r):(r._next=n[s],n[s]=r),r._next?r._next._prev=r:n[c]=r,r._prev=m,r.parent=r._dp=n,r},eg=function(n,r,s,c){s===void 0&&(s="_first"),c===void 0&&(c="_last");var h=r._prev,m=r._next;h?h._next=m:n[s]===r&&(n[s]=m),m?m._prev=h:n[c]===r&&(n[c]=h),r._next=r._prev=r.parent=null},pa=function(n,r){n.parent&&(!r||n.parent.autoRemoveChildren)&&n.parent.remove(n),n._act=0},Lc=function(n,r){if(n&&(!r||r._end>n._dur||r._start<0))for(var s=n;s;)s._dirty=1,s=s.parent;return n},_6=function(n){for(var r=n.parent;r&&r.parent;)r._dirty=1,r.totalDuration(),r=r.parent;return n},g6=function e(n){return!n||n._ts&&e(n.parent)},S2=function(n){return n._repeat?kh(n._tTime,n=n.duration()+n._rDelay)*n:0},kh=function(n,r){var s=Math.floor(n/=r);return n&&s===n?s-1:s},I_=function(n,r){return(n-r._start)*r._ts+(r._ts>=0?0:r._dirty?r.totalDuration():r._tDur)},tg=function(n){return n._end=Ai(n._start+(n._tDur/Math.abs(n._ts||n._rts||or)||0))},dC=function(n,r){var s=n._dp;return s&&s.smoothChildTiming&&n._ts&&(n._start=Ai(s._time-(n._ts>0?r/n._ts:((n._dirty?n.totalDuration():n._tDur)-r)/-n._ts)),tg(n),s._dirty||Lc(s,n)),n},pC=function(n,r){var s;if((r._time||r._initted&&!r._dur)&&(s=I_(n.rawTime(),r),(!r._dur||Zd(0,r.totalDuration(),s)-r._tTime>or)&&r.render(s,!0)),Lc(n,r)._dp&&n._initted&&n._time>=n._dur&&n._ts){if(n._dur<n.duration())for(s=n;s._dp;)s.rawTime()>=0&&s.totalTime(s._tTime),s=s._dp;n._zTime=-or}},Gs=function(n,r,s,c){return r.parent&&pa(r),r._start=Ai((ya(s)?s:s||n!==Tr?Uo(n,s,r):n._time)+r._delay),r._end=Ai(r._start+(r.totalDuration()/Math.abs(r.timeScale())||0)),m6(n,r,"_first","_last",n._sort?"_start":0),bv(r)||(n._recent=r),c||pC(n,r),n},mC=function(n,r){return(Eo.ScrollTrigger||kx("scrollTrigger",r))&&Eo.ScrollTrigger.create(r,n)},_C=function(n,r,s,c){if(N6(n,r),!n._initted)return 1;if(!s&&n._pt&&(n._dur&&n.vars.lazy!==!1||!n._dur&&n.vars.lazy)&&lC!==jo.frame)return yl.push(n),n._lazy=[r,c],1},y6=function e(n){var r=n.parent;return r&&r._ts&&r._initted&&!r._lock&&(r.rawTime()<0||e(r))},bv=function(n){var r=n.data;return r==="isFromStart"||r==="isStart"},v6=function(n,r,s,c){var h=n.ratio,m=r<0||!r&&(!n._start&&y6(n)&&!(!n._initted&&bv(n))||(n._ts<0||n._dp._ts<0)&&!bv(n))?0:1,a=n._rDelay,v=0,w,E,I;if(a&&n._repeat&&(v=Zd(0,n._tDur,r),E=kh(v,a),n._yoyo&&E&1&&(m=1-m),E!==kh(n._tTime,a)&&(h=1-m,n.vars.repeatRefresh&&n._initted&&n.invalidate())),m!==h||c||n._zTime===or||!r&&n._zTime){if(!n._initted&&_C(n,r,c,s))return;for(I=n._zTime,n._zTime=r||(s?or:0),s||(s=r&&!I),n.ratio=m,n._from&&(m=1-m),n._time=0,n._tTime=v,w=n._pt;w;)w.r(m,w.d),w=w._next;n._startAt&&r<0&&n._startAt.render(r,!0,!0),n._onUpdate&&!s&&Go(n,"onUpdate"),v&&n._repeat&&!s&&n.parent&&Go(n,"onRepeat"),(r>=n._tDur||r<0)&&n.ratio===m&&(m&&pa(n,1),s||(Go(n,m?"onComplete":"onReverseComplete",!0),n._prom&&n._prom()))}else n._zTime||(n._zTime=r)},x6=function(n,r,s){var c;if(s>r)for(c=n._first;c&&c._start<=s;){if(c.data==="isPause"&&c._start>r)return c;c=c._next}else for(c=n._last;c&&c._start>=s;){if(c.data==="isPause"&&c._start<r)return c;c=c._prev}},Ph=function(n,r,s,c){var h=n._repeat,m=Ai(r)||0,a=n._tTime/n._tDur;return a&&!c&&(n._time*=m/n._dur),n._dur=m,n._tDur=h?h<0?1e10:Ai(m*(h+1)+n._rDelay*h):m,a>0&&!c?dC(n,n._tTime=n._tDur*a):n.parent&&tg(n),s||Lc(n.parent,n),n},A2=function(n){return n instanceof Ji?Lc(n):Ph(n,n._dur)},b6={_start:0,endTime:Od,totalDuration:Od},Uo=function e(n,r,s){var c=n.labels,h=n._recent||b6,m=n.duration()>=$o?h.endTime(!1):n._dur,a,v,w;return oi(r)&&(isNaN(r)||r in c)?(v=r.charAt(0),w=r.substr(-1)==="%",a=r.indexOf("="),v==="<"||v===">"?(a>=0&&(r=r.replace(/=/,"")),(v==="<"?h._start:h.endTime(h._repeat>=0))+(parseFloat(r.substr(1))||0)*(w?(a<0?h:s).totalDuration()/100:1)):a<0?(r in c||(c[r]=m),c[r]):(v=parseFloat(r.charAt(a-1)+r.substr(a+1)),w&&s&&(v=v/100*(Ci(s)?s[0]:s).totalDuration()),a>1?e(n,r.substr(0,a-1),s)+v:m+v)):r==null?m:+r},yd=function(n,r,s){var c=ya(r[1]),h=(c?2:1)+(n<2?0:1),m=r[h],a,v;if(c&&(m.duration=r[1]),m.parent=s,n){for(a=m,v=s;v&&!("immediateRender"in a);)a=v.vars.defaults||{},v=eo(v.vars.inherit)&&v.parent;m.immediateRender=eo(a.immediateRender),n<2?m.runBackwards=1:m.startAt=r[h-1]}return new Jr(r[0],m,r[h+1])},Il=function(n,r){return n||n===0?r(n):r},Zd=function(n,r,s){return s<n?n:s>r?r:s},Qi=function(n,r){return!oi(n)||!(r=h6.exec(n))?"":n.substr(r.index+r[0].length)},w6=function(n,r,s){return Il(s,function(c){return Zd(n,r,c)})},wv=[].slice,gC=function(n,r){return n&&va(n)&&"length"in n&&(!r&&!n.length||n.length-1 in n&&va(n[0]))&&!n.nodeType&&n!==Fs},T6=function(n,r,s){return s===void 0&&(s=[]),n.forEach(function(c){var h;return oi(c)&&!r||gC(c,1)?(h=s).push.apply(h,Vo(c)):s.push(c)})||s},Vo=function(n,r,s){return oi(n)&&!s&&(vv||!Dh())?wv.call((r||Mx).querySelectorAll(n),0):Ci(n)?T6(n,s):gC(n)?wv.call(n,0):n?[n]:[]},E6=function(n){return n=Vo(n)[0]||S_("Invalid scope")||{},function(r){var s=n.current||n.nativeElement||n;return Vo(r,s.querySelectorAll?s:s===n?S_("Invalid scope")||Mx.createElement("div"):n)}},yC=function(n){return n.sort(function(){return .5-Math.random()})},vC=function(n){if(ri(n))return n;var r=va(n)?n:{each:n},s=Fc(r.ease),c=r.from||0,h=parseFloat(r.base)||0,m={},a=c>0&&c<1,v=isNaN(c)||a,w=r.axis,E=c,I=c;return oi(c)?E=I={center:.5,edges:.5,end:1}[c]||0:!a&&v&&(E=c[0],I=c[1]),function(M,P,j){var N=(j||r).length,q=m[N],V,ee,oe,pe,se,xe,Te,De,Me;if(!q){if(Me=r.grid==="auto"?0:(r.grid||[1,$o])[1],!Me){for(Te=-$o;Te<(Te=j[Me++].getBoundingClientRect().left)&&Me<N;);Me--}for(q=m[N]=[],V=v?Math.min(Me,N)*E-.5:c%Me,ee=Me===$o?0:v?N*I/Me-.5:c/Me|0,Te=0,De=$o,xe=0;xe<N;xe++)oe=xe%Me-V,pe=ee-(xe/Me|0),q[xe]=se=w?Math.abs(w==="y"?pe:oe):JA(oe*oe+pe*pe),se>Te&&(Te=se),se<De&&(De=se);c==="random"&&yC(q),q.max=Te-De,q.min=De,q.v=N=(parseFloat(r.amount)||parseFloat(r.each)*(Me>N?N-1:w?w==="y"?N/Me:Me:Math.max(Me,N/Me))||0)*(c==="edges"?-1:1),q.b=N<0?h-N:h,q.u=Qi(r.amount||r.each)||0,s=s&&N<0?CC(s):s}return N=(q[M]-q.min)/q.max||0,Ai(q.b+(s?s(N):N)*q.v)+q.u}},Tv=function(n){var r=Math.pow(10,((n+"").split(".")[1]||"").length);return function(s){var c=Math.round(parseFloat(s)/n)*n*r;return(c-c%1)/r+(ya(s)?0:Qi(s))}},xC=function(n,r){var s=Ci(n),c,h;return!s&&va(n)&&(c=s=n.radius||$o,n.values?(n=Vo(n.values),(h=!ya(n[0]))&&(c*=c)):n=Tv(n.increment)),Il(r,s?ri(n)?function(m){return h=n(m),Math.abs(h-m)<=c?h:m}:function(m){for(var a=parseFloat(h?m.x:m),v=parseFloat(h?m.y:0),w=$o,E=0,I=n.length,M,P;I--;)h?(M=n[I].x-a,P=n[I].y-v,M=M*M+P*P):M=Math.abs(n[I]-a),M<w&&(w=M,E=I);return E=!c||w<=c?n[E]:m,h||E===m||ya(m)?E:E+Qi(m)}:Tv(n))},bC=function(n,r,s,c){return Il(Ci(n)?!r:s===!0?!!(s=0):!c,function(){return Ci(n)?n[~~(Math.random()*n.length)]:(s=s||1e-5)&&(c=s<1?Math.pow(10,(s+"").length-2):1)&&Math.floor(Math.round((n-s/2+Math.random()*(r-n+s*.99))/s)*s*c)/c})},S6=function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return function(c){return r.reduce(function(h,m){return m(h)},c)}},A6=function(n,r){return function(s){return n(parseFloat(s))+(r||Qi(s))}},C6=function(n,r,s){return TC(n,r,0,1,s)},wC=function(n,r,s){return Il(s,function(c){return n[~~r(c)]})},I6=function e(n,r,s){var c=r-n;return Ci(n)?wC(n,e(0,n.length),r):Il(s,function(h){return(c+(h-n)%c)%c+n})},M6=function e(n,r,s){var c=r-n,h=c*2;return Ci(n)?wC(n,e(0,n.length-1),r):Il(s,function(m){return m=(h+(m-n)%h)%h||0,n+(m>c?h-m:m)})},Ld=function(n){for(var r=0,s="",c,h,m,a;~(c=n.indexOf("random(",r));)m=n.indexOf(")",c),a=n.charAt(c+7)==="[",h=n.substr(c+7,m-c-7).match(a?iC:yv),s+=n.substr(r,c-r)+bC(a?h:+h[0],a?0:+h[1],+h[2]||1e-5),r=m+1;return s+n.substr(r,n.length-r)},TC=function(n,r,s,c,h){var m=r-n,a=c-s;return Il(h,function(v){return s+((v-n)/m*a||0)})},k6=function e(n,r,s,c){var h=isNaN(n+r)?0:function(P){return(1-P)*n+P*r};if(!h){var m=oi(n),a={},v,w,E,I,M;if(s===!0&&(c=1)&&(s=null),m)n={p:n},r={p:r};else if(Ci(n)&&!Ci(r)){for(E=[],I=n.length,M=I-2,w=1;w<I;w++)E.push(e(n[w-1],n[w]));I--,h=function(j){j*=I;var N=Math.min(M,~~j);return E[N](j-N)},s=r}else c||(n=Mh(Ci(n)?[]:{},n));if(!E){for(v in r)zx.call(a,n,v,"get",r[v]);h=function(j){return Fx(j,a)||(m?n.p:n)}}}return Il(s,h)},C2=function(n,r,s){var c=n.labels,h=$o,m,a,v;for(m in c)a=c[m]-r,a<0==!!s&&a&&h>(a=Math.abs(a))&&(v=m,h=a);return v},Go=function(n,r,s){var c=n.vars,h=c[r],m,a;if(!!h)return m=c[r+"Params"],a=c.callbackScope||n,s&&yl.length&&A_(),m?h.apply(a,m):h.call(a)},sd=function(n){return pa(n),n.scrollTrigger&&n.scrollTrigger.kill(!1),n.progress()<1&&Go(n,"onInterrupt"),n},ch,P6=function(n){n=!n.name&&n.default||n;var r=n.name,s=ri(n),c=r&&!s&&n.init?function(){this._props=[]}:n,h={init:Od,render:Fx,add:zx,kill:W6,modifier:Z6,rawVars:0},m={targetTest:0,get:0,getSetter:Lx,aliases:{},register:0};if(Dh(),n!==c){if(mo[r])return;Xo(c,Xo(C_(n,h),m)),Mh(c.prototype,Mh(h,C_(n,m))),mo[c.prop=r]=c,n.targetTest&&(Vm.push(c),Px[r]=1),r=(r==="css"?"CSS":r.charAt(0).toUpperCase()+r.substr(1))+"Plugin"}aC(r,c),n.register&&n.register(Hs,c,no)},nr=255,ad={aqua:[0,nr,nr],lime:[0,nr,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,nr],navy:[0,0,128],white:[nr,nr,nr],olive:[128,128,0],yellow:[nr,nr,0],orange:[nr,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[nr,0,0],pink:[nr,192,203],cyan:[0,nr,nr],transparent:[nr,nr,nr,0]},iy=function(n,r,s){return n+=n<0?1:n>1?-1:0,(n*6<1?r+(s-r)*n*6:n<.5?s:n*3<2?r+(s-r)*(2/3-n)*6:r)*nr+.5|0},EC=function(n,r,s){var c=n?ya(n)?[n>>16,n>>8&nr,n&nr]:0:ad.black,h,m,a,v,w,E,I,M,P,j;if(!c){if(n.substr(-1)===","&&(n=n.substr(0,n.length-1)),ad[n])c=ad[n];else if(n.charAt(0)==="#"){if(n.length<6&&(h=n.charAt(1),m=n.charAt(2),a=n.charAt(3),n="#"+h+h+m+m+a+a+(n.length===5?n.charAt(4)+n.charAt(4):"")),n.length===9)return c=parseInt(n.substr(1,6),16),[c>>16,c>>8&nr,c&nr,parseInt(n.substr(7),16)/255];n=parseInt(n.substr(1),16),c=[n>>16,n>>8&nr,n&nr]}else if(n.substr(0,3)==="hsl"){if(c=j=n.match(yv),!r)v=+c[0]%360/360,w=+c[1]/100,E=+c[2]/100,m=E<=.5?E*(w+1):E+w-E*w,h=E*2-m,c.length>3&&(c[3]*=1),c[0]=iy(v+1/3,h,m),c[1]=iy(v,h,m),c[2]=iy(v-1/3,h,m);else if(~n.indexOf("="))return c=n.match(nC),s&&c.length<4&&(c[3]=1),c}else c=n.match(yv)||ad.transparent;c=c.map(Number)}return r&&!j&&(h=c[0]/nr,m=c[1]/nr,a=c[2]/nr,I=Math.max(h,m,a),M=Math.min(h,m,a),E=(I+M)/2,I===M?v=w=0:(P=I-M,w=E>.5?P/(2-I-M):P/(I+M),v=I===h?(m-a)/P+(m<a?6:0):I===m?(a-h)/P+2:(h-m)/P+4,v*=60),c[0]=~~(v+.5),c[1]=~~(w*100+.5),c[2]=~~(E*100+.5)),s&&c.length<4&&(c[3]=1),c},SC=function(n){var r=[],s=[],c=-1;return n.split(vl).forEach(function(h){var m=h.match(lh)||[];r.push.apply(r,m),s.push(c+=m.length+1)}),r.c=s,r},I2=function(n,r,s){var c="",h=(n+c).match(vl),m=r?"hsla(":"rgba(",a=0,v,w,E,I;if(!h)return n;if(h=h.map(function(M){return(M=EC(M,r,1))&&m+(r?M[0]+","+M[1]+"%,"+M[2]+"%,"+M[3]:M.join(","))+")"}),s&&(E=SC(n),v=s.c,v.join(c)!==E.c.join(c)))for(w=n.replace(vl,"1").split(lh),I=w.length-1;a<I;a++)c+=w[a]+(~v.indexOf(a)?h.shift()||m+"0,0,0,0)":(E.length?E:h.length?h:s).shift());if(!w)for(w=n.split(vl),I=w.length-1;a<I;a++)c+=w[a]+h[a];return c+w[I]},vl=function(){var e="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",n;for(n in ad)e+="|"+n+"\\b";return new RegExp(e+")","gi")}(),D6=/hsl[a]?\(/,AC=function(n){var r=n.join(" "),s;if(vl.lastIndex=0,vl.test(r))return s=D6.test(r),n[1]=I2(n[1],s),n[0]=I2(n[0],s,SC(n[1])),!0},M_,jo=function(){var e=Date.now,n=500,r=33,s=e(),c=s,h=1e3/240,m=h,a=[],v,w,E,I,M,P,j=function N(q){var V=e()-c,ee=q===!0,oe,pe,se,xe;if(V>n&&(s+=V-r),c+=V,se=c-s,oe=se-m,(oe>0||ee)&&(xe=++I.frame,M=se-I.time*1e3,I.time=se=se/1e3,m+=oe+(oe>=h?4:h-oe),pe=1),ee||(v=w(N)),pe)for(P=0;P<a.length;P++)a[P](se,M,xe,q)};return I={time:0,frame:0,tick:function(){j(!0)},deltaRatio:function(q){return M/(1e3/(q||60))},wake:function(){oC&&(!vv&&eC()&&(Fs=vv=window,Mx=Fs.document||{},Eo.gsap=Hs,(Fs.gsapVersions||(Fs.gsapVersions=[])).push(Hs.version),sC(E_||Fs.GreenSockGlobals||!Fs.gsap&&Fs||{}),E=Fs.requestAnimationFrame),v&&I.sleep(),w=E||function(q){return setTimeout(q,m-I.time*1e3+1|0)},M_=1,j(2))},sleep:function(){(E?Fs.cancelAnimationFrame:clearTimeout)(v),M_=0,w=Od},lagSmoothing:function(q,V){n=q||1/or,r=Math.min(V,n,0)},fps:function(q){h=1e3/(q||240),m=I.time*1e3+h},add:function(q){a.indexOf(q)<0&&a.push(q),Dh()},remove:function(q,V){~(V=a.indexOf(q))&&a.splice(V,1)&&P>=V&&P--},_listeners:a},I}(),Dh=function(){return!M_&&jo.wake()},Mn={},R6=/^[\d.\-M][\d.\-,\s]/,z6=/["']/g,O6=function(n){for(var r={},s=n.substr(1,n.length-3).split(":"),c=s[0],h=1,m=s.length,a,v,w;h<m;h++)v=s[h],a=h!==m-1?v.lastIndexOf(","):v.length,w=v.substr(0,a),r[c]=isNaN(w)?w.replace(z6,"").trim():+w,c=v.substr(a+1).trim();return r},L6=function(n){var r=n.indexOf("(")+1,s=n.indexOf(")"),c=n.indexOf("(",r);return n.substring(r,~c&&c<s?n.indexOf(")",s+1):s)},F6=function(n){var r=(n+"").split("("),s=Mn[r[0]];return s&&r.length>1&&s.config?s.config.apply(null,~n.indexOf("{")?[O6(r[1])]:L6(n).split(",").map(hC)):Mn._CE&&R6.test(n)?Mn._CE("",n):s},CC=function(n){return function(r){return 1-n(1-r)}},IC=function e(n,r){for(var s=n._first,c;s;)s instanceof Ji?e(s,r):s.vars.yoyoEase&&(!s._yoyo||!s._repeat)&&s._yoyo!==r&&(s.timeline?e(s.timeline,r):(c=s._ease,s._ease=s._yEase,s._yEase=c,s._yoyo=r)),s=s._next},Fc=function(n,r){return n&&(ri(n)?n:Mn[n]||F6(n))||r},Gc=function(n,r,s,c){s===void 0&&(s=function(v){return 1-r(1-v)}),c===void 0&&(c=function(v){return v<.5?r(v*2)/2:1-r((1-v)*2)/2});var h={easeIn:r,easeOut:s,easeInOut:c},m;return to(n,function(a){Mn[a]=Eo[a]=h,Mn[m=a.toLowerCase()]=s;for(var v in h)Mn[m+(v==="easeIn"?".in":v==="easeOut"?".out":".inOut")]=Mn[a+"."+v]=h[v]}),h},MC=function(n){return function(r){return r<.5?(1-n(1-r*2))/2:.5+n((r-.5)*2)/2}},oy=function e(n,r,s){var c=r>=1?r:1,h=(s||(n?.3:.45))/(r<1?r:1),m=h/gv*(Math.asin(1/c)||0),a=function(E){return E===1?1:c*Math.pow(2,-10*E)*u6((E-m)*h)+1},v=n==="out"?a:n==="in"?function(w){return 1-a(1-w)}:MC(a);return h=gv/h,v.config=function(w,E){return e(n,w,E)},v},sy=function e(n,r){r===void 0&&(r=1.70158);var s=function(m){return m?--m*m*((r+1)*m+r)+1:0},c=n==="out"?s:n==="in"?function(h){return 1-s(1-h)}:MC(s);return c.config=function(h){return e(n,h)},c};to("Linear,Quad,Cubic,Quart,Quint,Strong",function(e,n){var r=n<5?n+1:n;Gc(e+",Power"+(r-1),n?function(s){return Math.pow(s,r)}:function(s){return s},function(s){return 1-Math.pow(1-s,r)},function(s){return s<.5?Math.pow(s*2,r)/2:1-Math.pow((1-s)*2,r)/2})});Mn.Linear.easeNone=Mn.none=Mn.Linear.easeIn;Gc("Elastic",oy("in"),oy("out"),oy());(function(e,n){var r=1/n,s=2*r,c=2.5*r,h=function(a){return a<r?e*a*a:a<s?e*Math.pow(a-1.5/n,2)+.75:a<c?e*(a-=2.25/n)*a+.9375:e*Math.pow(a-2.625/n,2)+.984375};Gc("Bounce",function(m){return 1-h(1-m)},h)})(7.5625,2.75);Gc("Expo",function(e){return e?Math.pow(2,10*(e-1)):0});Gc("Circ",function(e){return-(JA(1-e*e)-1)});Gc("Sine",function(e){return e===1?1:-c6(e*a6)+1});Gc("Back",sy("in"),sy("out"),sy());Mn.SteppedEase=Mn.steps=Eo.SteppedEase={config:function(n,r){n===void 0&&(n=1);var s=1/n,c=n+(r?0:1),h=r?1:0,m=1-or;return function(a){return((c*Zd(0,m,a)|0)+h)*s}}};Ih.ease=Mn["quad.out"];to("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(e){return Dx+=e+","+e+"Params,"});var kC=function(n,r){this.id=l6++,n._gsap=this,this.target=n,this.harness=r,this.get=r?r.get:cC,this.set=r?r.getSetter:Lx},Fd=function(){function e(r){this.vars=r,this._delay=+r.delay||0,(this._repeat=r.repeat===1/0?-2:r.repeat||0)&&(this._rDelay=r.repeatDelay||0,this._yoyo=!!r.yoyo||!!r.yoyoEase),this._ts=1,Ph(this,+r.duration,1,1),this.data=r.data,M_||jo.wake()}var n=e.prototype;return n.delay=function(s){return s||s===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+s-this._delay),this._delay=s,this):this._delay},n.duration=function(s){return arguments.length?this.totalDuration(this._repeat>0?s+(s+this._rDelay)*this._repeat:s):this.totalDuration()&&this._dur},n.totalDuration=function(s){return arguments.length?(this._dirty=0,Ph(this,this._repeat<0?s:(s-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},n.totalTime=function(s,c){if(Dh(),!arguments.length)return this._tTime;var h=this._dp;if(h&&h.smoothChildTiming&&this._ts){for(dC(this,s),!h._dp||h.parent||pC(h,this);h&&h.parent;)h.parent._time!==h._start+(h._ts>=0?h._tTime/h._ts:(h.totalDuration()-h._tTime)/-h._ts)&&h.totalTime(h._tTime,!0),h=h.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&s<this._tDur||this._ts<0&&s>0||!this._tDur&&!s)&&Gs(this._dp,this,this._start-this._delay)}return(this._tTime!==s||!this._dur&&!c||this._initted&&Math.abs(this._zTime)===or||!s&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=s),uC(this,s,c)),this},n.time=function(s,c){return arguments.length?this.totalTime(Math.min(this.totalDuration(),s+S2(this))%(this._dur+this._rDelay)||(s?this._dur:0),c):this._time},n.totalProgress=function(s,c){return arguments.length?this.totalTime(this.totalDuration()*s,c):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},n.progress=function(s,c){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-s:s)+S2(this),c):this.duration()?Math.min(1,this._time/this._dur):this.ratio},n.iteration=function(s,c){var h=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(s-1)*h,c):this._repeat?kh(this._tTime,h)+1:1},n.timeScale=function(s){if(!arguments.length)return this._rts===-or?0:this._rts;if(this._rts===s)return this;var c=this.parent&&this._ts?I_(this.parent._time,this):this._tTime;return this._rts=+s||0,this._ts=this._ps||s===-or?0:this._rts,_6(this.totalTime(Zd(-this._delay,this._tDur,c),!0)),tg(this),this},n.paused=function(s){return arguments.length?(this._ps!==s&&(this._ps=s,s?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Dh(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==or&&(this._tTime-=or)))),this):this._ps},n.startTime=function(s){if(arguments.length){this._start=s;var c=this.parent||this._dp;return c&&(c._sort||!this.parent)&&Gs(c,this,s-this._delay),this}return this._start},n.endTime=function(s){return this._start+(eo(s)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},n.rawTime=function(s){var c=this.parent||this._dp;return c?s&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?I_(c.rawTime(s),this):this._tTime:this._tTime},n.globalTime=function(s){for(var c=this,h=arguments.length?s:c.rawTime();c;)h=c._start+h/(c._ts||1),c=c._dp;return h},n.repeat=function(s){return arguments.length?(this._repeat=s===1/0?-2:s,A2(this)):this._repeat===-2?1/0:this._repeat},n.repeatDelay=function(s){if(arguments.length){var c=this._time;return this._rDelay=s,A2(this),c?this.time(c):this}return this._rDelay},n.yoyo=function(s){return arguments.length?(this._yoyo=s,this):this._yoyo},n.seek=function(s,c){return this.totalTime(Uo(this,s),eo(c))},n.restart=function(s,c){return this.play().totalTime(s?-this._delay:0,eo(c))},n.play=function(s,c){return s!=null&&this.seek(s,c),this.reversed(!1).paused(!1)},n.reverse=function(s,c){return s!=null&&this.seek(s||this.totalDuration(),c),this.reversed(!0).paused(!1)},n.pause=function(s,c){return s!=null&&this.seek(s,c),this.paused(!0)},n.resume=function(){return this.paused(!1)},n.reversed=function(s){return arguments.length?(!!s!==this.reversed()&&this.timeScale(-this._rts||(s?-or:0)),this):this._rts<0},n.invalidate=function(){return this._initted=this._act=0,this._zTime=-or,this},n.isActive=function(){var s=this.parent||this._dp,c=this._start,h;return!!(!s||this._ts&&this._initted&&s.isActive()&&(h=s.rawTime(!0))>=c&&h<this.endTime(!0)-or)},n.eventCallback=function(s,c,h){var m=this.vars;return arguments.length>1?(c?(m[s]=c,h&&(m[s+"Params"]=h),s==="onUpdate"&&(this._onUpdate=c)):delete m[s],this):m[s]},n.then=function(s){var c=this;return new Promise(function(h){var m=ri(s)?s:fC,a=function(){var w=c.then;c.then=null,ri(m)&&(m=m(c))&&(m.then||m===c)&&(c.then=w),h(m),c.then=w};c._initted&&c.totalProgress()===1&&c._ts>=0||!c._tTime&&c._ts<0?a():c._prom=a})},n.kill=function(){sd(this)},e}();Xo(Fd.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-or,_prom:0,_ps:!1,_rts:1});var Ji=function(e){QA(n,e);function n(s,c){var h;return s===void 0&&(s={}),h=e.call(this,s)||this,h.labels={},h.smoothChildTiming=!!s.smoothChildTiming,h.autoRemoveChildren=!!s.autoRemoveChildren,h._sort=eo(s.sortChildren),Tr&&Gs(s.parent||Tr,fa(h),c),s.reversed&&h.reverse(),s.paused&&h.paused(!0),s.scrollTrigger&&mC(fa(h),s.scrollTrigger),h}var r=n.prototype;return r.to=function(c,h,m){return yd(0,arguments,this),this},r.from=function(c,h,m){return yd(1,arguments,this),this},r.fromTo=function(c,h,m,a){return yd(2,arguments,this),this},r.set=function(c,h,m){return h.duration=0,h.parent=this,gd(h).repeatDelay||(h.repeat=0),h.immediateRender=!!h.immediateRender,new Jr(c,h,Uo(this,m),1),this},r.call=function(c,h,m){return Gs(this,Jr.delayedCall(0,c,h),m)},r.staggerTo=function(c,h,m,a,v,w,E){return m.duration=h,m.stagger=m.stagger||a,m.onComplete=w,m.onCompleteParams=E,m.parent=this,new Jr(c,m,Uo(this,v)),this},r.staggerFrom=function(c,h,m,a,v,w,E){return m.runBackwards=1,gd(m).immediateRender=eo(m.immediateRender),this.staggerTo(c,h,m,a,v,w,E)},r.staggerFromTo=function(c,h,m,a,v,w,E,I){return a.startAt=m,gd(a).immediateRender=eo(a.immediateRender),this.staggerTo(c,h,a,v,w,E,I)},r.render=function(c,h,m){var a=this._time,v=this._dirty?this.totalDuration():this._tDur,w=this._dur,E=c<=0?0:Ai(c),I=this._zTime<0!=c<0&&(this._initted||!w),M,P,j,N,q,V,ee,oe,pe,se,xe,Te;if(this!==Tr&&E>v&&c>=0&&(E=v),E!==this._tTime||m||I){if(a!==this._time&&w&&(E+=this._time-a,c+=this._time-a),M=E,pe=this._start,oe=this._ts,V=!oe,I&&(w||(a=this._zTime),(c||!h)&&(this._zTime=c)),this._repeat){if(xe=this._yoyo,q=w+this._rDelay,this._repeat<-1&&c<0)return this.totalTime(q*100+c,h,m);if(M=Ai(E%q),E===v?(N=this._repeat,M=w):(N=~~(E/q),N&&N===E/q&&(M=w,N--),M>w&&(M=w)),se=kh(this._tTime,q),!a&&this._tTime&&se!==N&&(se=N),xe&&N&1&&(M=w-M,Te=1),N!==se&&!this._lock){var De=xe&&se&1,Me=De===(xe&&N&1);if(N<se&&(De=!De),a=De?0:w,this._lock=1,this.render(a||(Te?0:Ai(N*q)),h,!w)._lock=0,this._tTime=E,!h&&this.parent&&Go(this,"onRepeat"),this.vars.repeatRefresh&&!Te&&(this.invalidate()._lock=1),a&&a!==this._time||V!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(w=this._dur,v=this._tDur,Me&&(this._lock=2,a=De?w:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!Te&&this.invalidate()),this._lock=0,!this._ts&&!V)return this;IC(this,Te)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(ee=x6(this,Ai(a),Ai(M)),ee&&(E-=M-(M=ee._start))),this._tTime=E,this._time=M,this._act=!oe,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=c,a=0),!a&&M&&!h&&(Go(this,"onStart"),this._tTime!==E))return this;if(M>=a&&c>=0)for(P=this._first;P;){if(j=P._next,(P._act||M>=P._start)&&P._ts&&ee!==P){if(P.parent!==this)return this.render(c,h,m);if(P.render(P._ts>0?(M-P._start)*P._ts:(P._dirty?P.totalDuration():P._tDur)+(M-P._start)*P._ts,h,m),M!==this._time||!this._ts&&!V){ee=0,j&&(E+=this._zTime=-or);break}}P=j}else{P=this._last;for(var Be=c<0?c:M;P;){if(j=P._prev,(P._act||Be<=P._end)&&P._ts&&ee!==P){if(P.parent!==this)return this.render(c,h,m);if(P.render(P._ts>0?(Be-P._start)*P._ts:(P._dirty?P.totalDuration():P._tDur)+(Be-P._start)*P._ts,h,m),M!==this._time||!this._ts&&!V){ee=0,j&&(E+=this._zTime=Be?-or:or);break}}P=j}}if(ee&&!h&&(this.pause(),ee.render(M>=a?0:-or)._zTime=M>=a?1:-1,this._ts))return this._start=pe,tg(this),this.render(c,h,m);this._onUpdate&&!h&&Go(this,"onUpdate",!0),(E===v&&v>=this.totalDuration()||!E&&a)&&(pe===this._start||Math.abs(oe)!==Math.abs(this._ts))&&(this._lock||((c||!w)&&(E===v&&this._ts>0||!E&&this._ts<0)&&pa(this,1),!h&&!(c<0&&!a)&&(E||a||!v)&&(Go(this,E===v&&c>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(E<v&&this.timeScale()>0)&&this._prom())))}return this},r.add=function(c,h){var m=this;if(ya(h)||(h=Uo(this,h,c)),!(c instanceof Fd)){if(Ci(c))return c.forEach(function(a){return m.add(a,h)}),this;if(oi(c))return this.addLabel(c,h);if(ri(c))c=Jr.delayedCall(0,c);else return this}return this!==c?Gs(this,c,h):this},r.getChildren=function(c,h,m,a){c===void 0&&(c=!0),h===void 0&&(h=!0),m===void 0&&(m=!0),a===void 0&&(a=-$o);for(var v=[],w=this._first;w;)w._start>=a&&(w instanceof Jr?h&&v.push(w):(m&&v.push(w),c&&v.push.apply(v,w.getChildren(!0,h,m)))),w=w._next;return v},r.getById=function(c){for(var h=this.getChildren(1,1,1),m=h.length;m--;)if(h[m].vars.id===c)return h[m]},r.remove=function(c){return oi(c)?this.removeLabel(c):ri(c)?this.killTweensOf(c):(eg(this,c),c===this._recent&&(this._recent=this._last),Lc(this))},r.totalTime=function(c,h){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Ai(jo.time-(this._ts>0?c/this._ts:(this.totalDuration()-c)/-this._ts))),e.prototype.totalTime.call(this,c,h),this._forcing=0,this):this._tTime},r.addLabel=function(c,h){return this.labels[c]=Uo(this,h),this},r.removeLabel=function(c){return delete this.labels[c],this},r.addPause=function(c,h,m){var a=Jr.delayedCall(0,h||Od,m);return a.data="isPause",this._hasPause=1,Gs(this,a,Uo(this,c))},r.removePause=function(c){var h=this._first;for(c=Uo(this,c);h;)h._start===c&&h.data==="isPause"&&pa(h),h=h._next},r.killTweensOf=function(c,h,m){for(var a=this.getTweensOf(c,m),v=a.length;v--;)fl!==a[v]&&a[v].kill(c,h);return this},r.getTweensOf=function(c,h){for(var m=[],a=Vo(c),v=this._first,w=ya(h),E;v;)v instanceof Jr?f6(v._targets,a)&&(w?(!fl||v._initted&&v._ts)&&v.globalTime(0)<=h&&v.globalTime(v.totalDuration())>h:!h||v.isActive())&&m.push(v):(E=v.getTweensOf(a,h)).length&&m.push.apply(m,E),v=v._next;return m},r.tweenTo=function(c,h){h=h||{};var m=this,a=Uo(m,c),v=h,w=v.startAt,E=v.onStart,I=v.onStartParams,M=v.immediateRender,P,j=Jr.to(m,Xo({ease:h.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:h.duration||Math.abs((a-(w&&"time"in w?w.time:m._time))/m.timeScale())||or,onStart:function(){if(m.pause(),!P){var q=h.duration||Math.abs((a-(w&&"time"in w?w.time:m._time))/m.timeScale());j._dur!==q&&Ph(j,q,0,1).render(j._time,!0,!0),P=1}E&&E.apply(j,I||[])}},h));return M?j.render(0):j},r.tweenFromTo=function(c,h,m){return this.tweenTo(h,Xo({startAt:{time:Uo(this,c)}},m))},r.recent=function(){return this._recent},r.nextLabel=function(c){return c===void 0&&(c=this._time),C2(this,Uo(this,c))},r.previousLabel=function(c){return c===void 0&&(c=this._time),C2(this,Uo(this,c),1)},r.currentLabel=function(c){return arguments.length?this.seek(c,!0):this.previousLabel(this._time+or)},r.shiftChildren=function(c,h,m){m===void 0&&(m=0);for(var a=this._first,v=this.labels,w;a;)a._start>=m&&(a._start+=c,a._end+=c),a=a._next;if(h)for(w in v)v[w]>=m&&(v[w]+=c);return Lc(this)},r.invalidate=function(){var c=this._first;for(this._lock=0;c;)c.invalidate(),c=c._next;return e.prototype.invalidate.call(this)},r.clear=function(c){c===void 0&&(c=!0);for(var h=this._first,m;h;)m=h._next,this.remove(h),h=m;return this._dp&&(this._time=this._tTime=this._pTime=0),c&&(this.labels={}),Lc(this)},r.totalDuration=function(c){var h=0,m=this,a=m._last,v=$o,w,E,I;if(arguments.length)return m.timeScale((m._repeat<0?m.duration():m.totalDuration())/(m.reversed()?-c:c));if(m._dirty){for(I=m.parent;a;)w=a._prev,a._dirty&&a.totalDuration(),E=a._start,E>v&&m._sort&&a._ts&&!m._lock?(m._lock=1,Gs(m,a,E-a._delay,1)._lock=0):v=E,E<0&&a._ts&&(h-=E,(!I&&!m._dp||I&&I.smoothChildTiming)&&(m._start+=E/m._ts,m._time-=E,m._tTime-=E),m.shiftChildren(-E,!1,-1/0),v=0),a._end>h&&a._ts&&(h=a._end),a=w;Ph(m,m===Tr&&m._time>h?m._time:h,1,1),m._dirty=0}return m._tDur},n.updateRoot=function(c){if(Tr._ts&&(uC(Tr,I_(c,Tr)),lC=jo.frame),jo.frame>=T2){T2+=bo.autoSleep||120;var h=Tr._first;if((!h||!h._ts)&&bo.autoSleep&&jo._listeners.length<2){for(;h&&!h._ts;)h=h._next;h||jo.sleep()}}},n}(Fd);Xo(Ji.prototype,{_lock:0,_hasPause:0,_forcing:0});var B6=function(n,r,s,c,h,m,a){var v=new no(this._pt,n,r,0,1,LC,null,h),w=0,E=0,I,M,P,j,N,q,V,ee;for(v.b=s,v.e=c,s+="",c+="",(V=~c.indexOf("random("))&&(c=Ld(c)),m&&(ee=[s,c],m(ee,n,r),s=ee[0],c=ee[1]),M=s.match(ny)||[];I=ny.exec(c);)j=I[0],N=c.substring(w,I.index),P?P=(P+1)%5:N.substr(-5)==="rgba("&&(P=1),j!==M[E++]&&(q=parseFloat(M[E-1])||0,v._pt={_next:v._pt,p:N||E===1?N:",",s:q,c:j.charAt(1)==="="?parseFloat(j.substr(2))*(j.charAt(0)==="-"?-1:1):parseFloat(j)-q,m:P&&P<4?Math.round:0},w=ny.lastIndex);return v.c=w<c.length?c.substring(w,c.length):"",v.fp=a,(rC.test(c)||V)&&(v.e=0),this._pt=v,v},zx=function(n,r,s,c,h,m,a,v,w){ri(c)&&(c=c(h||0,n,m));var E=n[r],I=s!=="get"?s:ri(E)?w?n[r.indexOf("set")||!ri(n["get"+r.substr(3)])?r:"get"+r.substr(3)](w):n[r]():E,M=ri(E)?w?V6:zC:Ox,P;if(oi(c)&&(~c.indexOf("random(")&&(c=Ld(c)),c.charAt(1)==="="&&(P=parseFloat(I)+parseFloat(c.substr(2))*(c.charAt(0)==="-"?-1:1)+(Qi(I)||0),(P||P===0)&&(c=P))),I!==c)return!isNaN(I*c)&&c!==""?(P=new no(this._pt,n,r,+I||0,c-(I||0),typeof E=="boolean"?q6:OC,0,M),w&&(P.fp=w),a&&P.modifier(a,this,n),this._pt=P):(!E&&!(r in n)&&kx(r,c),B6.call(this,n,r,I,c,M,v||bo.stringFilter,w))},U6=function(n,r,s,c,h){if(ri(n)&&(n=vd(n,h,r,s,c)),!va(n)||n.style&&n.nodeType||Ci(n)||tC(n))return oi(n)?vd(n,h,r,s,c):n;var m={},a;for(a in n)m[a]=vd(n[a],h,r,s,c);return m},PC=function(n,r,s,c,h,m){var a,v,w,E;if(mo[n]&&(a=new mo[n]).init(h,a.rawVars?r[n]:U6(r[n],c,h,m,s),s,c,m)!==!1&&(s._pt=v=new no(s._pt,h,n,0,1,a.render,a,0,a.priority),s!==ch))for(w=s._ptLookup[s._targets.indexOf(h)],E=a._props.length;E--;)w[a._props[E]]=v;return a},fl,N6=function e(n,r){var s=n.vars,c=s.ease,h=s.startAt,m=s.immediateRender,a=s.lazy,v=s.onUpdate,w=s.onUpdateParams,E=s.callbackScope,I=s.runBackwards,M=s.yoyoEase,P=s.keyframes,j=s.autoRevert,N=n._dur,q=n._startAt,V=n._targets,ee=n.parent,oe=ee&&ee.data==="nested"?ee.parent._targets:V,pe=n._overwrite==="auto"&&!Cx,se=n.timeline,xe,Te,De,Me,Be,ze,Fe,Je,be,qe,Ke,_t,It;if(se&&(!P||!c)&&(c="none"),n._ease=Fc(c,Ih.ease),n._yEase=M?CC(Fc(M===!0?c:M,Ih.ease)):0,M&&n._yoyo&&!n._repeat&&(M=n._yEase,n._yEase=n._ease,n._ease=M),n._from=!se&&!!s.runBackwards,!se||P&&!s.stagger){if(Je=V[0]?Oc(V[0]).harness:0,_t=Je&&s[Je.prop],xe=C_(s,Px),q&&pa(q.render(-1,!0)),h)if(pa(n._startAt=Jr.set(V,Xo({data:"isStart",overwrite:!1,parent:ee,immediateRender:!0,lazy:eo(a),startAt:null,delay:0,onUpdate:v,onUpdateParams:w,callbackScope:E,stagger:0},h))),r<0&&!m&&!j&&n._startAt.render(-1,!0),m){if(r>0&&!j&&(n._startAt=0),N&&r<=0){r&&(n._zTime=r);return}}else j===!1&&(n._startAt=0);else if(I&&N){if(q)!j&&(n._startAt=0);else if(r&&(m=!1),De=Xo({overwrite:!1,data:"isFromStart",lazy:m&&eo(a),immediateRender:m,stagger:0,parent:ee},xe),_t&&(De[Je.prop]=_t),pa(n._startAt=Jr.set(V,De)),r<0&&n._startAt.render(-1,!0),n._zTime=r,!m)e(n._startAt,or);else if(!r)return}for(n._pt=0,a=N&&eo(a)||a&&!N,Te=0;Te<V.length;Te++){if(Be=V[Te],Fe=Be._gsap||Rx(V)[Te]._gsap,n._ptLookup[Te]=qe={},xv[Fe.id]&&yl.length&&A_(),Ke=oe===V?Te:oe.indexOf(Be),Je&&(be=new Je).init(Be,_t||xe,n,Ke,oe)!==!1&&(n._pt=Me=new no(n._pt,Be,be.name,0,1,be.render,be,0,be.priority),be._props.forEach(function(Tt){qe[Tt]=Me}),be.priority&&(ze=1)),!Je||_t)for(De in xe)mo[De]&&(be=PC(De,xe,n,Ke,Be,oe))?be.priority&&(ze=1):qe[De]=Me=zx.call(n,Be,De,"get",xe[De],Ke,oe,0,s.stringFilter);n._op&&n._op[Te]&&n.kill(Be,n._op[Te]),pe&&n._pt&&(fl=n,Tr.killTweensOf(Be,qe,n.globalTime(r)),It=!n.parent,fl=0),n._pt&&a&&(xv[Fe.id]=1)}ze&&FC(n),n._onInit&&n._onInit(n)}n._onUpdate=v,n._initted=(!n._op||n._pt)&&!It,P&&r<=0&&se.render($o,!0,!0)},j6=function(n,r){var s=n[0]?Oc(n[0]).harness:0,c=s&&s.aliases,h,m,a,v;if(!c)return r;h=Mh({},r);for(m in c)if(m in h)for(v=c[m].split(","),a=v.length;a--;)h[v[a]]=h[m];return h},$6=function(n,r,s,c){var h=r.ease||c||"power1.inOut",m,a;if(Ci(r))a=s[n]||(s[n]=[]),r.forEach(function(v,w){return a.push({t:w/(r.length-1)*100,v,e:h})});else for(m in r)a=s[m]||(s[m]=[]),m==="ease"||a.push({t:parseFloat(n),v:r[m],e:h})},vd=function(n,r,s,c,h){return ri(n)?n.call(r,s,c,h):oi(n)&&~n.indexOf("random(")?Ld(n):n},DC=Dx+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase",RC={};to(DC+",id,stagger,delay,duration,paused,scrollTrigger",function(e){return RC[e]=1});var Jr=function(e){QA(n,e);function n(s,c,h,m){var a;typeof c=="number"&&(h.duration=c,c=h,h=null),a=e.call(this,m?c:gd(c))||this;var v=a.vars,w=v.duration,E=v.delay,I=v.immediateRender,M=v.stagger,P=v.overwrite,j=v.keyframes,N=v.defaults,q=v.scrollTrigger,V=v.yoyoEase,ee=c.parent||Tr,oe=(Ci(s)||tC(s)?ya(s[0]):"length"in c)?[s]:Vo(s),pe,se,xe,Te,De,Me,Be,ze;if(a._targets=oe.length?Rx(oe):S_("GSAP target "+s+" not found. https://greensock.com",!bo.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=P,j||M||Dm(w)||Dm(E)){if(c=a.vars,pe=a.timeline=new Ji({data:"nested",defaults:N||{}}),pe.kill(),pe.parent=pe._dp=fa(a),pe._start=0,M||Dm(w)||Dm(E)){if(Te=oe.length,Be=M&&vC(M),va(M))for(De in M)~DC.indexOf(De)&&(ze||(ze={}),ze[De]=M[De]);for(se=0;se<Te;se++)xe=C_(c,RC),xe.stagger=0,V&&(xe.yoyoEase=V),ze&&Mh(xe,ze),Me=oe[se],xe.duration=+vd(w,fa(a),se,Me,oe),xe.delay=(+vd(E,fa(a),se,Me,oe)||0)-a._delay,!M&&Te===1&&xe.delay&&(a._delay=E=xe.delay,a._start+=E,xe.delay=0),pe.to(Me,xe,Be?Be(se,Me,oe):0),pe._ease=Mn.none;pe.duration()?w=E=0:a.timeline=0}else if(j){gd(Xo(pe.vars.defaults,{ease:"none"})),pe._ease=Fc(j.ease||c.ease||"none");var Fe=0,Je,be,qe;if(Ci(j))j.forEach(function(Ke){return pe.to(oe,Ke,">")});else{xe={};for(De in j)De==="ease"||De==="easeEach"||$6(De,j[De],xe,j.easeEach);for(De in xe)for(Je=xe[De].sort(function(Ke,_t){return Ke.t-_t.t}),Fe=0,se=0;se<Je.length;se++)be=Je[se],qe={ease:be.e,duration:(be.t-(se?Je[se-1].t:0))/100*w},qe[De]=be.v,pe.to(oe,qe,Fe),Fe+=qe.duration;pe.duration()<w&&pe.to({},{duration:w-pe.duration()})}}w||a.duration(w=pe.duration())}else a.timeline=0;return P===!0&&!Cx&&(fl=fa(a),Tr.killTweensOf(oe),fl=0),Gs(ee,fa(a),h),c.reversed&&a.reverse(),c.paused&&a.paused(!0),(I||!w&&!j&&a._start===Ai(ee._time)&&eo(I)&&g6(fa(a))&&ee.data!=="nested")&&(a._tTime=-or,a.render(Math.max(0,-E))),q&&mC(fa(a),q),a}var r=n.prototype;return r.render=function(c,h,m){var a=this._time,v=this._tDur,w=this._dur,E=c>v-or&&c>=0?v:c<or?0:c,I,M,P,j,N,q,V,ee,oe;if(!w)v6(this,c,h,m);else if(E!==this._tTime||!c||m||!this._initted&&this._tTime||this._startAt&&this._zTime<0!=c<0){if(I=E,ee=this.timeline,this._repeat){if(j=w+this._rDelay,this._repeat<-1&&c<0)return this.totalTime(j*100+c,h,m);if(I=Ai(E%j),E===v?(P=this._repeat,I=w):(P=~~(E/j),P&&P===E/j&&(I=w,P--),I>w&&(I=w)),q=this._yoyo&&P&1,q&&(oe=this._yEase,I=w-I),N=kh(this._tTime,j),I===a&&!m&&this._initted)return this;P!==N&&(ee&&this._yEase&&IC(ee,q),this.vars.repeatRefresh&&!q&&!this._lock&&(this._lock=m=1,this.render(Ai(j*P),!0).invalidate()._lock=0))}if(!this._initted){if(_C(this,c<0?c:I,m,h))return this._tTime=0,this;if(w!==this._dur)return this.render(c,h,m)}if(this._tTime=E,this._time=I,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=V=(oe||this._ease)(I/w),this._from&&(this.ratio=V=1-V),I&&!a&&!h&&(Go(this,"onStart"),this._tTime!==E))return this;for(M=this._pt;M;)M.r(V,M.d),M=M._next;ee&&ee.render(c<0?c:!I&&q?-or:ee._dur*ee._ease(I/this._dur),h,m)||this._startAt&&(this._zTime=c),this._onUpdate&&!h&&(c<0&&this._startAt&&this._startAt.render(c,!0,m),Go(this,"onUpdate")),this._repeat&&P!==N&&this.vars.onRepeat&&!h&&this.parent&&Go(this,"onRepeat"),(E===this._tDur||!E)&&this._tTime===E&&(c<0&&this._startAt&&!this._onUpdate&&this._startAt.render(c,!0,!0),(c||!w)&&(E===this._tDur&&this._ts>0||!E&&this._ts<0)&&pa(this,1),!h&&!(c<0&&!a)&&(E||a)&&(Go(this,E===v?"onComplete":"onReverseComplete",!0),this._prom&&!(E<v&&this.timeScale()>0)&&this._prom()))}return this},r.targets=function(){return this._targets},r.invalidate=function(){return this._pt=this._op=this._startAt=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),e.prototype.invalidate.call(this)},r.kill=function(c,h){if(h===void 0&&(h="all"),!c&&(!h||h==="all"))return this._lazy=this._pt=0,this.parent?sd(this):this;if(this.timeline){var m=this.timeline.totalDuration();return this.timeline.killTweensOf(c,h,fl&&fl.vars.overwrite!==!0)._first||sd(this),this.parent&&m!==this.timeline.totalDuration()&&Ph(this,this._dur*this.timeline._tDur/m,0,1),this}var a=this._targets,v=c?Vo(c):a,w=this._ptLookup,E=this._pt,I,M,P,j,N,q,V;if((!h||h==="all")&&p6(a,v))return h==="all"&&(this._pt=0),sd(this);for(I=this._op=this._op||[],h!=="all"&&(oi(h)&&(N={},to(h,function(ee){return N[ee]=1}),h=N),h=j6(a,h)),V=a.length;V--;)if(~v.indexOf(a[V])){M=w[V],h==="all"?(I[V]=h,j=M,P={}):(P=I[V]=I[V]||{},j=h);for(N in j)q=M&&M[N],q&&((!("kill"in q.d)||q.d.kill(N)===!0)&&eg(this,q,"_pt"),delete M[N]),P!=="all"&&(P[N]=1)}return this._initted&&!this._pt&&E&&sd(this),this},n.to=function(c,h){return new n(c,h,arguments[2])},n.from=function(c,h){return yd(1,arguments)},n.delayedCall=function(c,h,m,a){return new n(h,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:c,onComplete:h,onReverseComplete:h,onCompleteParams:m,onReverseCompleteParams:m,callbackScope:a})},n.fromTo=function(c,h,m){return yd(2,arguments)},n.set=function(c,h){return h.duration=0,h.repeatDelay||(h.repeat=0),new n(c,h)},n.killTweensOf=function(c,h,m){return Tr.killTweensOf(c,h,m)},n}(Fd);Xo(Jr.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});to("staggerTo,staggerFrom,staggerFromTo",function(e){Jr[e]=function(){var n=new Ji,r=wv.call(arguments,0);return r.splice(e==="staggerFromTo"?5:4,0,0),n[e].apply(n,r)}});var Ox=function(n,r,s){return n[r]=s},zC=function(n,r,s){return n[r](s)},V6=function(n,r,s,c){return n[r](c.fp,s)},G6=function(n,r,s){return n.setAttribute(r,s)},Lx=function(n,r){return ri(n[r])?zC:Ix(n[r])&&n.setAttribute?G6:Ox},OC=function(n,r){return r.set(r.t,r.p,Math.round((r.s+r.c*n)*1e6)/1e6,r)},q6=function(n,r){return r.set(r.t,r.p,!!(r.s+r.c*n),r)},LC=function(n,r){var s=r._pt,c="";if(!n&&r.b)c=r.b;else if(n===1&&r.e)c=r.e;else{for(;s;)c=s.p+(s.m?s.m(s.s+s.c*n):Math.round((s.s+s.c*n)*1e4)/1e4)+c,s=s._next;c+=r.c}r.set(r.t,r.p,c,r)},Fx=function(n,r){for(var s=r._pt;s;)s.r(n,s.d),s=s._next},Z6=function(n,r,s,c){for(var h=this._pt,m;h;)m=h._next,h.p===c&&h.modifier(n,r,s),h=m},W6=function(n){for(var r=this._pt,s,c;r;)c=r._next,r.p===n&&!r.op||r.op===n?eg(this,r,"_pt"):r.dep||(s=1),r=c;return!s},H6=function(n,r,s,c){c.mSet(n,r,c.m.call(c.tween,s,c.mt),c)},FC=function(n){for(var r=n._pt,s,c,h,m;r;){for(s=r._next,c=h;c&&c.pr>r.pr;)c=c._next;(r._prev=c?c._prev:m)?r._prev._next=r:h=r,(r._next=c)?c._prev=r:m=r,r=s}n._pt=h},no=function(){function e(r,s,c,h,m,a,v,w,E){this.t=s,this.s=h,this.c=m,this.p=c,this.r=a||OC,this.d=v||this,this.set=w||Ox,this.pr=E||0,this._next=r,r&&(r._prev=this)}var n=e.prototype;return n.modifier=function(s,c,h){this.mSet=this.mSet||this.set,this.set=H6,this.m=s,this.mt=h,this.tween=c},e}();to(Dx+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(e){return Px[e]=1});Eo.TweenMax=Eo.TweenLite=Jr;Eo.TimelineLite=Eo.TimelineMax=Ji;Tr=new Ji({sortChildren:!1,defaults:Ih,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});bo.stringFilter=AC;var k_={registerPlugin:function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];r.forEach(function(c){return P6(c)})},timeline:function(n){return new Ji(n)},getTweensOf:function(n,r){return Tr.getTweensOf(n,r)},getProperty:function(n,r,s,c){oi(n)&&(n=Vo(n)[0]);var h=Oc(n||{}).get,m=s?fC:hC;return s==="native"&&(s=""),n&&(r?m((mo[r]&&mo[r].get||h)(n,r,s,c)):function(a,v,w){return m((mo[a]&&mo[a].get||h)(n,a,v,w))})},quickSetter:function(n,r,s){if(n=Vo(n),n.length>1){var c=n.map(function(E){return Hs.quickSetter(E,r,s)}),h=c.length;return function(E){for(var I=h;I--;)c[I](E)}}n=n[0]||{};var m=mo[r],a=Oc(n),v=a.harness&&(a.harness.aliases||{})[r]||r,w=m?function(E){var I=new m;ch._pt=0,I.init(n,s?E+s:E,ch,0,[n]),I.render(1,I),ch._pt&&Fx(1,ch)}:a.set(n,v);return m?w:function(E){return w(n,v,s?E+s:E,a,1)}},isTweening:function(n){return Tr.getTweensOf(n,!0).length>0},defaults:function(n){return n&&n.ease&&(n.ease=Fc(n.ease,Ih.ease)),E2(Ih,n||{})},config:function(n){return E2(bo,n||{})},registerEffect:function(n){var r=n.name,s=n.effect,c=n.plugins,h=n.defaults,m=n.extendTimeline;(c||"").split(",").forEach(function(a){return a&&!mo[a]&&!Eo[a]&&S_(r+" effect requires "+a+" plugin.")}),ry[r]=function(a,v,w){return s(Vo(a),Xo(v||{},h),w)},m&&(Ji.prototype[r]=function(a,v,w){return this.add(ry[r](a,va(v)?v:(w=v)&&{},this),w)})},registerEase:function(n,r){Mn[n]=Fc(r)},parseEase:function(n,r){return arguments.length?Fc(n,r):Mn},getById:function(n){return Tr.getById(n)},exportRoot:function(n,r){n===void 0&&(n={});var s=new Ji(n),c,h;for(s.smoothChildTiming=eo(n.smoothChildTiming),Tr.remove(s),s._dp=0,s._time=s._tTime=Tr._time,c=Tr._first;c;)h=c._next,(r||!(!c._dur&&c instanceof Jr&&c.vars.onComplete===c._targets[0]))&&Gs(s,c,c._start-c._delay),c=h;return Gs(Tr,s,0),s},utils:{wrap:I6,wrapYoyo:M6,distribute:vC,random:bC,snap:xC,normalize:C6,getUnit:Qi,clamp:w6,splitColor:EC,toArray:Vo,selector:E6,mapRange:TC,pipe:S6,unitize:A6,interpolate:k6,shuffle:yC},install:sC,effects:ry,ticker:jo,updateRoot:Ji.updateRoot,plugins:mo,globalTimeline:Tr,core:{PropTween:no,globals:aC,Tween:Jr,Timeline:Ji,Animation:Fd,getCache:Oc,_removeLinkedListItem:eg,suppressOverwrites:function(n){return Cx=n}}};to("to,from,fromTo,delayedCall,set,killTweensOf",function(e){return k_[e]=Jr[e]});jo.add(Ji.updateRoot);ch=k_.to({},{duration:0});var X6=function(n,r){for(var s=n._pt;s&&s.p!==r&&s.op!==r&&s.fp!==r;)s=s._next;return s},K6=function(n,r){var s=n._targets,c,h,m;for(c in r)for(h=s.length;h--;)m=n._ptLookup[h][c],m&&(m=m.d)&&(m._pt&&(m=X6(m,c)),m&&m.modifier&&m.modifier(r[c],n,s[h],c))},ay=function(n,r){return{name:n,rawVars:1,init:function(c,h,m){m._onInit=function(a){var v,w;if(oi(h)&&(v={},to(h,function(E){return v[E]=1}),h=v),r){v={};for(w in h)v[w]=r(h[w]);h=v}K6(a,h)}}}},Hs=k_.registerPlugin({name:"attr",init:function(n,r,s,c,h){var m,a;for(m in r)a=this.add(n,"setAttribute",(n.getAttribute(m)||0)+"",r[m],c,h,0,0,m),a&&(a.op=m),this._props.push(m)}},{name:"endArray",init:function(n,r){for(var s=r.length;s--;)this.add(n,s,n[s]||0,r[s])}},ay("roundProps",Tv),ay("modifiers"),ay("snap",xC))||k_;Jr.version=Ji.version=Hs.version="3.9.1";oC=1;eC()&&Dh();Mn.Power0;Mn.Power1;Mn.Power2;Mn.Power3;Mn.Power4;Mn.Linear;Mn.Quad;Mn.Cubic;Mn.Quart;Mn.Quint;Mn.Strong;Mn.Elastic;Mn.Back;Mn.SteppedEase;Mn.Bounce;Mn.Sine;Mn.Expo;Mn.Circ;/*!
 * CSSPlugin 3.9.1
 * https://greensock.com
 *
 * Copyright 2008-2021, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var M2,dl,_h,Bx,Mc,k2,Y6=function(){return typeof window!="undefined"},bl={},wc=180/Math.PI,gh=Math.PI/180,Xu=Math.atan2,P2=1e8,BC=/([A-Z])/g,Q6=/(?:left|right|width|margin|padding|x)/i,J6=/[\s,\(]\S/,pl={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},UC=function(n,r){return r.set(r.t,r.p,Math.round((r.s+r.c*n)*1e4)/1e4+r.u,r)},eU=function(n,r){return r.set(r.t,r.p,n===1?r.e:Math.round((r.s+r.c*n)*1e4)/1e4+r.u,r)},tU=function(n,r){return r.set(r.t,r.p,n?Math.round((r.s+r.c*n)*1e4)/1e4+r.u:r.b,r)},nU=function(n,r){var s=r.s+r.c*n;r.set(r.t,r.p,~~(s+(s<0?-.5:.5))+r.u,r)},NC=function(n,r){return r.set(r.t,r.p,n?r.e:r.b,r)},jC=function(n,r){return r.set(r.t,r.p,n!==1?r.b:r.e,r)},rU=function(n,r,s){return n.style[r]=s},iU=function(n,r,s){return n.style.setProperty(r,s)},oU=function(n,r,s){return n._gsap[r]=s},sU=function(n,r,s){return n._gsap.scaleX=n._gsap.scaleY=s},aU=function(n,r,s,c,h){var m=n._gsap;m.scaleX=m.scaleY=s,m.renderTransform(h,m)},lU=function(n,r,s,c,h){var m=n._gsap;m[r]=s,m.renderTransform(h,m)},_i="transform",wl=_i+"Origin",$C,Ev=function(n,r){var s=dl.createElementNS?dl.createElementNS((r||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),n):dl.createElement(n);return s.style?s:dl.createElement(n)},ma=function e(n,r,s){var c=getComputedStyle(n);return c[r]||c.getPropertyValue(r.replace(BC,"-$1").toLowerCase())||c.getPropertyValue(r)||!s&&e(n,Rh(r)||r,1)||""},D2="O,Moz,ms,Ms,Webkit".split(","),Rh=function(n,r,s){var c=r||Mc,h=c.style,m=5;if(n in h&&!s)return n;for(n=n.charAt(0).toUpperCase()+n.substr(1);m--&&!(D2[m]+n in h););return m<0?null:(m===3?"ms":m>=0?D2[m]:"")+n},Sv=function(){Y6()&&window.document&&(M2=window,dl=M2.document,_h=dl.documentElement,Mc=Ev("div")||{style:{}},Ev("div"),_i=Rh(_i),wl=_i+"Origin",Mc.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",$C=!!Rh("perspective"),Bx=1)},ly=function e(n){var r=Ev("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),s=this.parentNode,c=this.nextSibling,h=this.style.cssText,m;if(_h.appendChild(r),r.appendChild(this),this.style.display="block",n)try{m=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=e}catch{}else this._gsapBBox&&(m=this._gsapBBox());return s&&(c?s.insertBefore(this,c):s.appendChild(this)),_h.removeChild(r),this.style.cssText=h,m},R2=function(n,r){for(var s=r.length;s--;)if(n.hasAttribute(r[s]))return n.getAttribute(r[s])},VC=function(n){var r;try{r=n.getBBox()}catch{r=ly.call(n,!0)}return r&&(r.width||r.height)||n.getBBox===ly||(r=ly.call(n,!0)),r&&!r.width&&!r.x&&!r.y?{x:+R2(n,["x","cx","x1"])||0,y:+R2(n,["y","cy","y1"])||0,width:0,height:0}:r},GC=function(n){return!!(n.getCTM&&(!n.parentNode||n.ownerSVGElement)&&VC(n))},Bd=function(n,r){if(r){var s=n.style;r in bl&&r!==wl&&(r=_i),s.removeProperty?((r.substr(0,2)==="ms"||r.substr(0,6)==="webkit")&&(r="-"+r),s.removeProperty(r.replace(BC,"-$1").toLowerCase())):s.removeAttribute(r)}},ml=function(n,r,s,c,h,m){var a=new no(n._pt,r,s,0,1,m?jC:NC);return n._pt=a,a.b=c,a.e=h,n._props.push(s),a},z2={deg:1,rad:1,turn:1},Tl=function e(n,r,s,c){var h=parseFloat(s)||0,m=(s+"").trim().substr((h+"").length)||"px",a=Mc.style,v=Q6.test(r),w=n.tagName.toLowerCase()==="svg",E=(w?"client":"offset")+(v?"Width":"Height"),I=100,M=c==="px",P=c==="%",j,N,q,V;return c===m||!h||z2[c]||z2[m]?h:(m!=="px"&&!M&&(h=e(n,r,s,"px")),V=n.getCTM&&GC(n),(P||m==="%")&&(bl[r]||~r.indexOf("adius"))?(j=V?n.getBBox()[v?"width":"height"]:n[E],jr(P?h/j*I:h/100*j)):(a[v?"width":"height"]=I+(M?m:c),N=~r.indexOf("adius")||c==="em"&&n.appendChild&&!w?n:n.parentNode,V&&(N=(n.ownerSVGElement||{}).parentNode),(!N||N===dl||!N.appendChild)&&(N=dl.body),q=N._gsap,q&&P&&q.width&&v&&q.time===jo.time?jr(h/q.width*I):((P||m==="%")&&(a.position=ma(n,"position")),N===n&&(a.position="static"),N.appendChild(Mc),j=Mc[E],N.removeChild(Mc),a.position="absolute",v&&P&&(q=Oc(N),q.time=jo.time,q.width=N[E]),jr(M?j*h/I:j&&h?I/j*h:0))))},Tc=function(n,r,s,c){var h;return Bx||Sv(),r in pl&&r!=="transform"&&(r=pl[r],~r.indexOf(",")&&(r=r.split(",")[0])),bl[r]&&r!=="transform"?(h=Nd(n,c),h=r!=="transformOrigin"?h[r]:h.svg?h.origin:D_(ma(n,wl))+" "+h.zOrigin+"px"):(h=n.style[r],(!h||h==="auto"||c||~(h+"").indexOf("calc("))&&(h=P_[r]&&P_[r](n,r,s)||ma(n,r)||cC(n,r)||(r==="opacity"?1:0))),s&&!~(h+"").trim().indexOf(" ")?Tl(n,r,h,s)+s:h},cU=function(n,r,s,c){if(!s||s==="none"){var h=Rh(r,n,1),m=h&&ma(n,h,1);m&&m!==s?(r=h,s=m):r==="borderColor"&&(s=ma(n,"borderTopColor"))}var a=new no(this._pt,n.style,r,0,1,LC),v=0,w=0,E,I,M,P,j,N,q,V,ee,oe,pe,se,xe;if(a.b=s,a.e=c,s+="",c+="",c==="auto"&&(n.style[r]=c,c=ma(n,r)||c,n.style[r]=s),E=[s,c],AC(E),s=E[0],c=E[1],M=s.match(lh)||[],xe=c.match(lh)||[],xe.length){for(;I=lh.exec(c);)q=I[0],ee=c.substring(v,I.index),j?j=(j+1)%5:(ee.substr(-5)==="rgba("||ee.substr(-5)==="hsla(")&&(j=1),q!==(N=M[w++]||"")&&(P=parseFloat(N)||0,pe=N.substr((P+"").length),se=q.charAt(1)==="="?+(q.charAt(0)+"1"):0,se&&(q=q.substr(2)),V=parseFloat(q),oe=q.substr((V+"").length),v=lh.lastIndex-oe.length,oe||(oe=oe||bo.units[r]||pe,v===c.length&&(c+=oe,a.e+=oe)),pe!==oe&&(P=Tl(n,r,N,oe)||0),a._pt={_next:a._pt,p:ee||w===1?ee:",",s:P,c:se?se*V:V-P,m:j&&j<4||r==="zIndex"?Math.round:0});a.c=v<c.length?c.substring(v,c.length):""}else a.r=r==="display"&&c==="none"?jC:NC;return rC.test(c)&&(a.e=0),this._pt=a,a},O2={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},uU=function(n){var r=n.split(" "),s=r[0],c=r[1]||"50%";return(s==="top"||s==="bottom"||c==="left"||c==="right")&&(n=s,s=c,c=n),r[0]=O2[s]||s,r[1]=O2[c]||c,r.join(" ")},hU=function(n,r){if(r.tween&&r.tween._time===r.tween._dur){var s=r.t,c=s.style,h=r.u,m=s._gsap,a,v,w;if(h==="all"||h===!0)c.cssText="",v=1;else for(h=h.split(","),w=h.length;--w>-1;)a=h[w],bl[a]&&(v=1,a=a==="transformOrigin"?wl:_i),Bd(s,a);v&&(Bd(s,_i),m&&(m.svg&&s.removeAttribute("transform"),Nd(s,1),m.uncache=1))}},P_={clearProps:function(n,r,s,c,h){if(h.data!=="isFromStart"){var m=n._pt=new no(n._pt,r,s,0,0,hU);return m.u=c,m.pr=-10,m.tween=h,n._props.push(s),1}}},Ud=[1,0,0,1,0,0],qC={},ZC=function(n){return n==="matrix(1, 0, 0, 1, 0, 0)"||n==="none"||!n},L2=function(n){var r=ma(n,_i);return ZC(r)?Ud:r.substr(7).match(nC).map(jr)},Ux=function(n,r){var s=n._gsap||Oc(n),c=n.style,h=L2(n),m,a,v,w;return s.svg&&n.getAttribute("transform")?(v=n.transform.baseVal.consolidate().matrix,h=[v.a,v.b,v.c,v.d,v.e,v.f],h.join(",")==="1,0,0,1,0,0"?Ud:h):(h===Ud&&!n.offsetParent&&n!==_h&&!s.svg&&(v=c.display,c.display="block",m=n.parentNode,(!m||!n.offsetParent)&&(w=1,a=n.nextSibling,_h.appendChild(n)),h=L2(n),v?c.display=v:Bd(n,"display"),w&&(a?m.insertBefore(n,a):m?m.appendChild(n):_h.removeChild(n))),r&&h.length>6?[h[0],h[1],h[4],h[5],h[12],h[13]]:h)},Av=function(n,r,s,c,h,m){var a=n._gsap,v=h||Ux(n,!0),w=a.xOrigin||0,E=a.yOrigin||0,I=a.xOffset||0,M=a.yOffset||0,P=v[0],j=v[1],N=v[2],q=v[3],V=v[4],ee=v[5],oe=r.split(" "),pe=parseFloat(oe[0])||0,se=parseFloat(oe[1])||0,xe,Te,De,Me;s?v!==Ud&&(Te=P*q-j*N)&&(De=pe*(q/Te)+se*(-N/Te)+(N*ee-q*V)/Te,Me=pe*(-j/Te)+se*(P/Te)-(P*ee-j*V)/Te,pe=De,se=Me):(xe=VC(n),pe=xe.x+(~oe[0].indexOf("%")?pe/100*xe.width:pe),se=xe.y+(~(oe[1]||oe[0]).indexOf("%")?se/100*xe.height:se)),c||c!==!1&&a.smooth?(V=pe-w,ee=se-E,a.xOffset=I+(V*P+ee*N)-V,a.yOffset=M+(V*j+ee*q)-ee):a.xOffset=a.yOffset=0,a.xOrigin=pe,a.yOrigin=se,a.smooth=!!c,a.origin=r,a.originIsAbsolute=!!s,n.style[wl]="0px 0px",m&&(ml(m,a,"xOrigin",w,pe),ml(m,a,"yOrigin",E,se),ml(m,a,"xOffset",I,a.xOffset),ml(m,a,"yOffset",M,a.yOffset)),n.setAttribute("data-svg-origin",pe+" "+se)},Nd=function(n,r){var s=n._gsap||new kC(n);if("x"in s&&!r&&!s.uncache)return s;var c=n.style,h=s.scaleX<0,m="px",a="deg",v=ma(n,wl)||"0",w,E,I,M,P,j,N,q,V,ee,oe,pe,se,xe,Te,De,Me,Be,ze,Fe,Je,be,qe,Ke,_t,It,Tt,Dn,Ot,Zn,Rn,_r;return w=E=I=j=N=q=V=ee=oe=0,M=P=1,s.svg=!!(n.getCTM&&GC(n)),xe=Ux(n,s.svg),s.svg&&(Ke=(!s.uncache||v==="0px 0px")&&!r&&n.getAttribute("data-svg-origin"),Av(n,Ke||v,!!Ke||s.originIsAbsolute,s.smooth!==!1,xe)),pe=s.xOrigin||0,se=s.yOrigin||0,xe!==Ud&&(Be=xe[0],ze=xe[1],Fe=xe[2],Je=xe[3],w=be=xe[4],E=qe=xe[5],xe.length===6?(M=Math.sqrt(Be*Be+ze*ze),P=Math.sqrt(Je*Je+Fe*Fe),j=Be||ze?Xu(ze,Be)*wc:0,V=Fe||Je?Xu(Fe,Je)*wc+j:0,V&&(P*=Math.abs(Math.cos(V*gh))),s.svg&&(w-=pe-(pe*Be+se*Fe),E-=se-(pe*ze+se*Je))):(_r=xe[6],Zn=xe[7],Tt=xe[8],Dn=xe[9],Ot=xe[10],Rn=xe[11],w=xe[12],E=xe[13],I=xe[14],Te=Xu(_r,Ot),N=Te*wc,Te&&(De=Math.cos(-Te),Me=Math.sin(-Te),Ke=be*De+Tt*Me,_t=qe*De+Dn*Me,It=_r*De+Ot*Me,Tt=be*-Me+Tt*De,Dn=qe*-Me+Dn*De,Ot=_r*-Me+Ot*De,Rn=Zn*-Me+Rn*De,be=Ke,qe=_t,_r=It),Te=Xu(-Fe,Ot),q=Te*wc,Te&&(De=Math.cos(-Te),Me=Math.sin(-Te),Ke=Be*De-Tt*Me,_t=ze*De-Dn*Me,It=Fe*De-Ot*Me,Rn=Je*Me+Rn*De,Be=Ke,ze=_t,Fe=It),Te=Xu(ze,Be),j=Te*wc,Te&&(De=Math.cos(Te),Me=Math.sin(Te),Ke=Be*De+ze*Me,_t=be*De+qe*Me,ze=ze*De-Be*Me,qe=qe*De-be*Me,Be=Ke,be=_t),N&&Math.abs(N)+Math.abs(j)>359.9&&(N=j=0,q=180-q),M=jr(Math.sqrt(Be*Be+ze*ze+Fe*Fe)),P=jr(Math.sqrt(qe*qe+_r*_r)),Te=Xu(be,qe),V=Math.abs(Te)>2e-4?Te*wc:0,oe=Rn?1/(Rn<0?-Rn:Rn):0),s.svg&&(Ke=n.getAttribute("transform"),s.forceCSS=n.setAttribute("transform","")||!ZC(ma(n,_i)),Ke&&n.setAttribute("transform",Ke))),Math.abs(V)>90&&Math.abs(V)<270&&(h?(M*=-1,V+=j<=0?180:-180,j+=j<=0?180:-180):(P*=-1,V+=V<=0?180:-180)),s.x=w-((s.xPercent=w&&(s.xPercent||(Math.round(n.offsetWidth/2)===Math.round(-w)?-50:0)))?n.offsetWidth*s.xPercent/100:0)+m,s.y=E-((s.yPercent=E&&(s.yPercent||(Math.round(n.offsetHeight/2)===Math.round(-E)?-50:0)))?n.offsetHeight*s.yPercent/100:0)+m,s.z=I+m,s.scaleX=jr(M),s.scaleY=jr(P),s.rotation=jr(j)+a,s.rotationX=jr(N)+a,s.rotationY=jr(q)+a,s.skewX=V+a,s.skewY=ee+a,s.transformPerspective=oe+m,(s.zOrigin=parseFloat(v.split(" ")[2])||0)&&(c[wl]=D_(v)),s.xOffset=s.yOffset=0,s.force3D=bo.force3D,s.renderTransform=s.svg?dU:$C?WC:fU,s.uncache=0,s},D_=function(n){return(n=n.split(" "))[0]+" "+n[1]},cy=function(n,r,s){var c=Qi(r);return jr(parseFloat(r)+parseFloat(Tl(n,"x",s+"px",c)))+c},fU=function(n,r){r.z="0px",r.rotationY=r.rotationX="0deg",r.force3D=0,WC(n,r)},_c="0deg",Hf="0px",gc=") ",WC=function(n,r){var s=r||this,c=s.xPercent,h=s.yPercent,m=s.x,a=s.y,v=s.z,w=s.rotation,E=s.rotationY,I=s.rotationX,M=s.skewX,P=s.skewY,j=s.scaleX,N=s.scaleY,q=s.transformPerspective,V=s.force3D,ee=s.target,oe=s.zOrigin,pe="",se=V==="auto"&&n&&n!==1||V===!0;if(oe&&(I!==_c||E!==_c)){var xe=parseFloat(E)*gh,Te=Math.sin(xe),De=Math.cos(xe),Me;xe=parseFloat(I)*gh,Me=Math.cos(xe),m=cy(ee,m,Te*Me*-oe),a=cy(ee,a,-Math.sin(xe)*-oe),v=cy(ee,v,De*Me*-oe+oe)}q!==Hf&&(pe+="perspective("+q+gc),(c||h)&&(pe+="translate("+c+"%, "+h+"%) "),(se||m!==Hf||a!==Hf||v!==Hf)&&(pe+=v!==Hf||se?"translate3d("+m+", "+a+", "+v+") ":"translate("+m+", "+a+gc),w!==_c&&(pe+="rotate("+w+gc),E!==_c&&(pe+="rotateY("+E+gc),I!==_c&&(pe+="rotateX("+I+gc),(M!==_c||P!==_c)&&(pe+="skew("+M+", "+P+gc),(j!==1||N!==1)&&(pe+="scale("+j+", "+N+gc),ee.style[_i]=pe||"translate(0, 0)"},dU=function(n,r){var s=r||this,c=s.xPercent,h=s.yPercent,m=s.x,a=s.y,v=s.rotation,w=s.skewX,E=s.skewY,I=s.scaleX,M=s.scaleY,P=s.target,j=s.xOrigin,N=s.yOrigin,q=s.xOffset,V=s.yOffset,ee=s.forceCSS,oe=parseFloat(m),pe=parseFloat(a),se,xe,Te,De,Me;v=parseFloat(v),w=parseFloat(w),E=parseFloat(E),E&&(E=parseFloat(E),w+=E,v+=E),v||w?(v*=gh,w*=gh,se=Math.cos(v)*I,xe=Math.sin(v)*I,Te=Math.sin(v-w)*-M,De=Math.cos(v-w)*M,w&&(E*=gh,Me=Math.tan(w-E),Me=Math.sqrt(1+Me*Me),Te*=Me,De*=Me,E&&(Me=Math.tan(E),Me=Math.sqrt(1+Me*Me),se*=Me,xe*=Me)),se=jr(se),xe=jr(xe),Te=jr(Te),De=jr(De)):(se=I,De=M,xe=Te=0),(oe&&!~(m+"").indexOf("px")||pe&&!~(a+"").indexOf("px"))&&(oe=Tl(P,"x",m,"px"),pe=Tl(P,"y",a,"px")),(j||N||q||V)&&(oe=jr(oe+j-(j*se+N*Te)+q),pe=jr(pe+N-(j*xe+N*De)+V)),(c||h)&&(Me=P.getBBox(),oe=jr(oe+c/100*Me.width),pe=jr(pe+h/100*Me.height)),Me="matrix("+se+","+xe+","+Te+","+De+","+oe+","+pe+")",P.setAttribute("transform",Me),ee&&(P.style[_i]=Me)},pU=function(n,r,s,c,h,m){var a=360,v=oi(h),w=parseFloat(h)*(v&&~h.indexOf("rad")?wc:1),E=m?w*m:w-c,I=c+E+"deg",M,P;return v&&(M=h.split("_")[1],M==="short"&&(E%=a,E!==E%(a/2)&&(E+=E<0?a:-a)),M==="cw"&&E<0?E=(E+a*P2)%a-~~(E/a)*a:M==="ccw"&&E>0&&(E=(E-a*P2)%a-~~(E/a)*a)),n._pt=P=new no(n._pt,r,s,c,E,eU),P.e=I,P.u="deg",n._props.push(s),P},F2=function(n,r){for(var s in r)n[s]=r[s];return n},mU=function(n,r,s){var c=F2({},s._gsap),h="perspective,force3D,transformOrigin,svgOrigin",m=s.style,a,v,w,E,I,M,P,j;c.svg?(w=s.getAttribute("transform"),s.setAttribute("transform",""),m[_i]=r,a=Nd(s,1),Bd(s,_i),s.setAttribute("transform",w)):(w=getComputedStyle(s)[_i],m[_i]=r,a=Nd(s,1),m[_i]=w);for(v in bl)w=c[v],E=a[v],w!==E&&h.indexOf(v)<0&&(P=Qi(w),j=Qi(E),I=P!==j?Tl(s,v,w,j):parseFloat(w),M=parseFloat(E),n._pt=new no(n._pt,a,v,I,M-I,UC),n._pt.u=j||0,n._props.push(v));F2(a,c)};to("padding,margin,Width,Radius",function(e,n){var r="Top",s="Right",c="Bottom",h="Left",m=(n<3?[r,s,c,h]:[r+h,r+s,c+s,c+h]).map(function(a){return n<2?e+a:"border"+a+e});P_[n>1?"border"+e:e]=function(a,v,w,E,I){var M,P;if(arguments.length<4)return M=m.map(function(j){return Tc(a,j,w)}),P=M.join(" "),P.split(M[0]).length===5?M[0]:P;M=(E+"").split(" "),P={},m.forEach(function(j,N){return P[j]=M[N]=M[N]||M[(N-1)/2|0]}),a.init(v,P,I)}});var HC={name:"css",register:Sv,targetTest:function(n){return n.style&&n.nodeType},init:function(n,r,s,c,h){var m=this._props,a=n.style,v=s.vars.startAt,w,E,I,M,P,j,N,q,V,ee,oe,pe,se,xe,Te;Bx||Sv();for(N in r)if(N!=="autoRound"&&(E=r[N],!(mo[N]&&PC(N,r,s,c,n,h)))){if(P=typeof E,j=P_[N],P==="function"&&(E=E.call(s,c,n,h),P=typeof E),P==="string"&&~E.indexOf("random(")&&(E=Ld(E)),j)j(this,n,N,E,s)&&(Te=1);else if(N.substr(0,2)==="--")w=(getComputedStyle(n).getPropertyValue(N)+"").trim(),E+="",vl.lastIndex=0,vl.test(w)||(q=Qi(w),V=Qi(E)),V?q!==V&&(w=Tl(n,N,w,V)+V):q&&(E+=q),this.add(a,"setProperty",w,E,c,h,0,0,N),m.push(N);else if(P!=="undefined"){if(v&&N in v?(w=typeof v[N]=="function"?v[N].call(s,c,n,h):v[N],oi(w)&&~w.indexOf("random(")&&(w=Ld(w)),Qi(w+"")||(w+=bo.units[N]||Qi(Tc(n,N))||""),(w+"").charAt(1)==="="&&(w=Tc(n,N))):w=Tc(n,N),M=parseFloat(w),ee=P==="string"&&E.charAt(1)==="="?+(E.charAt(0)+"1"):0,ee&&(E=E.substr(2)),I=parseFloat(E),N in pl&&(N==="autoAlpha"&&(M===1&&Tc(n,"visibility")==="hidden"&&I&&(M=0),ml(this,a,"visibility",M?"inherit":"hidden",I?"inherit":"hidden",!I)),N!=="scale"&&N!=="transform"&&(N=pl[N],~N.indexOf(",")&&(N=N.split(",")[0]))),oe=N in bl,oe){if(pe||(se=n._gsap,se.renderTransform&&!r.parseTransform||Nd(n,r.parseTransform),xe=r.smoothOrigin!==!1&&se.smooth,pe=this._pt=new no(this._pt,a,_i,0,1,se.renderTransform,se,0,-1),pe.dep=1),N==="scale")this._pt=new no(this._pt,se,"scaleY",se.scaleY,(ee?ee*I:I-se.scaleY)||0),m.push("scaleY",N),N+="X";else if(N==="transformOrigin"){E=uU(E),se.svg?Av(n,E,0,xe,0,this):(V=parseFloat(E.split(" ")[2])||0,V!==se.zOrigin&&ml(this,se,"zOrigin",se.zOrigin,V),ml(this,a,N,D_(w),D_(E)));continue}else if(N==="svgOrigin"){Av(n,E,1,xe,0,this);continue}else if(N in qC){pU(this,se,N,M,E,ee);continue}else if(N==="smoothOrigin"){ml(this,se,"smooth",se.smooth,E);continue}else if(N==="force3D"){se[N]=E;continue}else if(N==="transform"){mU(this,E,n);continue}}else N in a||(N=Rh(N)||N);if(oe||(I||I===0)&&(M||M===0)&&!J6.test(E)&&N in a)q=(w+"").substr((M+"").length),I||(I=0),V=Qi(E)||(N in bo.units?bo.units[N]:q),q!==V&&(M=Tl(n,N,w,V)),this._pt=new no(this._pt,oe?se:a,N,M,ee?ee*I:I-M,!oe&&(V==="px"||N==="zIndex")&&r.autoRound!==!1?nU:UC),this._pt.u=V||0,q!==V&&V!=="%"&&(this._pt.b=w,this._pt.r=tU);else if(N in a)cU.call(this,n,N,w,E);else if(N in n)this.add(n,N,w||n[N],E,c,h);else{kx(N,E);continue}m.push(N)}}Te&&FC(this)},get:Tc,aliases:pl,getSetter:function(n,r,s){var c=pl[r];return c&&c.indexOf(",")<0&&(r=c),r in bl&&r!==wl&&(n._gsap.x||Tc(n,"x"))?s&&k2===s?r==="scale"?sU:oU:(k2=s||{})&&(r==="scale"?aU:lU):n.style&&!Ix(n.style[r])?rU:~r.indexOf("-")?iU:Lx(n,r)},core:{_removeProperty:Bd,_getMatrix:Ux}};Hs.utils.checkPrefix=Rh;(function(e,n,r,s){var c=to(e+","+n+","+r,function(h){bl[h]=1});to(n,function(h){bo.units[h]="deg",qC[h]=1}),pl[c[13]]=e+","+n,to(s,function(h){var m=h.split(":");pl[m[1]]=c[m[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");to("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(e){bo.units[e]="px"});Hs.registerPlugin(HC);var _U=Hs.registerPlugin(HC)||Hs;_U.core.Tween;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var cn=function(){return cn=Object.assign||function(n){for(var r,s=1,c=arguments.length;s<c;s++){r=arguments[s];for(var h in r)Object.prototype.hasOwnProperty.call(r,h)&&(n[h]=r[h])}return n},cn.apply(this,arguments)},B2=function(){function e(){}return e.log=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];console.log.apply(console,n)},e.error=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];console.error.apply(console,n)},e.time=function(n){console.time(n)},e.timeEnd=function(n){console.timeEnd(n)},e}(),U2={50:"#f0f9ff",100:"#e0f2fe",200:"#bae6fd",300:"#7dd3fc",400:"#38bdf8",500:"#0ea5e9",600:"#0284c7",700:"#0369a1",800:"#075985",900:"#0c4a6e"},N2=!1,tr={black:"#000",white:"#fff",rose:{50:"#fff1f2",100:"#ffe4e6",200:"#fecdd3",300:"#fda4af",400:"#fb7185",500:"#f43f5e",600:"#e11d48",700:"#be123c",800:"#9f1239",900:"#881337"},pink:{50:"#fdf2f8",100:"#fce7f3",200:"#fbcfe8",300:"#f9a8d4",400:"#f472b6",500:"#ec4899",600:"#db2777",700:"#be185d",800:"#9d174d",900:"#831843"},fuchsia:{50:"#fdf4ff",100:"#fae8ff",200:"#f5d0fe",300:"#f0abfc",400:"#e879f9",500:"#d946ef",600:"#c026d3",700:"#a21caf",800:"#86198f",900:"#701a75"},purple:{50:"#faf5ff",100:"#f3e8ff",200:"#e9d5ff",300:"#d8b4fe",400:"#c084fc",500:"#a855f7",600:"#9333ea",700:"#7e22ce",800:"#6b21a8",900:"#581c87"},violet:{50:"#f5f3ff",100:"#ede9fe",200:"#ddd6fe",300:"#c4b5fd",400:"#a78bfa",500:"#8b5cf6",600:"#7c3aed",700:"#6d28d9",800:"#5b21b6",900:"#4c1d95"},indigo:{50:"#eef2ff",100:"#e0e7ff",200:"#c7d2fe",300:"#a5b4fc",400:"#818cf8",500:"#6366f1",600:"#4f46e5",700:"#4338ca",800:"#3730a3",900:"#312e81"},blue:{50:"#eff6ff",100:"#dbeafe",200:"#bfdbfe",300:"#93c5fd",400:"#60a5fa",500:"#3b82f6",600:"#2563eb",700:"#1d4ed8",800:"#1e40af",900:"#1e3a8a"},sky:U2,get lightBlue(){return N2||(B2.log("warn - `lightBlue` has been renamed to `sky`."),B2.log("warn - Please update your color palette to eliminate this warning."),N2=!0),U2},cyan:{50:"#ecfeff",100:"#cffafe",200:"#a5f3fc",300:"#67e8f9",400:"#22d3ee",500:"#06b6d4",600:"#0891b2",700:"#0e7490",800:"#155e75",900:"#164e63"},teal:{50:"#f0fdfa",100:"#ccfbf1",200:"#99f6e4",300:"#5eead4",400:"#2dd4bf",500:"#14b8a6",600:"#0d9488",700:"#0f766e",800:"#115e59",900:"#134e4a"},emerald:{50:"#ecfdf5",100:"#d1fae5",200:"#a7f3d0",300:"#6ee7b7",400:"#34d399",500:"#10b981",600:"#059669",700:"#047857",800:"#065f46",900:"#064e3b"},green:{50:"#f0fdf4",100:"#dcfce7",200:"#bbf7d0",300:"#86efac",400:"#4ade80",500:"#22c55e",600:"#16a34a",700:"#15803d",800:"#166534",900:"#14532d"},lime:{50:"#f7fee7",100:"#ecfccb",200:"#d9f99d",300:"#bef264",400:"#a3e635",500:"#84cc16",600:"#65a30d",700:"#4d7c0f",800:"#3f6212",900:"#365314"},yellow:{50:"#fefce8",100:"#fef9c3",200:"#fef08a",300:"#fde047",400:"#facc15",500:"#eab308",600:"#ca8a04",700:"#a16207",800:"#854d0e",900:"#713f12"},amber:{50:"#fffbeb",100:"#fef3c7",200:"#fde68a",300:"#fcd34d",400:"#fbbf24",500:"#f59e0b",600:"#d97706",700:"#b45309",800:"#92400e",900:"#78350f"},orange:{50:"#fff7ed",100:"#ffedd5",200:"#fed7aa",300:"#fdba74",400:"#fb923c",500:"#f97316",600:"#ea580c",700:"#c2410c",800:"#9a3412",900:"#7c2d12"},red:{50:"#fef2f2",100:"#fee2e2",200:"#fecaca",300:"#fca5a5",400:"#f87171",500:"#ef4444",600:"#dc2626",700:"#b91c1c",800:"#991b1b",900:"#7f1d1d"},warmGray:{50:"#fafaf9",100:"#f5f5f4",200:"#e7e5e4",300:"#d6d3d1",400:"#a8a29e",500:"#78716c",600:"#57534e",700:"#44403c",800:"#292524",900:"#1c1917"},trueGray:{50:"#fafafa",100:"#f5f5f5",200:"#e5e5e5",300:"#d4d4d4",400:"#a3a3a3",500:"#737373",600:"#525252",700:"#404040",800:"#262626",900:"#171717"},gray:{50:"#fafafa",100:"#f4f4f5",200:"#e4e4e7",300:"#d4d4d8",400:"#a1a1aa",500:"#71717a",600:"#52525b",700:"#3f3f46",800:"#27272a",900:"#18181b"},coolGray:{50:"#f9fafb",100:"#f3f4f6",200:"#e5e7eb",300:"#d1d5db",400:"#9ca3af",500:"#6b7280",600:"#4b5563",700:"#374151",800:"#1f2937",900:"#111827"},blueGray:{50:"#f8fafc",100:"#f1f5f9",200:"#e2e8f0",300:"#cbd5e1",400:"#94a3b8",500:"#64748b",600:"#475569",700:"#334155",800:"#1e293b",900:"#0f172a"},slate:{50:"#f8fafc",100:"#f1f5f9",200:"#e2e8f0",300:"#cbd5e1",400:"#94A3B8",500:"#64748B",600:"#475569",700:"#334155",800:"#1E293B",900:"#0F172A"},zink:{50:"#fafafa",100:"#f4f4f5",200:"#e4e4e7",300:"#d4d4d8",400:"#a1a1aa",500:"#71717A",600:"#52525B",700:"#3F3F46",800:"#27272A",900:"#18181B"},neutral:{50:"#fafafa",100:"#f5f5f5",200:"#e5e5e5",300:"#d4d4d4",400:"#a3a3a3",500:"#737373",600:"#525252",700:"#404040",800:"#262626",900:"#171717"},stone:{50:"#fafaf9",100:"#f5f5f4",200:"#e7e5e4",300:"#d6d3d1",400:"#a8a29e",500:"#78716C",600:"#57534E",700:"#44403C",800:"#292524",900:"#1C1917"},light:{50:"#fdfdfd",100:"#fcfcfc",200:"#fafafa",300:"#f8f9fa",400:"#f6f6f6",500:"#f2f2f2",600:"#f1f3f5",700:"#e9ecef",800:"#dee2e6",900:"#dde1e3"},dark:{50:"#4a4a4a",100:"#3c3c3c",200:"#323232",300:"#2d2d2d",400:"#222222",500:"#1f1f1f",600:"#1c1c1e",700:"#1b1b1b",800:"#181818",900:"#0f0f0f"}},gU={spin:{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}},ping:{"0%":{transform:"scale(1)",opacity:"1"},"75%, 100%":{transform:"scale(2)",opacity:"0"}},pulse:{"0%, 100%":{opacity:"1"},"50%":{opacity:".5"}},bounce:{"0%, 100%":{transform:"translateY(-25%)",animationTimingFunction:"cubic-bezier(0.8,0,1,1)"},"50%":{transform:"translateY(0)",animationTimingFunction:"cubic-bezier(0,0,0.2,1)"}},shock:{"from, 20%, 53%, 80%, to":{animationTimingFunction:"cubic-bezier(0.215, 0.61, 0.355, 1)",transform:"translate3d(0, 0, 0)"},"40%, 43%":{animationTimingFunction:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",transform:"translate3d(0, -30px, 0)"},"70%":{animationTimingFunction:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",transform:"translate3d(0, -15px, 0)"},"90%":{transform:"translate3d(0, -4px, 0)"}},flash:{"from, 50%, to":{opacity:"1"},"25%, 75%":{opacity:"0"}},bubble:{from:{transform:"scale3d(1, 1, 1)"},"50%":{transform:"scale3d(1.05, 1.05, 1.05)"},to:{transform:"scale3d(1, 1, 1)"}},rubberBand:{from:{transform:"scale3d(1, 1, 1)"},"30%":{transform:"scale3d(1.25, 0.75, 1)"},"40%":{transform:"scale3d(0.75, 1.25, 1)"},"50%":{transform:"scale3d(1.15, 0.85, 1)"},"65%":{transform:"scale3d(0.95, 1.05, 1)"},"75%":{transform:"scale3d(1.05, 0.95, 1)"},to:{transform:"scale3d(1, 1, 1)"}},shakeX:{"from, to":{transform:"translate3d(0, 0, 0)"},"10%, 30%, 50%, 70%, 90%":{transform:"translate3d(-10px, 0, 0)"},"20%, 40%, 60%, 80%":{transform:"translate3d(10px, 0, 0)"}},shakeY:{"from, to":{transform:"translate3d(0, 0, 0)"},"10%, 30%, 50%, 70%, 90%":{transform:"translate3d(0, -10px, 0)"},"20%, 40%, 60%, 80%":{transform:"translate3d(0, 10px, 0)"}},headShake:{"0%":{transform:"translateX(0)"},"6.5%":{transform:"translateX(-6px) rotateY(-9deg)"},"18.5%":{transform:"translateX(5px) rotateY(7deg)"},"31.5%":{transform:"translateX(-3px) rotateY(-5deg)"},"43.5%":{transform:"translateX(2px) rotateY(3deg)"},"50%":{transform:"translateX(0)"}},swing:{"20%":{transform:"rotate3d(0, 0, 1, 15deg)"},"40%":{transform:"rotate3d(0, 0, 1, -10deg)"},"60%":{transform:"rotate3d(0, 0, 1, 5deg)"},"80%":{transform:"rotate3d(0, 0, 1, -5deg)"},to:{transform:"rotate3d(0, 0, 1, 0deg)"}},tada:{from:{transform:"scale3d(1, 1, 1)"},"10%, 20%":{transform:"scale3d(0.9, 0.9, 0.9) rotate3d(0, 0, 1, -3deg)"},"30%, 50%, 70%, 90%":{transform:"scale3d(1.1, 1.1, 1.1) rotate3d(0, 0, 1, 3deg)"},"40%, 60%, 80%":{transform:"scale3d(1.1, 1.1, 1.1) rotate3d(0, 0, 1, -3deg)"},to:{transform:"scale3d(1, 1, 1)"}},wobble:{from:{transform:"translate3d(0, 0, 0)"},"15%":{transform:"translate3d(-25%, 0, 0) rotate3d(0, 0, 1, -5deg)"},"30%":{transform:"translate3d(20%, 0, 0) rotate3d(0, 0, 1, 3deg)"},"45%":{transform:"translate3d(-15%, 0, 0) rotate3d(0, 0, 1, -3deg)"},"60%":{transform:"translate3d(10%, 0, 0) rotate3d(0, 0, 1, 2deg)"},"75%":{transform:"translate3d(-5%, 0, 0) rotate3d(0, 0, 1, -1deg)"},to:{transform:"translate3d(0, 0, 0)"}},jello:{"from, 11.1% to":{transform:"translate3d(0, 0, 0)"},"22.2%":{transform:"skewX(-12.5deg) skewY(-12.5deg)"},"33.3%":{transform:"skewX(6.25deg) skewY(6.25deg)"},"44.4%":{transform:"skewX(-3.125deg) skewY(-3.125deg)"},"55.5%":{transform:"skewX(1.5625deg) skewY(1.5625deg)"},"66.6%":{transform:"skewX(-0.78125deg) skewY(-0.78125deg)"},"77.7%":{transform:"skewX(0.390625deg) skewY(0.390625deg)"},"88.8%":{transform:"skewX(-0.1953125deg) skewY(-0.1953125deg)"}},heartBeat:{"0%":{transform:"scale(1)"},"14%":{transform:"scale(1.3)"},"28%":{transform:"scale(1)"},"42%":{transform:"scale(1.3)"},"70%":{transform:"scale(1)"}},hinge:{"0%":{transformOrigin:"top left",animationTimingFunction:"ease-in-out"},"20%, 60%":{transform:"rotate3d(0, 0, 1, 80deg)",transformOrigin:"top left",animationTimingFunction:"ease-in-out"},"40%, 80%":{transform:"rotate3d(0, 0, 1, 60deg)",transformOrigin:"top left",animationTimingFunction:"ease-in-out"},to:{transform:"translate3d(0, 700px, 0)",opacity:"0"}},jackInTheBox:{from:{opacity:"0",transformOrigin:"center bottom",transform:"scale(0.1) rotate(30deg)"},"50%":{transform:"rotate(-10deg)"},"70%":{transform:"rotate(3deg)"},to:{transform:"scale(1)"}},lightSpeedInRight:{from:{opacity:"0",transform:"translate3d(100%, 0, 0) skewX(-30deg)"},"60%":{opacity:"1",transform:"skewX(20deg)"},"80%":{transform:"skewX(-5deg)"},to:{transform:"translate3d(0, 0, 0)"}},lightSpeedInLeft:{from:{opacity:"0",transform:"translate3d(100%, 0, 0) skewX(-30deg)"},"60%":{opacity:"1",transform:"skewX(20deg)"},"80%":{transform:"skewX(-5deg)"},to:{transform:"translate3d(0, 0, 0)"}},lightSpeedOutLeft:{from:{opacity:"1"},to:{opacity:"0",transform:"translate3d(100%, 0, 0) skewX(30deg)"}},lightSpeedOutRight:{from:{opacity:"1"},to:{opacity:"0",transform:"translate3d(100%, 0, 0) skewX(30deg)"}},flip:{from:{transform:"perspective(400px) scale3d(1, 1, 1) translate3d(0, 0, 0) rotate3d(0, 1, 0, -360deg)",animationTimingFunction:"ease-out"},"40%":{transform:"perspective(400px) scale3d(1, 1, 1) translate3d(0, 0, 150px) rotate3d(0, 1, 0, -190deg)",animationTimingFunction:"ease-out"},"50%":{transform:"perspective(400px) scale3d(1, 1, 1) translate3d(0, 0, 150px) rotate3d(0, 1, 0, -170deg)",animationTimingFunction:"ease-in"},"80%":{transform:"perspective(400px) scale3d(0.95, 0.95, 0.95) translate3d(0, 0, 0) rotate3d(0, 1, 0, 0deg)",animationTimingFunction:"ease-in"},to:{transform:"perspective(400px) scale3d(1, 1, 1) translate3d(0, 0, 0) rotate3d(0, 1, 0, 0deg)",animationTimingFunction:"ease-in"}},flipInX:{from:{transform:"perspective(400px) rotate3d(1, 0, 0, 90deg)",animationTimingFunction:"ease-in",opacity:"0"},"40%":{transform:"perspective(400px) rotate3d(1, 0, 0, -20deg)",animationTimingFunction:"ease-in"},"60%":{transform:"perspective(400px) rotate3d(1, 0, 0, 10deg)",opacity:"1"},"80%":{transform:"perspective(400px) rotate3d(1, 0, 0, -5deg)"},to:{transform:"perspective(400px)"}},flipInY:{from:{transform:"perspective(400px) rotate3d(0, 1, 0, 90deg)",animationTimingFunction:"ease-in",opacity:"0"},"40%":{transform:"perspective(400px) rotate3d(0, 1, 0, -20deg)",animationTimingFunction:"ease-in"},"60%":{transform:"perspective(400px) rotate3d(0, 1, 0, 10deg)",opacity:"1"},"80%":{transform:"perspective(400px) rotate3d(0, 1, 0, -5deg)"},to:{transform:"perspective(400px)"}},flipOutX:{from:{transform:"perspective(400px)"},"30%":{transform:"perspective(400px) rotate3d(1, 0, 0, -20deg)",opacity:"1"},to:{transform:"perspective(400px) rotate3d(1, 0, 0, 90deg)",opacity:"0"}},flipOutY:{from:{transform:"perspective(400px)"},"30%":{transform:"perspective(400px) rotate3d(0, 1, 0, -15deg)",opacity:"1"},to:{transform:"perspective(400px) rotate3d(0, 1, 0, 90deg)",opacity:"0"}},rotateIn:{from:{transformOrigin:"center",transform:"rotate3d(0, 0, 1, -200deg)",opacity:"0"},to:{transformOrigin:"center",transform:"translate3d(0, 0, 0)",opacity:"1"}},rotateInDownLeft:{from:{transformOrigin:"left bottom",transform:"rotate3d(0, 0, 1, -45deg)",opacity:"0"},to:{transformOrigin:"left bottom",transform:"translate3d(0, 0, 0)",opacity:"1"}},rotateInDownRight:{from:{transformOrigin:"right bottom",transform:"rotate3d(0, 0, 1, 45deg)",opacity:"0"},to:{transformOrigin:"right bottom",transform:"translate3d(0, 0, 0)",opacity:"1"}},rotateInUpLeft:{from:{transformOrigin:"left top",transform:"rotate3d(0, 0, 1, 45deg)",opacity:"0"},to:{transformOrigin:"left top",transform:"translate3d(0, 0, 0)",opacity:"1"}},rotateInUpRight:{from:{transformOrigin:"right bottom",transform:"rotate3d(0, 0, 1, -90deg)",opacity:"0"},to:{transformOrigin:"right bottom",transform:"translate3d(0, 0, 0)",opacity:"1"}},rotateOut:{from:{transformOrigin:"center",opacity:"1"},to:{transformOrigin:"center",transform:"rotate3d(0, 0, 1, 200deg)",opacity:"0"}},rotateOutDownLeft:{from:{transformOrigin:"left bottom",opacity:"1"},to:{transformOrigin:"left bottom",transform:"rotate3d(0, 0, 1, 45deg)",opacity:"0"}},rotateOutDownRight:{from:{transformOrigin:"right bottom",opacity:"1"},to:{transformOrigin:"right bottom",transform:"rotate3d(0, 0, 1, -45deg)",opacity:"0"}},rotateOutUpLeft:{from:{transformOrigin:"left bottom",opacity:"1"},to:{transformOrigin:"left bottom",transform:"rotate3d(0, 0, 1, -45deg)",opacity:"0"}},rotateOutUpRight:{from:{transformOrigin:"right bottom",opacity:"1"},to:{transformOrigin:"left bottom",transform:"rotate3d(0, 0, 1, 90deg)",opacity:"0"}},rollIn:{from:{opacity:"0",transform:"translate3d(-100%, 0, 0) rotate3d(0, 0, 1, -120deg)"},to:{opacity:"1",transform:"translate3d(0, 0, 0)"}},rollOut:{from:{opacity:"1"},to:{opacity:"0",transform:"translate3d(100%, 0, 0) rotate3d(0, 0, 1, 120deg)"}},zoomIn:{from:{opacity:"0",transform:"scale3d(0.3, 0.3, 0.3)"},"50%":{opacity:"1"}},zoomInDown:{from:{opacity:"0",transform:"scale3d(0.1, 0.1, 0.1) translate3d(0, -1000px, 0)",animationTimingFunction:"cubic-bezier(0.55, 0.055, 0.675, 0.19)"},"60%":{opacity:"1",transform:"scale3d(0.475, 0.475, 0.475) translate3d(0, 60px, 0)",animationTimingFunction:"cubic-bezier(0.175, 0.885, 0.32, 1)"}},zoomInLeft:{from:{opacity:"0",transform:"scale3d(0.1, 0.1, 0.1) translate3d(-1000px, 0, 0)",animationTimingFunction:"cubic-bezier(0.55, 0.055, 0.675, 0.19)"},"60%":{opacity:"1",transform:"scale3d(0.475, 0.475, 0.475) translate3d(10px, 0, 0)",animationTimingFunction:"cubic-bezier(0.175, 0.885, 0.32, 1)"}},zoomInRight:{from:{opacity:"0",transform:"scale3d(0.1, 0.1, 0.1) translate3d(1000px, 0, 0)",animationTimingFunction:"cubic-bezier(0.55, 0.055, 0.675, 0.19)"},"60%":{opacity:"1",transform:"scale3d(0.475, 0.475, 0.475) translate3d(-10px, 0, 0)",animationTimingFunction:"cubic-bezier(0.175, 0.885, 0.32, 1)"}},zoomInUp:{from:{opacity:"0",transform:"scale3d(0.1, 0.1, 0.1) translate3d(0, 1000px, 0)",animationTimingFunction:"cubic-bezier(0.55, 0.055, 0.675, 0.19)"},"60%":{opacity:"1",transform:"scale3d(0.475, 0.475, 0.475) translate3d(0, -60px, 0)",animationTimingFunction:"cubic-bezier(0.175, 0.885, 0.32, 1)"}},bounceIn:{"from, 20%, 40%, 60%, 80%, to":{animationTimingFunction:"ease-in-out"},"0%":{opacity:"0",transform:"scale3d(0.3, 0.3, 0.3)"},"20%":{transform:"scale3d(1.1, 1.1, 1.1)"},"40%":{transform:"scale3d(0.9, 0.9, 0.9)"},"60%":{transform:"scale3d(1.03, 1.03, 1.03)",opacity:"1"},"80%":{transform:"scale3d(0.97, 0.97, 0.97)"},to:{opacity:"1",transform:"scale3d(1, 1, 1)"}},bounceInDown:{"from, 60%, 75%, 90%, to":{animationTimingFunction:"cubic-bezier(0.215, 0.61, 0.355, 1)"},"0%":{opacity:"0",transform:"translate3d(0, -3000px, 0)"},"60%":{opacity:"1",transform:"translate3d(0, 25px, 0)"},"75%":{transform:"translate3d(0, -10px, 0)"},"90%":{transform:"translate3d(0, 5px, 0)"},to:{transform:"translate3d(0, 0, 0)"}},bounceInLeft:{"from, 60%, 75%, 90%, to":{animationTimingFunction:"cubic-bezier(0.215, 0.61, 0.355, 1)"},"0%":{opacity:"0",transform:"translate3d(-3000px, 0, 0)"},"60%":{opacity:"1",transform:"translate3d(25px, 0, 0)"},"75%":{transform:"translate3d(-10px, 0, 0)"},"90%":{transform:"translate3d(5px, 0, 0)"},to:{transform:"translate3d(0, 0, 0)"}},bounceInRight:{"from, 60%, 75%, 90%, to":{animationTimingFunction:"cubic-bezier(0.215, 0.61, 0.355, 1)"},"0%":{opacity:"0",transform:"translate3d(3000px, 0, 0)"},"60%":{opacity:"1",transform:"translate3d(-25px, 0, 0)"},"75%":{transform:"translate3d(10px, 0, 0)"},"90%":{transform:"translate3d(-5px, 0, 0)"},to:{transform:"translate3d(0, 0, 0)"}},bounceInUp:{"from, 60%, 75%, 90%, to":{animationTimingFunction:"cubic-bezier(0.215, 0.61, 0.355, 1)"},"0%":{opacity:"0",transform:"translate3d(0, 3000px, 0)"},"60%":{opacity:"1",transform:"translate3d(0, -20px, 0)"},"75%":{transform:"translate3d(0, 10px, 0)"},"90%":{transform:"translate3d(0, -5px, 0)"},to:{transform:"translate3d(0, 0, 0)"}},bounceOut:{"20%":{transform:"scale3d(0.9, 0.9, 0.9)"},"50%, 55%":{opacity:"1",transform:"scale3d(1.1, 1.1, 1.1)"},to:{opacity:"0",transform:"scale3d(0.3, 0.3, 0.3)"}},bounceOutDown:{"20%":{transform:"translate3d(0, 10px, 0)"},"40%, 45%":{opacity:"1",transform:"translate3d(0, -20px, 0)"},to:{opacity:"0",transform:"translate3d(0, 2000px, 0)"}},bounceOutLeft:{"20%":{opacity:"1",transform:"translate3d(20px, 0, 0)"},to:{opacity:"0",transform:"translate3d(-2000px, 0, 0)"}},bounceOutRight:{"20%":{opacity:"1",transform:"translate3d(-20px, 0, 0)"},to:{opacity:"0",transform:"translate3d(2000px, 0, 0)"}},bounceOutUp:{"20%":{transform:"translate3d(0, -10px, 0)"},"40%, 45%":{opacity:"1",transform:"translate3d(0, 20px, 0)"},to:{opacity:"0",transform:"translate3d(0, -2000px, 0)"}},zoomOut:{from:{opacity:"1"},"50%":{opacity:"0",transform:"scale3d(0.3, 0.3, 0.3)"},to:{opacity:"0"}},zoomOutDown:{"40%":{opacity:"1",transform:"scale3d(0.475, 0.475, 0.475) translate3d(0, -60px, 0)",animationTimingFunction:"cubic-bezier(0.55, 0.055, 0.675, 0.19)"},to:{opacity:"0",transform:"scale3d(0.1, 0.1, 0.1) translate3d(0, 2000px, 0)",transformOrigin:"center bottom",animationTimingFunction:"cubic-bezier(0.175, 0.885, 0.32, 1)"}},zoomOutLeft:{"40%":{opacity:"1",transform:"scale3d(0.475, 0.475, 0.475) translate3d(42px, 0, 0)"},to:{opacity:"0",transform:"scale(0.1) translate3d(-2000px, 0, 0)",transformOrigin:"left center"}},zoomOutRight:{"40%":{opacity:"1",transform:"scale3d(0.475, 0.475, 0.475) translate3d(-42px, 0, 0)"},to:{opacity:"0",transform:"scale(0.1) translate3d(2000px, 0, 0)",transformOrigin:"right center"}},zoomOutUp:{"40%":{opacity:"1",transform:"scale3d(0.475, 0.475, 0.475) translate3d(0, 60px, 0)",animationTimingFunction:"cubic-bezier(0.55, 0.055, 0.675, 0.19)"},to:{opacity:"0",transform:"scale3d(0.1, 0.1, 0.1) translate3d(0, -2000px, 0)",transformOrigin:"center bottom",animationTimingFunction:"cubic-bezier(0.175, 0.885, 0.32, 1)"}},slideInDown:{from:{transform:"translate3d(0, -100%, 0)",visibility:"visible"},to:{transform:"translate3d(0, 0, 0)"}},slideInLeft:{from:{transform:"translate3d(-100%, 0, 0)",visibility:"visible"},to:{transform:"translate3d(0, 0, 0)"}},slideInRight:{from:{transform:"translate3d(100%, 0, 0)",visibility:"visible"},to:{transform:"translate3d(0, 0, 0)"}},slideInUp:{from:{transform:"translate3d(0, 100%, 0)",visibility:"visible"},to:{transform:"translate3d(0, 0, 0)"}},slideOutDown:{from:{transform:"translate3d(0, 0, 0)"},to:{visibility:"hidden",transform:"translate3d(0, 100%, 0)"}},slideOutLeft:{from:{transform:"translate3d(0, 0, 0)"},to:{visibility:"hidden",transform:"translate3d(-100%, 0, 0)"}},slideOutRight:{from:{transform:"translate3d(0, 0, 0)"},to:{visibility:"hidden",transform:"translate3d(100%, 0, 0)"}},slideOutUp:{from:{transform:"translate3d(0, 0, 0)"},to:{visibility:"hidden",transform:"translate3d(0, -100%, 0)"}},fadeIn:{from:{opacity:"0"},to:{opacity:"1"}},fadeInDown:{from:{opacity:"0",transform:"translate3d(0, -100%, 0)"},to:{opacity:"1",transform:"translate3d(0, 0, 0)"}},fadeInDownBig:{from:{opacity:"0",transform:"translate3d(0, -2000px, 0)"},to:{opacity:"1",transform:"translate3d(0, 0, 0)"}},fadeInLeft:{from:{opacity:"0",transform:"translate3d(-100%, 0, 0)"},to:{opacity:"1",transform:"translate3d(0, 0, 0)"}},fadeInLeftBig:{from:{opacity:"0",transform:"translate3d(-2000px, 0, 0)"},to:{opacity:"1",transform:"translate3d(0, 0, 0)"}},fadeInRight:{from:{opacity:"0",transform:"translate3d(100%, 0, 0)"},to:{opacity:"1",transform:"translate3d(0, 0, 0)"}},fadeInRightBig:{from:{opacity:"0",transform:"translate3d(2000px, 0, 0)"},to:{opacity:"1",transform:"translate3d(0, 0, 0)"}},fadeInUp:{from:{opacity:"0",transform:"translate3d(0, 100%, 0)"},to:{opacity:"1",transform:"translate3d(0, 0, 0)"}},fadeInUpBig:{from:{opacity:"0",transform:"translate3d(0, 2000px, 0)"},to:{opacity:"1",transform:"translate3d(0, 0, 0)"}},fadeInTopLeft:{from:{opacity:"0",transform:"translate3d(-100%, -100%, 0)"},to:{opacity:"1",transform:"translate3d(0, 0, 0)"}},fadeInTopRight:{from:{opacity:"0",transform:"translate3d(100%, -100%, 0)"},to:{opacity:"1",transform:"translate3d(0, 0, 0)"}},fadeInBottomLeft:{from:{opacity:"0",transform:"translate3d(-100%, 100%, 0)"},to:{opacity:"1",transform:"translate3d(0, 0, 0)"}},fadeInBottomRight:{from:{opacity:"0",transform:"translate3d(100%, 100%, 0)"},to:{opacity:"1",transform:"translate3d(0, 0, 0)"}},fadeOut:{from:{opacity:"1"},to:{opacity:"0"}},fadeOutDown:{from:{opacity:"1"},to:{opacity:"0",transform:"translate3d(0, 100%, 0)"}},fadeOutDownBig:{from:{opacity:"1"},to:{opacity:"0",transform:"translate3d(0, 2000px, 0)"}},fadeOutLeft:{from:{opacity:"1"},to:{opacity:"0",transform:"translate3d(-100%, 0, 0)"}},fadeOutLeftBig:{from:{opacity:"1"},to:{opacity:"0",transform:"translate3d(-2000px, 0, 0)"}},fadeOutRight:{from:{opacity:"1"},to:{opacity:"0",transform:"translate3d(100%, 0, 0)"}},fadeOutRightBig:{from:{opacity:"1"},to:{opacity:"0",transform:"translate3d(2000px, 0, 0)"}},fadeOutUp:{from:{opacity:"1"},to:{opacity:"0",transform:"translate3d(0, -100%, 0)"}},fadeOutUpBig:{from:{opacity:"1"},to:{opacity:"0",transform:"translate3d(0, -2000px, 0)"}},fadeOutTopLeft:{from:{opacity:"1",transform:"translate3d(0, 0, 0)"},to:{opacity:"0",transform:"translate3d(-100%, -100%, 0)"}},fadeOutTopRight:{from:{opacity:"1",transform:"translate3d(0, 0, 0)"},to:{opacity:"0",transform:"translate3d(100%, -100%, 0)"}},fadeOutBottomLeft:{from:{opacity:"1",transform:"translate3d(0, 0, 0)"},to:{opacity:"0",transform:"translate3d(-100%, 100%, 0)"}},fadeOutBottomRight:{from:{opacity:"1",transform:"translate3d(0, 0, 0)"},to:{opacity:"0",transform:"translate3d(100%, 100%, 0)"}},backInUp:{"0%":{opacity:"0.7",transform:"translateY(1200px) scale(0.7)"},"80%":{opacity:"0.7",transform:"translateY(0px) scale(0.7)"},"100%":{opacity:"1",transform:"scale(1)"}},backInDown:{"0%":{opacity:"0.7",transform:"translateY(-1200px) scale(0.7)"},"80%":{opacity:"0.7",transform:"translateY(0px) scale(0.7)"},"100%":{opacity:"1",transform:"scale(1)"}},backInLeft:{"0%":{opacity:"0.7",transform:"translateX(-2000px) scale(0.7)"},"80%":{opacity:"0.7",transform:"translateX(0px) scale(0.7)"},"100%":{opacity:"1",transform:"scale(1)"}},backInRight:{"0%":{opacity:"0.7",transform:"translateX(2000px) scale(0.7)"},"80%":{opacity:"0.7",transform:"translateY(0px) scale(0.7)"},"100%":{opacity:"1",transform:"scale(1)"}},backOutUp:{"0%":{opacity:"1",transform:"scale(1)"},"80%":{opacity:"0.7",transform:"translateY(0px) scale(0.7)"},"100%":{opacity:"0.7",transform:"translateY(-700px) scale(0.7)"}},backOutDown:{"0%":{opacity:"1",transform:"scale(1)"},"80%":{opacity:"0.7",transform:"translateY(0px) scale(0.7)"},"100%":{opacity:"0.7",transform:"translateY(700px) scale(0.7)"}},backOutLeft:{"0%":{opacity:"1",transform:"scale(1)"},"80%":{opacity:"0.7",transform:"translateX(-2000px) scale(0.7)"},"100%":{opacity:"0.7",transform:"translateY(-700px) scale(0.7)"}},backOutRight:{"0%":{opacity:"1",transform:"scale(1)"},"80%":{opacity:"0.7",transform:"translateY(0px) scale(0.7)"},"100%":{opacity:"0.7",transform:"translateX(2000px) scale(0.7)"}}},yU=["hover","focus","active","visited","link","target","focus-visible","focus-within","checked","not-checked","default","disabled","enabled","indeterminate","invalid","valid","optional","required","placeholder-shown","read-only","read-write","not-disabled","first-of-type","not-first-of-type","last-of-type","not-last-of-type","first","last","not-first","not-last","only-child","not-only-child","only-of-type","not-only-of-type","even","odd","even-of-type","odd-of-type","root","empty","before","after","first-letter","first-line","file-selector-button","file","selection","marker","svg","all","children","siblings","sibling","ltr","rtl","group-hover","group-focus","group-active","group-visited","motion-safe","motion-reduce"],j2;(function(e){e[e.base=10]="base",e[e.components=150]="components",e[e.shortcuts=160]="shortcuts",e[e.utilities=2e4]="utilities"})(j2||(j2={}));var $2;(function(e){e[e.columns=80]="columns",e[e.container=100]="container",e[e.space=200]="space",e[e.divideWidth=300]="divideWidth",e[e.divideColor=400]="divideColor",e[e.divideStyle=500]="divideStyle",e[e.divideOpacity=600]="divideOpacity",e[e.accessibility=700]="accessibility",e[e.appearance=800]="appearance",e[e.backgroundAttachment=900]="backgroundAttachment",e[e.backgroundClip=1e3]="backgroundClip",e[e.backgroundColor=1100]="backgroundColor",e[e.backgroundImage=1200]="backgroundImage",e[e.gradientColorStops=1300]="gradientColorStops",e[e.backgroundOpacity=1400]="backgroundOpacity",e[e.backgroundPosition=1500]="backgroundPosition",e[e.backgroundRepeat=1600]="backgroundRepeat",e[e.backgroundSize=1700]="backgroundSize",e[e.backgroundOrigin=1750]="backgroundOrigin",e[e.borderCollapse=1800]="borderCollapse",e[e.borderColor=1900]="borderColor",e[e.borderOpacity=2e3]="borderOpacity",e[e.borderRadius=2100]="borderRadius",e[e.borderStyle=2200]="borderStyle",e[e.borderWidth=2300]="borderWidth",e[e.boxDecorationBreak=2350]="boxDecorationBreak",e[e.boxSizing=2400]="boxSizing",e[e.cursor=2500]="cursor",e[e.captionSide=2550]="captionSide",e[e.emptyCells=2560]="emptyCells",e[e.display=2600]="display",e[e.flexBasis=2699]="flexBasis",e[e.flexDirection=2700]="flexDirection",e[e.flexWrap=2800]="flexWrap",e[e.placeItems=2900]="placeItems",e[e.placeContent=3e3]="placeContent",e[e.placeSelf=3100]="placeSelf",e[e.alignItems=3200]="alignItems",e[e.alignContent=3300]="alignContent",e[e.alignSelf=3400]="alignSelf",e[e.justifyItems=3500]="justifyItems",e[e.justifyContent=3600]="justifyContent",e[e.justifySelf=3700]="justifySelf",e[e.flex=3800]="flex",e[e.flexGrow=3900]="flexGrow",e[e.flexShrink=4e3]="flexShrink",e[e.order=4100]="order",e[e.float=4200]="float",e[e.clear=4300]="clear",e[e.fontFamily=4400]="fontFamily",e[e.fontWeight=4500]="fontWeight",e[e.height=4600]="height",e[e.fontSize=4700]="fontSize",e[e.lineHeight=4800]="lineHeight",e[e.listStylePosition=4900]="listStylePosition",e[e.listStyleType=5e3]="listStyleType",e[e.margin=5100]="margin",e[e.maxHeight=5200]="maxHeight",e[e.maxWidth=5300]="maxWidth",e[e.minHeight=5400]="minHeight",e[e.minWidth=5500]="minWidth",e[e.objectFit=5600]="objectFit",e[e.objectPosition=5700]="objectPosition",e[e.opacity=5800]="opacity",e[e.outline=5900]="outline",e[e.overflow=6e3]="overflow",e[e.overscrollBehavior=6100]="overscrollBehavior",e[e.padding=6200]="padding",e[e.placeholderColor=6300]="placeholderColor",e[e.placeholderOpacity=6400]="placeholderOpacity",e[e.caretColor=6450]="caretColor",e[e.caretOpacity=6460]="caretOpacity",e[e.tabSize=6470]="tabSize",e[e.pointerEvents=6500]="pointerEvents",e[e.position=6600]="position",e[e.inset=6700]="inset",e[e.resize=6800]="resize",e[e.boxShadow=6900]="boxShadow",e[e.boxShadowColor=6950]="boxShadowColor",e[e.ringWidth=7e3]="ringWidth",e[e.ringOffsetColor=7100]="ringOffsetColor",e[e.ringOffsetWidth=7200]="ringOffsetWidth",e[e.ringColor=7300]="ringColor",e[e.ringOpacity=7400]="ringOpacity",e[e.fill=7500]="fill",e[e.stroke=7600]="stroke",e[e.strokeWidth=7700]="strokeWidth",e[e.strokeDashArray=7750]="strokeDashArray",e[e.strokeDashOffset=7760]="strokeDashOffset",e[e.tableLayout=7800]="tableLayout",e[e.textAlign=7900]="textAlign",e[e.textColor=8e3]="textColor",e[e.textOpacity=8100]="textOpacity",e[e.textOverflow=8200]="textOverflow",e[e.textShadow=8250]="textShadow",e[e.fontStyle=8300]="fontStyle",e[e.textTransform=8400]="textTransform",e[e.textDecorationStyle=8450]="textDecorationStyle",e[e.textDecorationLength=8455]="textDecorationLength",e[e.textDecorationColor=8460]="textDecorationColor",e[e.textDecorationOpacity=8470]="textDecorationOpacity",e[e.textDecorationOffset=8480]="textDecorationOffset",e[e.textDecorationThickness=8490]="textDecorationThickness",e[e.textDecoration=8500]="textDecoration",e[e.textIndent=8550]="textIndent",e[e.textStrokeColor=8560]="textStrokeColor",e[e.textStrokeWidth=8570]="textStrokeWidth",e[e.content=8580]="content",e[e.fontSmoothing=8600]="fontSmoothing",e[e.fontVariantNumeric=8700]="fontVariantNumeric",e[e.letterSpacing=8800]="letterSpacing",e[e.userSelect=8900]="userSelect",e[e.verticalAlign=9e3]="verticalAlign",e[e.visibility=9100]="visibility",e[e.backfaceVisibility=9150]="backfaceVisibility",e[e.whitespace=9200]="whitespace",e[e.wordBreak=9300]="wordBreak",e[e.writingMode=9340]="writingMode",e[e.hyphens=9350]="hyphens",e[e.width=9400]="width",e[e.zIndex=9500]="zIndex",e[e.isolation=9550]="isolation",e[e.gap=9600]="gap",e[e.gridAutoFlow=9700]="gridAutoFlow",e[e.gridTemplateColumns=9800]="gridTemplateColumns",e[e.gridAutoColumns=9900]="gridAutoColumns",e[e.gridColumn=1e4]="gridColumn",e[e.gridColumnStart=10100]="gridColumnStart",e[e.gridColumnEnd=10200]="gridColumnEnd",e[e.gridTemplateRows=10300]="gridTemplateRows",e[e.gridAutoRows=10400]="gridAutoRows",e[e.gridRow=10500]="gridRow",e[e.gridRowStart=10600]="gridRowStart",e[e.gridRowEnd=10700]="gridRowEnd",e[e.transform=10800]="transform",e[e.transformOrigin=10900]="transformOrigin",e[e.scale=11e3]="scale",e[e.rotate=11100]="rotate",e[e.translate=11200]="translate",e[e.skew=11300]="skew",e[e.perspective=11350]="perspective",e[e.perspectiveOrigin=11360]="perspectiveOrigin",e[e.transitionProperty=11400]="transitionProperty",e[e.transitionTimingFunction=11500]="transitionTimingFunction",e[e.transitionDuration=11600]="transitionDuration",e[e.transitionDelay=11700]="transitionDelay",e[e.keyframes=11800]="keyframes",e[e.animation=11900]="animation",e[e.imageRendering=11950]="imageRendering",e[e.mixBlendMode=12e3]="mixBlendMode",e[e.backgroundBlendMode=12100]="backgroundBlendMode",e[e.filter=12200]="filter",e[e.blur=12300]="blur",e[e.brightness=12400]="brightness",e[e.contrast=12500]="contrast",e[e.dropShadow=12600]="dropShadow",e[e.grayscale=12700]="grayscale",e[e.hueRotate=12800]="hueRotate",e[e.invert=12900]="invert",e[e.saturate=13e3]="saturate",e[e.sepia=13100]="sepia",e[e.backdropFilter=13200]="backdropFilter",e[e.backdropBlur=13300]="backdropBlur",e[e.backdropBrightness=13400]="backdropBrightness",e[e.backdropContrast=13500]="backdropContrast",e[e.backdropGrayscale=13600]="backdropGrayscale",e[e.backdropHueRotate=13700]="backdropHueRotate",e[e.backdropInvert=13800]="backdropInvert",e[e.backdropOpacity=13900]="backdropOpacity",e[e.backdropSaturate=14e3]="backdropSaturate",e[e.backdropSepia=14100]="backdropSepia",e[e.willChange=14200]="willChange",e[e.touchAction=14300]="touchAction",e[e.scrollBehavior=14400]="scrollBehavior",e[e.accentColor=14500]="accentColor"})($2||($2={}));var XC=function(e,n){return{handler:e,config:n}};XC.withOptions=function(e,n){n===void 0&&(n=function(){return{}});var r=function(s){return s===void 0&&(s={}),{__options:s,handler:e(s),config:n(s)}};return r.__isOptionsFunction=!0,r.__pluginFunction=e,r.__configFunction=n,r};var vU={transparent:"transparent",current:"currentColor",inherit:"inherit",light:tr.light,dark:tr.dark,black:tr.black,white:tr.white,gray:tr.coolGray,red:tr.red,yellow:tr.amber,green:tr.emerald,blue:tr.blue,indigo:tr.indigo,purple:tr.violet,pink:tr.pink,rose:tr.rose,fuchsia:tr.fuchsia,violet:tr.violet,cyan:tr.cyan,teal:tr.teal,emerald:tr.emerald,lime:tr.lime,amber:tr.amber,orange:tr.orange,sky:tr.sky,"light-blue":tr.sky,"warm-gray":tr.warmGray,"true-gray":tr.trueGray,"cool-gray":tr.coolGray,"blue-gray":tr.blueGray},Ku={xs:"20rem",sm:"24rem",md:"28rem",lg:"32rem",xl:"36rem","2xl":"42rem","3xl":"48rem","4xl":"56rem","5xl":"64rem","6xl":"72rem","7xl":"80rem"};cn(cn({},Ku),{auto:"auto",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12","3xs":"16rem","2xs":"18rem"}),XC(function(e){var n=e.addUtilities;n({".before\\:contents":{"&::before":{content:'""',display:"contents"}},".after\\:contents":{"&::after":{content:'""',display:"contents"}}})});var KC=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function xU(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var YC={exports:{}};(function(e,n){(function(r,s){e.exports=s()})(KC,function(){var r,s,c;function h(a,v){if(!r)r=v;else if(!s)s=v;else{var w="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+r+")(sharedChunk); ("+s+")(sharedChunk); self.onerror = null;",E={};r(E),c=v(E),typeof window!="undefined"&&window&&window.URL&&window.URL.createObjectURL&&(c.workerUrl=window.URL.createObjectURL(new Blob([w],{type:"text/javascript"})))}}h(["exports"],function(a){var v="2.7.0",w=E;function E(i,t,l,u){this.cx=3*i,this.bx=3*(l-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(u-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=u,this.p2x=l,this.p2y=u}E.prototype.sampleCurveX=function(i){return((this.ax*i+this.bx)*i+this.cx)*i},E.prototype.sampleCurveY=function(i){return((this.ay*i+this.by)*i+this.cy)*i},E.prototype.sampleCurveDerivativeX=function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},E.prototype.solveCurveX=function(i,t){var l,u,d,p,y;for(t===void 0&&(t=1e-6),d=i,y=0;y<8;y++){if(p=this.sampleCurveX(d)-i,Math.abs(p)<t)return d;var b=this.sampleCurveDerivativeX(d);if(Math.abs(b)<1e-6)break;d-=p/b}if((d=i)<(l=0))return l;if(d>(u=1))return u;for(;l<u;){if(p=this.sampleCurveX(d),Math.abs(p-i)<t)return d;i>p?l=d:u=d,d=.5*(u-l)+l}return d},E.prototype.solve=function(i,t){return this.sampleCurveY(this.solveCurveX(i,t))};var I=M;function M(i,t){this.x=i,this.y=t}M.prototype={clone:function(){return new M(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,t){return this.clone()._rotateAround(i,t)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var t=i.x-this.x,l=i.y-this.y;return t*t+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,t){return Math.atan2(this.x*t-this.y*i,this.x*i+this.y*t)},_matMult:function(i){var t=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=t,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var t=Math.cos(i),l=Math.sin(i),u=l*this.x+t*this.y;return this.x=t*this.x-l*this.y,this.y=u,this},_rotateAround:function(i,t){var l=Math.cos(i),u=Math.sin(i),d=t.y+u*(this.x-t.x)+l*(this.y-t.y);return this.x=t.x+l*(this.x-t.x)-u*(this.y-t.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},M.convert=function(i){return i instanceof M?i:Array.isArray(i)?new M(i[0],i[1]):i};var P=typeof self!="undefined"?self:{},j=1e-6,N=typeof Float32Array!="undefined"?Float32Array:Array;function q(){var i=new N(9);return N!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function V(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function ee(i,t,l){var u=t[0],d=t[1],p=t[2],y=t[3],b=t[4],S=t[5],C=t[6],D=t[7],R=t[8],z=t[9],U=t[10],G=t[11],H=t[12],K=t[13],re=t[14],he=t[15],ye=l[0],Ee=l[1],Se=l[2],Ae=l[3];return i[0]=ye*u+Ee*b+Se*R+Ae*H,i[1]=ye*d+Ee*S+Se*z+Ae*K,i[2]=ye*p+Ee*C+Se*U+Ae*re,i[3]=ye*y+Ee*D+Se*G+Ae*he,i[4]=(ye=l[4])*u+(Ee=l[5])*b+(Se=l[6])*R+(Ae=l[7])*H,i[5]=ye*d+Ee*S+Se*z+Ae*K,i[6]=ye*p+Ee*C+Se*U+Ae*re,i[7]=ye*y+Ee*D+Se*G+Ae*he,i[8]=(ye=l[8])*u+(Ee=l[9])*b+(Se=l[10])*R+(Ae=l[11])*H,i[9]=ye*d+Ee*S+Se*z+Ae*K,i[10]=ye*p+Ee*C+Se*U+Ae*re,i[11]=ye*y+Ee*D+Se*G+Ae*he,i[12]=(ye=l[12])*u+(Ee=l[13])*b+(Se=l[14])*R+(Ae=l[15])*H,i[13]=ye*d+Ee*S+Se*z+Ae*K,i[14]=ye*p+Ee*C+Se*U+Ae*re,i[15]=ye*y+Ee*D+Se*G+Ae*he,i}function oe(i,t,l){var u,d,p,y,b,S,C,D,R,z,U,G,H=l[0],K=l[1],re=l[2];return t===i?(i[12]=t[0]*H+t[4]*K+t[8]*re+t[12],i[13]=t[1]*H+t[5]*K+t[9]*re+t[13],i[14]=t[2]*H+t[6]*K+t[10]*re+t[14],i[15]=t[3]*H+t[7]*K+t[11]*re+t[15]):(d=t[1],p=t[2],y=t[3],b=t[4],S=t[5],C=t[6],D=t[7],R=t[8],z=t[9],U=t[10],G=t[11],i[0]=u=t[0],i[1]=d,i[2]=p,i[3]=y,i[4]=b,i[5]=S,i[6]=C,i[7]=D,i[8]=R,i[9]=z,i[10]=U,i[11]=G,i[12]=u*H+b*K+R*re+t[12],i[13]=d*H+S*K+z*re+t[13],i[14]=p*H+C*K+U*re+t[14],i[15]=y*H+D*K+G*re+t[15]),i}function pe(i,t,l){var u=l[0],d=l[1],p=l[2];return i[0]=t[0]*u,i[1]=t[1]*u,i[2]=t[2]*u,i[3]=t[3]*u,i[4]=t[4]*d,i[5]=t[5]*d,i[6]=t[6]*d,i[7]=t[7]*d,i[8]=t[8]*p,i[9]=t[9]*p,i[10]=t[10]*p,i[11]=t[11]*p,i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i}function se(i,t,l){var u=Math.sin(l),d=Math.cos(l),p=t[4],y=t[5],b=t[6],S=t[7],C=t[8],D=t[9],R=t[10],z=t[11];return t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[4]=p*d+C*u,i[5]=y*d+D*u,i[6]=b*d+R*u,i[7]=S*d+z*u,i[8]=C*d-p*u,i[9]=D*d-y*u,i[10]=R*d-b*u,i[11]=z*d-S*u,i}function xe(i,t,l){var u=Math.sin(l),d=Math.cos(l),p=t[0],y=t[1],b=t[2],S=t[3],C=t[8],D=t[9],R=t[10],z=t[11];return t!==i&&(i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=p*d-C*u,i[1]=y*d-D*u,i[2]=b*d-R*u,i[3]=S*d-z*u,i[8]=p*u+C*d,i[9]=y*u+D*d,i[10]=b*u+R*d,i[11]=S*u+z*d,i}Math.hypot||(Math.hypot=function(){for(var i=0,t=arguments.length;t--;)i+=arguments[t]*arguments[t];return Math.sqrt(i)});var Te=ee;function De(){var i=new N(3);return N!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function Me(i){var t=new N(3);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t}function Be(i){return Math.hypot(i[0],i[1],i[2])}function ze(i,t,l){var u=new N(3);return u[0]=i,u[1]=t,u[2]=l,u}function Fe(i,t,l){return i[0]=t[0]+l[0],i[1]=t[1]+l[1],i[2]=t[2]+l[2],i}function Je(i,t,l){return i[0]=t[0]-l[0],i[1]=t[1]-l[1],i[2]=t[2]-l[2],i}function be(i,t,l){return i[0]=t[0]*l[0],i[1]=t[1]*l[1],i[2]=t[2]*l[2],i}function qe(i,t,l){return i[0]=Math.max(t[0],l[0]),i[1]=Math.max(t[1],l[1]),i[2]=Math.max(t[2],l[2]),i}function Ke(i,t,l){return i[0]=t[0]*l,i[1]=t[1]*l,i[2]=t[2]*l,i}function _t(i,t,l,u){return i[0]=t[0]+l[0]*u,i[1]=t[1]+l[1]*u,i[2]=t[2]+l[2]*u,i}function It(i,t){var l=t[0],u=t[1],d=t[2],p=l*l+u*u+d*d;return p>0&&(p=1/Math.sqrt(p)),i[0]=t[0]*p,i[1]=t[1]*p,i[2]=t[2]*p,i}function Tt(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]}function Dn(i,t,l){var u=t[0],d=t[1],p=t[2],y=l[0],b=l[1],S=l[2];return i[0]=d*S-p*b,i[1]=p*y-u*S,i[2]=u*b-d*y,i}function Ot(i,t,l){var u=t[0],d=t[1],p=t[2],y=l[3]*u+l[7]*d+l[11]*p+l[15];return i[0]=(l[0]*u+l[4]*d+l[8]*p+l[12])/(y=y||1),i[1]=(l[1]*u+l[5]*d+l[9]*p+l[13])/y,i[2]=(l[2]*u+l[6]*d+l[10]*p+l[14])/y,i}function Zn(i,t,l){var u=l[0],d=l[1],p=l[2],y=t[0],b=t[1],S=t[2],C=d*S-p*b,D=p*y-u*S,R=u*b-d*y,z=d*R-p*D,U=p*C-u*R,G=u*D-d*C,H=2*l[3];return D*=H,R*=H,U*=2,G*=2,i[0]=y+(C*=H)+(z*=2),i[1]=b+D+U,i[2]=S+R+G,i}var Rn,_r=Je,it=be,Dt=Be;function yt(i,t,l){var u=t[0],d=t[1],p=t[2],y=t[3];return i[0]=l[0]*u+l[4]*d+l[8]*p+l[12]*y,i[1]=l[1]*u+l[5]*d+l[9]*p+l[13]*y,i[2]=l[2]*u+l[6]*d+l[10]*p+l[14]*y,i[3]=l[3]*u+l[7]*d+l[11]*p+l[15]*y,i}function Lt(){var i=new N(4);return N!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function Tn(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i}function Cn(i,t,l){l*=.5;var u=t[0],d=t[1],p=t[2],y=t[3],b=Math.sin(l),S=Math.cos(l);return i[0]=u*S+y*b,i[1]=d*S+p*b,i[2]=p*S-d*b,i[3]=y*S-u*b,i}function Kt(i,t){return i[0]===t[0]&&i[1]===t[1]}De(),Rn=new N(4),N!=Float32Array&&(Rn[0]=0,Rn[1]=0,Rn[2]=0,Rn[3]=0),De(),ze(1,0,0),ze(0,1,0),Lt(),Lt(),q(),function(){var i;i=new N(2),N!=Float32Array&&(i[0]=0,i[1]=0)}();const Ht=Math.PI/180,fe=180/Math.PI;function _e(i){return i*Ht}function Oe(i){return i*fe}const rt=[[0,0],[1,0],[1,1],[0,1]];function ot(i){if(i<=0)return 0;if(i>=1)return 1;const t=i*i,l=t*i;return 4*(i<.5?l:3*(i-t)+l-.75)}function vt(i,t,l,u){const d=new w(i,t,l,u);return function(p){return d.solve(p)}}const St=vt(.25,.1,.25,1);function Ye(i,t,l){return Math.min(l,Math.max(t,i))}function at(i,t,l){return(l=Ye((l-i)/(t-i),0,1))*l*(3-2*l)}function we(i,t,l){const u=l-t,d=((i-t)%u+u)%u+t;return d===t?l:d}function Ue(i,t,l){if(!i.length)return l(null,[]);let u=i.length;const d=new Array(i.length);let p=null;i.forEach((y,b)=>{t(y,(S,C)=>{S&&(p=S),d[b]=C,--u==0&&l(p,d)})})}function At(i){const t=[];for(const l in i)t.push(i[l]);return t}function mt(i,...t){for(const l of t)for(const u in l)i[u]=l[u];return i}let Gt=1;function Qt(){return Gt++}function _n(){return function i(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,i)}()}function tn(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function zn(i){return!!i&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(i)}function Dr(i,t){i.forEach(l=>{t[l]&&(t[l]=t[l].bind(t))})}function Ii(i,t){return i.indexOf(t,i.length-t.length)!==-1}function io(i,t,l){const u={};for(const d in i)u[d]=t.call(l||this,i[d],d,i);return u}function Bi(i,t,l){const u={};for(const d in i)t.call(l||this,i[d],d,i)&&(u[d]=i[d]);return u}function si(i){return Array.isArray(i)?i.map(si):typeof i=="object"&&i?io(i,si):i}const Rr={};function wn(i){Rr[i]||(typeof console!="undefined"&&console.warn(i),Rr[i]=!0)}function ai(i,t,l){return(l.y-i.y)*(t.x-i.x)>(t.y-i.y)*(l.x-i.x)}function wa(i){let t=0;for(let l,u,d=0,p=i.length,y=p-1;d<p;y=d++)l=i[d],u=i[y],t+=(u.x-l.x)*(l.y+u.y);return t}function So(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function Ta(i){const t={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,u,d,p)=>{const y=d||p;return t[u]=!y||y.toLowerCase(),""}),t["max-age"]){const l=parseInt(t["max-age"],10);isNaN(l)?delete t["max-age"]:t["max-age"]=l}return t}let Ks,Yo,oo,gs=null;function Ao(i){if(gs==null){const t=i.navigator?i.navigator.userAgent:null;gs=!!i.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return gs}function Ea(i){try{const t=P[i];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}const Mi={now:()=>oo!==void 0?oo:P.performance.now(),setNow(i){oo=i},restoreNow(){oo=void 0},frame(i){const t=P.requestAnimationFrame(i);return{cancel:()=>P.cancelAnimationFrame(t)}},getImageData(i,t=0){const l=P.document.createElement("canvas"),u=l.getContext("2d");if(!u)throw new Error("failed to create canvas 2d context");return l.width=i.width,l.height=i.height,u.drawImage(i,0,0,i.width,i.height),u.getImageData(-t,-t,i.width+2*t,i.height+2*t)},resolveURL:i=>(Ks||(Ks=P.document.createElement("a")),Ks.href=i,Ks.href),get devicePixelRatio(){return P.devicePixelRatio},get prefersReducedMotion(){return!!P.matchMedia&&(Yo==null&&(Yo=P.matchMedia("(prefers-reduced-motion: reduce)")),Yo.matches)}};let ne;const B={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(ne==null){const i=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{ne={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):i}catch{ne=i}}return ne},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Z={supported:!1,testSupport:function(i){!ge&&ie&&(Ce?Ie(i):te=i)}};let te,ie,ge=!1,Ce=!1;function Ie(i){const t=i.createTexture();i.bindTexture(i.TEXTURE_2D,t);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,ie),i.isContextLost())return;Z.supported=!0}catch{}i.deleteTexture(t),ge=!0}P.document&&(ie=P.document.createElement("img"),ie.onload=function(){te&&Ie(te),te=null,Ce=!0},ie.onerror=function(){ge=!0,te=null},ie.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ve="01",Pe="NO_ACCESS_TOKEN";function Ze(i){return i.indexOf("mapbox:")===0}function He(i){return B.API_URL_REGEX.test(i)}const tt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Rt(i){const t=i.match(tt);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function Ut(i){const t=i.params.length?`?${i.params.join("&")}`:"";return`${i.protocol}://${i.authority}${i.path}${t}`}function Nt(i){if(!i)return null;const t=i.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(P.atob(t[1]).split("").map(l=>"%"+("00"+l.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class $t{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const l=Nt(B.ACCESS_TOKEN);let u="";return u=l&&l.u?P.btoa(encodeURIComponent(l.u).replace(/%([0-9A-F]{2})/g,(d,p)=>String.fromCharCode(Number("0x"+p)))):B.ACCESS_TOKEN||"",t?`mapbox.eventData.${t}:${u}`:`mapbox.eventData:${u}`}fetchEventData(){const t=Ea("localStorage"),l=this.getStorageKey(),u=this.getStorageKey("uuid");if(t)try{const d=P.localStorage.getItem(l);d&&(this.eventData=JSON.parse(d));const p=P.localStorage.getItem(u);p&&(this.anonId=p)}catch{wn("Unable to read from LocalStorage")}}saveEventData(){const t=Ea("localStorage"),l=this.getStorageKey(),u=this.getStorageKey("uuid");if(t)try{P.localStorage.setItem(u,this.anonId),Object.keys(this.eventData).length>=1&&P.localStorage.setItem(l,JSON.stringify(this.eventData))}catch{wn("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,l,u,d){if(!B.EVENTS_URL)return;const p=Rt(B.EVENTS_URL);p.params.push(`access_token=${d||B.ACCESS_TOKEN||""}`);const y={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:v,skuId:ve,userId:this.anonId},b=l?mt(y,l):y,S={url:Ut(p),headers:{"Content-Type":"text/plain"},body:JSON.stringify([b])};this.pendingRequest=Io(S,C=>{this.pendingRequest=null,u(C),this.saveEventData(),this.processRequests(d)})}queueRequest(t,l){this.queue.push(t),this.processRequests(l)}}const on=new class extends $t{constructor(i){super("appUserTurnstile"),this._customAccessToken=i}postTurnstileEvent(i,t){B.EVENTS_URL&&B.ACCESS_TOKEN&&Array.isArray(i)&&i.some(l=>Ze(l)||He(l))&&this.queueRequest(Date.now(),t)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const t=Nt(B.ACCESS_TOKEN),l=t?t.u:B.ACCESS_TOKEN;let u=l!==this.eventData.tokenU;zn(this.anonId)||(this.anonId=_n(),u=!0);const d=this.queue.shift();if(this.eventData.lastSuccess){const p=new Date(this.eventData.lastSuccess),y=new Date(d),b=(d-this.eventData.lastSuccess)/864e5;u=u||b>=1||b<-1||p.getDate()!==y.getDate()}else u=!0;if(!u)return this.processRequests();this.postEvent(d,{"enabled.telemetry":!1},p=>{p||(this.eventData.lastSuccess=d,this.eventData.tokenU=l)},i)}},Gn=on.postTurnstileEvent.bind(on),Wn=new class extends $t{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(i,t,l,u){this.skuToken=t,this.errorCb=u,B.EVENTS_URL&&(l||B.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},l):this.errorCb(new Error(Pe)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:l}=this.queue.shift();t&&this.success[t]||(this.anonId||this.fetchEventData(),zn(this.anonId)||(this.anonId=_n()),this.postEvent(l,{skuToken:this.skuToken},u=>{u?this.errorCb(u):t&&(this.success[t]=!0)},i))}},Nn=Wn.postMapLoadEvent.bind(Wn),Hn=new class extends $t{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(i,t,l,u){if(!B.API_URL||!B.SESSION_PATH)return;const d=Rt(B.API_URL+B.SESSION_PATH);d.params.push(`sku=${t||""}`),d.params.push(`access_token=${u||B.ACCESS_TOKEN||""}`);const p={url:Ut(d),headers:{"Content-Type":"text/plain"}};this.pendingRequest=cg(p,y=>{this.pendingRequest=null,l(y),this.saveEventData(),this.processRequests(u)})}getSessionAPI(i,t,l,u){this.skuToken=t,this.errorCb=u,B.SESSION_PATH&&B.API_URL&&(l||B.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},l):this.errorCb(new Error(Pe)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:l}=this.queue.shift();t&&this.success[t]||this.getSession(l,this.skuToken,u=>{u?this.errorCb(u):t&&(this.success[t]=!0)},i)}},ys=Hn.getSessionAPI.bind(Hn),Qo=new Set,Gr="mapbox-tiles";let Co,Zc,Yd=500,$h=50;function kl(){P.caches&&!Co&&(Co=P.caches.open(Gr))}function Vh(i){const t=i.indexOf("?");return t<0?i:i.slice(0,t)}let Wc=1/0;const Hc={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Hc);class Pl extends Error{constructor(t,l,u){l===401&&He(u)&&(t+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(t),this.status=l,this.url=u}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Gh=So()?()=>self.worker&&self.worker.referrer:()=>(P.location.protocol==="blob:"?P.parent:P).location.href,so=function(i,t){if(!(/^file:/.test(l=i.url)||/^file:/.test(Gh())&&!/^\w+:/.test(l))){if(P.fetch&&P.Request&&P.AbortController&&P.Request.prototype.hasOwnProperty("signal"))return function(u,d){const p=new P.AbortController,y=new P.Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:Gh(),signal:p.signal});let b=!1,S=!1;const C=(D=y.url).indexOf("sku=")>0&&He(D);var D;u.type==="json"&&y.headers.set("Accept","application/json");const R=(U,G,H)=>{if(S)return;if(U&&U.message!=="SecurityError"&&wn(U),G&&H)return z(G);const K=Date.now();P.fetch(y).then(re=>{if(re.ok){const he=C?re.clone():null;return z(re,he,K)}return d(new Pl(re.statusText,re.status,u.url))}).catch(re=>{re.code!==20&&d(new Error(re.message))})},z=(U,G,H)=>{(u.type==="arrayBuffer"?U.arrayBuffer():u.type==="json"?U.json():U.text()).then(K=>{S||(G&&H&&function(re,he,ye){if(kl(),!Co)return;const Ee={status:he.status,statusText:he.statusText,headers:new P.Headers};he.headers.forEach((Ae,Ge)=>Ee.headers.set(Ge,Ae));const Se=Ta(he.headers.get("Cache-Control")||"");Se["no-store"]||(Se["max-age"]&&Ee.headers.set("Expires",new Date(ye+1e3*Se["max-age"]).toUTCString()),new Date(Ee.headers.get("Expires")).getTime()-ye<42e4||function(Ae,Ge){if(Zc===void 0)try{new Response(new ReadableStream),Zc=!0}catch{Zc=!1}Zc?Ge(Ae.body):Ae.blob().then(Ge)}(he,Ae=>{const Ge=new P.Response(Ae,Ee);kl(),Co&&Co.then($e=>$e.put(Vh(re.url),Ge)).catch($e=>wn($e.message))}))}(y,G,H),b=!0,d(null,K,U.headers.get("Cache-Control"),U.headers.get("Expires")))}).catch(K=>{S||d(new Error(K.message))})};return C?function(U,G){if(kl(),!Co)return G(null);const H=Vh(U.url);Co.then(K=>{K.match(H).then(re=>{const he=function(ye){if(!ye)return!1;const Ee=new Date(ye.headers.get("Expires")||0),Se=Ta(ye.headers.get("Cache-Control")||"");return Ee>Date.now()&&!Se["no-cache"]}(re);K.delete(H),he&&K.put(H,re.clone()),G(null,re,he)}).catch(G)}).catch(G)}(y,R):R(null,null),{cancel:()=>{S=!0,b||p.abort()}}}(i,t);if(So()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,t,void 0,!0)}var l;return function(u,d){const p=new P.XMLHttpRequest;p.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(p.responseType="arraybuffer");for(const y in u.headers)p.setRequestHeader(y,u.headers[y]);return u.type==="json"&&(p.responseType="text",p.setRequestHeader("Accept","application/json")),p.withCredentials=u.credentials==="include",p.onerror=()=>{d(new Error(p.statusText))},p.onload=()=>{if((p.status>=200&&p.status<300||p.status===0)&&p.response!==null){let y=p.response;if(u.type==="json")try{y=JSON.parse(p.response)}catch(b){return d(b)}d(null,y,p.getResponseHeader("Cache-Control"),p.getResponseHeader("Expires"))}else d(new Pl(p.statusText,p.status,u.url))},p.send(u.body),{cancel:()=>p.abort()}}(i,t)},Dl=function(i,t){return so(mt(i,{type:"arrayBuffer"}),t)},Io=function(i,t){return so(mt(i,{method:"POST"}),t)},cg=function(i,t){return so(mt(i,{method:"GET"}),t)};function Qd(i){const t=P.document.createElement("a");return t.href=i,t.protocol===P.document.location.protocol&&t.host===P.document.location.host}const Sa="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Aa,Rl;Aa=[],Rl=0;const Jd=function(i,t){if(Z.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),Rl>=B.MAX_PARALLEL_IMAGE_REQUESTS){const p={requestParameters:i,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return Aa.push(p),p}Rl++;let l=!1;const u=()=>{if(!l)for(l=!0,Rl--;Aa.length&&Rl<B.MAX_PARALLEL_IMAGE_REQUESTS;){const p=Aa.shift(),{requestParameters:y,callback:b,cancelled:S}=p;S||(p.cancel=Jd(y,b).cancel)}},d=Dl(i,(p,y,b,S)=>{u(),p?t(p):y&&(P.createImageBitmap?function(C,D){const R=new P.Blob([new Uint8Array(C)],{type:"image/png"});P.createImageBitmap(R).then(z=>{D(null,z)}).catch(z=>{D(new Error(`Could not load image because of ${z.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(y,(C,D)=>t(C,D,b,S)):function(C,D){const R=new P.Image,z=P.URL;R.onload=()=>{D(null,R),z.revokeObjectURL(R.src),R.onload=null,P.requestAnimationFrame(()=>{R.src=Sa})},R.onerror=()=>D(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const U=new P.Blob([new Uint8Array(C)],{type:"image/png"});R.src=C.byteLength?z.createObjectURL(U):Sa}(y,(C,D)=>t(C,D,b,S)))});return{cancel:()=>{d.cancel(),u()}}};function ep(i,t,l){l[i]&&l[i].indexOf(t)!==-1||(l[i]=l[i]||[],l[i].push(t))}function Xc(i,t,l){if(l&&l[i]){const u=l[i].indexOf(t);u!==-1&&l[i].splice(u,1)}}class vs{constructor(t,l={}){mt(this,l),this.type=t}}class Kc extends vs{constructor(t,l={}){super("error",mt({error:t},l))}}class xs{on(t,l){return this._listeners=this._listeners||{},ep(t,l,this._listeners),this}off(t,l){return Xc(t,l,this._listeners),Xc(t,l,this._oneTimeListeners),this}once(t,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},ep(t,l,this._oneTimeListeners),this):new Promise(u=>this.once(t,u))}fire(t,l){typeof t=="string"&&(t=new vs(t,l||{}));const u=t.type;if(this.listens(u)){t.target=this;const d=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];for(const b of d)b.call(this,t);const p=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];for(const b of p)Xc(u,b,this._oneTimeListeners),b.call(this,t);const y=this._eventedParent;y&&(mt(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),y.fire(t))}else t instanceof Kc&&console.error(t.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,l){return this._eventedParent=t,this._eventedParentData=l,this}}var Ne=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":0.1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');class bt{constructor(t,l,u,d){this.message=(t?`${t}: `:"")+u,d&&(this.identifier=d),l!=null&&l.__line__&&(this.line=l.__line__)}}function tp(i){const t=i.value;return t?[new bt(i.key,t,"constants have been deprecated as of v8")]:[]}function bs(i,...t){for(const l of t)for(const u in l)i[u]=l[u];return i}function pr(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Jo(i){if(Array.isArray(i))return i.map(Jo);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const t={};for(const l in i)t[l]=Jo(i[l]);return t}return pr(i)}class Mo extends Error{constructor(t,l){super(l),this.message=l,this.key=t}}class Yc{constructor(t,l=[]){this.parent=t,this.bindings={};for(const[u,d]of l)this.bindings[u]=d}concat(t){return new Yc(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const ws={kind:"null"},xt={kind:"number"},hn={kind:"string"},nn={kind:"boolean"},ko={kind:"color"},Ca={kind:"object"},rn={kind:"value"},zl={kind:"collator"},Ts={kind:"formatted"},Ol={kind:"resolvedImage"};function Ui(i,t){return{kind:"array",itemType:i,N:t}}function sr(i){if(i.kind==="array"){const t=sr(i.itemType);return typeof i.N=="number"?`array<${t}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${t}>`}return i.kind}const ug=[ws,xt,hn,nn,ko,Ts,Ca,Ui(rn),Ol];function yi(i,t){if(t.kind==="error")return null;if(i.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!yi(i.itemType,t.itemType))&&(typeof i.N!="number"||i.N===t.N))return null}else{if(i.kind===t.kind)return null;if(i.kind==="value"){for(const l of ug)if(!yi(l,t))return null}}return`Expected ${sr(i)} but found ${sr(t)} instead.`}function Qc(i,t){return t.some(l=>l.kind===i.kind)}function Ia(i,t){return t.some(l=>l==="null"?i===null:l==="array"?Array.isArray(i):l==="object"?i&&!Array.isArray(i)&&typeof i=="object":l===typeof i)}function Ma(i){var t={exports:{}};return i(t,t.exports),t.exports}var ka=Ma(function(i,t){var l={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function u(b){return(b=Math.round(b))<0?0:b>255?255:b}function d(b){return u(b[b.length-1]==="%"?parseFloat(b)/100*255:parseInt(b))}function p(b){return(S=b[b.length-1]==="%"?parseFloat(b)/100:parseFloat(b))<0?0:S>1?1:S;var S}function y(b,S,C){return C<0?C+=1:C>1&&(C-=1),6*C<1?b+(S-b)*C*6:2*C<1?S:3*C<2?b+(S-b)*(2/3-C)*6:b}try{t.parseCSSColor=function(b){var S,C=b.replace(/ /g,"").toLowerCase();if(C in l)return l[C].slice();if(C[0]==="#")return C.length===4?(S=parseInt(C.substr(1),16))>=0&&S<=4095?[(3840&S)>>4|(3840&S)>>8,240&S|(240&S)>>4,15&S|(15&S)<<4,1]:null:C.length===7&&(S=parseInt(C.substr(1),16))>=0&&S<=16777215?[(16711680&S)>>16,(65280&S)>>8,255&S,1]:null;var D=C.indexOf("("),R=C.indexOf(")");if(D!==-1&&R+1===C.length){var z=C.substr(0,D),U=C.substr(D+1,R-(D+1)).split(","),G=1;switch(z){case"rgba":if(U.length!==4)return null;G=p(U.pop());case"rgb":return U.length!==3?null:[d(U[0]),d(U[1]),d(U[2]),G];case"hsla":if(U.length!==4)return null;G=p(U.pop());case"hsl":if(U.length!==3)return null;var H=(parseFloat(U[0])%360+360)%360/360,K=p(U[1]),re=p(U[2]),he=re<=.5?re*(K+1):re+K-re*K,ye=2*re-he;return[u(255*y(ye,he,H+1/3)),u(255*y(ye,he,H)),u(255*y(ye,he,H-1/3)),G];default:return null}}return null}}catch{}});class xn{constructor(t,l,u,d=1){this.r=t,this.g=l,this.b=u,this.a=d}static parse(t){if(!t)return;if(t instanceof xn)return t;if(typeof t!="string")return;const l=ka.parseCSSColor(t);return l?new xn(l[0]/255*l[3],l[1]/255*l[3],l[2]/255*l[3],l[3]):void 0}toString(){const[t,l,u,d]=this.toArray();return`rgba(${Math.round(t)},${Math.round(l)},${Math.round(u)},${d})`}toArray(){const{r:t,g:l,b:u,a:d}=this;return d===0?[0,0,0,0]:[255*t/d,255*l/d,255*u/d,d]}}xn.black=new xn(0,0,0,1),xn.white=new xn(1,1,1,1),xn.transparent=new xn(0,0,0,0),xn.red=new xn(1,0,0,1),xn.blue=new xn(0,0,1,1);class Jc{constructor(t,l,u){this.sensitivity=t?l?"variant":"case":l?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,l){return this.collator.compare(t,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class qh{constructor(t,l,u,d,p){this.text=t.normalize?t.normalize():t,this.image=l,this.scale=u,this.fontStack=d,this.textColor=p}}class Xt{constructor(t){this.sections=t}static fromString(t){return new Xt([new qh(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof Xt?t:Xt.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const l of this.sections){if(l.image){t.push(["image",l.image.name]);continue}t.push(l.text);const u={};l.fontStack&&(u["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(u["font-scale"]=l.scale),l.textColor&&(u["text-color"]=["rgba"].concat(l.textColor.toArray())),t.push(u)}return t}}class Ni{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Ni({name:t,available:!1}):null}serialize(){return["image",this.name]}}function np(i,t,l,u){return typeof i=="number"&&i>=0&&i<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof l=="number"&&l>=0&&l<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[i,t,l,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[i,t,l,u]:[i,t,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function eu(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof xn||i instanceof Jc||i instanceof Xt||i instanceof Ni)return!0;if(Array.isArray(i)){for(const t of i)if(!eu(t))return!1;return!0}if(typeof i=="object"){for(const t in i)if(!eu(i[t]))return!1;return!0}return!1}function gr(i){if(i===null)return ws;if(typeof i=="string")return hn;if(typeof i=="boolean")return nn;if(typeof i=="number")return xt;if(i instanceof xn)return ko;if(i instanceof Jc)return zl;if(i instanceof Xt)return Ts;if(i instanceof Ni)return Ol;if(Array.isArray(i)){const t=i.length;let l;for(const u of i){const d=gr(u);if(l){if(l===d)continue;l=rn;break}l=d}return Ui(l||rn,t)}return Ca}function Ll(i){const t=typeof i;return i===null?"":t==="string"||t==="number"||t==="boolean"?String(i):i instanceof xn||i instanceof Xt||i instanceof Ni?i.toString():JSON.stringify(i)}class Es{constructor(t,l){this.type=t,this.value=l}static parse(t,l){if(t.length!==2)return l.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!eu(t[1]))return l.error("invalid value");const u=t[1];let d=gr(u);const p=l.expectedType;return d.kind!=="array"||d.N!==0||!p||p.kind!=="array"||typeof p.N=="number"&&p.N!==0||(d=p),new Es(d,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof xn?["rgba"].concat(this.value.toArray()):this.value instanceof Xt?this.value.serialize():this.value}}class zr{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const tu={string:hn,number:xt,boolean:nn,object:Ca};class ji{constructor(t,l){this.type=t,this.args=l}static parse(t,l){if(t.length<2)return l.error("Expected at least one argument.");let u,d=1;const p=t[0];if(p==="array"){let b,S;if(t.length>2){const C=t[1];if(typeof C!="string"||!(C in tu)||C==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);b=tu[C],d++}else b=rn;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return l.error('The length argument to "array" must be a positive integer literal',2);S=t[2],d++}u=Ui(b,S)}else u=tu[p];const y=[];for(;d<t.length;d++){const b=l.parse(t[d],d,rn);if(!b)return null;y.push(b)}return new ji(u,y)}evaluate(t){for(let l=0;l<this.args.length;l++){const u=this.args[l].evaluate(t);if(!yi(this.type,gr(u)))return u;if(l===this.args.length-1)throw new zr(`Expected value to be of type ${sr(this.type)}, but found ${sr(gr(u))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,l=[t.kind];if(t.kind==="array"){const u=t.itemType;if(u.kind==="string"||u.kind==="number"||u.kind==="boolean"){l.push(u.kind);const d=t.N;(typeof d=="number"||this.args.length>1)&&l.push(d)}}return l.concat(this.args.map(u=>u.serialize()))}}class Po{constructor(t){this.type=Ts,this.sections=t}static parse(t,l){if(t.length<2)return l.error("Expected at least one argument.");const u=t[1];if(!Array.isArray(u)&&typeof u=="object")return l.error("First argument must be an image or text section.");const d=[];let p=!1;for(let y=1;y<=t.length-1;++y){const b=t[y];if(p&&typeof b=="object"&&!Array.isArray(b)){p=!1;let S=null;if(b["font-scale"]&&(S=l.parse(b["font-scale"],1,xt),!S))return null;let C=null;if(b["text-font"]&&(C=l.parse(b["text-font"],1,Ui(hn)),!C))return null;let D=null;if(b["text-color"]&&(D=l.parse(b["text-color"],1,ko),!D))return null;const R=d[d.length-1];R.scale=S,R.font=C,R.textColor=D}else{const S=l.parse(t[y],1,rn);if(!S)return null;const C=S.type.kind;if(C!=="string"&&C!=="value"&&C!=="null"&&C!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,d.push({content:S,scale:null,font:null,textColor:null})}}return new Po(d)}evaluate(t){return new Xt(this.sections.map(l=>{const u=l.content.evaluate(t);return gr(u)===Ol?new qh("",u,null,null,null):new qh(Ll(u),null,l.scale?l.scale.evaluate(t):null,l.font?l.font.evaluate(t).join(","):null,l.textColor?l.textColor.evaluate(t):null)}))}eachChild(t){for(const l of this.sections)t(l.content),l.scale&&t(l.scale),l.font&&t(l.font),l.textColor&&t(l.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const l of this.sections){t.push(l.content.serialize());const u={};l.scale&&(u["font-scale"]=l.scale.serialize()),l.font&&(u["text-font"]=l.font.serialize()),l.textColor&&(u["text-color"]=l.textColor.serialize()),t.push(u)}return t}}class Ys{constructor(t){this.type=Ol,this.input=t}static parse(t,l){if(t.length!==2)return l.error("Expected two arguments.");const u=l.parse(t[1],1,hn);return u?new Ys(u):l.error("No image name provided.")}evaluate(t){const l=this.input.evaluate(t),u=Ni.fromString(l);return u&&t.availableImages&&(u.available=t.availableImages.indexOf(l)>-1),u}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const hg={"to-boolean":nn,"to-color":ko,"to-number":xt,"to-string":hn};class Do{constructor(t,l){this.type=t,this.args=l}static parse(t,l){if(t.length<2)return l.error("Expected at least one argument.");const u=t[0];if((u==="to-boolean"||u==="to-string")&&t.length!==2)return l.error("Expected one argument.");const d=hg[u],p=[];for(let y=1;y<t.length;y++){const b=l.parse(t[y],y,rn);if(!b)return null;p.push(b)}return new Do(d,p)}evaluate(t){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(t));if(this.type.kind==="color"){let l,u;for(const d of this.args){if(l=d.evaluate(t),u=null,l instanceof xn)return l;if(typeof l=="string"){const p=t.parseColor(l);if(p)return p}else if(Array.isArray(l)&&(u=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:np(l[0],l[1],l[2],l[3]),!u))return new xn(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new zr(u||`Could not parse color from value '${typeof l=="string"?l:String(JSON.stringify(l))}'`)}if(this.type.kind==="number"){let l=null;for(const u of this.args){if(l=u.evaluate(t),l===null)return 0;const d=Number(l);if(!isNaN(d))return d}throw new zr(`Could not convert ${JSON.stringify(l)} to number.`)}return this.type.kind==="formatted"?Xt.fromString(Ll(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?Ni.fromString(Ll(this.args[0].evaluate(t))):Ll(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Po([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Ys(this.args[0]).serialize();const t=[`to-${this.type.kind}`];return this.eachChild(l=>{t.push(l.serialize())}),t}}const rp=["Unknown","Point","LineString","Polygon"];class ip{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?rp[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,l=this.featureDistanceData.scale,{x:u,y:d}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(u*l-t[0])+this.featureDistanceData.bearing[1]*(d*l-t[1])}return 0}parseColor(t){let l=this._parseColorCache[t];return l||(l=this._parseColorCache[t]=xn.parse(t)),l}}class ki{constructor(t,l,u,d){this.name=t,this.type=l,this._evaluate=u,this.args=d}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,l){const u=t[0],d=ki.definitions[u];if(!d)return l.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const p=Array.isArray(d)?d[0]:d.type,y=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,b=y.filter(([C])=>!Array.isArray(C)||C.length===t.length-1);let S=null;for(const[C,D]of b){S=new iu(l.registry,l.path,null,l.scope);const R=[];let z=!1;for(let U=1;U<t.length;U++){const G=t[U],H=Array.isArray(C)?C[U-1]:C.type,K=S.parse(G,1+R.length,H);if(!K){z=!0;break}R.push(K)}if(!z)if(Array.isArray(C)&&C.length!==R.length)S.error(`Expected ${C.length} arguments, but found ${R.length} instead.`);else{for(let U=0;U<R.length;U++){const G=Array.isArray(C)?C[U]:C.type,H=R[U];S.concat(U+1).checkSubtype(G,H.type)}if(S.errors.length===0)return new ki(u,p,D,R)}}if(b.length===1)l.errors.push(...S.errors);else{const C=(b.length?b:y).map(([R])=>{return z=R,Array.isArray(z)?`(${z.map(sr).join(", ")})`:`(${sr(z.type)}...)`;var z}).join(" | "),D=[];for(let R=1;R<t.length;R++){const z=l.parse(t[R],1+D.length);if(!z)return null;D.push(sr(z.type))}l.error(`Expected arguments of type ${C}, but found (${D.join(", ")}) instead.`)}return null}static register(t,l){ki.definitions=l;for(const u in l)t[u]=ki}}class Fl{constructor(t,l,u){this.type=zl,this.locale=u,this.caseSensitive=t,this.diacriticSensitive=l}static parse(t,l){if(t.length!==2)return l.error("Expected one argument.");const u=t[1];if(typeof u!="object"||Array.isArray(u))return l.error("Collator options argument must be an object.");const d=l.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,nn);if(!d)return null;const p=l.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,nn);if(!p)return null;let y=null;return u.locale&&(y=l.parse(u.locale,1,hn),!y)?null:new Fl(d,p,y)}evaluate(t){return new Jc(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}const Ss=8192;function nu(i,t){i[0]=Math.min(i[0],t[0]),i[1]=Math.min(i[1],t[1]),i[2]=Math.max(i[2],t[0]),i[3]=Math.max(i[3],t[1])}function Bl(i,t){return!(i[0]<=t[0]||i[2]>=t[2]||i[1]<=t[1]||i[3]>=t[3])}function op(i,t){const l=(180+i[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,d=Math.pow(2,t.z);return[Math.round(l*d*Ss),Math.round(u*d*Ss)]}function sp(i,t,l){const u=i[0]-t[0],d=i[1]-t[1],p=i[0]-l[0],y=i[1]-l[1];return u*y-p*d==0&&u*p<=0&&d*y<=0}function Zh(i,t){let l=!1;for(let y=0,b=t.length;y<b;y++){const S=t[y];for(let C=0,D=S.length;C<D-1;C++){if(sp(i,S[C],S[C+1]))return!1;(d=S[C])[1]>(u=i)[1]!=(p=S[C+1])[1]>u[1]&&u[0]<(p[0]-d[0])*(u[1]-d[1])/(p[1]-d[1])+d[0]&&(l=!l)}}var u,d,p;return l}function ap(i,t){for(let l=0;l<t.length;l++)if(Zh(i,t[l]))return!0;return!1}function Wh(i,t,l,u){const d=u[0]-l[0],p=u[1]-l[1],y=(i[0]-l[0])*p-d*(i[1]-l[1]),b=(t[0]-l[0])*p-d*(t[1]-l[1]);return y>0&&b<0||y<0&&b>0}function fg(i,t,l){for(const C of l)for(let D=0;D<C.length-1;++D)if((b=[(y=C[D+1])[0]-(p=C[D])[0],y[1]-p[1]])[0]*(S=[(d=t)[0]-(u=i)[0],d[1]-u[1]])[1]-b[1]*S[0]!=0&&Wh(u,d,p,y)&&Wh(p,y,u,d))return!0;var u,d,p,y,b,S;return!1}function lp(i,t){for(let l=0;l<i.length;++l)if(!Zh(i[l],t))return!1;for(let l=0;l<i.length-1;++l)if(fg(i[l],i[l+1],t))return!1;return!0}function dg(i,t){for(let l=0;l<t.length;l++)if(lp(i,t[l]))return!0;return!1}function Hh(i,t,l){const u=[];for(let d=0;d<i.length;d++){const p=[];for(let y=0;y<i[d].length;y++){const b=op(i[d][y],l);nu(t,b),p.push(b)}u.push(p)}return u}function cp(i,t,l){const u=[];for(let d=0;d<i.length;d++){const p=Hh(i[d],t,l);u.push(p)}return u}function Xh(i,t,l,u){if(i[0]<l[0]||i[0]>l[2]){const d=.5*u;let p=i[0]-l[0]>d?-u:l[0]-i[0]>d?u:0;p===0&&(p=i[0]-l[2]>d?-u:l[2]-i[0]>d?u:0),i[0]+=p}nu(t,i)}function up(i,t,l,u){const d=Math.pow(2,u.z)*Ss,p=[u.x*Ss,u.y*Ss],y=[];for(const b of i)for(const S of b){const C=[S.x+p[0],S.y+p[1]];Xh(C,t,l,d),y.push(C)}return y}function hp(i,t,l,u){const d=Math.pow(2,u.z)*Ss,p=[u.x*Ss,u.y*Ss],y=[];for(const S of i){const C=[];for(const D of S){const R=[D.x+p[0],D.y+p[1]];nu(t,R),C.push(R)}y.push(C)}if(t[2]-t[0]<=d/2){(b=t)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const S of y)for(const C of S)Xh(C,t,l,d)}var b;return y}class Qs{constructor(t,l){this.type=nn,this.geojson=t,this.geometries=l}static parse(t,l){if(t.length!==2)return l.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(eu(t[1])){const u=t[1];if(u.type==="FeatureCollection")for(let d=0;d<u.features.length;++d){const p=u.features[d].geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Qs(u,u.features[d].geometry)}else if(u.type==="Feature"){const d=u.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new Qs(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new Qs(u,u)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(l,u){const d=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],y=l.canonicalID();if(u.type==="Polygon"){const b=Hh(u.coordinates,p,y),S=up(l.geometry(),d,p,y);if(!Bl(d,p))return!1;for(const C of S)if(!Zh(C,b))return!1}if(u.type==="MultiPolygon"){const b=cp(u.coordinates,p,y),S=up(l.geometry(),d,p,y);if(!Bl(d,p))return!1;for(const C of S)if(!ap(C,b))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(l,u){const d=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],y=l.canonicalID();if(u.type==="Polygon"){const b=Hh(u.coordinates,p,y),S=hp(l.geometry(),d,p,y);if(!Bl(d,p))return!1;for(const C of S)if(!lp(C,b))return!1}if(u.type==="MultiPolygon"){const b=cp(u.coordinates,p,y),S=hp(l.geometry(),d,p,y);if(!Bl(d,p))return!1;for(const C of S)if(!dg(C,b))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function Pa(i){if(i instanceof ki&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof Qs)return!1;let t=!0;return i.eachChild(l=>{t&&!Pa(l)&&(t=!1)}),t}function Ul(i){if(i instanceof ki&&i.name==="feature-state")return!1;let t=!0;return i.eachChild(l=>{t&&!Ul(l)&&(t=!1)}),t}function Nl(i,t){if(i instanceof ki&&t.indexOf(i.name)>=0)return!1;let l=!0;return i.eachChild(u=>{l&&!Nl(u,t)&&(l=!1)}),l}class ru{constructor(t,l){this.type=l.type,this.name=t,this.boundExpression=l}static parse(t,l){if(t.length!==2||typeof t[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");const u=t[1];return l.scope.has(u)?new ru(u,l.scope.get(u)):l.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class iu{constructor(t,l=[],u,d=new Yc,p=[]){this.registry=t,this.path=l,this.key=l.map(y=>`[${y}]`).join(""),this.scope=d,this.errors=p,this.expectedType=u}parse(t,l,u,d,p={}){return l?this.concat(l,u,d)._parse(t,p):this._parse(t,p)}_parse(t,l){function u(d,p,y){return y==="assert"?new ji(p,[d]):y==="coerce"?new Do(p,[d]):d}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=t[0];if(typeof d!="string")return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const p=this.registry[d];if(p){let y=p.parse(t,this);if(!y)return null;if(this.expectedType){const b=this.expectedType,S=y.type;if(b.kind!=="string"&&b.kind!=="number"&&b.kind!=="boolean"&&b.kind!=="object"&&b.kind!=="array"||S.kind!=="value")if(b.kind!=="color"&&b.kind!=="formatted"&&b.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string"){if(this.checkSubtype(b,S))return null}else y=u(y,b,l.typeAnnotation||"coerce");else y=u(y,b,l.typeAnnotation||"assert")}if(!(y instanceof Es)&&y.type.kind!=="resolvedImage"&&ou(y)){const b=new ip;try{y=new Es(y.type,y.evaluate(b))}catch(S){return this.error(S.message),null}}return y}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,l,u){const d=typeof t=="number"?this.path.concat(t):this.path,p=u?this.scope.concat(u):this.scope;return new iu(this.registry,d,l||null,p,this.errors)}error(t,...l){const u=`${this.key}${l.map(d=>`[${d}]`).join("")}`;this.errors.push(new Mo(u,t))}checkSubtype(t,l){const u=yi(t,l);return u&&this.error(u),u}}function ou(i){if(i instanceof ru)return ou(i.boundExpression);if(i instanceof ki&&i.name==="error"||i instanceof Fl||i instanceof Qs)return!1;const t=i instanceof Do||i instanceof ji;let l=!0;return i.eachChild(u=>{l=t?l&&ou(u):l&&u instanceof Es}),!!l&&Pa(i)&&Nl(i,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function jl(i,t){const l=i.length-1;let u,d,p=0,y=l,b=0;for(;p<=y;)if(b=Math.floor((p+y)/2),u=i[b],d=i[b+1],u<=t){if(b===l||t<d)return b;p=b+1}else{if(!(u>t))throw new zr("Input is not a number.");y=b-1}return 0}class $l{constructor(t,l,u){this.type=t,this.input=l,this.labels=[],this.outputs=[];for(const[d,p]of u)this.labels.push(d),this.outputs.push(p)}static parse(t,l){if(t.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return l.error("Expected an even number of arguments.");const u=l.parse(t[1],1,xt);if(!u)return null;const d=[];let p=null;l.expectedType&&l.expectedType.kind!=="value"&&(p=l.expectedType);for(let y=1;y<t.length;y+=2){const b=y===1?-1/0:t[y],S=t[y+1],C=y,D=y+1;if(typeof b!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(d.length&&d[d.length-1][0]>=b)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',C);const R=l.parse(S,D,p);if(!R)return null;p=p||R.type,d.push([b,R])}return new $l(p,u,d)}evaluate(t){const l=this.labels,u=this.outputs;if(l.length===1)return u[0].evaluate(t);const d=this.input.evaluate(t);if(d<=l[0])return u[0].evaluate(t);const p=l.length;return d>=l[p-1]?u[p-1].evaluate(t):u[jl(l,d)].evaluate(t)}eachChild(t){t(this.input);for(const l of this.outputs)t(l)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let l=0;l<this.labels.length;l++)l>0&&t.push(this.labels[l]),t.push(this.outputs[l].serialize());return t}}function In(i,t,l){return i*(1-l)+t*l}var su=Object.freeze({__proto__:null,number:In,color:function(i,t,l){return new xn(In(i.r,t.r,l),In(i.g,t.g,l),In(i.b,t.b,l),In(i.a,t.a,l))},array:function(i,t,l){return i.map((u,d)=>In(u,t[d],l))}});const fp=.95047,Vl=1.08883,Kh=4/29,au=6/29,dp=3*au*au,pg=Math.PI/180,mg=180/Math.PI;function lu(i){return i>.008856451679035631?Math.pow(i,1/3):i/dp+Kh}function cu(i){return i>au?i*i*i:dp*(i-Kh)}function uu(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function Gl(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function pp(i){const t=Gl(i.r),l=Gl(i.g),u=Gl(i.b),d=lu((.4124564*t+.3575761*l+.1804375*u)/fp),p=lu((.2126729*t+.7151522*l+.072175*u)/1);return{l:116*p-16,a:500*(d-p),b:200*(p-lu((.0193339*t+.119192*l+.9503041*u)/Vl)),alpha:i.a}}function mp(i){let t=(i.l+16)/116,l=isNaN(i.a)?t:t+i.a/500,u=isNaN(i.b)?t:t-i.b/200;return t=1*cu(t),l=fp*cu(l),u=Vl*cu(u),new xn(uu(3.2404542*l-1.5371385*t-.4985314*u),uu(-.969266*l+1.8760108*t+.041556*u),uu(.0556434*l-.2040259*t+1.0572252*u),i.alpha)}function _g(i,t,l){const u=t-i;return i+l*(u>180||u<-180?u-360*Math.round(u/360):u)}const ql={forward:pp,reverse:mp,interpolate:function(i,t,l){return{l:In(i.l,t.l,l),a:In(i.a,t.a,l),b:In(i.b,t.b,l),alpha:In(i.alpha,t.alpha,l)}}},Zl={forward:function(i){const{l:t,a:l,b:u}=pp(i),d=Math.atan2(u,l)*mg;return{h:d<0?d+360:d,c:Math.sqrt(l*l+u*u),l:t,alpha:i.a}},reverse:function(i){const t=i.h*pg,l=i.c;return mp({l:i.l,a:Math.cos(t)*l,b:Math.sin(t)*l,alpha:i.alpha})},interpolate:function(i,t,l){return{h:_g(i.h,t.h,l),c:In(i.c,t.c,l),l:In(i.l,t.l,l),alpha:In(i.alpha,t.alpha,l)}}};var _p=Object.freeze({__proto__:null,lab:ql,hcl:Zl});class vi{constructor(t,l,u,d,p){this.type=t,this.operator=l,this.interpolation=u,this.input=d,this.labels=[],this.outputs=[];for(const[y,b]of p)this.labels.push(y),this.outputs.push(b)}static interpolationFactor(t,l,u,d){let p=0;if(t.name==="exponential")p=hu(l,t.base,u,d);else if(t.name==="linear")p=hu(l,1,u,d);else if(t.name==="cubic-bezier"){const y=t.controlPoints;p=new w(y[0],y[1],y[2],y[3]).solve(hu(l,1,u,d))}return p}static parse(t,l){let[u,d,p,...y]=t;if(!Array.isArray(d)||d.length===0)return l.error("Expected an interpolation type expression.",1);if(d[0]==="linear")d={name:"linear"};else if(d[0]==="exponential"){const C=d[1];if(typeof C!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:C}}else{if(d[0]!=="cubic-bezier")return l.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const C=d.slice(1);if(C.length!==4||C.some(D=>typeof D!="number"||D<0||D>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:C}}}if(t.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(p=l.parse(p,2,xt),!p)return null;const b=[];let S=null;u==="interpolate-hcl"||u==="interpolate-lab"?S=ko:l.expectedType&&l.expectedType.kind!=="value"&&(S=l.expectedType);for(let C=0;C<y.length;C+=2){const D=y[C],R=y[C+1],z=C+3,U=C+4;if(typeof D!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(b.length&&b[b.length-1][0]>=D)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',z);const G=l.parse(R,U,S);if(!G)return null;S=S||G.type,b.push([D,G])}return S.kind==="number"||S.kind==="color"||S.kind==="array"&&S.itemType.kind==="number"&&typeof S.N=="number"?new vi(S,u,d,p,b):l.error(`Type ${sr(S)} is not interpolatable.`)}evaluate(t){const l=this.labels,u=this.outputs;if(l.length===1)return u[0].evaluate(t);const d=this.input.evaluate(t);if(d<=l[0])return u[0].evaluate(t);const p=l.length;if(d>=l[p-1])return u[p-1].evaluate(t);const y=jl(l,d),b=vi.interpolationFactor(this.interpolation,d,l[y],l[y+1]),S=u[y].evaluate(t),C=u[y+1].evaluate(t);return this.operator==="interpolate"?su[this.type.kind.toLowerCase()](S,C,b):this.operator==="interpolate-hcl"?Zl.reverse(Zl.interpolate(Zl.forward(S),Zl.forward(C),b)):ql.reverse(ql.interpolate(ql.forward(S),ql.forward(C),b))}eachChild(t){t(this.input);for(const l of this.outputs)t(l)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const l=[this.operator,t,this.input.serialize()];for(let u=0;u<this.labels.length;u++)l.push(this.labels[u],this.outputs[u].serialize());return l}}function hu(i,t,l,u){const d=u-l,p=i-l;return d===0?0:t===1?p/d:(Math.pow(t,p)-1)/(Math.pow(t,d)-1)}class Js{constructor(t,l){this.type=t,this.args=l}static parse(t,l){if(t.length<2)return l.error("Expectected at least one argument.");let u=null;const d=l.expectedType;d&&d.kind!=="value"&&(u=d);const p=[];for(const b of t.slice(1)){const S=l.parse(b,1+p.length,u,void 0,{typeAnnotation:"omit"});if(!S)return null;u=u||S.type,p.push(S)}const y=d&&p.some(b=>yi(d,b.type));return new Js(y?rn:u,p)}evaluate(t){let l,u=null,d=0;for(const p of this.args){if(d++,u=p.evaluate(t),u&&u instanceof Ni&&!u.available&&(l||(l=u),u=null,d===this.args.length))return l;if(u!==null)break}return u}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(l=>{t.push(l.serialize())}),t}}class fu{constructor(t,l){this.type=l.type,this.bindings=[].concat(t),this.result=l}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const l of this.bindings)t(l[1]);t(this.result)}static parse(t,l){if(t.length<4)return l.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const u=[];for(let p=1;p<t.length-1;p+=2){const y=t[p];if(typeof y!="string")return l.error(`Expected string, but found ${typeof y} instead.`,p);if(/[^a-zA-Z0-9_]/.test(y))return l.error("Variable names must contain only alphanumeric characters or '_'.",p);const b=l.parse(t[p+1],p+1);if(!b)return null;u.push([y,b])}const d=l.parse(t[t.length-1],t.length-1,l.expectedType,u);return d?new fu(u,d):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[l,u]of this.bindings)t.push(l,u.serialize());return t.push(this.result.serialize()),t}}class Yh{constructor(t,l,u){this.type=t,this.index=l,this.input=u}static parse(t,l){if(t.length!==3)return l.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const u=l.parse(t[1],1,xt),d=l.parse(t[2],2,Ui(l.expectedType||rn));return u&&d?new Yh(d.type.itemType,u,d):null}evaluate(t){const l=this.index.evaluate(t),u=this.input.evaluate(t);if(l<0)throw new zr(`Array index out of bounds: ${l} < 0.`);if(l>=u.length)throw new zr(`Array index out of bounds: ${l} > ${u.length-1}.`);if(l!==Math.floor(l))throw new zr(`Array index must be an integer, but found ${l} instead.`);return u[l]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Qh{constructor(t,l){this.type=nn,this.needle=t,this.haystack=l}static parse(t,l){if(t.length!==3)return l.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const u=l.parse(t[1],1,rn),d=l.parse(t[2],2,rn);return u&&d?Qc(u.type,[nn,hn,xt,ws,rn])?new Qh(u,d):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${sr(u.type)} instead`):null}evaluate(t){const l=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(!u)return!1;if(!Ia(l,["boolean","string","number","null"]))throw new zr(`Expected first argument to be of type boolean, string, number or null, but found ${sr(gr(l))} instead.`);if(!Ia(u,["string","array"]))throw new zr(`Expected second argument to be of type array or string, but found ${sr(gr(u))} instead.`);return u.indexOf(l)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class ao{constructor(t,l,u){this.type=xt,this.needle=t,this.haystack=l,this.fromIndex=u}static parse(t,l){if(t.length<=2||t.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const u=l.parse(t[1],1,rn),d=l.parse(t[2],2,rn);if(!u||!d)return null;if(!Qc(u.type,[nn,hn,xt,ws,rn]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${sr(u.type)} instead`);if(t.length===4){const p=l.parse(t[3],3,xt);return p?new ao(u,d,p):null}return new ao(u,d)}evaluate(t){const l=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(!Ia(l,["boolean","string","number","null"]))throw new zr(`Expected first argument to be of type boolean, string, number or null, but found ${sr(gr(l))} instead.`);if(!Ia(u,["string","array"]))throw new zr(`Expected second argument to be of type array or string, but found ${sr(gr(u))} instead.`);if(this.fromIndex){const d=this.fromIndex.evaluate(t);return u.indexOf(l,d)}return u.indexOf(l)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class du{constructor(t,l,u,d,p,y){this.inputType=t,this.type=l,this.input=u,this.cases=d,this.outputs=p,this.otherwise=y}static parse(t,l){if(t.length<5)return l.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return l.error("Expected an even number of arguments.");let u,d;l.expectedType&&l.expectedType.kind!=="value"&&(d=l.expectedType);const p={},y=[];for(let C=2;C<t.length-1;C+=2){let D=t[C];const R=t[C+1];Array.isArray(D)||(D=[D]);const z=l.concat(C);if(D.length===0)return z.error("Expected at least one branch label.");for(const G of D){if(typeof G!="number"&&typeof G!="string")return z.error("Branch labels must be numbers or strings.");if(typeof G=="number"&&Math.abs(G)>Number.MAX_SAFE_INTEGER)return z.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof G=="number"&&Math.floor(G)!==G)return z.error("Numeric branch labels must be integer values.");if(u){if(z.checkSubtype(u,gr(G)))return null}else u=gr(G);if(p[String(G)]!==void 0)return z.error("Branch labels must be unique.");p[String(G)]=y.length}const U=l.parse(R,C,d);if(!U)return null;d=d||U.type,y.push(U)}const b=l.parse(t[1],1,rn);if(!b)return null;const S=l.parse(t[t.length-1],t.length-1,d);return S?b.type.kind!=="value"&&l.concat(1).checkSubtype(u,b.type)?null:new du(u,d,b,p,y,S):null}evaluate(t){const l=this.input.evaluate(t);return(gr(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],l=Object.keys(this.cases).sort(),u=[],d={};for(const y of l){const b=d[this.cases[y]];b===void 0?(d[this.cases[y]]=u.length,u.push([this.cases[y],[y]])):u[b][1].push(y)}const p=y=>this.inputType.kind==="number"?Number(y):y;for(const[y,b]of u)t.push(b.length===1?p(b[0]):b.map(p)),t.push(this.outputs[y].serialize());return t.push(this.otherwise.serialize()),t}}class As{constructor(t,l,u){this.type=t,this.branches=l,this.otherwise=u}static parse(t,l){if(t.length<4)return l.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return l.error("Expected an odd number of arguments.");let u;l.expectedType&&l.expectedType.kind!=="value"&&(u=l.expectedType);const d=[];for(let y=1;y<t.length-1;y+=2){const b=l.parse(t[y],y,nn);if(!b)return null;const S=l.parse(t[y+1],y+1,u);if(!S)return null;d.push([b,S]),u=u||S.type}const p=l.parse(t[t.length-1],t.length-1,u);return p?new As(u,d,p):null}evaluate(t){for(const[l,u]of this.branches)if(l.evaluate(t))return u.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[l,u]of this.branches)t(l),t(u);t(this.otherwise)}outputDefined(){return this.branches.every(([t,l])=>l.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(l=>{t.push(l.serialize())}),t}}class Wl{constructor(t,l,u,d){this.type=t,this.input=l,this.beginIndex=u,this.endIndex=d}static parse(t,l){if(t.length<=2||t.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const u=l.parse(t[1],1,rn),d=l.parse(t[2],2,xt);if(!u||!d)return null;if(!Qc(u.type,[Ui(rn),hn,rn]))return l.error(`Expected first argument to be of type array or string, but found ${sr(u.type)} instead`);if(t.length===4){const p=l.parse(t[3],3,xt);return p?new Wl(u.type,u,d,p):null}return new Wl(u.type,u,d)}evaluate(t){const l=this.input.evaluate(t),u=this.beginIndex.evaluate(t);if(!Ia(l,["string","array"]))throw new zr(`Expected first argument to be of type array or string, but found ${sr(gr(l))} instead.`);if(this.endIndex){const d=this.endIndex.evaluate(t);return l.slice(u,d)}return l.slice(u)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function gp(i,t){return i==="=="||i==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function pu(i,t,l,u){return u.compare(t,l)===0}function Cs(i,t,l){const u=i!=="=="&&i!=="!=";return class QC{constructor(p,y,b){this.type=nn,this.lhs=p,this.rhs=y,this.collator=b,this.hasUntypedArgument=p.type.kind==="value"||y.type.kind==="value"}static parse(p,y){if(p.length!==3&&p.length!==4)return y.error("Expected two or three arguments.");const b=p[0];let S=y.parse(p[1],1,rn);if(!S)return null;if(!gp(b,S.type))return y.concat(1).error(`"${b}" comparisons are not supported for type '${sr(S.type)}'.`);let C=y.parse(p[2],2,rn);if(!C)return null;if(!gp(b,C.type))return y.concat(2).error(`"${b}" comparisons are not supported for type '${sr(C.type)}'.`);if(S.type.kind!==C.type.kind&&S.type.kind!=="value"&&C.type.kind!=="value")return y.error(`Cannot compare types '${sr(S.type)}' and '${sr(C.type)}'.`);u&&(S.type.kind==="value"&&C.type.kind!=="value"?S=new ji(C.type,[S]):S.type.kind!=="value"&&C.type.kind==="value"&&(C=new ji(S.type,[C])));let D=null;if(p.length===4){if(S.type.kind!=="string"&&C.type.kind!=="string"&&S.type.kind!=="value"&&C.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(D=y.parse(p[3],3,zl),!D)return null}return new QC(S,C,D)}evaluate(p){const y=this.lhs.evaluate(p),b=this.rhs.evaluate(p);if(u&&this.hasUntypedArgument){const S=gr(y),C=gr(b);if(S.kind!==C.kind||S.kind!=="string"&&S.kind!=="number")throw new zr(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${S.kind}, ${C.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const S=gr(y),C=gr(b);if(S.kind!=="string"||C.kind!=="string")return t(p,y,b)}return this.collator?l(p,y,b,this.collator.evaluate(p)):t(p,y,b)}eachChild(p){p(this.lhs),p(this.rhs),this.collator&&p(this.collator)}outputDefined(){return!0}serialize(){const p=[i];return this.eachChild(y=>{p.push(y.serialize())}),p}}}const yp=Cs("==",function(i,t,l){return t===l},pu),Jh=Cs("!=",function(i,t,l){return t!==l},function(i,t,l,u){return!pu(0,t,l,u)}),ef=Cs("<",function(i,t,l){return t<l},function(i,t,l,u){return u.compare(t,l)<0}),vp=Cs(">",function(i,t,l){return t>l},function(i,t,l,u){return u.compare(t,l)>0}),tf=Cs("<=",function(i,t,l){return t<=l},function(i,t,l,u){return u.compare(t,l)<=0}),xp=Cs(">=",function(i,t,l){return t>=l},function(i,t,l,u){return u.compare(t,l)>=0});class mu{constructor(t,l,u,d,p){this.type=hn,this.number=t,this.locale=l,this.currency=u,this.minFractionDigits=d,this.maxFractionDigits=p}static parse(t,l){if(t.length!==3)return l.error("Expected two arguments.");const u=l.parse(t[1],1,xt);if(!u)return null;const d=t[2];if(typeof d!="object"||Array.isArray(d))return l.error("NumberFormat options argument must be an object.");let p=null;if(d.locale&&(p=l.parse(d.locale,1,hn),!p))return null;let y=null;if(d.currency&&(y=l.parse(d.currency,1,hn),!y))return null;let b=null;if(d["min-fraction-digits"]&&(b=l.parse(d["min-fraction-digits"],1,xt),!b))return null;let S=null;return d["max-fraction-digits"]&&(S=l.parse(d["max-fraction-digits"],1,xt),!S)?null:new mu(u,p,y,b,S)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class _u{constructor(t){this.type=xt,this.input=t}static parse(t,l){if(t.length!==2)return l.error(`Expected 1 argument, but found ${t.length-1} instead.`);const u=l.parse(t[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?l.error(`Expected argument of type string or array, but found ${sr(u.type)} instead.`):new _u(u):null}evaluate(t){const l=this.input.evaluate(t);if(typeof l=="string"||Array.isArray(l))return l.length;throw new zr(`Expected value to be of type string or array, but found ${sr(gr(l))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(l=>{t.push(l.serialize())}),t}}const lo={"==":yp,"!=":Jh,">":vp,"<":ef,">=":xp,"<=":tf,array:ji,at:Yh,boolean:ji,case:As,coalesce:Js,collator:Fl,format:Po,image:Ys,in:Qh,"index-of":ao,interpolate:vi,"interpolate-hcl":vi,"interpolate-lab":vi,length:_u,let:fu,literal:Es,match:du,number:ji,"number-format":mu,object:ji,slice:Wl,step:$l,string:ji,"to-boolean":Do,"to-color":Do,"to-number":Do,"to-string":Do,var:ru,within:Qs};function nf(i,[t,l,u,d]){t=t.evaluate(i),l=l.evaluate(i),u=u.evaluate(i);const p=d?d.evaluate(i):1,y=np(t,l,u,p);if(y)throw new zr(y);return new xn(t/255*p,l/255*p,u/255*p,p)}function rf(i,t){return i in t}function Hl(i,t){const l=t[i];return l===void 0?null:l}function Is(i){return{type:i}}function bp(i){return{result:"success",value:i}}function es(i){return{result:"error",value:i}}function Da(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function wp(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function of(i){return!!i.expression&&i.expression.interpolated}function En(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function gu(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function yu(i){return i}function Xl(i,t){const l=t.type==="color",u=i.stops&&typeof i.stops[0][0]=="object",d=u||!(u||i.property!==void 0),p=i.type||(of(t)?"exponential":"interval");if(l&&((i=bs({},i)).stops&&(i.stops=i.stops.map(C=>[C[0],xn.parse(C[1])])),i.default=xn.parse(i.default?i.default:t.default)),i.colorSpace&&i.colorSpace!=="rgb"&&!_p[i.colorSpace])throw new Error(`Unknown color space: ${i.colorSpace}`);let y,b,S;if(p==="exponential")y=Tp;else if(p==="interval")y=gg;else if(p==="categorical"){y=vu,b=Object.create(null);for(const C of i.stops)b[C[0]]=C[1];S=typeof i.stops[0][0]}else{if(p!=="identity")throw new Error(`Unknown function type "${p}"`);y=yg}if(u){const C={},D=[];for(let U=0;U<i.stops.length;U++){const G=i.stops[U],H=G[0].zoom;C[H]===void 0&&(C[H]={zoom:H,type:i.type,property:i.property,default:i.default,stops:[]},D.push(H)),C[H].stops.push([G[0].value,G[1]])}const R=[];for(const U of D)R.push([C[U].zoom,Xl(C[U],t)]);const z={name:"linear"};return{kind:"composite",interpolationType:z,interpolationFactor:vi.interpolationFactor.bind(void 0,z),zoomStops:R.map(U=>U[0]),evaluate:({zoom:U},G)=>Tp({stops:R,base:i.base},t,U).evaluate(U,G)}}if(d){const C=p==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:C,interpolationFactor:vi.interpolationFactor.bind(void 0,C),zoomStops:i.stops.map(D=>D[0]),evaluate:({zoom:D})=>y(i,t,D,b,S)}}return{kind:"source",evaluate(C,D){const R=D&&D.properties?D.properties[i.property]:void 0;return R===void 0?qr(i.default,t.default):y(i,t,R,b,S)}}}function qr(i,t,l){return i!==void 0?i:t!==void 0?t:l!==void 0?l:void 0}function vu(i,t,l,u,d){return qr(typeof l===d?u[l]:void 0,i.default,t.default)}function gg(i,t,l){if(En(l)!=="number")return qr(i.default,t.default);const u=i.stops.length;if(u===1||l<=i.stops[0][0])return i.stops[0][1];if(l>=i.stops[u-1][0])return i.stops[u-1][1];const d=jl(i.stops.map(p=>p[0]),l);return i.stops[d][1]}function Tp(i,t,l){const u=i.base!==void 0?i.base:1;if(En(l)!=="number")return qr(i.default,t.default);const d=i.stops.length;if(d===1||l<=i.stops[0][0])return i.stops[0][1];if(l>=i.stops[d-1][0])return i.stops[d-1][1];const p=jl(i.stops.map(D=>D[0]),l),y=function(D,R,z,U){const G=U-z,H=D-z;return G===0?0:R===1?H/G:(Math.pow(R,H)-1)/(Math.pow(R,G)-1)}(l,u,i.stops[p][0],i.stops[p+1][0]),b=i.stops[p][1],S=i.stops[p+1][1];let C=su[t.type]||yu;if(i.colorSpace&&i.colorSpace!=="rgb"){const D=_p[i.colorSpace];C=(R,z)=>D.reverse(D.interpolate(D.forward(R),D.forward(z),y))}return typeof b.evaluate=="function"?{evaluate(...D){const R=b.evaluate.apply(void 0,D),z=S.evaluate.apply(void 0,D);if(R!==void 0&&z!==void 0)return C(R,z,y)}}:C(b,S,y)}function yg(i,t,l){return t.type==="color"?l=xn.parse(l):t.type==="formatted"?l=Xt.fromString(l.toString()):t.type==="resolvedImage"?l=Ni.fromString(l.toString()):En(l)===t.type||t.type==="enum"&&t.values[l]||(l=void 0),qr(l,i.default,t.default)}ki.register(lo,{error:[{kind:"error"},[hn],(i,[t])=>{throw new zr(t.evaluate(i))}],typeof:[hn,[rn],(i,[t])=>sr(gr(t.evaluate(i)))],"to-rgba":[Ui(xt,4),[ko],(i,[t])=>t.evaluate(i).toArray()],rgb:[ko,[xt,xt,xt],nf],rgba:[ko,[xt,xt,xt,xt],nf],has:{type:nn,overloads:[[[hn],(i,[t])=>rf(t.evaluate(i),i.properties())],[[hn,Ca],(i,[t,l])=>rf(t.evaluate(i),l.evaluate(i))]]},get:{type:rn,overloads:[[[hn],(i,[t])=>Hl(t.evaluate(i),i.properties())],[[hn,Ca],(i,[t,l])=>Hl(t.evaluate(i),l.evaluate(i))]]},"feature-state":[rn,[hn],(i,[t])=>Hl(t.evaluate(i),i.featureState||{})],properties:[Ca,[],i=>i.properties()],"geometry-type":[hn,[],i=>i.geometryType()],id:[rn,[],i=>i.id()],zoom:[xt,[],i=>i.globals.zoom],pitch:[xt,[],i=>i.globals.pitch||0],"distance-from-center":[xt,[],i=>i.distanceFromCenter()],"heatmap-density":[xt,[],i=>i.globals.heatmapDensity||0],"line-progress":[xt,[],i=>i.globals.lineProgress||0],"sky-radial-progress":[xt,[],i=>i.globals.skyRadialProgress||0],accumulated:[rn,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[xt,Is(xt),(i,t)=>{let l=0;for(const u of t)l+=u.evaluate(i);return l}],"*":[xt,Is(xt),(i,t)=>{let l=1;for(const u of t)l*=u.evaluate(i);return l}],"-":{type:xt,overloads:[[[xt,xt],(i,[t,l])=>t.evaluate(i)-l.evaluate(i)],[[xt],(i,[t])=>-t.evaluate(i)]]},"/":[xt,[xt,xt],(i,[t,l])=>t.evaluate(i)/l.evaluate(i)],"%":[xt,[xt,xt],(i,[t,l])=>t.evaluate(i)%l.evaluate(i)],ln2:[xt,[],()=>Math.LN2],pi:[xt,[],()=>Math.PI],e:[xt,[],()=>Math.E],"^":[xt,[xt,xt],(i,[t,l])=>Math.pow(t.evaluate(i),l.evaluate(i))],sqrt:[xt,[xt],(i,[t])=>Math.sqrt(t.evaluate(i))],log10:[xt,[xt],(i,[t])=>Math.log(t.evaluate(i))/Math.LN10],ln:[xt,[xt],(i,[t])=>Math.log(t.evaluate(i))],log2:[xt,[xt],(i,[t])=>Math.log(t.evaluate(i))/Math.LN2],sin:[xt,[xt],(i,[t])=>Math.sin(t.evaluate(i))],cos:[xt,[xt],(i,[t])=>Math.cos(t.evaluate(i))],tan:[xt,[xt],(i,[t])=>Math.tan(t.evaluate(i))],asin:[xt,[xt],(i,[t])=>Math.asin(t.evaluate(i))],acos:[xt,[xt],(i,[t])=>Math.acos(t.evaluate(i))],atan:[xt,[xt],(i,[t])=>Math.atan(t.evaluate(i))],min:[xt,Is(xt),(i,t)=>Math.min(...t.map(l=>l.evaluate(i)))],max:[xt,Is(xt),(i,t)=>Math.max(...t.map(l=>l.evaluate(i)))],abs:[xt,[xt],(i,[t])=>Math.abs(t.evaluate(i))],round:[xt,[xt],(i,[t])=>{const l=t.evaluate(i);return l<0?-Math.round(-l):Math.round(l)}],floor:[xt,[xt],(i,[t])=>Math.floor(t.evaluate(i))],ceil:[xt,[xt],(i,[t])=>Math.ceil(t.evaluate(i))],"filter-==":[nn,[hn,rn],(i,[t,l])=>i.properties()[t.value]===l.value],"filter-id-==":[nn,[rn],(i,[t])=>i.id()===t.value],"filter-type-==":[nn,[hn],(i,[t])=>i.geometryType()===t.value],"filter-<":[nn,[hn,rn],(i,[t,l])=>{const u=i.properties()[t.value],d=l.value;return typeof u==typeof d&&u<d}],"filter-id-<":[nn,[rn],(i,[t])=>{const l=i.id(),u=t.value;return typeof l==typeof u&&l<u}],"filter->":[nn,[hn,rn],(i,[t,l])=>{const u=i.properties()[t.value],d=l.value;return typeof u==typeof d&&u>d}],"filter-id->":[nn,[rn],(i,[t])=>{const l=i.id(),u=t.value;return typeof l==typeof u&&l>u}],"filter-<=":[nn,[hn,rn],(i,[t,l])=>{const u=i.properties()[t.value],d=l.value;return typeof u==typeof d&&u<=d}],"filter-id-<=":[nn,[rn],(i,[t])=>{const l=i.id(),u=t.value;return typeof l==typeof u&&l<=u}],"filter->=":[nn,[hn,rn],(i,[t,l])=>{const u=i.properties()[t.value],d=l.value;return typeof u==typeof d&&u>=d}],"filter-id->=":[nn,[rn],(i,[t])=>{const l=i.id(),u=t.value;return typeof l==typeof u&&l>=u}],"filter-has":[nn,[rn],(i,[t])=>t.value in i.properties()],"filter-has-id":[nn,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[nn,[Ui(hn)],(i,[t])=>t.value.indexOf(i.geometryType())>=0],"filter-id-in":[nn,[Ui(rn)],(i,[t])=>t.value.indexOf(i.id())>=0],"filter-in-small":[nn,[hn,Ui(rn)],(i,[t,l])=>l.value.indexOf(i.properties()[t.value])>=0],"filter-in-large":[nn,[hn,Ui(rn)],(i,[t,l])=>function(u,d,p,y){for(;p<=y;){const b=p+y>>1;if(d[b]===u)return!0;d[b]>u?y=b-1:p=b+1}return!1}(i.properties()[t.value],l.value,0,l.value.length-1)],all:{type:nn,overloads:[[[nn,nn],(i,[t,l])=>t.evaluate(i)&&l.evaluate(i)],[Is(nn),(i,t)=>{for(const l of t)if(!l.evaluate(i))return!1;return!0}]]},any:{type:nn,overloads:[[[nn,nn],(i,[t,l])=>t.evaluate(i)||l.evaluate(i)],[Is(nn),(i,t)=>{for(const l of t)if(l.evaluate(i))return!0;return!1}]]},"!":[nn,[nn],(i,[t])=>!t.evaluate(i)],"is-supported-script":[nn,[hn],(i,[t])=>{const l=i.globals&&i.globals.isSupportedScript;return!l||l(t.evaluate(i))}],upcase:[hn,[hn],(i,[t])=>t.evaluate(i).toUpperCase()],downcase:[hn,[hn],(i,[t])=>t.evaluate(i).toLowerCase()],concat:[hn,Is(rn),(i,t)=>t.map(l=>Ll(l.evaluate(i))).join("")],"resolved-locale":[hn,[zl],(i,[t])=>t.evaluate(i).resolvedLocale()]});class sf{constructor(t,l){this.expression=t,this._warningHistory={},this._evaluator=new ip,this._defaultValue=l?function(u){return u.type==="color"&&gu(u.default)?new xn(0,0,0,0):u.type==="color"?xn.parse(u.default)||null:u.default===void 0?null:u.default}(l):null,this._enumValues=l&&l.type==="enum"?l.values:null}evaluateWithoutErrorHandling(t,l,u,d,p,y,b,S){return this._evaluator.globals=t,this._evaluator.feature=l,this._evaluator.featureState=u,this._evaluator.canonical=d,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=y,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=S||null,this.expression.evaluate(this._evaluator)}evaluate(t,l,u,d,p,y,b,S){this._evaluator.globals=t,this._evaluator.feature=l||null,this._evaluator.featureState=u||null,this._evaluator.canonical=d,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=y||null,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=S||null;try{const C=this.expression.evaluate(this._evaluator);if(C==null||typeof C=="number"&&C!=C)return this._defaultValue;if(this._enumValues&&!(C in this._enumValues))throw new zr(`Expected value to be one of ${Object.keys(this._enumValues).map(D=>JSON.stringify(D)).join(", ")}, but found ${JSON.stringify(C)} instead.`);return C}catch(C){return this._warningHistory[C.message]||(this._warningHistory[C.message]=!0,typeof console!="undefined"&&console.warn(C.message)),this._defaultValue}}}function Ra(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in lo}function Kl(i,t){const l=new iu(lo,[],t?function(d){const p={color:ko,string:hn,number:xt,enum:hn,boolean:nn,formatted:Ts,resolvedImage:Ol};return d.type==="array"?Ui(p[d.value]||rn,d.length):p[d.type]}(t):void 0),u=l.parse(i,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?bp(new sf(u,t)):es(l.errors)}class Yl{constructor(t,l){this.kind=t,this._styleExpression=l,this.isStateDependent=t!=="constant"&&!Ul(l.expression)}evaluateWithoutErrorHandling(t,l,u,d,p,y){return this._styleExpression.evaluateWithoutErrorHandling(t,l,u,d,p,y)}evaluate(t,l,u,d,p,y){return this._styleExpression.evaluate(t,l,u,d,p,y)}}class af{constructor(t,l,u,d){this.kind=t,this.zoomStops=u,this._styleExpression=l,this.isStateDependent=t!=="camera"&&!Ul(l.expression),this.interpolationType=d}evaluateWithoutErrorHandling(t,l,u,d,p,y){return this._styleExpression.evaluateWithoutErrorHandling(t,l,u,d,p,y)}evaluate(t,l,u,d,p,y){return this._styleExpression.evaluate(t,l,u,d,p,y)}interpolationFactor(t,l,u){return this.interpolationType?vi.interpolationFactor(this.interpolationType,t,l,u):0}}function Ep(i,t){if((i=Kl(i,t)).result==="error")return i;const l=i.value.expression,u=Pa(l);if(!u&&!Da(t))return es([new Mo("","data expressions not supported")]);const d=Nl(l,["zoom","pitch","distance-from-center"]);if(!d&&!wp(t))return es([new Mo("","zoom expressions not supported")]);const p=xu(l);return p||d?p instanceof Mo?es([p]):p instanceof vi&&!of(t)?es([new Mo("",'"interpolate" expressions cannot be used with this property')]):bp(p?new af(u?"camera":"composite",i.value,p.labels,p instanceof vi?p.interpolation:void 0):new Yl(u?"constant":"source",i.value)):es([new Mo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class za{constructor(t,l){this._parameters=t,this._specification=l,bs(this,Xl(this._parameters,this._specification))}static deserialize(t){return new za(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function xu(i){let t=null;if(i instanceof fu)t=xu(i.result);else if(i instanceof Js){for(const l of i.args)if(t=xu(l),t)break}else(i instanceof $l||i instanceof vi)&&i.input instanceof ki&&i.input.name==="zoom"&&(t=i);return t instanceof Mo||i.eachChild(l=>{const u=xu(l);u instanceof Mo?t=u:!t&&u?t=new Mo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&u&&t!==u&&(t=new Mo("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function $i(i){const t=i.key,l=i.value,u=i.valueSpec||{},d=i.objectElementValidators||{},p=i.style,y=i.styleSpec;let b=[];const S=En(l);if(S!=="object")return[new bt(t,l,`object expected, ${S} found`)];for(const C in l){const D=C.split(".")[0],R=u[D]||u["*"];let z;if(d[D])z=d[D];else if(u[D])z=Or;else if(d["*"])z=d["*"];else{if(!u["*"]){b.push(new bt(t,l[C],`unknown property "${C}"`));continue}z=Or}b=b.concat(z({key:(t&&`${t}.`)+C,value:l[C],valueSpec:R,style:p,styleSpec:y,object:l,objectKey:C},l))}for(const C in u)d[C]||u[C].required&&u[C].default===void 0&&l[C]===void 0&&b.push(new bt(t,l,`missing required property "${C}"`));return b}function lf(i){const t=i.value,l=i.valueSpec,u=i.style,d=i.styleSpec,p=i.key,y=i.arrayElementValidator||Or;if(En(t)!=="array")return[new bt(p,t,`array expected, ${En(t)} found`)];if(l.length&&t.length!==l.length)return[new bt(p,t,`array length ${l.length} expected, length ${t.length} found`)];if(l["min-length"]&&t.length<l["min-length"])return[new bt(p,t,`array length at least ${l["min-length"]} expected, length ${t.length} found`)];let b={type:l.value,values:l.values,minimum:l.minimum,maximum:l.maximum};d.$version<7&&(b.function=l.function),En(l.value)==="object"&&(b=l.value);let S=[];for(let C=0;C<t.length;C++)S=S.concat(y({array:t,arrayIndex:C,value:t[C],valueSpec:b,style:u,styleSpec:d,key:`${p}[${C}]`}));return S}function Sp(i){const t=i.key,l=i.value,u=i.valueSpec;let d=En(l);if(d==="number"&&l!=l&&(d="NaN"),d!=="number")return[new bt(t,l,`number expected, ${d} found`)];if("minimum"in u){let p=u.minimum;if(En(u.minimum)==="array"&&(p=u.minimum[i.arrayIndex]),l<p)return[new bt(t,l,`${l} is less than the minimum value ${p}`)]}if("maximum"in u){let p=u.maximum;if(En(u.maximum)==="array"&&(p=u.maximum[i.arrayIndex]),l>p)return[new bt(t,l,`${l} is greater than the maximum value ${p}`)]}return[]}function bu(i){const t=i.valueSpec,l=pr(i.value.type);let u,d,p,y={};const b=l!=="categorical"&&i.value.property===void 0,S=!b,C=En(i.value.stops)==="array"&&En(i.value.stops[0])==="array"&&En(i.value.stops[0][0])==="object",D=$i({key:i.key,value:i.value,valueSpec:i.styleSpec.function,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(U){if(l==="identity")return[new bt(U.key,U.value,'identity function may not have a "stops" property')];let G=[];const H=U.value;return G=G.concat(lf({key:U.key,value:H,valueSpec:U.valueSpec,style:U.style,styleSpec:U.styleSpec,arrayElementValidator:R})),En(H)==="array"&&H.length===0&&G.push(new bt(U.key,H,"array must have at least one stop")),G},default:function(U){return Or({key:U.key,value:U.value,valueSpec:t,style:U.style,styleSpec:U.styleSpec})}}});return l==="identity"&&b&&D.push(new bt(i.key,i.value,'missing required property "property"')),l==="identity"||i.value.stops||D.push(new bt(i.key,i.value,'missing required property "stops"')),l==="exponential"&&i.valueSpec.expression&&!of(i.valueSpec)&&D.push(new bt(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(S&&!Da(i.valueSpec)?D.push(new bt(i.key,i.value,"property functions not supported")):b&&!wp(i.valueSpec)&&D.push(new bt(i.key,i.value,"zoom functions not supported"))),l!=="categorical"&&!C||i.value.property!==void 0||D.push(new bt(i.key,i.value,'"property" property is required')),D;function R(U){let G=[];const H=U.value,K=U.key;if(En(H)!=="array")return[new bt(K,H,`array expected, ${En(H)} found`)];if(H.length!==2)return[new bt(K,H,`array length 2 expected, length ${H.length} found`)];if(C){if(En(H[0])!=="object")return[new bt(K,H,`object expected, ${En(H[0])} found`)];if(H[0].zoom===void 0)return[new bt(K,H,"object stop key must have zoom")];if(H[0].value===void 0)return[new bt(K,H,"object stop key must have value")];if(p&&p>pr(H[0].zoom))return[new bt(K,H[0].zoom,"stop zoom values must appear in ascending order")];pr(H[0].zoom)!==p&&(p=pr(H[0].zoom),d=void 0,y={}),G=G.concat($i({key:`${K}[0]`,value:H[0],valueSpec:{zoom:{}},style:U.style,styleSpec:U.styleSpec,objectElementValidators:{zoom:Sp,value:z}}))}else G=G.concat(z({key:`${K}[0]`,value:H[0],valueSpec:{},style:U.style,styleSpec:U.styleSpec},H));return Ra(Jo(H[1]))?G.concat([new bt(`${K}[1]`,H[1],"expressions are not allowed in function stops.")]):G.concat(Or({key:`${K}[1]`,value:H[1],valueSpec:t,style:U.style,styleSpec:U.styleSpec}))}function z(U,G){const H=En(U.value),K=pr(U.value),re=U.value!==null?U.value:G;if(u){if(H!==u)return[new bt(U.key,re,`${H} stop domain type must match previous stop domain type ${u}`)]}else u=H;if(H!=="number"&&H!=="string"&&H!=="boolean")return[new bt(U.key,re,"stop domain value must be a number, string, or boolean")];if(H!=="number"&&l!=="categorical"){let he=`number expected, ${H} found`;return Da(t)&&l===void 0&&(he+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new bt(U.key,re,he)]}return l!=="categorical"||H!=="number"||isFinite(K)&&Math.floor(K)===K?l!=="categorical"&&H==="number"&&d!==void 0&&K<d?[new bt(U.key,re,"stop domain values must appear in ascending order")]:(d=K,l==="categorical"&&K in y?[new bt(U.key,re,"stop domain values must be unique")]:(y[K]=!0,[])):[new bt(U.key,re,`integer expected, found ${K}`)]}}function ts(i){const t=(i.expressionContext==="property"?Ep:Kl)(Jo(i.value),i.valueSpec);if(t.result==="error")return t.value.map(u=>new bt(`${i.key}${u.key}`,i.value,u.message));const l=t.value.expression||t.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!l.outputDefined())return[new bt(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!Ul(l))return[new bt(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter")return cf(l,i);if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!Nl(l,["zoom","feature-state"]))return[new bt(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!Pa(l))return[new bt(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function cf(i,t){const l=new Set(["zoom","feature-state","pitch","distance-from-center"]);for(const d of t.valueSpec.expression.parameters)l.delete(d);if(l.size===0)return[];const u=[];return i instanceof ki&&l.has(i.name)?[new bt(t.key,t.value,`["${i.name}"] expression is not supported in a filter for a ${t.object.type} layer with id: ${t.object.id}`)]:(i.eachChild(d=>{u.push(...cf(d,t))}),u)}function wu(i){const t=i.key,l=i.value,u=i.valueSpec,d=[];return Array.isArray(u.values)?u.values.indexOf(pr(l))===-1&&d.push(new bt(t,l,`expected one of [${u.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(u.values).indexOf(pr(l))===-1&&d.push(new bt(t,l,`expected one of [${Object.keys(u.values).join(", ")}], ${JSON.stringify(l)} found`)),d}function Tu(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const t of i.slice(1))if(!Tu(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}function Eu(i,t="fill"){if(i==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Tu(i)||(i=Au(i));const l=i;let u=!0;try{u=function(C){if(!Oa(C))return C;let D=Jo(C);return Ap(D),D=Su(D),D}(l)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(l,null,2)}
        `)}const d=Ne[`filter_${t}`],p=Kl(u,d);let y=null;if(p.result==="error")throw new Error(p.value.map(C=>`${C.key}: ${C.message}`).join(", "));y=(C,D,R)=>p.value.evaluate(C,D,{},R);let b=null,S=null;if(u!==l){const C=Kl(l,d);if(C.result==="error")throw new Error(C.value.map(D=>`${D.key}: ${D.message}`).join(", "));b=(D,R,z,U,G)=>C.value.evaluate(D,R,{},z,void 0,void 0,U,G),S=!Pa(C.value.expression)}return y=y,{filter:y,dynamicFilter:b||void 0,needGeometry:uf(u),needFeature:!!S}}function Su(i){if(!Array.isArray(i))return i;const t=function(l){if(vg.has(l[0])){for(let u=1;u<l.length;u++)if(Oa(l[u]))return!0}return l}(i);return t===!0?t:t.map(l=>Su(l))}function Ap(i){let t=!1;const l=[];if(i[0]==="case"){for(let u=1;u<i.length-1;u+=2)t=t||Oa(i[u]),l.push(i[u+1]);l.push(i[i.length-1])}else if(i[0]==="match"){t=t||Oa(i[1]);for(let u=2;u<i.length-1;u+=2)l.push(i[u+1]);l.push(i[i.length-1])}else if(i[0]==="step"){t=t||Oa(i[1]);for(let u=1;u<i.length-1;u+=2)l.push(i[u+1])}t&&(i.length=0,i.push("any",...l));for(let u=1;u<i.length;u++)Ap(i[u])}function Oa(i){if(!Array.isArray(i))return!1;if((t=i[0])==="pitch"||t==="distance-from-center")return!0;var t;for(let l=1;l<i.length;l++)if(Oa(i[l]))return!0;return!1}const vg=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function xg(i,t){return i<t?-1:i>t?1:0}function uf(i){if(!Array.isArray(i))return!1;if(i[0]==="within")return!0;for(let t=1;t<i.length;t++)if(uf(i[t]))return!0;return!1}function Au(i){if(!i)return!0;const t=i[0];return i.length<=1?t!=="any":t==="=="?hf(i[1],i[2],"=="):t==="!="?Cu(hf(i[1],i[2],"==")):t==="<"||t===">"||t==="<="||t===">="?hf(i[1],i[2],t):t==="any"?(l=i.slice(1),["any"].concat(l.map(Au))):t==="all"?["all"].concat(i.slice(1).map(Au)):t==="none"?["all"].concat(i.slice(1).map(Au).map(Cu)):t==="in"?Cp(i[1],i.slice(2)):t==="!in"?Cu(Cp(i[1],i.slice(2))):t==="has"?Ip(i[1]):t==="!has"?Cu(Ip(i[1])):t!=="within"||i;var l}function hf(i,t,l){switch(i){case"$type":return[`filter-type-${l}`,t];case"$id":return[`filter-id-${l}`,t];default:return[`filter-${l}`,i,t]}}function Cp(i,t){if(t.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(l=>typeof l!=typeof t[0])?["filter-in-large",i,["literal",t.sort(xg)]]:["filter-in-small",i,["literal",t]]}}function Ip(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function Cu(i){return["!",i]}function ff(i){if(Tu(Jo(i.value))){const t=Jo(i.layerType);return ts(bs({},i,{expressionContext:"filter",valueSpec:i.styleSpec[`filter_${t||"fill"}`]}))}return Mp(i)}function Mp(i){const t=i.value,l=i.key;if(En(t)!=="array")return[new bt(l,t,`array expected, ${En(t)} found`)];const u=i.styleSpec;let d,p=[];if(t.length<1)return[new bt(l,t,"filter array must have at least 1 element")];switch(p=p.concat(wu({key:`${l}[0]`,value:t[0],valueSpec:u.filter_operator,style:i.style,styleSpec:i.styleSpec})),pr(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&pr(t[1])==="$type"&&p.push(new bt(l,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&p.push(new bt(l,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(d=En(t[1]),d!=="string"&&p.push(new bt(`${l}[1]`,t[1],`string expected, ${d} found`)));for(let y=2;y<t.length;y++)d=En(t[y]),pr(t[1])==="$type"?p=p.concat(wu({key:`${l}[${y}]`,value:t[y],valueSpec:u.geometry_type,style:i.style,styleSpec:i.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&p.push(new bt(`${l}[${y}]`,t[y],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let y=1;y<t.length;y++)p=p.concat(Mp({key:`${l}[${y}]`,value:t[y],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":d=En(t[1]),t.length!==2?p.push(new bt(l,t,`filter array for "${t[0]}" operator must have 2 elements`)):d!=="string"&&p.push(new bt(`${l}[1]`,t[1],`string expected, ${d} found`));break;case"within":d=En(t[1]),t.length!==2?p.push(new bt(l,t,`filter array for "${t[0]}" operator must have 2 elements`)):d!=="object"&&p.push(new bt(`${l}[1]`,t[1],`object expected, ${d} found`))}return p}function Ql(i,t){const l=i.key,u=i.style,d=i.styleSpec,p=i.value,y=i.objectKey,b=d[`${t}_${i.layerType}`];if(!b)return[];const S=y.match(/^(.*)-transition$/);if(t==="paint"&&S&&b[S[1]]&&b[S[1]].transition)return Or({key:l,value:p,valueSpec:d.transition,style:u,styleSpec:d});const C=i.valueSpec||b[y];if(!C)return[new bt(l,p,`unknown property "${y}"`)];let D;if(En(p)==="string"&&Da(C)&&!C.tokens&&(D=/^{([^}]+)}$/.exec(p)))return[new bt(l,p,`"${y}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(D[1])} }\`.`)];const R=[];return i.layerType==="symbol"&&(y==="text-field"&&u&&!u.glyphs&&R.push(new bt(l,p,'use of "text-field" requires a style "glyphs" property')),y==="text-font"&&gu(Jo(p))&&pr(p.type)==="identity"&&R.push(new bt(l,p,'"text-font" does not support identity functions'))),R.concat(Or({key:i.key,value:p,valueSpec:C,style:u,styleSpec:d,expressionContext:"property",propertyType:t,propertyKey:y}))}function kp(i){return Ql(i,"paint")}function Pp(i){return Ql(i,"layout")}function Jl(i){let t=[];const l=i.value,u=i.key,d=i.style,p=i.styleSpec;l.type||l.ref||t.push(new bt(u,l,'either "type" or "ref" is required'));let y=pr(l.type);const b=pr(l.ref);if(l.id){const S=pr(l.id);for(let C=0;C<i.arrayIndex;C++){const D=d.layers[C];pr(D.id)===S&&t.push(new bt(u,l.id,`duplicate layer id "${l.id}", previously used at line ${D.id.__line__}`))}}if("ref"in l){let S;["type","source","source-layer","filter","layout"].forEach(C=>{C in l&&t.push(new bt(u,l[C],`"${C}" is prohibited for ref layers`))}),d.layers.forEach(C=>{pr(C.id)===b&&(S=C)}),S?S.ref?t.push(new bt(u,l.ref,"ref cannot reference another ref layer")):y=pr(S.type):t.push(new bt(u,l.ref,`ref layer "${b}" not found`))}else if(y!=="background"&&y!=="sky")if(l.source){const S=d.sources&&d.sources[l.source],C=S&&pr(S.type);S?C==="vector"&&y==="raster"?t.push(new bt(u,l.source,`layer "${l.id}" requires a raster source`)):C==="raster"&&y!=="raster"?t.push(new bt(u,l.source,`layer "${l.id}" requires a vector source`)):C!=="vector"||l["source-layer"]?C==="raster-dem"&&y!=="hillshade"?t.push(new bt(u,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):y!=="line"||!l.paint||!l.paint["line-gradient"]||C==="geojson"&&S.lineMetrics||t.push(new bt(u,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new bt(u,l,`layer "${l.id}" must specify a "source-layer"`)):t.push(new bt(u,l.source,`source "${l.source}" not found`))}else t.push(new bt(u,l,'missing required property "source"'));return t=t.concat($i({key:u,value:l,valueSpec:p.layer,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Or({key:`${u}.type`,value:l.type,valueSpec:p.layer.type,style:i.style,styleSpec:i.styleSpec,object:l,objectKey:"type"}),filter:S=>ff(bs({layerType:y},S)),layout:S=>$i({layer:l,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,objectElementValidators:{"*":C=>Pp(bs({layerType:y},C))}}),paint:S=>$i({layer:l,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,objectElementValidators:{"*":C=>kp(bs({layerType:y},C))}})}})),t}function La(i){const t=i.value,l=i.key,u=En(t);return u!=="string"?[new bt(l,t,`string expected, ${u} found`)]:[]}const df={promoteId:function({key:i,value:t}){if(En(t)==="string")return La({key:i,value:t});{const l=[];for(const u in t)l.push(...La({key:`${i}.${u}`,value:t[u]}));return l}}};function Dp(i){const t=i.value,l=i.key,u=i.styleSpec,d=i.style;if(!t.type)return[new bt(l,t,'"type" is required')];const p=pr(t.type);let y;switch(p){case"vector":case"raster":case"raster-dem":return y=$i({key:l,value:t,valueSpec:u[`source_${p.replace("-","_")}`],style:i.style,styleSpec:u,objectElementValidators:df}),y;case"geojson":if(y=$i({key:l,value:t,valueSpec:u.source_geojson,style:d,styleSpec:u,objectElementValidators:df}),t.cluster)for(const b in t.clusterProperties){const[S,C]=t.clusterProperties[b],D=typeof S=="string"?[S,["accumulated"],["get",b]]:S;y.push(...ts({key:`${l}.${b}.map`,value:C,expressionContext:"cluster-map"})),y.push(...ts({key:`${l}.${b}.reduce`,value:D,expressionContext:"cluster-reduce"}))}return y;case"video":return $i({key:l,value:t,valueSpec:u.source_video,style:d,styleSpec:u});case"image":return $i({key:l,value:t,valueSpec:u.source_image,style:d,styleSpec:u});case"canvas":return[new bt(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return wu({key:`${l}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:d,styleSpec:u})}}function pf(i){const t=i.value,l=i.styleSpec,u=l.light,d=i.style;let p=[];const y=En(t);if(t===void 0)return p;if(y!=="object")return p=p.concat([new bt("light",t,`object expected, ${y} found`)]),p;for(const b in t){const S=b.match(/^(.*)-transition$/);p=p.concat(S&&u[S[1]]&&u[S[1]].transition?Or({key:b,value:t[b],valueSpec:l.transition,style:d,styleSpec:l}):u[b]?Or({key:b,value:t[b],valueSpec:u[b],style:d,styleSpec:l}):[new bt(b,t[b],`unknown property "${b}"`)])}return p}function mf(i){const t=i.value,l=i.key,u=i.style,d=i.styleSpec,p=d.terrain;let y=[];const b=En(t);if(t===void 0)return y;if(b!=="object")return y=y.concat([new bt("terrain",t,`object expected, ${b} found`)]),y;for(const S in t){const C=S.match(/^(.*)-transition$/);y=y.concat(C&&p[C[1]]&&p[C[1]].transition?Or({key:S,value:t[S],valueSpec:d.transition,style:u,styleSpec:d}):p[S]?Or({key:S,value:t[S],valueSpec:p[S],style:u,styleSpec:d}):[new bt(S,t[S],`unknown property "${S}"`)])}if(t.source){const S=u.sources&&u.sources[t.source],C=S&&pr(S.type);S?C!=="raster-dem"&&y.push(new bt(l,t.source,`terrain cannot be used with a source of type ${C}, it only be used with a "raster-dem" source type`)):y.push(new bt(l,t.source,`source "${t.source}" not found`))}else y.push(new bt(l,t,'terrain is missing required property "source"'));return y}function _f(i){const t=i.value,l=i.style,u=i.styleSpec,d=u.fog;let p=[];const y=En(t);if(t===void 0)return p;if(y!=="object")return p=p.concat([new bt("fog",t,`object expected, ${y} found`)]),p;for(const b in t){const S=b.match(/^(.*)-transition$/);p=p.concat(S&&d[S[1]]&&d[S[1]].transition?Or({key:b,value:t[b],valueSpec:u.transition,style:l,styleSpec:u}):d[b]?Or({key:b,value:t[b],valueSpec:d[b],style:l,styleSpec:u}):[new bt(b,t[b],`unknown property "${b}"`)])}return p}const gf={"*":()=>[],array:lf,boolean:function(i){const t=i.value,l=i.key,u=En(t);return u!=="boolean"?[new bt(l,t,`boolean expected, ${u} found`)]:[]},number:Sp,color:function(i){const t=i.key,l=i.value,u=En(l);return u!=="string"?[new bt(t,l,`color expected, ${u} found`)]:ka.parseCSSColor(l)===null?[new bt(t,l,`color expected, "${l}" found`)]:[]},constants:tp,enum:wu,filter:ff,function:bu,layer:Jl,object:$i,source:Dp,light:pf,terrain:mf,fog:_f,string:La,formatted:function(i){return La(i).length===0?[]:ts(i)},resolvedImage:function(i){return La(i).length===0?[]:ts(i)},projection:function(i){const t=i.value,l=i.styleSpec,u=l.projection,d=i.style;let p=[];const y=En(t);if(y==="object")for(const b in t)p=p.concat(Or({key:b,value:t[b],valueSpec:u[b],style:d,styleSpec:l}));else y!=="string"&&(p=p.concat([new bt("projection",t,`object or string expected, ${y} found`)]));return p}};function Or(i){const t=i.value,l=i.valueSpec,u=i.styleSpec;return l.expression&&gu(pr(t))?bu(i):l.expression&&Ra(Jo(t))?ts(i):l.type&&gf[l.type]?gf[l.type](i):$i(bs({},i,{valueSpec:l.type?u[l.type]:l}))}function yf(i){const t=i.value,l=i.key,u=La(i);return u.length||(t.indexOf("{fontstack}")===-1&&u.push(new bt(l,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&u.push(new bt(l,t,'"glyphs" url must include a "{range}" token'))),u}function ns(i,t=Ne){let l=[];return l=l.concat(Or({key:"",value:i,valueSpec:t.$root,styleSpec:t,style:i,objectElementValidators:{glyphs:yf,"*":()=>[]}})),i.constants&&(l=l.concat(tp({key:"constants",value:i.constants,style:i,styleSpec:t}))),Rp(l)}function Rp(i){return[].concat(i).sort((t,l)=>t.line-l.line)}function co(i){return function(...t){return Rp(i.apply(this,t))}}ns.source=co(Dp),ns.light=co(pf),ns.terrain=co(mf),ns.fog=co(_f),ns.layer=co(Jl),ns.filter=co(ff),ns.paintProperty=co(kp),ns.layoutProperty=co(Pp);const Fa=ns,Ba=Fa.light,bg=Fa.fog,vf=Fa.paintProperty,wg=Fa.layoutProperty;function zp(i,t){let l=!1;if(t&&t.length)for(const u of t)i.fire(new Kc(new Error(u.message))),l=!0;return l}var ec=li;function li(i,t,l){var u=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;var d=new Int32Array(this.arrayBuffer);i=d[0],this.d=(t=d[1])+2*(l=d[2]);for(var p=0;p<this.d*this.d;p++){var y=d[3+p],b=d[3+p+1];u.push(y===b?null:d.subarray(y,b))}var S=d[3+u.length+1];this.keys=d.subarray(d[3+u.length],S),this.bboxes=d.subarray(S),this.insert=this._insertReadonly}else{this.d=t+2*l;for(var C=0;C<this.d*this.d;C++)u.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=i,this.padding=l,this.scale=t/i,this.uid=0;var D=l/t*i;this.min=-D,this.max=i+D}li.prototype.insert=function(i,t,l,u,d){this._forEachCell(t,l,u,d,this._insertCell,this.uid++),this.keys.push(i),this.bboxes.push(t),this.bboxes.push(l),this.bboxes.push(u),this.bboxes.push(d)},li.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},li.prototype._insertCell=function(i,t,l,u,d,p){this.cells[d].push(p)},li.prototype.query=function(i,t,l,u,d){var p=this.min,y=this.max;if(i<=p&&t<=p&&y<=l&&y<=u&&!d)return Array.prototype.slice.call(this.keys);var b=[];return this._forEachCell(i,t,l,u,this._queryCell,b,{},d),b},li.prototype._queryCell=function(i,t,l,u,d,p,y,b){var S=this.cells[d];if(S!==null)for(var C=this.keys,D=this.bboxes,R=0;R<S.length;R++){var z=S[R];if(y[z]===void 0){var U=4*z;(b?b(D[U+0],D[U+1],D[U+2],D[U+3]):i<=D[U+2]&&t<=D[U+3]&&l>=D[U+0]&&u>=D[U+1])?(y[z]=!0,p.push(C[z])):y[z]=!1}}},li.prototype._forEachCell=function(i,t,l,u,d,p,y,b){for(var S=this._convertToCellCoord(i),C=this._convertToCellCoord(t),D=this._convertToCellCoord(l),R=this._convertToCellCoord(u),z=S;z<=D;z++)for(var U=C;U<=R;U++){var G=this.d*U+z;if((!b||b(this._convertFromCellCoord(z),this._convertFromCellCoord(U),this._convertFromCellCoord(z+1),this._convertFromCellCoord(U+1)))&&d.call(this,i,t,l,u,G,p,y,b))return}},li.prototype._convertFromCellCoord=function(i){return(i-this.padding)/this.scale},li.prototype._convertToCellCoord=function(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))},li.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var i=this.cells,t=3+this.cells.length+1+1,l=0,u=0;u<this.cells.length;u++)l+=this.cells[u].length;var d=new Int32Array(t+l+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;for(var p=t,y=0;y<i.length;y++){var b=i[y];d[3+y]=p,d.set(b,p),p+=b.length}return d[3+i.length]=p,d.set(this.keys,p),d[3+i.length+1]=p+=this.keys.length,d.set(this.bboxes,p),p+=this.bboxes.length,d.buffer};const{ImageData:tc,ImageBitmap:Ua}=P,nc={};function Ct(i,t,l={}){Object.defineProperty(t,"_classRegistryKey",{value:i,writeable:!1}),nc[i]={klass:t,omit:l.omit||[],shallow:l.shallow||[]}}Ct("Object",Object),ec.serialize=function(i,t){const l=i.toArrayBuffer();return t&&t.push(l),{buffer:l}},ec.deserialize=function(i){return new ec(i.buffer)},Ct("Grid",ec),Ct("Color",xn),Ct("Error",Error),Ct("ResolvedImage",Ni),Ct("StylePropertyFunction",za),Ct("StyleExpression",sf,{omit:["_evaluator"]}),Ct("ZoomDependentExpression",af),Ct("ZoomConstantExpression",Yl),Ct("CompoundExpression",ki,{omit:["_evaluate"]});for(const i in lo)lo[i]._classRegistryKey||Ct(`Expression_${i}`,lo[i]);function Na(i){return i&&typeof ArrayBuffer!="undefined"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function Op(i){return Ua&&i instanceof Ua}function rc(i,t){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp)return i;if(Na(i)||Op(i))return t&&t.push(i),i;if(ArrayBuffer.isView(i)){const l=i;return t&&t.push(l.buffer),l}if(i instanceof tc)return t&&t.push(i.data.buffer),i;if(Array.isArray(i)){const l=[];for(const u of i)l.push(rc(u,t));return l}if(typeof i=="object"){const l=i.constructor,u=l._classRegistryKey;if(!u)throw new Error("can't serialize object of unregistered class");const d=l.serialize?l.serialize(i,t):{};if(!l.serialize){for(const p in i){if(!i.hasOwnProperty(p)||nc[u].omit.indexOf(p)>=0)continue;const y=i[p];d[p]=nc[u].shallow.indexOf(p)>=0?y:rc(y,t)}i instanceof Error&&(d.message=i.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(d.$name=u),d}throw new Error("can't serialize object of type "+typeof i)}function Ms(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||Na(i)||Op(i)||ArrayBuffer.isView(i)||i instanceof tc)return i;if(Array.isArray(i))return i.map(Ms);if(typeof i=="object"){const t=i.$name||"Object",{klass:l}=nc[t];if(!l)throw new Error(`can't deserialize unregistered class ${t}`);if(l.deserialize)return l.deserialize(i);const u=Object.create(l.prototype);for(const d of Object.keys(i)){if(d==="$name")continue;const p=i[d];u[d]=nc[t].shallow.indexOf(d)>=0?p:Ms(p)}return u}throw new Error("can't deserialize object of type "+typeof i)}class _{constructor(){this.first=!0}update(t,l){const u=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=l):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=l),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=u,!0))}}const o=i=>i>=1536&&i<=1791,f=i=>i>=1872&&i<=1919,g=i=>i>=2208&&i<=2303,x=i=>i>=11904&&i<=12031,T=i=>i>=12032&&i<=12255,A=i=>i>=12272&&i<=12287,k=i=>i>=12288&&i<=12351,O=i=>i>=12352&&i<=12447,L=i=>i>=12448&&i<=12543,F=i=>i>=12544&&i<=12591,$=i=>i>=12704&&i<=12735,W=i=>i>=12736&&i<=12783,Q=i=>i>=12784&&i<=12799,X=i=>i>=12800&&i<=13055,J=i=>i>=13056&&i<=13311,de=i=>i>=13312&&i<=19903,Y=i=>i>=19968&&i<=40959,ce=i=>i>=40960&&i<=42127,ue=i=>i>=42128&&i<=42191,ae=i=>i>=44032&&i<=55215,le=i=>i>=63744&&i<=64255,me=i=>i>=64336&&i<=65023,ke=i=>i>=65040&&i<=65055,Le=i=>i>=65072&&i<=65103,ht=i=>i>=65104&&i<=65135,nt=i=>i>=65136&&i<=65279,et=i=>i>=65280&&i<=65519;function je(i){for(const t of i)if(We(t.charCodeAt(0)))return!0;return!1}function Re(i){for(const t of i)if(!Qe(t.charCodeAt(0)))return!1;return!0}function Qe(i){return!(o(i)||f(i)||g(i)||me(i)||nt(i))}function We(i){return!(i!==746&&i!==747&&(i<4352||!($(i)||F(i)||Le(i)&&!(i>=65097&&i<=65103)||le(i)||J(i)||x(i)||W(i)||!(!k(i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||de(i)||Y(i)||X(i)||(t=>t>=12592&&t<=12687)(i)||(t=>t>=43360&&t<=43391)(i)||(t=>t>=55216&&t<=55295)(i)||(t=>t>=4352&&t<=4607)(i)||ae(i)||O(i)||A(i)||(t=>t>=12688&&t<=12703)(i)||T(i)||Q(i)||L(i)&&i!==12540||!(!et(i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!ht(i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||(t=>t>=5120&&t<=5759)(i)||(t=>t>=6320&&t<=6399)(i)||ke(i)||(t=>t>=19904&&t<=19967)(i)||ce(i)||ue(i))))}function zt(i){return!(We(i)||function(t){return!!((l=>l>=128&&l<=255)(t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||(l=>l>=8192&&l<=8303)(t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||(l=>l>=8448&&l<=8527)(t)||(l=>l>=8528&&l<=8591)(t)||(l=>l>=8960&&l<=9215)(t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||(l=>l>=9216&&l<=9279)(t)&&t!==9251||(l=>l>=9280&&l<=9311)(t)||(l=>l>=9312&&l<=9471)(t)||(l=>l>=9632&&l<=9727)(t)||(l=>l>=9728&&l<=9983)(t)&&!(t>=9754&&t<=9759)||(l=>l>=11008&&l<=11263)(t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||k(t)||L(t)||(l=>l>=57344&&l<=63743)(t)||Le(t)||ht(t)||et(t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(i))}function jt(i){return i>=1424&&i<=2303||me(i)||nt(i)}function Jt(i,t){return!(!t&&jt(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||(l=>l>=6016&&l<=6143)(i))}function ut(i){for(const t of i)if(jt(t.charCodeAt(0)))return!0;return!1}const Ft="deferred",Zt="loading",Pn="loaded";let jn=null,qt="unavailable",sn=null;const Xn=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(qt="error"),jn&&jn(i)};function Er(){xi.fire(new vs("pluginStateChange",{pluginStatus:qt,pluginURL:sn}))}const xi=new xs,Vi=function(){return qt},uo=function(){if(qt!==Ft||!sn)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");qt=Zt,Er(),sn&&Dl({url:sn},i=>{i?Xn(i):(qt=Pn,Er())})},gn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>qt===Pn||gn.applyArabicShaping!=null,isLoading:()=>qt===Zt,setState(i){qt=i.pluginStatus,sn=i.pluginURL},isParsed:()=>gn.applyArabicShaping!=null&&gn.processBidirectionalText!=null&&gn.processStyledBidirectionalText!=null,getPluginURL:()=>sn};class Wt{constructor(t,l){this.zoom=t,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.zoomHistory=l.zoomHistory,this.transition=l.transition,this.pitch=l.pitch):(this.now=0,this.fadeDuration=0,this.zoomHistory=new _,this.transition={},this.pitch=0)}isSupportedScript(t){return function(l,u){for(const d of l)if(!Jt(d.charCodeAt(0),u))return!1;return!0}(t,gn.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,l=t-Math.floor(t),u=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:l+(1-l)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*l}}}class fn{constructor(t,l){this.property=t,this.value=l,this.expression=function(u,d){if(gu(u))return new za(u,d);if(Ra(u)){const p=Ep(u,d);if(p.result==="error")throw new Error(p.value.map(y=>`${y.key}: ${y.message}`).join(", "));return p.value}{let p=u;return typeof u=="string"&&d.type==="color"&&(p=xn.parse(u)),{kind:"constant",evaluate:()=>p}}}(l===void 0?t.specification.default:l,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,l,u){return this.property.possiblyEvaluate(this,t,l,u)}}class ur{constructor(t){this.property=t,this.value=new fn(t,void 0)}transitioned(t,l){return new qn(this.property,this.value,l,mt({},t.transition,this.transition),t.now)}untransitioned(){return new qn(this.property,this.value,null,{},0)}}class Pi{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return si(this._values[t].value.value)}setValue(t,l){this._values.hasOwnProperty(t)||(this._values[t]=new ur(this._values[t].property)),this._values[t].value=new fn(this._values[t].property,l===null?void 0:si(l))}getTransition(t){return si(this._values[t].transition)}setTransition(t,l){this._values.hasOwnProperty(t)||(this._values[t]=new ur(this._values[t].property)),this._values[t].transition=si(l)||void 0}serialize(){const t={};for(const l of Object.keys(this._values)){const u=this.getValue(l);u!==void 0&&(t[l]=u);const d=this.getTransition(l);d!==void 0&&(t[`${l}-transition`]=d)}return t}transitioned(t,l){const u=new Di(this._properties);for(const d of Object.keys(this._values))u._values[d]=this._values[d].transitioned(t,l._values[d]);return u}untransitioned(){const t=new Di(this._properties);for(const l of Object.keys(this._values))t._values[l]=this._values[l].untransitioned();return t}}class qn{constructor(t,l,u,d,p){const y=d.delay||0,b=d.duration||0;p=p||0,this.property=t,this.value=l,this.begin=p+y,this.end=this.begin+b,t.specification.transition&&(d.delay||d.duration)&&(this.prior=u)}possiblyEvaluate(t,l,u){const d=t.now||0,p=this.value.possiblyEvaluate(t,l,u),y=this.prior;if(y){if(d>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(d<this.begin)return y.possiblyEvaluate(t,l,u);{const b=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(t,l,u),p,ot(b))}}return p}}class Di{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,l,u){const d=new ea(this._properties);for(const p of Object.keys(this._values))d._values[p]=this._values[p].possiblyEvaluate(t,l,u);return d}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class ic{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}getValue(t){return si(this._values[t].value)}setValue(t,l){this._values[t]=new fn(this._values[t].property,l===null?void 0:si(l))}serialize(){const t={};for(const l of Object.keys(this._values)){const u=this.getValue(l);u!==void 0&&(t[l]=u)}return t}possiblyEvaluate(t,l,u){const d=new ea(this._properties);for(const p of Object.keys(this._values))d._values[p]=this._values[p].possiblyEvaluate(t,l,u);return d}}class bi{constructor(t,l,u){this.property=t,this.value=l,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,l,u,d){return this.property.evaluate(this.value,this.parameters,t,l,u,d)}}class ea{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Mt{constructor(t){this.specification=t}possiblyEvaluate(t,l){return t.expression.evaluate(l)}interpolate(t,l,u){const d=su[this.specification.type];return d?d(t,l,u):t}}class Bt{constructor(t,l){this.specification=t,this.overrides=l}possiblyEvaluate(t,l,u,d){return new bi(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(l,null,{},u,d)}:t.expression,l)}interpolate(t,l,u){if(t.value.kind!=="constant"||l.value.kind!=="constant")return t;if(t.value.value===void 0||l.value.value===void 0)return new bi(this,{kind:"constant",value:void 0},t.parameters);const d=su[this.specification.type];return d?new bi(this,{kind:"constant",value:d(t.value.value,l.value.value,u)},t.parameters):t}evaluate(t,l,u,d,p,y){return t.kind==="constant"?t.value:t.evaluate(l,u,d,p,y)}}class Lr extends Bt{possiblyEvaluate(t,l,u,d){if(t.value===void 0)return new bi(this,{kind:"constant",value:void 0},l);if(t.expression.kind==="constant"){const p=t.expression.evaluate(l,null,{},u,d),y=t.property.specification.type==="resolvedImage"&&typeof p!="string"?p.name:p,b=this._calculate(y,y,y,l);return new bi(this,{kind:"constant",value:b},l)}if(t.expression.kind==="camera"){const p=this._calculate(t.expression.evaluate({zoom:l.zoom-1}),t.expression.evaluate({zoom:l.zoom}),t.expression.evaluate({zoom:l.zoom+1}),l);return new bi(this,{kind:"constant",value:p},l)}return new bi(this,t.expression,l)}evaluate(t,l,u,d,p,y){if(t.kind==="source"){const b=t.evaluate(l,u,d,p,y);return this._calculate(b,b,b,l)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(l.zoom)-1},u,d),t.evaluate({zoom:Math.floor(l.zoom)},u,d),t.evaluate({zoom:Math.floor(l.zoom)+1},u,d),l):t.value}_calculate(t,l,u,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:t,to:l,other:u}:{from:u,to:l,other:t}}interpolate(t){return t}}class ta{constructor(t){this.specification=t}possiblyEvaluate(t,l,u,d){if(t.value!==void 0){if(t.expression.kind==="constant"){const p=t.expression.evaluate(l,null,{},u,d);return this._calculate(p,p,p,l)}return this._calculate(t.expression.evaluate(new Wt(Math.floor(l.zoom-1),l)),t.expression.evaluate(new Wt(Math.floor(l.zoom),l)),t.expression.evaluate(new Wt(Math.floor(l.zoom+1),l)),l)}}_calculate(t,l,u,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:t,to:l}:{from:u,to:l}}interpolate(t){return t}}class ks{constructor(t){this.specification=t}possiblyEvaluate(t,l,u,d){return!!t.expression.evaluate(l,null,{},u,d)}interpolate(){return!1}}class Zr{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const l in t){const u=t[l];u.specification.overridable&&this.overridableProperties.push(l);const d=this.defaultPropertyValues[l]=new fn(u,void 0),p=this.defaultTransitionablePropertyValues[l]=new ur(u);this.defaultTransitioningPropertyValues[l]=p.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=d.possiblyEvaluate({})}}}function Xx(i,t){return 256*(i=Ye(Math.floor(i),0,255))+Ye(Math.floor(t),0,255)}Ct("DataDrivenProperty",Bt),Ct("DataConstantProperty",Mt),Ct("CrossFadedDataDrivenProperty",Lr),Ct("CrossFadedProperty",ta),Ct("ColorRampProperty",ks);const RI={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class xf{constructor(t,l){this._structArray=t,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class yr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,l){return t._trim(),l&&(t.isTransferred=!0,l.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const l=Object.create(this.prototype);return l.arrayBuffer=t.arrayBuffer,l.length=t.length,l.capacity=t.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function ar(i,t=1){let l=0,u=0;return{members:i.map(d=>{const p=RI[d.type].BYTES_PER_ELEMENT,y=l=Kx(l,Math.max(t,p)),b=d.components||1;return u=Math.max(u,p),l+=p*b,{name:d.name,type:d.type,components:b,offset:y}}),size:Kx(l,Math.max(u,t)),alignment:t}}function Kx(i,t){return Math.ceil(i/t)*t}class Iu extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,l){const u=this.length;return this.resize(u+1),this.emplace(u,t,l)}emplace(t,l,u){const d=2*t;return this.int16[d+0]=l,this.int16[d+1]=u,t}}Iu.prototype.bytesPerElement=4,Ct("StructArrayLayout2i4",Iu);class Mu extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,l,u,d){const p=this.length;return this.resize(p+1),this.emplace(p,t,l,u,d)}emplace(t,l,u,d,p){const y=4*t;return this.int16[y+0]=l,this.int16[y+1]=u,this.int16[y+2]=d,this.int16[y+3]=p,t}}Mu.prototype.bytesPerElement=8,Ct("StructArrayLayout4i8",Mu);class Tg extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,l,u,d,p,y,b){const S=this.length;return this.resize(S+1),this.emplace(S,t,l,u,d,p,y,b)}emplace(t,l,u,d,p,y,b,S){const C=6*t,D=12*t,R=3*t;return this.int16[C+0]=l,this.int16[C+1]=u,this.uint8[D+4]=d,this.uint8[D+5]=p,this.uint8[D+6]=y,this.uint8[D+7]=b,this.float32[R+2]=S,t}}Tg.prototype.bytesPerElement=12,Ct("StructArrayLayout2i4ub1f12",Tg);class ku extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,l,u){const d=this.length;return this.resize(d+1),this.emplace(d,t,l,u)}emplace(t,l,u,d){const p=3*t;return this.float32[p+0]=l,this.float32[p+1]=u,this.float32[p+2]=d,t}}ku.prototype.bytesPerElement=12,Ct("StructArrayLayout3f12",ku);class ja extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,l,u,d,p,y,b,S,C,D){const R=this.length;return this.resize(R+1),this.emplace(R,t,l,u,d,p,y,b,S,C,D)}emplace(t,l,u,d,p,y,b,S,C,D,R){const z=10*t;return this.uint16[z+0]=l,this.uint16[z+1]=u,this.uint16[z+2]=d,this.uint16[z+3]=p,this.uint16[z+4]=y,this.uint16[z+5]=b,this.uint16[z+6]=S,this.uint16[z+7]=C,this.uint16[z+8]=D,this.uint16[z+9]=R,t}}ja.prototype.bytesPerElement=20,Ct("StructArrayLayout10ui20",ja);class Lp extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,l,u,d,p,y,b,S){const C=this.length;return this.resize(C+1),this.emplace(C,t,l,u,d,p,y,b,S)}emplace(t,l,u,d,p,y,b,S,C){const D=8*t;return this.uint16[D+0]=l,this.uint16[D+1]=u,this.uint16[D+2]=d,this.uint16[D+3]=p,this.uint16[D+4]=y,this.uint16[D+5]=b,this.uint16[D+6]=S,this.uint16[D+7]=C,t}}Lp.prototype.bytesPerElement=16,Ct("StructArrayLayout8ui16",Lp);class Eg extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,l,u,d,p,y,b,S,C,D,R,z,U,G,H,K){const re=this.length;return this.resize(re+1),this.emplace(re,t,l,u,d,p,y,b,S,C,D,R,z,U,G,H,K)}emplace(t,l,u,d,p,y,b,S,C,D,R,z,U,G,H,K,re){const he=16*t;return this.int16[he+0]=l,this.int16[he+1]=u,this.int16[he+2]=d,this.int16[he+3]=p,this.uint16[he+4]=y,this.uint16[he+5]=b,this.uint16[he+6]=S,this.uint16[he+7]=C,this.int16[he+8]=D,this.int16[he+9]=R,this.int16[he+10]=z,this.int16[he+11]=U,this.int16[he+12]=G,this.int16[he+13]=H,this.int16[he+14]=K,this.int16[he+15]=re,t}}Eg.prototype.bytesPerElement=32,Ct("StructArrayLayout4i4ui4i4i32",Eg);class Sg extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const l=this.length;return this.resize(l+1),this.emplace(l,t)}emplace(t,l){return this.uint32[1*t+0]=l,t}}Sg.prototype.bytesPerElement=4,Ct("StructArrayLayout1ul4",Sg);class Ag extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,l,u,d,p,y,b,S,C,D,R,z,U){const G=this.length;return this.resize(G+1),this.emplace(G,t,l,u,d,p,y,b,S,C,D,R,z,U)}emplace(t,l,u,d,p,y,b,S,C,D,R,z,U,G){const H=20*t,K=10*t;return this.int16[H+0]=l,this.int16[H+1]=u,this.int16[H+2]=d,this.int16[H+3]=p,this.int16[H+4]=y,this.float32[K+3]=b,this.float32[K+4]=S,this.float32[K+5]=C,this.float32[K+6]=D,this.int16[H+14]=R,this.uint32[K+8]=z,this.uint16[H+18]=U,this.uint16[H+19]=G,t}}Ag.prototype.bytesPerElement=40,Ct("StructArrayLayout5i4f1i1ul2ui40",Ag);class Fp extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,l,u,d,p,y,b){const S=this.length;return this.resize(S+1),this.emplace(S,t,l,u,d,p,y,b)}emplace(t,l,u,d,p,y,b,S){const C=8*t;return this.int16[C+0]=l,this.int16[C+1]=u,this.int16[C+2]=d,this.int16[C+4]=p,this.int16[C+5]=y,this.int16[C+6]=b,this.int16[C+7]=S,t}}Fp.prototype.bytesPerElement=16,Ct("StructArrayLayout3i2i2i16",Fp);class Cg extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,l,u,d,p){const y=this.length;return this.resize(y+1),this.emplace(y,t,l,u,d,p)}emplace(t,l,u,d,p,y){const b=4*t,S=8*t;return this.float32[b+0]=l,this.float32[b+1]=u,this.float32[b+2]=d,this.int16[S+6]=p,this.int16[S+7]=y,t}}Cg.prototype.bytesPerElement=16,Ct("StructArrayLayout2f1f2i16",Cg);class Ig extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,l,u,d){const p=this.length;return this.resize(p+1),this.emplace(p,t,l,u,d)}emplace(t,l,u,d,p){const y=12*t,b=3*t;return this.uint8[y+0]=l,this.uint8[y+1]=u,this.float32[b+1]=d,this.float32[b+2]=p,t}}Ig.prototype.bytesPerElement=12,Ct("StructArrayLayout2ub2f12",Ig);class ho extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,l,u){const d=this.length;return this.resize(d+1),this.emplace(d,t,l,u)}emplace(t,l,u,d){const p=3*t;return this.uint16[p+0]=l,this.uint16[p+1]=u,this.uint16[p+2]=d,t}}ho.prototype.bytesPerElement=6,Ct("StructArrayLayout3ui6",ho);class Mg extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,l,u,d,p,y,b,S,C,D,R,z,U,G,H,K,re,he,ye,Ee,Se){const Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,t,l,u,d,p,y,b,S,C,D,R,z,U,G,H,K,re,he,ye,Ee,Se)}emplace(t,l,u,d,p,y,b,S,C,D,R,z,U,G,H,K,re,he,ye,Ee,Se,Ae){const Ge=30*t,$e=15*t,dt=60*t;return this.int16[Ge+0]=l,this.int16[Ge+1]=u,this.int16[Ge+2]=d,this.float32[$e+2]=p,this.float32[$e+3]=y,this.uint16[Ge+8]=b,this.uint16[Ge+9]=S,this.uint32[$e+5]=C,this.uint32[$e+6]=D,this.uint32[$e+7]=R,this.uint16[Ge+16]=z,this.uint16[Ge+17]=U,this.uint16[Ge+18]=G,this.float32[$e+10]=H,this.float32[$e+11]=K,this.uint8[dt+48]=re,this.uint8[dt+49]=he,this.uint8[dt+50]=ye,this.uint32[$e+13]=Ee,this.int16[Ge+28]=Se,this.uint8[dt+58]=Ae,t}}Mg.prototype.bytesPerElement=60,Ct("StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60",Mg);class kg extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,l,u,d,p,y,b,S,C,D,R,z,U,G,H,K,re,he,ye,Ee,Se,Ae,Ge,$e,dt,lt,Ve,ct,gt,Xe){const wt=this.length;return this.resize(wt+1),this.emplace(wt,t,l,u,d,p,y,b,S,C,D,R,z,U,G,H,K,re,he,ye,Ee,Se,Ae,Ge,$e,dt,lt,Ve,ct,gt,Xe)}emplace(t,l,u,d,p,y,b,S,C,D,R,z,U,G,H,K,re,he,ye,Ee,Se,Ae,Ge,$e,dt,lt,Ve,ct,gt,Xe,wt){const kt=38*t,pn=19*t;return this.int16[kt+0]=l,this.int16[kt+1]=u,this.int16[kt+2]=d,this.float32[pn+2]=p,this.float32[pn+3]=y,this.int16[kt+8]=b,this.int16[kt+9]=S,this.int16[kt+10]=C,this.int16[kt+11]=D,this.int16[kt+12]=R,this.int16[kt+13]=z,this.uint16[kt+14]=U,this.uint16[kt+15]=G,this.uint16[kt+16]=H,this.uint16[kt+17]=K,this.uint16[kt+18]=re,this.uint16[kt+19]=he,this.uint16[kt+20]=ye,this.uint16[kt+21]=Ee,this.uint16[kt+22]=Se,this.uint16[kt+23]=Ae,this.uint16[kt+24]=Ge,this.uint16[kt+25]=$e,this.uint16[kt+26]=dt,this.uint16[kt+27]=lt,this.uint16[kt+28]=Ve,this.uint32[pn+15]=ct,this.float32[pn+16]=gt,this.float32[pn+17]=Xe,this.float32[pn+18]=wt,t}}kg.prototype.bytesPerElement=76,Ct("StructArrayLayout3i2f6i15ui1ul3f76",kg);class Bp extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const l=this.length;return this.resize(l+1),this.emplace(l,t)}emplace(t,l){return this.float32[1*t+0]=l,t}}Bp.prototype.bytesPerElement=4,Ct("StructArrayLayout1f4",Bp);class Pg extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,l,u){const d=this.length;return this.resize(d+1),this.emplace(d,t,l,u)}emplace(t,l,u,d){const p=3*t;return this.int16[p+0]=l,this.int16[p+1]=u,this.int16[p+2]=d,t}}Pg.prototype.bytesPerElement=6,Ct("StructArrayLayout3i6",Pg);class bf extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,l,u,d,p,y,b){const S=this.length;return this.resize(S+1),this.emplace(S,t,l,u,d,p,y,b)}emplace(t,l,u,d,p,y,b,S){const C=7*t;return this.float32[C+0]=l,this.float32[C+1]=u,this.float32[C+2]=d,this.float32[C+3]=p,this.float32[C+4]=y,this.float32[C+5]=b,this.float32[C+6]=S,t}}bf.prototype.bytesPerElement=28,Ct("StructArrayLayout7f28",bf);class Dg extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,l,u,d){const p=this.length;return this.resize(p+1),this.emplace(p,t,l,u,d)}emplace(t,l,u,d,p){const y=6*t;return this.uint32[3*t+0]=l,this.uint16[y+2]=u,this.uint16[y+3]=d,this.uint16[y+4]=p,t}}Dg.prototype.bytesPerElement=12,Ct("StructArrayLayout1ul3ui12",Dg);class $a extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,l){const u=this.length;return this.resize(u+1),this.emplace(u,t,l)}emplace(t,l,u){const d=2*t;return this.uint16[d+0]=l,this.uint16[d+1]=u,t}}$a.prototype.bytesPerElement=4,Ct("StructArrayLayout2ui4",$a);class Up extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const l=this.length;return this.resize(l+1),this.emplace(l,t)}emplace(t,l){return this.uint16[1*t+0]=l,t}}Up.prototype.bytesPerElement=2,Ct("StructArrayLayout1ui2",Up);class Np extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,l){const u=this.length;return this.resize(u+1),this.emplace(u,t,l)}emplace(t,l,u){const d=2*t;return this.float32[d+0]=l,this.float32[d+1]=u,t}}Np.prototype.bytesPerElement=8,Ct("StructArrayLayout2f8",Np);class Rg extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,l,u,d){const p=this.length;return this.resize(p+1),this.emplace(p,t,l,u,d)}emplace(t,l,u,d,p){const y=4*t;return this.float32[y+0]=l,this.float32[y+1]=u,this.float32[y+2]=d,this.float32[y+3]=p,t}}Rg.prototype.bytesPerElement=16,Ct("StructArrayLayout4f16",Rg);class Yx extends xf{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Yx.prototype.size=40;class zg extends Ag{get(t){return new Yx(this,t)}}Ct("CollisionBoxArray",zg);class Qx extends xf{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}Qx.prototype.size=60;class Jx extends Mg{get(t){return new Qx(this,t)}}Ct("PlacedSymbolArray",Jx);class e1 extends xf{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(t){this._structArray.uint32[this._pos4+15]=t}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}e1.prototype.size=76;class t1 extends kg{get(t){return new e1(this,t)}}Ct("SymbolInstanceArray",t1);class n1 extends Bp{getoffsetX(t){return this.float32[1*t+0]}}Ct("GlyphOffsetArray",n1);class r1 extends Pg{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}Ct("SymbolLineVertexArray",r1);class i1 extends xf{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}i1.prototype.size=12;class o1 extends Dg{get(t){return new i1(this,t)}}Ct("FeatureIndexArray",o1);class s1 extends xf{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}s1.prototype.size=4;class a1 extends $a{get(t){return new s1(this,t)}}Ct("FillExtrusionCentroidArray",a1);const zI=ar([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),OI=ar([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var l1=Ma(function(i){i.exports=function(t,l){var u,d,p,y,b,S,C,D;for(d=t.length-(u=3&t.length),p=l,b=3432918353,S=461845907,D=0;D<d;)C=255&t.charCodeAt(D)|(255&t.charCodeAt(++D))<<8|(255&t.charCodeAt(++D))<<16|(255&t.charCodeAt(++D))<<24,++D,p=27492+(65535&(y=5*(65535&(p=(p^=C=(65535&(C=(C=(65535&C)*b+(((C>>>16)*b&65535)<<16)&4294967295)<<15|C>>>17))*S+(((C>>>16)*S&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(C=0,u){case 3:C^=(255&t.charCodeAt(D+2))<<16;case 2:C^=(255&t.charCodeAt(D+1))<<8;case 1:p^=C=(65535&(C=(C=(65535&(C^=255&t.charCodeAt(D)))*b+(((C>>>16)*b&65535)<<16)&4294967295)<<15|C>>>17))*S+(((C>>>16)*S&65535)<<16)&4294967295}return p^=t.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0}}),LI=Ma(function(i){i.exports=function(t,l){for(var u,d=t.length,p=l^d,y=0;d>=4;)u=1540483477*(65535&(u=255&t.charCodeAt(y)|(255&t.charCodeAt(++y))<<8|(255&t.charCodeAt(++y))<<16|(255&t.charCodeAt(++y))<<24))+((1540483477*(u>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),d-=4,++y;switch(d){case 3:p^=(255&t.charCodeAt(y+2))<<16;case 2:p^=(255&t.charCodeAt(y+1))<<8;case 1:p=1540483477*(65535&(p^=255&t.charCodeAt(y)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0}}),wf=l1,FI=LI;wf.murmur3=l1,wf.murmur2=FI;class jp{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,l,u,d){this.ids.push(c1(t)),this.positions.push(l,u,d)}getPositions(t){const l=c1(t);let u=0,d=this.ids.length-1;for(;u<d;){const y=u+d>>1;this.ids[y]>=l?d=y:u=y+1}const p=[];for(;this.ids[u]===l;)p.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return p}static serialize(t,l){const u=new Float64Array(t.ids),d=new Uint32Array(t.positions);return Og(u,d,0,u.length-1),l&&l.push(u.buffer,d.buffer),{ids:u,positions:d}}static deserialize(t){const l=new jp;return l.ids=t.ids,l.positions=t.positions,l.indexed=!0,l}}function c1(i){const t=+i;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:wf(String(i))}function Og(i,t,l,u){for(;l<u;){const d=i[l+u>>1];let p=l-1,y=u+1;for(;;){do p++;while(i[p]<d);do y--;while(i[y]>d);if(p>=y)break;$p(i,p,y),$p(t,3*p,3*y),$p(t,3*p+1,3*y+1),$p(t,3*p+2,3*y+2)}y-l<u-y?(Og(i,t,l,y),l=y+1):(Og(i,t,y+1,u),u=y)}}function $p(i,t,l){const u=i[t];i[t]=i[l],i[l]=u}Ct("FeaturePositionMap",jp);class na{constructor(t,l){this.gl=t.gl,this.location=l}}class Vp extends na{constructor(t,l){super(t,l),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class u1 extends na{constructor(t,l){super(t,l),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class h1 extends na{constructor(t,l){super(t,l),this.current=xn.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const BI=new Float32Array(16),UI=new Float32Array(9),NI=new Float32Array(4);function Lg(i){return[Xx(255*i.r,255*i.g),Xx(255*i.b,255*i.a)]}class Tf{constructor(t,l,u){this.value=t,this.uniformNames=l.map(d=>`u_${d}`),this.type=u}setUniform(t,l,u){t.set(u.constantOr(this.value))}getBinding(t,l,u){return this.type==="color"?new h1(t,l):new Vp(t,l)}}class Pu{constructor(t,l){this.uniformNames=l.map(u=>`u_${u}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,l){this.pixelRatioFrom=l.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=l.tl.concat(l.br),this.patternTo=t.tl.concat(t.br)}setUniform(t,l,u,d){const p=d==="u_pattern_to"||d==="u_dash_to"?this.patternTo:d==="u_pattern_from"||d==="u_dash_from"?this.patternFrom:d==="u_pixel_ratio_to"?this.pixelRatioTo:d==="u_pixel_ratio_from"?this.pixelRatioFrom:null;p&&t.set(p)}getBinding(t,l,u){return u==="u_pattern_from"||u==="u_pattern_to"||u==="u_dash_from"||u==="u_dash_to"?new u1(t,l):new Vp(t,l)}}class ra{constructor(t,l,u,d){this.expression=t,this.type=u,this.maxValue=0,this.paintVertexAttributes=l.map(p=>({name:`a_${p}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new d}populatePaintArray(t,l,u,d,p,y){const b=this.paintVertexArray.length,S=this.expression.evaluate(new Wt(0),l,{},p,d,y);this.paintVertexArray.resize(t),this._setPaintValue(b,t,S)}updatePaintArray(t,l,u,d,p){const y=this.expression.evaluate({zoom:0},u,d,void 0,p);this._setPaintValue(t,l,y)}_setPaintValue(t,l,u){if(this.type==="color"){const d=Lg(u);for(let p=t;p<l;p++)this.paintVertexArray.emplace(p,d[0],d[1])}else{for(let d=t;d<l;d++)this.paintVertexArray.emplace(d,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class rs{constructor(t,l,u,d,p,y){this.expression=t,this.uniformNames=l.map(b=>`u_${b}_t`),this.type=u,this.useIntegerZoom=d,this.zoom=p,this.maxValue=0,this.paintVertexAttributes=l.map(b=>({name:`a_${b}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(t,l,u,d,p,y){const b=this.expression.evaluate(new Wt(this.zoom),l,{},p,d,y),S=this.expression.evaluate(new Wt(this.zoom+1),l,{},p,d,y),C=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(C,t,b,S)}updatePaintArray(t,l,u,d,p){const y=this.expression.evaluate({zoom:this.zoom},u,d,void 0,p),b=this.expression.evaluate({zoom:this.zoom+1},u,d,void 0,p);this._setPaintValue(t,l,y,b)}_setPaintValue(t,l,u,d){if(this.type==="color"){const p=Lg(u),y=Lg(d);for(let b=t;b<l;b++)this.paintVertexArray.emplace(b,p[0],p[1],y[0],y[1])}else{for(let p=t;p<l;p++)this.paintVertexArray.emplace(p,u,d);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(d))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,l){const u=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,d=Ye(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);t.set(d)}getBinding(t,l,u){return new Vp(t,l)}}class Va{constructor(t,l,u,d,p,y,b){this.expression=t,this.type=u,this.useIntegerZoom=d,this.zoom=p,this.layerId=b,this.paintVertexAttributes=(u==="array"?OI:zI).members;for(let S=0;S<l.length;++S);this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y}populatePaintArray(t,l,u){const d=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(d,t,l.patterns&&l.patterns[this.layerId],u)}updatePaintArray(t,l,u,d,p,y){this._setPaintValues(t,l,u.patterns&&u.patterns[this.layerId],y)}_setPaintValues(t,l,u,d){if(!d||!u)return;const{min:p,mid:y,max:b}=u,S=d[p],C=d[y],D=d[b];if(S&&C&&D)for(let R=t;R<l;R++)this._setPaintValue(this.zoomInPaintVertexArray,R,C,S),this._setPaintValue(this.zoomOutPaintVertexArray,R,C,D)}_setPaintValue(t,l,u,d){t.emplace(l,u.tl[0],u.tl[1],u.br[0],u.br[1],d.tl[0],d.tl[1],d.br[0],d.br[1],u.pixelRatio,d.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class ia{constructor(t,l,u=()=>!0){this.binders={},this._buffers=[];const d=[];for(const p in t.paint._values){if(!u(p))continue;const y=t.paint.get(p);if(!(y instanceof bi&&Da(y.property.specification)))continue;const b=$I(p,t.type),S=y.value,C=y.property.specification.type,D=y.property.useIntegerZoom,R=y.property.specification["property-type"],z=R==="cross-faded"||R==="cross-faded-data-driven",U=String(p)==="line-dasharray"&&t.layout.get("line-cap").value.kind!=="constant";if(S.kind!=="constant"||U)if(S.kind==="source"||U||z){const G=f1(p,C,"source");this.binders[p]=z?new Va(S,b,C,D,l,G,t.id):new ra(S,b,C,G),d.push(`/a_${p}`)}else{const G=f1(p,C,"composite");this.binders[p]=new rs(S,b,C,D,l,G),d.push(`/z_${p}`)}else this.binders[p]=z?new Pu(S.value,b):new Tf(S.value,b,C),d.push(`/u_${p}`)}this.cacheKey=d.sort().join("")}getMaxValue(t){const l=this.binders[t];return l instanceof ra||l instanceof rs?l.maxValue:0}populatePaintArrays(t,l,u,d,p,y){for(const b in this.binders){const S=this.binders[b];(S instanceof ra||S instanceof rs||S instanceof Va)&&S.populatePaintArray(t,l,u,d,p,y)}}setConstantPatternPositions(t,l){for(const u in this.binders){const d=this.binders[u];d instanceof Pu&&d.setConstantPatternPositions(t,l)}}updatePaintArrays(t,l,u,d,p,y){let b=!1;for(const S in t){const C=l.getPositions(S);for(const D of C){const R=u.feature(D.index);for(const z in this.binders){const U=this.binders[z];if((U instanceof ra||U instanceof rs||U instanceof Va)&&U.expression.isStateDependent===!0){const G=d.paint.get(z);U.expression=G.value,U.updatePaintArray(D.start,D.end,R,t[S],p,y),b=!0}}}}return b}defines(){const t=[];for(const l in this.binders){const u=this.binders[l];(u instanceof Tf||u instanceof Pu)&&t.push(...u.uniformNames.map(d=>`#define HAS_UNIFORM_${d}`))}return t}getBinderAttributes(){const t=[];for(const l in this.binders){const u=this.binders[l];if(u instanceof ra||u instanceof rs||u instanceof Va)for(let d=0;d<u.paintVertexAttributes.length;d++)t.push(u.paintVertexAttributes[d].name)}return t}getBinderUniforms(){const t=[];for(const l in this.binders){const u=this.binders[l];if(u instanceof Tf||u instanceof Pu||u instanceof rs)for(const d of u.uniformNames)t.push(d)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,l){const u=[];for(const d in this.binders){const p=this.binders[d];if(p instanceof Tf||p instanceof Pu||p instanceof rs){for(const y of p.uniformNames)if(l[y]){const b=p.getBinding(t,l[y],y);u.push({name:y,property:d,binding:b})}}}return u}setUniforms(t,l,u,d){for(const{name:p,property:y,binding:b}of l)this.binders[y].setUniform(b,d,u.get(y),p)}updatePaintBuffers(t){this._buffers=[];for(const l in this.binders){const u=this.binders[l];if(t&&u instanceof Va){const d=t.fromScale===2?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;d&&this._buffers.push(d)}else(u instanceof ra||u instanceof rs)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(t){for(const l in this.binders){const u=this.binders[l];(u instanceof ra||u instanceof rs||u instanceof Va)&&u.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const l=this.binders[t];(l instanceof ra||l instanceof rs||l instanceof Va)&&l.destroy()}}}class oc{constructor(t,l,u=()=>!0){this.programConfigurations={};for(const d of t)this.programConfigurations[d.id]=new ia(d,l,u);this.needsUpload=!1,this._featureMap=new jp,this._bufferOffset=0}populatePaintArrays(t,l,u,d,p,y,b){for(const S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(t,l,d,p,y,b);l.id!==void 0&&this._featureMap.add(l.id,u,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,l,u,d,p){for(const y of u)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(t,this._featureMap,l,y,d,p)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const jI={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function $I(i,t){return jI[i]||[i.replace(`${t}-`,"").replace(/-/g,"_")]}const VI={"line-pattern":{source:ja,composite:ja},"fill-pattern":{source:ja,composite:ja},"fill-extrusion-pattern":{source:ja,composite:ja},"line-dasharray":{source:Lp,composite:Lp}},GI={color:{source:Np,composite:Rg},number:{source:Bp,composite:Np}};function f1(i,t,l){const u=VI[i];return u&&u[l]||GI[t][l]}Ct("ConstantBinder",Tf),Ct("CrossFadedConstantBinder",Pu),Ct("SourceExpressionBinder",ra),Ct("CrossFadedCompositeBinder",Va),Ct("CompositeExpressionBinder",rs),Ct("ProgramConfiguration",ia,{omit:["_buffers"]}),Ct("ProgramConfigurationSet",oc);const Gp="-transition";class is extends xs{constructor(t,l){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,t.type!=="custom"&&(this.metadata=(t=t).metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&t.type!=="sky"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),l.layout&&(this._unevaluatedLayout=new ic(l.layout)),l.paint)){this._transitionablePaint=new Pi(l.paint);for(const u in t.paint)this.setPaintProperty(u,t.paint[u],{validate:!1});for(const u in t.layout)this.setLayoutProperty(u,t.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ea(l.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,l,u={}){l!=null&&this._validate(wg,`layers.${this.id}.layout.${t}`,t,l,u)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,l):this.visibility=l)}getPaintProperty(t){return Ii(t,Gp)?this._transitionablePaint.getTransition(t.slice(0,-Gp.length)):this._transitionablePaint.getValue(t)}setPaintProperty(t,l,u={}){if(l!=null&&this._validate(vf,`layers.${this.id}.paint.${t}`,t,l,u))return!1;if(Ii(t,Gp))return this._transitionablePaint.setTransition(t.slice(0,-Gp.length),l||void 0),!1;{const d=this._transitionablePaint._values[t],p=d.property.specification["property-type"]==="cross-faded-data-driven",y=d.value.isDataDriven(),b=d.value;this._transitionablePaint.setValue(t,l),this._handleSpecialPaintPropertyUpdate(t);const S=this._transitionablePaint._values[t].value;return S.isDataDriven()||y||p||this._handleOverridablePaintPropertyUpdate(t,b,S)}}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getProgramConfiguration(t){return null}_handleOverridablePaintPropertyUpdate(t,l,u){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,l){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,l)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),Bi(t,(l,u)=>!(l===void 0||u==="layout"&&!Object.keys(l).length||u==="paint"&&!Object.keys(l).length))}_validate(t,l,u,d,p={}){return(!p||p.validate!==!1)&&zp(this,t.call(Fa,{key:l,layerType:this.type,objectKey:u,value:d,styleSpec:Ne,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const l=this.paint.get(t);if(l instanceof bi&&Da(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Eu(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const qI=ar([{name:"a_pos",components:2,type:"Int16"}],4),{members:ZI}=qI;class vr{constructor(t=[]){this.segments=t}prepareSegment(t,l,u,d){let p=this.segments[this.segments.length-1];return t>vr.MAX_VERTEX_ARRAY_LENGTH&&wn(`Max vertices per segment is ${vr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!p||p.vertexLength+t>vr.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==d)&&(p={vertexOffset:l.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},d!==void 0&&(p.sortKey=d),this.segments.push(p)),p}get(){return this.segments}destroy(){for(const t of this.segments)for(const l in t.vaos)t.vaos[l].destroy()}static simpleSegment(t,l,u,d){return new vr([{vertexOffset:t,primitiveOffset:l,vertexLength:u,primitiveLength:d,vaos:{},sortKey:0}])}}vr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ct("SegmentVector",vr);var ln=8192;class sc{constructor(t,l){t&&(l?this.setSouthWest(t).setNorthEast(l):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof Fn?new Fn(t.lng,t.lat):Fn.convert(t),this}setSouthWest(t){return this._sw=t instanceof Fn?new Fn(t.lng,t.lat):Fn.convert(t),this}extend(t){const l=this._sw,u=this._ne;let d,p;if(t instanceof Fn)d=t,p=t;else{if(!(t instanceof sc))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(sc.convert(t)):this.extend(Fn.convert(t)):this;if(d=t._sw,p=t._ne,!d||!p)return this}return l||u?(l.lng=Math.min(d.lng,l.lng),l.lat=Math.min(d.lat,l.lat),u.lng=Math.max(p.lng,u.lng),u.lat=Math.max(p.lat,u.lat)):(this._sw=new Fn(d.lng,d.lat),this._ne=new Fn(p.lng,p.lat)),this}getCenter(){return new Fn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Fn(this.getWest(),this.getNorth())}getSouthEast(){return new Fn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:l,lat:u}=Fn.convert(t);let d=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&d}static convert(t){return!t||t instanceof sc?t:new sc(t)}}const d1=63710088e-1;class Fn{constructor(t,l){if(isNaN(t)||isNaN(l))throw new Error(`Invalid LngLat object: (${t}, ${l})`);if(this.lng=+t,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Fn(we(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const l=Math.PI/180,u=this.lat*l,d=t.lat*l,p=Math.sin(u)*Math.sin(d)+Math.cos(u)*Math.cos(d)*Math.cos((t.lng-this.lng)*l);return d1*Math.acos(Math.min(p,1))}toBounds(t=0){const l=360*t/40075017,u=l/Math.cos(Math.PI/180*this.lat);return new sc(new Fn(this.lng-u,this.lat-l),new Fn(this.lng+u,this.lat+l))}static convert(t){if(t instanceof Fn)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Fn(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Fn(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const p1=2*Math.PI*d1;function m1(i){return p1*Math.cos(i*Math.PI/180)}function Du(i){return(180+i)/360}function Ru(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function os(i,t){return i/m1(t)}function oa(i){return 360*i-180}function Ro(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function _1(i,t){return i*m1(Ro(t))}const Ps=85.051129;class qp{constructor(t,l,u=0){this.x=+t,this.y=+l,this.z=+u}static fromLngLat(t,l=0){const u=Fn.convert(t);return new qp(Du(u.lng),Ru(u.lat),os(l,u.lat))}toLngLat(){return new Fn(oa(this.x),Ro(this.y))}toAltitude(){return _1(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/p1*(t=Ro(this.y),1/Math.cos(t*Math.PI/180));var t}}function Fg(i,t,l,u,d,p,y,b,S){const C=(t+u)/2,D=(l+d)/2,R=new I(C,D);b(R),function(z,U,G,H,K,re){const he=G-K,ye=H-re;return Math.abs((H-U)*he-(G-z)*ye)/Math.hypot(he,ye)}(R.x,R.y,p.x,p.y,y.x,y.y)>=S?(Fg(i,t,l,C,D,p,R,b,S),Fg(i,C,D,u,d,R,y,b,S)):i.push(y)}function WI(i,t,l){const u=[];let d,p,y;for(const b of i){const{x:S,y:C}=b;t(b),y?Fg(u,d,p,S,C,y,b,t,l):u.push(b),d=S,p=C,y=b}return u}const Bg=Math.pow(2,14)-1,g1=-Bg-1;function HI(i,t){const l=Math.round(i.x*t),u=Math.round(i.y*t);return i.x=Ye(l,g1,Bg),i.y=Ye(u,g1,Bg),(l<i.x||l>i.x+1||u<i.y||u>i.y+1)&&wn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),i}function sa(i,t,l){const u=i.loadGeometry(),d=i.extent,p=ln/d;if(t&&l&&l.projection.isReprojectedInTileSpace){const y=1<<t.z,{scale:b,x:S,y:C,projection:D}=l,R=z=>{const U=oa((t.x+z.x/d)/y),G=Ro((t.y+z.y/d)/y),H=D.project(U,G);z.x=(H.x*b-S)*d,z.y=(H.y*b-C)*d};for(let z=0;z<u.length;z++)if(i.type!==1)u[z]=WI(u[z],R,1);else{const U=[];for(const G of u[z])G.x<0||G.x>=d||G.y<0||G.y>=d||(R(G),U.push(G));u[z]=U}}for(const y of u)for(const b of y)HI(b,p);return u}function ac(i,t){return{type:i.type,id:i.id,properties:i.properties,geometry:t?sa(i):[]}}function Zp(i,t,l,u,d){i.emplaceBack(2*t+(u+1)/2,2*l+(d+1)/2)}class Ug{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(l=>l.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Iu,this.indexArray=new ho,this.segments=new vr,this.programConfigurations=new oc(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(t,l,u,d){const p=this.layers[0],y=[];let b=null;p.type==="circle"&&(b=p.layout.get("circle-sort-key"));for(const{feature:S,id:C,index:D,sourceLayerIndex:R}of t){const z=this.layers[0]._featureFilter.needGeometry,U=ac(S,z);if(!this.layers[0]._featureFilter.filter(new Wt(this.zoom),U,u))continue;const G=b?b.evaluate(U,{},u):void 0,H={id:C,properties:S.properties,type:S.type,sourceLayerIndex:R,index:D,geometry:z?U.geometry:sa(S,u,d),patterns:{},sortKey:G};y.push(H)}b&&y.sort((S,C)=>S.sortKey-C.sortKey);for(const S of y){const{geometry:C,index:D,sourceLayerIndex:R}=S,z=t[D].feature;this.addFeature(S,C,D,l.availableImages,u),l.featureIndex.insert(z,C,D,R,this.index)}}update(t,l,u,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,l,this.stateDependentLayers,u,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ZI),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,l,u,d,p){for(const y of l)for(const b of y){const S=b.x,C=b.y;if(S<0||S>=ln||C<0||C>=ln)continue;const D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),R=D.vertexLength;Zp(this.layoutVertexArray,S,C,-1,-1),Zp(this.layoutVertexArray,S,C,1,-1),Zp(this.layoutVertexArray,S,C,1,1),Zp(this.layoutVertexArray,S,C,-1,1),this.indexArray.emplaceBack(R,R+1,R+2),this.indexArray.emplaceBack(R,R+3,R+2),D.vertexLength+=4,D.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,{},d,p)}}function y1(i,t){for(let l=0;l<i.length;l++)if(zu(t,i[l]))return!0;for(let l=0;l<t.length;l++)if(zu(i,t[l]))return!0;return!!Ng(i,t)}function XI(i,t,l){return!!zu(i,t)||!!jg(t,i,l)}function v1(i,t){if(i.length===1)return b1(t,i[0]);for(let l=0;l<t.length;l++){const u=t[l];for(let d=0;d<u.length;d++)if(zu(i,u[d]))return!0}for(let l=0;l<i.length;l++)if(b1(t,i[l]))return!0;for(let l=0;l<t.length;l++)if(Ng(i,t[l]))return!0;return!1}function KI(i,t,l){if(i.length>1){if(Ng(i,t))return!0;for(let u=0;u<t.length;u++)if(jg(t[u],i,l))return!0}for(let u=0;u<i.length;u++)if(jg(i[u],t,l))return!0;return!1}function Ng(i,t){if(i.length===0||t.length===0)return!1;for(let l=0;l<i.length-1;l++){const u=i[l],d=i[l+1];for(let p=0;p<t.length-1;p++)if(YI(u,d,t[p],t[p+1]))return!0}return!1}function YI(i,t,l,u){return ai(i,l,u)!==ai(t,l,u)&&ai(i,t,l)!==ai(i,t,u)}function jg(i,t,l){const u=l*l;if(t.length===1)return i.distSqr(t[0])<u;for(let d=1;d<t.length;d++)if(x1(i,t[d-1],t[d])<u)return!0;return!1}function x1(i,t,l){const u=t.distSqr(l);if(u===0)return i.distSqr(t);const d=((i.x-t.x)*(l.x-t.x)+(i.y-t.y)*(l.y-t.y))/u;return i.distSqr(d<0?t:d>1?l:l.sub(t)._mult(d)._add(t))}function b1(i,t){let l,u,d,p=!1;for(let y=0;y<i.length;y++){l=i[y];for(let b=0,S=l.length-1;b<l.length;S=b++)u=l[b],d=l[S],u.y>t.y!=d.y>t.y&&t.x<(d.x-u.x)*(t.y-u.y)/(d.y-u.y)+u.x&&(p=!p)}return p}function zu(i,t){let l=!1;for(let u=0,d=i.length-1;u<i.length;d=u++){const p=i[u],y=i[d];p.y>t.y!=y.y>t.y&&t.x<(y.x-p.x)*(t.y-p.y)/(y.y-p.y)+p.x&&(l=!l)}return l}function w1(i,t,l,u,d){for(const y of i)if(t<=y.x&&l<=y.y&&u>=y.x&&d>=y.y)return!0;const p=[new I(t,l),new I(t,d),new I(u,d),new I(u,l)];if(i.length>2){for(const y of p)if(zu(i,y))return!0}for(let y=0;y<i.length-1;y++)if(QI(i[y],i[y+1],p))return!0;return!1}function QI(i,t,l){const u=l[0],d=l[2];if(i.x<u.x&&t.x<u.x||i.x>d.x&&t.x>d.x||i.y<u.y&&t.y<u.y||i.y>d.y&&t.y>d.y)return!1;const p=ai(i,t,l[0]);return p!==ai(i,t,l[1])||p!==ai(i,t,l[2])||p!==ai(i,t,l[3])}function Ou(i,t,l){const u=t.paint.get(i).value;return u.kind==="constant"?u.value:l.programConfigurations.get(t.id).getMaxValue(i)}function Wp(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function T1(i,t,l,u,d){if(!t[0]&&!t[1])return i;const p=I.convert(t)._mult(d);l==="viewport"&&p._rotate(-u);const y=[];for(let b=0;b<i.length;b++)y.push(i[b].sub(p));return y}function E1(i,t,l,u){const d=I.convert(i)._mult(u);return t==="viewport"&&d._rotate(-l),d}Ct("CircleBucket",Ug,{omit:["layers"]});const JI=new Zr({"circle-sort-key":new Bt(Ne.layout_circle["circle-sort-key"])});var eM={paint:new Zr({"circle-radius":new Bt(Ne.paint_circle["circle-radius"]),"circle-color":new Bt(Ne.paint_circle["circle-color"]),"circle-blur":new Bt(Ne.paint_circle["circle-blur"]),"circle-opacity":new Bt(Ne.paint_circle["circle-opacity"]),"circle-translate":new Mt(Ne.paint_circle["circle-translate"]),"circle-translate-anchor":new Mt(Ne.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Mt(Ne.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Mt(Ne.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Bt(Ne.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Bt(Ne.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Bt(Ne.paint_circle["circle-stroke-opacity"])}),layout:JI};class $g{constructor(t,l){this.points=t,this.planes=l}static fromInvProjectionMatrix(t,l,u,d){const p=Math.pow(2,u),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(S=>{const C=yt([],S,t),D=1/C[3]/l*p;return function(R,z,U){return R[0]=z[0]*U[0],R[1]=z[1]*U[1],R[2]=z[2]*U[2],R[3]=z[3]*U[3],R}(C,C,[D,D,d?1/C[3]:D,D])}),b=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(S=>{const C=It([],Dn([],_r([],y[S[0]],y[S[1]]),_r([],y[S[2]],y[S[1]]))),D=-Tt(C,y[S[1]]);return C.concat(D)});return new $g(y,b)}}class ss{constructor(t,l){this.min=t,this.max=l,this.center=Ke([],Fe([],this.min,this.max),.5)}quadrant(t){const l=[t%2==0,t<2],u=Me(this.min),d=Me(this.max);for(let p=0;p<l.length;p++)u[p]=l[p]?this.min[p]:this.center[p],d[p]=l[p]?this.center[p]:this.max[p];return d[2]=this.max[2],new ss(u,d)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,l=this.max;return[[t[0],t[1],t[2]],[l[0],t[1],t[2]],[l[0],l[1],t[2]],[t[0],l[1],t[2]],[t[0],t[1],l[2]],[l[0],t[1],l[2]],[l[0],l[1],l[2]],[t[0],l[1],l[2]]]}intersects(t){const l=this.getCorners();let u=!0;for(let d=0;d<t.planes.length;d++){const p=t.planes[d];let y=0;for(let b=0;b<l.length;b++)y+=Tt(p,l[b])+p[3]>=0;if(y===0)return 0;y!==l.length&&(u=!1)}if(u)return 2;for(let d=0;d<3;d++){let p=Number.MAX_VALUE,y=-Number.MAX_VALUE;for(let b=0;b<t.points.length;b++){const S=t.points[b][d]-this.min[d];p=Math.min(p,S),y=Math.max(y,S)}if(y<0||p>this.max[d]-this.min[d])return 0}return 1}}function S1(i,t,l,u,d,p,y,b,S){if(p&&i.queryGeometry.isAboveHorizon)return!1;p&&(S*=i.pixelToTileUnitsFactor);for(const C of t)for(const D of C){const R=D.add(b),z=d&&l.elevation?l.elevation.exaggeration()*d.getElevationAt(R.x,R.y,!0):0,U=p?R:tM(R,z,u),G=p?i.tilespaceRays.map(K=>rM(K,z)):i.queryGeometry.screenGeometry,H=yt([],[D.x,D.y,z,1],u);if(!y&&p?S*=H[3]/l.cameraToCenterDistance:y&&!p&&(S*=l.cameraToCenterDistance/H[3]),XI(G,U,S))return!0}return!1}function tM(i,t,l){const u=yt([],[i.x,i.y,t,1],l);return new I(u[0]/u[3],u[1]/u[3])}const A1=ze(0,0,0),nM=ze(0,0,1);function rM(i,t){const l=De();return A1[2]=t,i.intersectsPlane(A1,nM,l),new I(l[0],l[1])}class C1 extends Ug{}function Vg(i,{width:t,height:l},u,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==t*l*u)throw new RangeError("mismatched image size")}else d=new Uint8Array(t*l*u);return i.width=t,i.height=l,i.data=d,i}function I1(i,{width:t,height:l},u){if(t===i.width&&l===i.height)return;const d=Vg({},{width:t,height:l},u);Gg(i,d,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,t),height:Math.min(i.height,l)},u),i.width=t,i.height=l,i.data=d.data}function Gg(i,t,l,u,d,p){if(d.width===0||d.height===0)return t;if(d.width>i.width||d.height>i.height||l.x>i.width-d.width||l.y>i.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>t.width||d.height>t.height||u.x>t.width-d.width||u.y>t.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const y=i.data,b=t.data;for(let S=0;S<d.height;S++){const C=((l.y+S)*i.width+l.x)*p,D=((u.y+S)*t.width+u.x)*p;for(let R=0;R<d.width*p;R++)b[D+R]=y[C+R]}return t}Ct("HeatmapBucket",C1,{omit:["layers"]});class Ga{constructor(t,l){Vg(this,t,1,l)}resize(t){I1(this,t,1)}clone(){return new Ga({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,l,u,d,p){Gg(t,l,u,d,p,1)}}class fo{constructor(t,l){Vg(this,t,4,l)}resize(t){I1(this,t,4)}replace(t,l){l?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new fo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,l,u,d,p){Gg(t,l,u,d,p,4)}}Ct("AlphaImage",Ga),Ct("RGBAImage",fo);var iM={paint:new Zr({"heatmap-radius":new Bt(Ne.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Bt(Ne.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Mt(Ne.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ks(Ne.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Mt(Ne.paint_heatmap["heatmap-opacity"])})};function qg(i){const t={},l=i.resolution||256,u=i.clips?i.clips.length:1,d=i.image||new fo({width:l,height:u}),p=(y,b,S)=>{t[i.evaluationKey]=S;const C=i.expression.evaluate(t);d.data[y+b+0]=Math.floor(255*C.r/C.a),d.data[y+b+1]=Math.floor(255*C.g/C.a),d.data[y+b+2]=Math.floor(255*C.b/C.a),d.data[y+b+3]=Math.floor(255*C.a)};if(i.clips)for(let y=0,b=0;y<u;++y,b+=4*l)for(let S=0,C=0;S<l;S++,C+=4){const D=S/(l-1),{start:R,end:z}=i.clips[y];p(b,C,R*(1-D)+z*D)}else for(let y=0,b=0;y<l;y++,b+=4)p(0,b,y/(l-1));return d}var oM={paint:new Zr({"hillshade-illumination-direction":new Mt(Ne.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Mt(Ne.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Mt(Ne.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Mt(Ne.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Mt(Ne.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Mt(Ne.paint_hillshade["hillshade-accent-color"])})};const sM=ar([{name:"a_pos",components:2,type:"Int16"}],4),{members:aM}=sM;var Hp=Xp,lM=Xp;function Xp(i,t,l){l=l||2;var u,d,p,y,b,S,C,D=t&&t.length,R=D?t[0]*l:i.length,z=M1(i,0,R,l,!0),U=[];if(!z||z.next===z.prev)return U;if(D&&(z=function(H,K,re,he){var ye,Ee,Se,Ae=[];for(ye=0,Ee=K.length;ye<Ee;ye++)(Se=M1(H,K[ye]*he,ye<Ee-1?K[ye+1]*he:H.length,he,!1))===Se.next&&(Se.steiner=!0),Ae.push(_M(Se));for(Ae.sort(dM),ye=0;ye<Ae.length;ye++)re=qa(re=pM(Ae[ye],re),re.next);return re}(i,t,z,l)),i.length>80*l){u=p=i[0],d=y=i[1];for(var G=l;G<R;G+=l)(b=i[G])<u&&(u=b),(S=i[G+1])<d&&(d=S),b>p&&(p=b),S>y&&(y=S);C=(C=Math.max(p-u,y-d))!==0?1/C:0}return Ef(z,U,l,u,d,C),U}function M1(i,t,l,u,d){var p,y;if(d===Hg(i,t,l,u)>0)for(p=t;p<l;p+=u)y=D1(p,i[p],i[p+1],y);else for(p=l-u;p>=t;p-=u)y=D1(p,i[p],i[p+1],y);return y&&Kp(y,y.next)&&(Af(y),y=y.next),y}function qa(i,t){if(!i)return i;t||(t=i);var l,u=i;do if(l=!1,u.steiner||!Kp(u,u.next)&&xr(u.prev,u,u.next)!==0)u=u.next;else{if(Af(u),(u=t=u.prev)===u.next)break;l=!0}while(l||u!==t);return t}function Ef(i,t,l,u,d,p,y){if(i){!y&&p&&function(D,R,z,U){var G=D;do G.z===null&&(G.z=Zg(G.x,G.y,R,z,U)),G.prevZ=G.prev,G.nextZ=G.next,G=G.next;while(G!==D);G.prevZ.nextZ=null,G.prevZ=null,function(H){var K,re,he,ye,Ee,Se,Ae,Ge,$e=1;do{for(re=H,H=null,Ee=null,Se=0;re;){for(Se++,he=re,Ae=0,K=0;K<$e&&(Ae++,he=he.nextZ);K++);for(Ge=$e;Ae>0||Ge>0&&he;)Ae!==0&&(Ge===0||!he||re.z<=he.z)?(ye=re,re=re.nextZ,Ae--):(ye=he,he=he.nextZ,Ge--),Ee?Ee.nextZ=ye:H=ye,ye.prevZ=Ee,Ee=ye;re=he}Ee.nextZ=null,$e*=2}while(Se>1)}(G)}(i,u,d,p);for(var b,S,C=i;i.prev!==i.next;)if(b=i.prev,S=i.next,p?uM(i,u,d,p):cM(i))t.push(b.i/l),t.push(i.i/l),t.push(S.i/l),Af(i),i=S.next,C=S.next;else if((i=S)===C){y?y===1?Ef(i=hM(qa(i),t,l),t,l,u,d,p,2):y===2&&fM(i,t,l,u,d,p):Ef(qa(i),t,l,u,d,p,1);break}}}function cM(i){var t=i.prev,l=i,u=i.next;if(xr(t,l,u)>=0)return!1;for(var d=i.next.next;d!==i.prev;){if(Lu(t.x,t.y,l.x,l.y,u.x,u.y,d.x,d.y)&&xr(d.prev,d,d.next)>=0)return!1;d=d.next}return!0}function uM(i,t,l,u){var d=i.prev,p=i,y=i.next;if(xr(d,p,y)>=0)return!1;for(var b=d.x>p.x?d.x>y.x?d.x:y.x:p.x>y.x?p.x:y.x,S=d.y>p.y?d.y>y.y?d.y:y.y:p.y>y.y?p.y:y.y,C=Zg(d.x<p.x?d.x<y.x?d.x:y.x:p.x<y.x?p.x:y.x,d.y<p.y?d.y<y.y?d.y:y.y:p.y<y.y?p.y:y.y,t,l,u),D=Zg(b,S,t,l,u),R=i.prevZ,z=i.nextZ;R&&R.z>=C&&z&&z.z<=D;){if(R!==i.prev&&R!==i.next&&Lu(d.x,d.y,p.x,p.y,y.x,y.y,R.x,R.y)&&xr(R.prev,R,R.next)>=0||(R=R.prevZ,z!==i.prev&&z!==i.next&&Lu(d.x,d.y,p.x,p.y,y.x,y.y,z.x,z.y)&&xr(z.prev,z,z.next)>=0))return!1;z=z.nextZ}for(;R&&R.z>=C;){if(R!==i.prev&&R!==i.next&&Lu(d.x,d.y,p.x,p.y,y.x,y.y,R.x,R.y)&&xr(R.prev,R,R.next)>=0)return!1;R=R.prevZ}for(;z&&z.z<=D;){if(z!==i.prev&&z!==i.next&&Lu(d.x,d.y,p.x,p.y,y.x,y.y,z.x,z.y)&&xr(z.prev,z,z.next)>=0)return!1;z=z.nextZ}return!0}function hM(i,t,l){var u=i;do{var d=u.prev,p=u.next.next;!Kp(d,p)&&k1(d,u,u.next,p)&&Sf(d,p)&&Sf(p,d)&&(t.push(d.i/l),t.push(u.i/l),t.push(p.i/l),Af(u),Af(u.next),u=i=p),u=u.next}while(u!==i);return qa(u)}function fM(i,t,l,u,d,p){var y=i;do{for(var b=y.next.next;b!==y.prev;){if(y.i!==b.i&&gM(y,b)){var S=P1(y,b);return y=qa(y,y.next),S=qa(S,S.next),Ef(y,t,l,u,d,p),void Ef(S,t,l,u,d,p)}b=b.next}y=y.next}while(y!==i)}function dM(i,t){return i.x-t.x}function pM(i,t){var l=function(p,y){var b,S=y,C=p.x,D=p.y,R=-1/0;do{if(D<=S.y&&D>=S.next.y&&S.next.y!==S.y){var z=S.x+(D-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(z<=C&&z>R){if(R=z,z===C){if(D===S.y)return S;if(D===S.next.y)return S.next}b=S.x<S.next.x?S:S.next}}S=S.next}while(S!==y);if(!b)return null;if(C===R)return b;var U,G=b,H=b.x,K=b.y,re=1/0;S=b;do C>=S.x&&S.x>=H&&C!==S.x&&Lu(D<K?C:R,D,H,K,D<K?R:C,D,S.x,S.y)&&(U=Math.abs(D-S.y)/(C-S.x),Sf(S,p)&&(U<re||U===re&&(S.x>b.x||S.x===b.x&&mM(b,S)))&&(b=S,re=U)),S=S.next;while(S!==G);return b}(i,t);if(!l)return t;var u=P1(l,i),d=qa(l,l.next);return qa(u,u.next),t===l?d:t}function mM(i,t){return xr(i.prev,i,t.prev)<0&&xr(t.next,i,i.next)<0}function Zg(i,t,l,u,d){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-l)*d)|i<<8))|i<<4))|i<<2))|i<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-u)*d)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function _M(i){var t=i,l=i;do(t.x<l.x||t.x===l.x&&t.y<l.y)&&(l=t),t=t.next;while(t!==i);return l}function Lu(i,t,l,u,d,p,y,b){return(d-y)*(t-b)-(i-y)*(p-b)>=0&&(i-y)*(u-b)-(l-y)*(t-b)>=0&&(l-y)*(p-b)-(d-y)*(u-b)>=0}function gM(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!function(l,u){var d=l;do{if(d.i!==l.i&&d.next.i!==l.i&&d.i!==u.i&&d.next.i!==u.i&&k1(d,d.next,l,u))return!0;d=d.next}while(d!==l);return!1}(i,t)&&(Sf(i,t)&&Sf(t,i)&&function(l,u){var d=l,p=!1,y=(l.x+u.x)/2,b=(l.y+u.y)/2;do d.y>b!=d.next.y>b&&d.next.y!==d.y&&y<(d.next.x-d.x)*(b-d.y)/(d.next.y-d.y)+d.x&&(p=!p),d=d.next;while(d!==l);return p}(i,t)&&(xr(i.prev,i,t.prev)||xr(i,t.prev,t))||Kp(i,t)&&xr(i.prev,i,i.next)>0&&xr(t.prev,t,t.next)>0)}function xr(i,t,l){return(t.y-i.y)*(l.x-t.x)-(t.x-i.x)*(l.y-t.y)}function Kp(i,t){return i.x===t.x&&i.y===t.y}function k1(i,t,l,u){var d=Qp(xr(i,t,l)),p=Qp(xr(i,t,u)),y=Qp(xr(l,u,i)),b=Qp(xr(l,u,t));return d!==p&&y!==b||!(d!==0||!Yp(i,l,t))||!(p!==0||!Yp(i,u,t))||!(y!==0||!Yp(l,i,u))||!(b!==0||!Yp(l,t,u))}function Yp(i,t,l){return t.x<=Math.max(i.x,l.x)&&t.x>=Math.min(i.x,l.x)&&t.y<=Math.max(i.y,l.y)&&t.y>=Math.min(i.y,l.y)}function Qp(i){return i>0?1:i<0?-1:0}function Sf(i,t){return xr(i.prev,i,i.next)<0?xr(i,t,i.next)>=0&&xr(i,i.prev,t)>=0:xr(i,t,i.prev)<0||xr(i,i.next,t)<0}function P1(i,t){var l=new Wg(i.i,i.x,i.y),u=new Wg(t.i,t.x,t.y),d=i.next,p=t.prev;return i.next=t,t.prev=i,l.next=d,d.prev=l,u.next=l,l.prev=u,p.next=u,u.prev=p,u}function D1(i,t,l,u){var d=new Wg(i,t,l);return u?(d.next=u.next,d.prev=u,u.next.prev=d,u.next=d):(d.prev=d,d.next=d),d}function Af(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Wg(i,t,l){this.i=i,this.x=t,this.y=l,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Hg(i,t,l,u){for(var d=0,p=t,y=l-u;p<l;p+=u)d+=(i[y]-i[p])*(i[p+1]+i[y+1]),y=p;return d}function yM(i,t,l,u,d){R1(i,t,l||0,u||i.length-1,d||vM)}function R1(i,t,l,u,d){for(;u>l;){if(u-l>600){var p=u-l+1,y=t-l+1,b=Math.log(p),S=.5*Math.exp(2*b/3),C=.5*Math.sqrt(b*S*(p-S)/p)*(y-p/2<0?-1:1);R1(i,t,Math.max(l,Math.floor(t-y*S/p+C)),Math.min(u,Math.floor(t+(p-y)*S/p+C)),d)}var D=i[t],R=l,z=u;for(Cf(i,l,t),d(i[u],D)>0&&Cf(i,l,u);R<z;){for(Cf(i,R,z),R++,z--;d(i[R],D)<0;)R++;for(;d(i[z],D)>0;)z--}d(i[l],D)===0?Cf(i,l,z):Cf(i,++z,u),z<=t&&(l=z+1),t<=z&&(u=z-1)}}function Cf(i,t,l){var u=i[t];i[t]=i[l],i[l]=u}function vM(i,t){return i<t?-1:i>t?1:0}function Xg(i,t){const l=i.length;if(l<=1)return[i];const u=[];let d,p;for(let y=0;y<l;y++){const b=wa(i[y]);b!==0&&(i[y].area=Math.abs(b),p===void 0&&(p=b<0),p===b<0?(d&&u.push(d),d=[i[y]]):d.push(i[y]))}if(d&&u.push(d),t>1)for(let y=0;y<u.length;y++)u[y].length<=t||(yM(u[y],t,1,u[y].length-1,xM),u[y]=u[y].slice(0,t));return u}function xM(i,t){return t.area-i.area}function Kg(i,t,l){const u=l.patternDependencies;let d=!1;for(const p of t){const y=p.paint.get(`${i}-pattern`);y.isConstant()||(d=!0);const b=y.constantOr(null);b&&(d=!0,u[b.to]=!0,u[b.from]=!0)}return d}function Yg(i,t,l,u,d){const p=d.patternDependencies;for(const y of t){const b=y.paint.get(`${i}-pattern`).value;if(b.kind!=="constant"){let S=b.evaluate({zoom:u-1},l,{},d.availableImages),C=b.evaluate({zoom:u},l,{},d.availableImages),D=b.evaluate({zoom:u+1},l,{},d.availableImages);S=S&&S.name?S.name:S,C=C&&C.name?C.name:C,D=D&&D.name?D.name:D,p[S]=!0,p[C]=!0,p[D]=!0,l.patterns[y.id]={min:S,mid:C,max:D}}}return l}Xp.deviation=function(i,t,l,u){var d=t&&t.length,p=Math.abs(Hg(i,0,d?t[0]*l:i.length,l));if(d)for(var y=0,b=t.length;y<b;y++)p-=Math.abs(Hg(i,t[y]*l,y<b-1?t[y+1]*l:i.length,l));var S=0;for(y=0;y<u.length;y+=3){var C=u[y]*l,D=u[y+1]*l,R=u[y+2]*l;S+=Math.abs((i[C]-i[R])*(i[D+1]-i[C+1])-(i[C]-i[D])*(i[R+1]-i[C+1]))}return p===0&&S===0?0:Math.abs((S-p)/p)},Xp.flatten=function(i){for(var t=i[0][0].length,l={vertices:[],holes:[],dimensions:t},u=0,d=0;d<i.length;d++){for(var p=0;p<i[d].length;p++)for(var y=0;y<t;y++)l.vertices.push(i[d][p][y]);d>0&&l.holes.push(u+=i[d-1].length)}return l},Hp.default=lM;class Jp{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(l=>l.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Iu,this.indexArray=new ho,this.indexArray2=new $a,this.programConfigurations=new oc(t.layers,t.zoom),this.segments=new vr,this.segments2=new vr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(t,l,u,d){this.hasPattern=Kg("fill",this.layers,l);const p=this.layers[0].layout.get("fill-sort-key"),y=[];for(const{feature:b,id:S,index:C,sourceLayerIndex:D}of t){const R=this.layers[0]._featureFilter.needGeometry,z=ac(b,R);if(!this.layers[0]._featureFilter.filter(new Wt(this.zoom),z,u))continue;const U=p?p.evaluate(z,{},u,l.availableImages):void 0,G={id:S,properties:b.properties,type:b.type,sourceLayerIndex:D,index:C,geometry:R?z.geometry:sa(b,u,d),patterns:{},sortKey:U};y.push(G)}p&&y.sort((b,S)=>b.sortKey-S.sortKey);for(const b of y){const{geometry:S,index:C,sourceLayerIndex:D}=b;if(this.hasPattern){const R=Yg("fill",this.layers,b,this.zoom,l);this.patternFeatures.push(R)}else this.addFeature(b,S,C,u,{},l.availableImages);l.featureIndex.insert(t[C].feature,S,C,D,this.index)}}update(t,l,u,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,l,this.stateDependentLayers,u,d)}addFeatures(t,l,u,d){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,l,u,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,aM),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,l,u,d,p,y=[]){for(const b of Xg(l,500)){let S=0;for(const G of b)S+=G.length;const C=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray),D=C.vertexLength,R=[],z=[];for(const G of b){if(G.length===0)continue;G!==b[0]&&z.push(R.length/2);const H=this.segments2.prepareSegment(G.length,this.layoutVertexArray,this.indexArray2),K=H.vertexLength;this.layoutVertexArray.emplaceBack(G[0].x,G[0].y),this.indexArray2.emplaceBack(K+G.length-1,K),R.push(G[0].x),R.push(G[0].y);for(let re=1;re<G.length;re++)this.layoutVertexArray.emplaceBack(G[re].x,G[re].y),this.indexArray2.emplaceBack(K+re-1,K+re),R.push(G[re].x),R.push(G[re].y);H.vertexLength+=G.length,H.primitiveLength+=G.length}const U=Hp(R,z);for(let G=0;G<U.length;G+=3)this.indexArray.emplaceBack(D+U[G],D+U[G+1],D+U[G+2]);C.vertexLength+=S,C.primitiveLength+=U.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,p,y,d)}}Ct("FillBucket",Jp,{omit:["layers","patternFeatures"]});const bM=new Zr({"fill-sort-key":new Bt(Ne.layout_fill["fill-sort-key"])});var wM={paint:new Zr({"fill-antialias":new Mt(Ne.paint_fill["fill-antialias"]),"fill-opacity":new Bt(Ne.paint_fill["fill-opacity"]),"fill-color":new Bt(Ne.paint_fill["fill-color"]),"fill-outline-color":new Bt(Ne.paint_fill["fill-outline-color"]),"fill-translate":new Mt(Ne.paint_fill["fill-translate"]),"fill-translate-anchor":new Mt(Ne.paint_fill["fill-translate-anchor"]),"fill-pattern":new Lr(Ne.paint_fill["fill-pattern"])}),layout:bM};const TM=ar([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),EM=ar([{name:"a_centroid_pos",components:2,type:"Uint16"}]),{members:SM}=TM;var z1=Fu;function Fu(i,t,l,u,d){this.properties={},this.extent=l,this.type=0,this._pbf=i,this._geometry=-1,this._keys=u,this._values=d,i.readFields(AM,this,t)}function AM(i,t,l){i==1?t.id=l.readVarint():i==2?function(u,d){for(var p=u.readVarint()+u.pos;u.pos<p;){var y=d._keys[u.readVarint()],b=d._values[u.readVarint()];d.properties[y]=b}}(l,t):i==3?t.type=l.readVarint():i==4&&(t._geometry=l.pos)}function CM(i){for(var t,l,u=0,d=0,p=i.length,y=p-1;d<p;y=d++)u+=((l=i[y]).x-(t=i[d]).x)*(t.y+l.y);return u}Fu.types=["Unknown","Point","LineString","Polygon"],Fu.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var t,l=i.readVarint()+i.pos,u=1,d=0,p=0,y=0,b=[];i.pos<l;){if(d<=0){var S=i.readVarint();u=7&S,d=S>>3}if(d--,u===1||u===2)p+=i.readSVarint(),y+=i.readSVarint(),u===1&&(t&&b.push(t),t=[]),t.push(new I(p,y));else{if(u!==7)throw new Error("unknown command "+u);t&&t.push(t[0].clone())}}return t&&b.push(t),b},Fu.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var t=i.readVarint()+i.pos,l=1,u=0,d=0,p=0,y=1/0,b=-1/0,S=1/0,C=-1/0;i.pos<t;){if(u<=0){var D=i.readVarint();l=7&D,u=D>>3}if(u--,l===1||l===2)(d+=i.readSVarint())<y&&(y=d),d>b&&(b=d),(p+=i.readSVarint())<S&&(S=p),p>C&&(C=p);else if(l!==7)throw new Error("unknown command "+l)}return[y,S,b,C]},Fu.prototype.toGeoJSON=function(i,t,l){var u,d,p=this.extent*Math.pow(2,l),y=this.extent*i,b=this.extent*t,S=this.loadGeometry(),C=Fu.types[this.type];function D(U){for(var G=0;G<U.length;G++){var H=U[G];U[G]=[360*(H.x+y)/p-180,360/Math.PI*Math.atan(Math.exp((180-360*(H.y+b)/p)*Math.PI/180))-90]}}switch(this.type){case 1:var R=[];for(u=0;u<S.length;u++)R[u]=S[u][0];D(S=R);break;case 2:for(u=0;u<S.length;u++)D(S[u]);break;case 3:for(S=function(U){var G=U.length;if(G<=1)return[U];for(var H,K,re=[],he=0;he<G;he++){var ye=CM(U[he]);ye!==0&&(K===void 0&&(K=ye<0),K===ye<0?(H&&re.push(H),H=[U[he]]):H.push(U[he]))}return H&&re.push(H),re}(S),u=0;u<S.length;u++)for(d=0;d<S[u].length;d++)D(S[u][d])}S.length===1?S=S[0]:C="Multi"+C;var z={type:"Feature",geometry:{type:C,coordinates:S},properties:this.properties};return"id"in this&&(z.id=this.id),z};var O1=L1;function L1(i,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(IM,this,t),this.length=this._features.length}function IM(i,t,l){i===15?t.version=l.readVarint():i===1?t.name=l.readString():i===5?t.extent=l.readVarint():i===2?t._features.push(l.pos):i===3?t._keys.push(l.readString()):i===4&&t._values.push(function(u){for(var d=null,p=u.readVarint()+u.pos;u.pos<p;){var y=u.readVarint()>>3;d=y===1?u.readString():y===2?u.readFloat():y===3?u.readDouble():y===4?u.readVarint64():y===5?u.readVarint():y===6?u.readSVarint():y===7?u.readBoolean():null}return d}(l))}function MM(i,t,l){if(i===3){var u=new O1(l,l.readVarint()+l.pos);u.length&&(t[u.name]=u)}}L1.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var t=this._pbf.readVarint()+this._pbf.pos;return new z1(this._pbf,t,this.extent,this._keys,this._values)};var lc={VectorTile:function(i,t){this.layers=i.readFields(MM,{},t)},VectorTileFeature:z1,VectorTileLayer:O1};const kM=lc.VectorTileFeature.types,PM=Math.pow(2,13);function If(i,t,l,u,d,p,y,b){i.emplaceBack((t<<1)+y,(l<<1)+p,(Math.floor(u*PM)<<1)+d,Math.round(b))}class F1{constructor(){this.acc=new I(0,0),this.polyCount=[]}startRing(t){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new I(t.x,t.y),this.max=new I(t.x,t.y))}append(t,l){this.currentPolyCount.edges++,this.acc._add(t);let u=!!this.borders;const d=this.min,p=this.max;t.x<d.x?(d.x=t.x,u=!0):t.x>p.x&&(p.x=t.x,u=!0),t.y<d.y?(d.y=t.y,u=!0):t.y>p.y&&(p.y=t.y,u=!0),((t.x===0||t.x===ln)&&t.x===l.x)!=((t.y===0||t.y===ln)&&t.y===l.y)&&this.processBorderOverlap(t,l),u&&this.checkBorderIntersection(t,l)}checkBorderIntersection(t,l){l.x<0!=t.x<0&&this.addBorderIntersection(0,In(l.y,t.y,(0-l.x)/(t.x-l.x))),l.x>ln!=t.x>ln&&this.addBorderIntersection(1,In(l.y,t.y,(ln-l.x)/(t.x-l.x))),l.y<0!=t.y<0&&this.addBorderIntersection(2,In(l.x,t.x,(0-l.y)/(t.y-l.y))),l.y>ln!=t.y>ln&&this.addBorderIntersection(3,In(l.x,t.x,(ln-l.y)/(t.y-l.y)))}addBorderIntersection(t,l){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const u=this.borders[t];l<u[0]&&(u[0]=l),l>u[1]&&(u[1]=l)}processBorderOverlap(t,l){if(t.x===l.x){if(t.y===l.y)return;const u=t.x===0?0:1;this.addBorderIntersection(u,l.y),this.addBorderIntersection(u,t.y)}else{const u=t.y===0?2:3;this.addBorderIntersection(u,l.x),this.addBorderIntersection(u,t.x)}}centroid(){const t=this.polyCount.reduce((l,u)=>l+u.edges,0);return t!==0?this.acc.div(t)._round():new I(0,0)}span(){return new I(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((t,l)=>t+ +(l[0]!==Number.MAX_VALUE),0)}}class Qg{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(l=>l.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Mu,this.centroidVertexArray=new a1,this.indexArray=new ho,this.programConfigurations=new oc(t.layers,t.zoom),this.segments=new vr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.enableTerrain=t.enableTerrain}populate(t,l,u,d){this.features=[],this.hasPattern=Kg("fill-extrusion",this.layers,l),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDone=[!1,!1,!1,!1],this.tileToMeter=function(p){const y=Math.exp(Math.PI*(1-p.y/(1<<p.z)*2));return 80150034*y/(y*y+1)/ln/(1<<p.z)}(u);for(const{feature:p,id:y,index:b,sourceLayerIndex:S}of t){const C=this.layers[0]._featureFilter.needGeometry,D=ac(p,C);if(!this.layers[0]._featureFilter.filter(new Wt(this.zoom),D,u))continue;const R={id:y,sourceLayerIndex:S,index:b,geometry:C?D.geometry:sa(p,u,d),properties:p.properties,type:p.type,patterns:{}},z=this.layoutVertexArray.length;this.hasPattern?this.features.push(Yg("fill-extrusion",this.layers,R,this.zoom,l)):this.addFeature(R,R.geometry,b,u,{},l.availableImages),l.featureIndex.insert(p,R.geometry,b,S,this.index,z)}this.sortBorders()}addFeatures(t,l,u,d){for(const p of this.features){const{geometry:y}=p;this.addFeature(p,y,p.index,l,u,d)}this.sortBorders()}update(t,l,u,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,l,this.stateDependentLayers,u,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,SM),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,EM.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,l,u,d,p,y){const b=this.enableTerrain?new F1:null;for(const C of Xg(l,500)){let D=0,R=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);if(C.length===0||(S=C[0]).every(K=>K.x<=0)||S.every(K=>K.x>=ln)||S.every(K=>K.y<=0)||S.every(K=>K.y>=ln))continue;for(let K=0;K<C.length;K++){const re=C[K];if(re.length===0)continue;D+=re.length;let he=0;b&&b.startRing(re[0]);for(let ye=0;ye<re.length;ye++){const Ee=re[ye];if(ye>=1){const Se=re[ye-1];if(!DM(Ee,Se)){b&&b.append(Ee,Se),R.vertexLength+4>vr.MAX_VERTEX_ARRAY_LENGTH&&(R=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Ae=Ee.sub(Se)._perp(),Ge=Ae.x/(Math.abs(Ae.x)+Math.abs(Ae.y)),$e=Ae.y>0?1:0,dt=Se.dist(Ee);he+dt>32768&&(he=0),If(this.layoutVertexArray,Ee.x,Ee.y,Ge,$e,0,0,he),If(this.layoutVertexArray,Ee.x,Ee.y,Ge,$e,0,1,he),he+=dt,If(this.layoutVertexArray,Se.x,Se.y,Ge,$e,0,0,he),If(this.layoutVertexArray,Se.x,Se.y,Ge,$e,0,1,he);const lt=R.vertexLength;this.indexArray.emplaceBack(lt,lt+2,lt+1),this.indexArray.emplaceBack(lt+1,lt+2,lt+3),R.vertexLength+=4,R.primitiveLength+=2}}}}if(R.vertexLength+D>vr.MAX_VERTEX_ARRAY_LENGTH&&(R=this.segments.prepareSegment(D,this.layoutVertexArray,this.indexArray)),kM[t.type]!=="Polygon")continue;const z=[],U=[],G=R.vertexLength;for(let K=0;K<C.length;K++){const re=C[K];if(re.length!==0){re!==C[0]&&U.push(z.length/2);for(let he=0;he<re.length;he++){const ye=re[he];If(this.layoutVertexArray,ye.x,ye.y,0,0,1,1,0),z.push(ye.x),z.push(ye.y),b&&b.currentPolyCount.top++}}}const H=Hp(z,U);for(let K=0;K<H.length;K+=3)this.indexArray.emplaceBack(G+H[K],G+H[K+2],G+H[K+1]);R.primitiveLength+=H.length/3,R.vertexLength+=D}var S;if(b&&b.polyCount.length>0){if(b.borders){b.vertexArrayOffset=this.centroidVertexArray.length;const C=b.borders,D=this.featuresOnBorder.push(b)-1;for(let R=0;R<4;R++)C[R][0]!==Number.MAX_VALUE&&this.borders[R].push(D)}this.encodeCentroid(b.borders?void 0:b.centroid(),b)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,p,y,d)}sortBorders(){for(let t=0;t<4;t++)this.borders[t].sort((l,u)=>this.featuresOnBorder[l].borders[t][0]-this.featuresOnBorder[u].borders[t][0])}encodeCentroid(t,l,u=!0){let d,p;if(t)if(t.y!==0){const b=l.span()._mult(this.tileToMeter);d=(Math.max(t.x,1)<<3)+Math.min(7,Math.round(b.x/10)),p=(Math.max(t.y,1)<<3)+Math.min(7,Math.round(b.y/10))}else d=Math.ceil(7*(t.x+450)),p=0;else d=0,p=+u;let y=u?this.centroidVertexArray.length:l.vertexArrayOffset;for(const b of l.polyCount){u&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*b.edges+b.top);for(let S=0;S<2*b.edges;S++)this.centroidVertexArray.emplace(y++,0,p),this.centroidVertexArray.emplace(y++,d,p);for(let S=0;S<b.top;S++)this.centroidVertexArray.emplace(y++,d,p)}}}function DM(i,t){return i.x===t.x&&(i.x<0||i.x>ln)||i.y===t.y&&(i.y<0||i.y>ln)}Ct("FillExtrusionBucket",Qg,{omit:["layers","features"]}),Ct("PartMetadata",F1);var RM={paint:new Zr({"fill-extrusion-opacity":new Mt(Ne["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Bt(Ne["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Mt(Ne["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Mt(Ne["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Lr(Ne["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Bt(Ne["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Bt(Ne["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Mt(Ne["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Mf(i,t){return i.x*t.x+i.y*t.y}function B1(i,t){if(i.length===1){let l=0;const u=t[l++];let d;for(;!d||u.equals(d);)if(d=t[l++],!d)return 1/0;for(;l<t.length;l++){const p=t[l],y=i[0],b=d.sub(u),S=p.sub(u),C=y.sub(u),D=Mf(b,b),R=Mf(b,S),z=Mf(S,S),U=Mf(C,b),G=Mf(C,S),H=D*z-R*R,K=(z*U-R*G)/H,re=(D*G-R*U)/H,he=u.z*(1-K-re)+d.z*K+p.z*re;if(isFinite(he))return he}return 1/0}{let l=1/0;for(const u of t)l=Math.min(l,u.z);return l}}function U1(i){const t=new I(i[0],i[1]);return t.z=i[2],t}function zM(i,t,l,u,d,p,y,b){const S=y*d.getElevationAt(i,t,!0,!0),C=p[0]!==0,D=C?p[1]===0?y*(p[0]/7-450):y*function(R,z,U){const G=Math.floor(z[0]/8),H=Math.floor(z[1]/8),K=10*(z[0]-8*G),re=10*(z[1]-8*H),he=R.getElevationAt(G,H,!0,!0),ye=R.getMeterToDEM(U),Ee=Math.floor(.5*(K*ye-1)),Se=Math.floor(.5*(re*ye-1)),Ae=R.tileCoordToPixel(G,H),Ge=2*Ee+1,$e=2*Se+1,dt=function(wt,kt,pn,Vn,yn){return[wt.getElevationAtPixel(kt,pn,!0),wt.getElevationAtPixel(kt+yn,pn,!0),wt.getElevationAtPixel(kt,pn+yn,!0),wt.getElevationAtPixel(kt+Vn,pn+yn,!0)]}(R,Ae.x-Ee,Ae.y-Se,Ge,$e),lt=Math.abs(dt[0]-dt[1]),Ve=Math.abs(dt[2]-dt[3]),ct=Math.abs(dt[0]-dt[2])+Math.abs(dt[1]-dt[3]),gt=Math.min(.25,.5*ye*(lt+Ve)/Ge),Xe=Math.min(.25,.5*ye*ct/$e);return he+Math.max(gt*K,Xe*re)}(d,p,b):S;return{base:S+(l===0)?-1:l,top:C?Math.max(D+u,S+l+2):S+u}}const OM=ar([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:LM}=OM,FM=ar([{name:"a_packed",components:3,type:"Float32"}]),{members:BM}=FM,UM=lc.VectorTileFeature.types,NM=Math.cos(Math.PI/180*37.5);class em{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(l=>l.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new Tg,this.layoutVertexArray2=new ku,this.indexArray=new ho,this.programConfigurations=new oc(t.layers,t.zoom),this.segments=new vr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(t,l,u,d){this.hasPattern=Kg("line",this.layers,l);const p=this.layers[0].layout.get("line-sort-key"),y=[];for(const{feature:D,id:R,index:z,sourceLayerIndex:U}of t){const G=this.layers[0]._featureFilter.needGeometry,H=ac(D,G);if(!this.layers[0]._featureFilter.filter(new Wt(this.zoom),H,u))continue;const K=p?p.evaluate(H,{},u):void 0,re={id:R,properties:D.properties,type:D.type,sourceLayerIndex:U,index:z,geometry:G?H.geometry:sa(D,u,d),patterns:{},sortKey:K};y.push(re)}p&&y.sort((D,R)=>D.sortKey-R.sortKey);const{lineAtlas:b,featureIndex:S}=l,C=this.addConstantDashes(b);for(const D of y){const{geometry:R,index:z,sourceLayerIndex:U}=D;if(C&&this.addFeatureDashes(D,b),this.hasPattern){const G=Yg("line",this.layers,D,this.zoom,l);this.patternFeatures.push(G)}else this.addFeature(D,R,z,u,b.positions,l.availableImages);S.insert(t[z].feature,R,z,U,this.index)}}addConstantDashes(t){let l=!1;for(const u of this.layers){const d=u.paint.get("line-dasharray").value,p=u.layout.get("line-cap").value;if(d.kind!=="constant"||p.kind!=="constant")l=!0;else{const y=p.value,b=d.value;if(!b)continue;t.addDash(b.from,y),t.addDash(b.to,y),b.other&&t.addDash(b.other,y)}}return l}addFeatureDashes(t,l){const u=this.zoom;for(const d of this.layers){const p=d.paint.get("line-dasharray").value,y=d.layout.get("line-cap").value;if(p.kind==="constant"&&y.kind==="constant")continue;let b,S,C,D,R,z;if(p.kind==="constant"){const K=p.value;if(!K)continue;b=K.other||K.to,S=K.to,C=K.from}else b=p.evaluate({zoom:u-1},t),S=p.evaluate({zoom:u},t),C=p.evaluate({zoom:u+1},t);y.kind==="constant"?D=R=z=y.value:(D=y.evaluate({zoom:u-1},t),R=y.evaluate({zoom:u},t),z=y.evaluate({zoom:u+1},t)),l.addDash(b,D),l.addDash(S,R),l.addDash(C,z);const U=l.getKey(b,D),G=l.getKey(S,R),H=l.getKey(C,z);t.patterns[d.id]={min:U,mid:G,max:H}}}update(t,l,u,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,l,this.stateDependentLayers,u,d)}addFeatures(t,l,u,d){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,l,u,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,BM)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,LM),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,l,u,d,p,y){const b=this.layers[0].layout,S=b.get("line-join").evaluate(t,{}),C=b.get("line-cap").evaluate(t,{}),D=b.get("line-miter-limit"),R=b.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const z of l)this.addLine(z,t,S,C,D,R);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,p,y,d)}addLine(t,l,u,d,p,y){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let re=0;re<t.length-1;re++)this.totalDistance+=t[re].dist(t[re+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const b=UM[l.type]==="Polygon";let S=t.length;for(;S>=2&&t[S-1].equals(t[S-2]);)S--;let C=0;for(;C<S-1&&t[C].equals(t[C+1]);)C++;if(S<(b?3:2))return;u==="bevel"&&(p=1.05);const D=this.overscaling<=16?122880/(512*this.overscaling):0,R=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let z,U,G,H,K;this.e1=this.e2=-1,b&&(z=t[S-2],K=t[C].sub(z)._unit()._perp());for(let re=C;re<S;re++){if(G=re===S-1?b?t[C+1]:void 0:t[re+1],G&&t[re].equals(G))continue;K&&(H=K),z&&(U=z),z=t[re],K=G?G.sub(z)._unit()._perp():H,H=H||K;let he=H.add(K);he.x===0&&he.y===0||he._unit();const ye=H.x*K.x+H.y*K.y,Ee=he.x*K.x+he.y*K.y,Se=Ee!==0?1/Ee:1/0,Ae=2*Math.sqrt(2-2*Ee),Ge=Ee<NM&&U&&G,$e=H.x*K.y-H.y*K.x>0;if(Ge&&re>C){const Ve=z.dist(U);if(Ve>2*D){const ct=z.sub(z.sub(U)._mult(D/Ve)._round());this.updateDistance(U,ct),this.addCurrentVertex(ct,H,0,0,R),U=ct}}const dt=U&&G;let lt=dt?u:b?"butt":d;if(dt&&lt==="round"&&(Se<y?lt="miter":Se<=2&&(lt="fakeround")),lt==="miter"&&Se>p&&(lt="bevel"),lt==="bevel"&&(Se>2&&(lt="flipbevel"),Se<p&&(lt="miter")),U&&this.updateDistance(U,z),lt==="miter")he._mult(Se),this.addCurrentVertex(z,he,0,0,R);else if(lt==="flipbevel"){if(Se>100)he=K.mult(-1);else{const Ve=Se*H.add(K).mag()/H.sub(K).mag();he._perp()._mult(Ve*($e?-1:1))}this.addCurrentVertex(z,he,0,0,R),this.addCurrentVertex(z,he.mult(-1),0,0,R)}else if(lt==="bevel"||lt==="fakeround"){const Ve=-Math.sqrt(Se*Se-1),ct=$e?Ve:0,gt=$e?0:Ve;if(U&&this.addCurrentVertex(z,H,ct,gt,R),lt==="fakeround"){const Xe=Math.round(180*Ae/Math.PI/20);for(let wt=1;wt<Xe;wt++){let kt=wt/Xe;if(kt!==.5){const Vn=kt-.5;kt+=kt*Vn*(kt-1)*((1.0904+ye*(ye*(3.55645-1.43519*ye)-3.2452))*Vn*Vn+(.848013+ye*(.215638*ye-1.06021)))}const pn=K.sub(H)._mult(kt)._add(H)._unit()._mult($e?-1:1);this.addHalfVertex(z,pn.x,pn.y,!1,$e,0,R)}}G&&this.addCurrentVertex(z,K,-ct,-gt,R)}else if(lt==="butt")this.addCurrentVertex(z,he,0,0,R);else if(lt==="square"){const Ve=U?1:-1;U||this.addCurrentVertex(z,he,Ve,Ve,R),this.addCurrentVertex(z,he,0,0,R),U&&this.addCurrentVertex(z,he,Ve,Ve,R)}else lt==="round"&&(U&&(this.addCurrentVertex(z,H,0,0,R),this.addCurrentVertex(z,H,1,1,R,!0)),G&&(this.addCurrentVertex(z,K,-1,-1,R,!0),this.addCurrentVertex(z,K,0,0,R)));if(Ge&&re<S-1){const Ve=z.dist(G);if(Ve>2*D){const ct=z.add(G.sub(z)._mult(D/Ve)._round());this.updateDistance(z,ct),this.addCurrentVertex(ct,K,0,0,R),z=ct}}}}addCurrentVertex(t,l,u,d,p,y=!1){const b=l.y*d-l.x,S=-l.y-l.x*d;this.addHalfVertex(t,l.x+l.y*u,l.y-l.x*u,y,!1,u,p),this.addHalfVertex(t,b,S,y,!0,-d,p)}addHalfVertex({x:t,y:l},u,d,p,y,b,S){this.layoutVertexArray.emplaceBack((t<<1)+(p?1:0),(l<<1)+(y?1:0),Math.round(63*u)+128,Math.round(63*d)+128,1+(b===0?0:b<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineSoFar);const C=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,C),S.primitiveLength++),y?this.e2=C:this.e1=C}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,l){this.distance+=t.dist(l),this.updateScaledDistance()}}Ct("LineBucket",em,{omit:["layers","patternFeatures"]});const jM=new Zr({"line-cap":new Bt(Ne.layout_line["line-cap"]),"line-join":new Bt(Ne.layout_line["line-join"]),"line-miter-limit":new Mt(Ne.layout_line["line-miter-limit"]),"line-round-limit":new Mt(Ne.layout_line["line-round-limit"]),"line-sort-key":new Bt(Ne.layout_line["line-sort-key"])});var N1={paint:new Zr({"line-opacity":new Bt(Ne.paint_line["line-opacity"]),"line-color":new Bt(Ne.paint_line["line-color"]),"line-translate":new Mt(Ne.paint_line["line-translate"]),"line-translate-anchor":new Mt(Ne.paint_line["line-translate-anchor"]),"line-width":new Bt(Ne.paint_line["line-width"]),"line-gap-width":new Bt(Ne.paint_line["line-gap-width"]),"line-offset":new Bt(Ne.paint_line["line-offset"]),"line-blur":new Bt(Ne.paint_line["line-blur"]),"line-dasharray":new Lr(Ne.paint_line["line-dasharray"]),"line-pattern":new Lr(Ne.paint_line["line-pattern"]),"line-gradient":new ks(Ne.paint_line["line-gradient"])}),layout:jM};const j1=new class extends Bt{possiblyEvaluate(i,t){return t=new Wt(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,zoomHistory:t.zoomHistory,transition:t.transition}),super.possiblyEvaluate(i,t)}evaluate(i,t,l,u){return t=mt({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(i,t,l,u)}}(N1.paint.properties["line-width"].specification);function $1(i,t){return t>0?t+2*i:i}j1.useIntegerZoom=!0;const $M=ar([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"},{name:"a_z_tile_anchor",components:4,type:"Int16"}],4),VM=ar([{name:"a_projected_pos",components:3,type:"Float32"}],4);ar([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const GM=ar([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),qM=ar([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);ar([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const V1=ar([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ZM=ar([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ar([{name:"triangle",components:3,type:"Uint16"}]),ar([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),ar([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),ar([{type:"Float32",name:"offsetX"}]),ar([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Kr=24;const Ds=128;function Jg(i,t){const{expression:l}=t;if(l.kind==="constant")return{kind:"constant",layoutSize:l.evaluate(new Wt(i+1))};if(l.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:d}=l;let p=0;for(;p<u.length&&u[p]<=i;)p++;p=Math.max(0,p-1);let y=p;for(;y<u.length&&u[y]<i+1;)y++;y=Math.min(u.length-1,y);const b=u[p],S=u[y];return l.kind==="composite"?{kind:"composite",minZoom:b,maxZoom:S,interpolationType:d}:{kind:"camera",minZoom:b,maxZoom:S,minSize:l.evaluate(new Wt(b)),maxSize:l.evaluate(new Wt(S)),interpolationType:d}}}function tm(i,{uSize:t,uSizeT:l},{lowerSize:u,upperSize:d}){return i.kind==="source"?u/Ds:i.kind==="composite"?In(u/Ds,d/Ds,l):t}function Bu(i,t){let l=0,u=0;if(i.kind==="constant")u=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:d,minZoom:p,maxZoom:y}=i,b=d?Ye(vi.interpolationFactor(d,t,p,y),0,1):0;i.kind==="camera"?u=In(i.minSize,i.maxSize,b):l=b}return{uSizeT:l,uSize:u}}var WM=Object.freeze({__proto__:null,getSizeData:Jg,evaluateSizeForFeature:tm,evaluateSizeForZoom:Bu,SIZE_PACK_FACTOR:Ds});function HM(i,t,l){return i.sections.forEach(u=>{u.text=function(d,p,y){const b=p.layout.get("text-transform").evaluate(y,{});return b==="uppercase"?d=d.toLocaleUpperCase():b==="lowercase"&&(d=d.toLocaleLowerCase()),gn.applyArabicShaping&&(d=gn.applyArabicShaping(d)),d}(u.text,t,l)}),i}const kf={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};function XM(i){return i==="\uFE36"||i==="\uFE48"||i==="\uFE38"||i==="\uFE44"||i==="\uFE42"||i==="\uFE3E"||i==="\uFE3C"||i==="\uFE3A"||i==="\uFE18"||i==="\uFE40"||i==="\uFE10"||i==="\uFE13"||i==="\uFE14"||i==="\uFF40"||i==="\uFFE3"||i==="\uFE11"||i==="\uFE12"}function KM(i){return i==="\uFE35"||i==="\uFE47"||i==="\uFE37"||i==="\uFE43"||i==="\uFE41"||i==="\uFE3D"||i==="\uFE3B"||i==="\uFE39"||i==="\uFE17"||i==="\uFE3F"}var G1=function(i,t,l,u,d){var p,y,b=8*d-u-1,S=(1<<b)-1,C=S>>1,D=-7,R=l?d-1:0,z=l?-1:1,U=i[t+R];for(R+=z,p=U&(1<<-D)-1,U>>=-D,D+=b;D>0;p=256*p+i[t+R],R+=z,D-=8);for(y=p&(1<<-D)-1,p>>=-D,D+=u;D>0;y=256*y+i[t+R],R+=z,D-=8);if(p===0)p=1-C;else{if(p===S)return y?NaN:1/0*(U?-1:1);y+=Math.pow(2,u),p-=C}return(U?-1:1)*y*Math.pow(2,p-u)},q1=function(i,t,l,u,d,p){var y,b,S,C=8*p-d-1,D=(1<<C)-1,R=D>>1,z=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,U=u?0:p-1,G=u?1:-1,H=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(b=isNaN(t)?1:0,y=D):(y=Math.floor(Math.log(t)/Math.LN2),t*(S=Math.pow(2,-y))<1&&(y--,S*=2),(t+=y+R>=1?z/S:z*Math.pow(2,1-R))*S>=2&&(y++,S/=2),y+R>=D?(b=0,y=D):y+R>=1?(b=(t*S-1)*Math.pow(2,d),y+=R):(b=t*Math.pow(2,R-1)*Math.pow(2,d),y=0));d>=8;i[l+U]=255&b,U+=G,b/=256,d-=8);for(y=y<<d|b,C+=d;C>0;i[l+U]=255&y,U+=G,y/=256,C-=8);i[l+U-G]|=128*H},Pf=$n;function $n(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}$n.Varint=0,$n.Fixed64=1,$n.Bytes=2,$n.Fixed32=5;var e0=4294967296,Z1=1/e0,W1=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function aa(i){return i.type===$n.Bytes?i.readVarint()+i.pos:i.pos+1}function Uu(i,t,l){return l?4294967296*t+(i>>>0):4294967296*(t>>>0)+(i>>>0)}function H1(i,t,l){var u=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));l.realloc(u);for(var d=l.pos-1;d>=i;d--)l.buf[d+u]=l.buf[d]}function YM(i,t){for(var l=0;l<i.length;l++)t.writeVarint(i[l])}function QM(i,t){for(var l=0;l<i.length;l++)t.writeSVarint(i[l])}function JM(i,t){for(var l=0;l<i.length;l++)t.writeFloat(i[l])}function ek(i,t){for(var l=0;l<i.length;l++)t.writeDouble(i[l])}function tk(i,t){for(var l=0;l<i.length;l++)t.writeBoolean(i[l])}function nk(i,t){for(var l=0;l<i.length;l++)t.writeFixed32(i[l])}function rk(i,t){for(var l=0;l<i.length;l++)t.writeSFixed32(i[l])}function ik(i,t){for(var l=0;l<i.length;l++)t.writeFixed64(i[l])}function ok(i,t){for(var l=0;l<i.length;l++)t.writeSFixed64(i[l])}function nm(i,t){return(i[t]|i[t+1]<<8|i[t+2]<<16)+16777216*i[t+3]}function Nu(i,t,l){i[l]=t,i[l+1]=t>>>8,i[l+2]=t>>>16,i[l+3]=t>>>24}function X1(i,t){return(i[t]|i[t+1]<<8|i[t+2]<<16)+(i[t+3]<<24)}function sk(i,t,l){t.glyphs=[],i===1&&l.readMessage(ak,t)}function ak(i,t,l){if(i===3){const{id:u,bitmap:d,width:p,height:y,left:b,top:S,advance:C}=l.readMessage(lk,{});t.glyphs.push({id:u,bitmap:new Ga({width:p+6,height:y+6},d),metrics:{width:p,height:y,left:b,top:S,advance:C}})}else i===4?t.ascender=l.readSVarint():i===5&&(t.descender=l.readSVarint())}function lk(i,t,l){i===1?t.id=l.readVarint():i===2?t.bitmap=l.readBytes():i===3?t.width=l.readVarint():i===4?t.height=l.readVarint():i===5?t.left=l.readSVarint():i===6?t.top=l.readSVarint():i===7&&(t.advance=l.readVarint())}function t0(i){let t=0,l=0;for(const y of i)t+=y.w*y.h,l=Math.max(l,y.w);i.sort((y,b)=>b.h-y.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),l),h:1/0}];let d=0,p=0;for(const y of i)for(let b=u.length-1;b>=0;b--){const S=u[b];if(!(y.w>S.w||y.h>S.h)){if(y.x=S.x,y.y=S.y,p=Math.max(p,y.y+y.h),d=Math.max(d,y.x+y.w),y.w===S.w&&y.h===S.h){const C=u.pop();b<u.length&&(u[b]=C)}else y.h===S.h?(S.x+=y.w,S.w-=y.w):y.w===S.w?(S.y+=y.h,S.h-=y.h):(u.push({x:S.x+y.w,y:S.y,w:S.w-y.w,h:y.h}),S.y+=y.h,S.h-=y.h);break}}return{w:d,h:p,fill:t/(d*p)||0}}$n.prototype={destroy:function(){this.buf=null},readFields:function(i,t,l){for(l=l||this.length;this.pos<l;){var u=this.readVarint(),d=u>>3,p=this.pos;this.type=7&u,i(d,t,this),this.pos===p&&this.skip(u)}return t},readMessage:function(i,t){return this.readFields(i,t,this.readVarint()+this.pos)},readFixed32:function(){var i=nm(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=X1(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=nm(this.buf,this.pos)+nm(this.buf,this.pos+4)*e0;return this.pos+=8,i},readSFixed64:function(){var i=nm(this.buf,this.pos)+X1(this.buf,this.pos+4)*e0;return this.pos+=8,i},readFloat:function(){var i=G1(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=G1(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var t,l,u=this.buf;return t=127&(l=u[this.pos++]),l<128?t:(t|=(127&(l=u[this.pos++]))<<7,l<128?t:(t|=(127&(l=u[this.pos++]))<<14,l<128?t:(t|=(127&(l=u[this.pos++]))<<21,l<128?t:function(d,p,y){var b,S,C=y.buf;if(b=(112&(S=C[y.pos++]))>>4,S<128||(b|=(127&(S=C[y.pos++]))<<3,S<128)||(b|=(127&(S=C[y.pos++]))<<10,S<128)||(b|=(127&(S=C[y.pos++]))<<17,S<128)||(b|=(127&(S=C[y.pos++]))<<24,S<128)||(b|=(1&(S=C[y.pos++]))<<31,S<128))return Uu(d,b,p);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(l=u[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var i=this.readVarint()+this.pos,t=this.pos;return this.pos=i,i-t>=12&&W1?function(l,u,d){return W1.decode(l.subarray(u,d))}(this.buf,t,i):function(l,u,d){for(var p="",y=u;y<d;){var b,S,C,D=l[y],R=null,z=D>239?4:D>223?3:D>191?2:1;if(y+z>d)break;z===1?D<128&&(R=D):z===2?(192&(b=l[y+1]))==128&&(R=(31&D)<<6|63&b)<=127&&(R=null):z===3?(S=l[y+2],(192&(b=l[y+1]))==128&&(192&S)==128&&((R=(15&D)<<12|(63&b)<<6|63&S)<=2047||R>=55296&&R<=57343)&&(R=null)):z===4&&(S=l[y+2],C=l[y+3],(192&(b=l[y+1]))==128&&(192&S)==128&&(192&C)==128&&((R=(15&D)<<18|(63&b)<<12|(63&S)<<6|63&C)<=65535||R>=1114112)&&(R=null)),R===null?(R=65533,z=1):R>65535&&(R-=65536,p+=String.fromCharCode(R>>>10&1023|55296),R=56320|1023&R),p+=String.fromCharCode(R),y+=z}return p}(this.buf,t,i)},readBytes:function(){var i=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,i);return this.pos=i,t},readPackedVarint:function(i,t){if(this.type!==$n.Bytes)return i.push(this.readVarint(t));var l=aa(this);for(i=i||[];this.pos<l;)i.push(this.readVarint(t));return i},readPackedSVarint:function(i){if(this.type!==$n.Bytes)return i.push(this.readSVarint());var t=aa(this);for(i=i||[];this.pos<t;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==$n.Bytes)return i.push(this.readBoolean());var t=aa(this);for(i=i||[];this.pos<t;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==$n.Bytes)return i.push(this.readFloat());var t=aa(this);for(i=i||[];this.pos<t;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==$n.Bytes)return i.push(this.readDouble());var t=aa(this);for(i=i||[];this.pos<t;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==$n.Bytes)return i.push(this.readFixed32());var t=aa(this);for(i=i||[];this.pos<t;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==$n.Bytes)return i.push(this.readSFixed32());var t=aa(this);for(i=i||[];this.pos<t;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==$n.Bytes)return i.push(this.readFixed64());var t=aa(this);for(i=i||[];this.pos<t;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==$n.Bytes)return i.push(this.readSFixed64());var t=aa(this);for(i=i||[];this.pos<t;)i.push(this.readSFixed64());return i},skip:function(i){var t=7&i;if(t===$n.Varint)for(;this.buf[this.pos++]>127;);else if(t===$n.Bytes)this.pos=this.readVarint()+this.pos;else if(t===$n.Fixed32)this.pos+=4;else{if(t!==$n.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(i,t){this.writeVarint(i<<3|t)},realloc:function(i){for(var t=this.length||16;t<this.pos+i;)t*=2;if(t!==this.length){var l=new Uint8Array(t);l.set(this.buf),this.buf=l,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),Nu(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),Nu(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),Nu(this.buf,-1&i,this.pos),Nu(this.buf,Math.floor(i*Z1),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),Nu(this.buf,-1&i,this.pos),Nu(this.buf,Math.floor(i*Z1),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(t,l){var u,d;if(t>=0?(u=t%4294967296|0,d=t/4294967296|0):(d=~(-t/4294967296),4294967295^(u=~(-t%4294967296))?u=u+1|0:(u=0,d=d+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),function(p,y,b){b.buf[b.pos++]=127&p|128,p>>>=7,b.buf[b.pos++]=127&p|128,p>>>=7,b.buf[b.pos++]=127&p|128,p>>>=7,b.buf[b.pos++]=127&p|128,b.buf[b.pos]=127&(p>>>=7)}(u,0,l),function(p,y){var b=(7&p)<<4;y.buf[y.pos++]|=b|((p>>>=3)?128:0),p&&(y.buf[y.pos++]=127&p|((p>>>=7)?128:0),p&&(y.buf[y.pos++]=127&p|((p>>>=7)?128:0),p&&(y.buf[y.pos++]=127&p|((p>>>=7)?128:0),p&&(y.buf[y.pos++]=127&p|((p>>>=7)?128:0),p&&(y.buf[y.pos++]=127&p)))))}(d,l)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(Boolean(i))},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var t=this.pos;this.pos=function(u,d,p){for(var y,b,S=0;S<d.length;S++){if((y=d.charCodeAt(S))>55295&&y<57344){if(!b){y>56319||S+1===d.length?(u[p++]=239,u[p++]=191,u[p++]=189):b=y;continue}if(y<56320){u[p++]=239,u[p++]=191,u[p++]=189,b=y;continue}y=b-55296<<10|y-56320|65536,b=null}else b&&(u[p++]=239,u[p++]=191,u[p++]=189,b=null);y<128?u[p++]=y:(y<2048?u[p++]=y>>6|192:(y<65536?u[p++]=y>>12|224:(u[p++]=y>>18|240,u[p++]=y>>12&63|128),u[p++]=y>>6&63|128),u[p++]=63&y|128)}return p}(this.buf,i,this.pos);var l=this.pos-t;l>=128&&H1(t,l,this),this.pos=t-1,this.writeVarint(l),this.pos+=l},writeFloat:function(i){this.realloc(4),q1(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),q1(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var t=i.length;this.writeVarint(t),this.realloc(t);for(var l=0;l<t;l++)this.buf[this.pos++]=i[l]},writeRawMessage:function(i,t){this.pos++;var l=this.pos;i(t,this);var u=this.pos-l;u>=128&&H1(l,u,this),this.pos=l-1,this.writeVarint(u),this.pos+=u},writeMessage:function(i,t,l){this.writeTag(i,$n.Bytes),this.writeRawMessage(t,l)},writePackedVarint:function(i,t){t.length&&this.writeMessage(i,YM,t)},writePackedSVarint:function(i,t){t.length&&this.writeMessage(i,QM,t)},writePackedBoolean:function(i,t){t.length&&this.writeMessage(i,tk,t)},writePackedFloat:function(i,t){t.length&&this.writeMessage(i,JM,t)},writePackedDouble:function(i,t){t.length&&this.writeMessage(i,ek,t)},writePackedFixed32:function(i,t){t.length&&this.writeMessage(i,nk,t)},writePackedSFixed32:function(i,t){t.length&&this.writeMessage(i,rk,t)},writePackedFixed64:function(i,t){t.length&&this.writeMessage(i,ik,t)},writePackedSFixed64:function(i,t){t.length&&this.writeMessage(i,ok,t)},writeBytesField:function(i,t){this.writeTag(i,$n.Bytes),this.writeBytes(t)},writeFixed32Field:function(i,t){this.writeTag(i,$n.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(i,t){this.writeTag(i,$n.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(i,t){this.writeTag(i,$n.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(i,t){this.writeTag(i,$n.Fixed64),this.writeSFixed64(t)},writeVarintField:function(i,t){this.writeTag(i,$n.Varint),this.writeVarint(t)},writeSVarintField:function(i,t){this.writeTag(i,$n.Varint),this.writeSVarint(t)},writeStringField:function(i,t){this.writeTag(i,$n.Bytes),this.writeString(t)},writeFloatField:function(i,t){this.writeTag(i,$n.Fixed32),this.writeFloat(t)},writeDoubleField:function(i,t){this.writeTag(i,$n.Fixed64),this.writeDouble(t)},writeBooleanField:function(i,t){this.writeVarintField(i,Boolean(t))}};class n0{constructor(t,{pixelRatio:l,version:u,stretchX:d,stretchY:p,content:y}){this.paddedRect=t,this.pixelRatio=l,this.stretchX=d,this.stretchY=p,this.content=y,this.version=u}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class K1{constructor(t,l){const u={},d={};this.haveRenderCallbacks=[];const p=[];this.addImages(t,u,p),this.addImages(l,d,p);const{w:y,h:b}=t0(p),S=new fo({width:y||1,height:b||1});for(const C in t){const D=t[C],R=u[C].paddedRect;fo.copy(D.data,S,{x:0,y:0},{x:R.x+1,y:R.y+1},D.data)}for(const C in l){const D=l[C],R=d[C].paddedRect,z=R.x+1,U=R.y+1,G=D.data.width,H=D.data.height;fo.copy(D.data,S,{x:0,y:0},{x:z,y:U},D.data),fo.copy(D.data,S,{x:0,y:H-1},{x:z,y:U-1},{width:G,height:1}),fo.copy(D.data,S,{x:0,y:0},{x:z,y:U+H},{width:G,height:1}),fo.copy(D.data,S,{x:G-1,y:0},{x:z-1,y:U},{width:1,height:H}),fo.copy(D.data,S,{x:0,y:0},{x:z+G,y:U},{width:1,height:H})}this.image=S,this.iconPositions=u,this.patternPositions=d}addImages(t,l,u){for(const d in t){const p=t[d],y={x:0,y:0,w:p.data.width+2,h:p.data.height+2};u.push(y),l[d]=new n0(y,p),p.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(t,l){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const u in t.updatedImages)this.patchUpdatedImage(this.iconPositions[u],t.getImage(u),l),this.patchUpdatedImage(this.patternPositions[u],t.getImage(u),l)}patchUpdatedImage(t,l,u){if(!t||!l||t.version===l.version)return;t.version=l.version;const[d,p]=t.tl;u.update(l.data,void 0,{x:d,y:p})}}Ct("ImagePosition",n0),Ct("ImageAtlas",K1);const po={horizontal:1,vertical:2,horizontalOnly:3};class Df{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,l){const u=new Df;return u.scale=t||1,u.fontStack=l,u}static forImage(t){const l=new Df;return l.imageName=t,l}}class ju{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,l){const u=new ju;for(let d=0;d<t.sections.length;d++){const p=t.sections[d];p.image?u.addImageSection(p):u.addTextSection(p,l)}return u}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(t){this.text=function(l,u){let d="";for(let p=0;p<l.length;p++){const y=l.charCodeAt(p+1)||null,b=l.charCodeAt(p-1)||null;d+=!u&&(y&&zt(y)&&!kf[l[p+1]]||b&&zt(b)&&!kf[l[p-1]])||!kf[l[p]]?l[p]:kf[l[p]]}return d}(this.text,t)}trim(){let t=0;for(let u=0;u<this.text.length&&rm[this.text.charCodeAt(u)];u++)t++;let l=this.text.length;for(let u=this.text.length-1;u>=0&&u>=t&&rm[this.text.charCodeAt(u)];u--)l--;this.text=this.text.substring(t,l),this.sectionIndex=this.sectionIndex.slice(t,l)}substring(t,l){const u=new ju;return u.text=this.text.substring(t,l),u.sectionIndex=this.sectionIndex.slice(t,l),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,l)=>Math.max(t,this.sections[l].scale),0)}addTextSection(t,l){this.text+=t.text,this.sections.push(Df.forText(t.scale,t.fontStack||l));const u=this.sections.length-1;for(let d=0;d<t.text.length;++d)this.sectionIndex.push(u)}addImageSection(t){const l=t.image?t.image.name:"";if(l.length===0)return void wn("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(Df.forImage(l)),this.sectionIndex.push(this.sections.length-1)):wn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function r0(i,t,l,u,d,p,y,b,S,C,D,R,z,U,G,H){const K=ju.fromFeature(i,d);let re;R===po.vertical&&K.verticalizePunctuation(z);const{processBidirectionalText:he,processStyledBidirectionalText:ye}=gn;if(he&&K.sections.length===1){re=[];const Ae=he(K.toString(),i0(K,C,p,t,u,U,G));for(const Ge of Ae){const $e=new ju;$e.text=Ge,$e.sections=K.sections;for(let dt=0;dt<Ge.length;dt++)$e.sectionIndex.push(0);re.push($e)}}else if(ye){re=[];const Ae=ye(K.text,K.sectionIndex,i0(K,C,p,t,u,U,G));for(const Ge of Ae){const $e=new ju;$e.text=Ge[0],$e.sectionIndex=Ge[1],$e.sections=K.sections,re.push($e)}}else re=function(Ae,Ge){const $e=[],dt=Ae.text;let lt=0;for(const Ve of Ge)$e.push(Ae.substring(lt,Ve)),lt=Ve;return lt<dt.length&&$e.push(Ae.substring(lt,dt.length)),$e}(K,i0(K,C,p,t,u,U,G));const Ee=[],Se={positionedLines:Ee,text:K.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:R,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Ae,Ge,$e,dt,lt,Ve,ct,gt,Xe,wt,kt,pn){let Vn=0,yn=0,vn=0;const st=gt==="right"?1:gt==="left"?0:.5;let Sn=!1;for(const An of lt){const dn=An.getSections();for(const Jn of dn){if(Jn.imageName)continue;const wr=Ge[Jn.fontStack];if(wr&&(Sn=wr.ascender!==void 0&&wr.descender!==void 0,!Sn))break}if(!Sn)break}let bn=0;for(const An of lt){An.trim();const dn=An.getMaxScale(),Jn=(dn-1)*Kr,wr={positionedGlyphs:[],lineOffset:0};Ae.positionedLines[bn]=wr;const mr=wr.positionedGlyphs;let Sr=0;if(!An.length()){yn+=Ve,++bn;continue}let Yr=0,zi=0;for(let Kn=0;Kn<An.length();Kn++){const Br=An.getSection(Kn),Oo=An.getSectionIndex(Kn),Wr=An.getCharCode(Kn);let Bn=Br.scale,Ur=null,er=null,ui=null,Ir=Kr,hi=0;const wi=!(Xe===po.horizontal||!kt&&!We(Wr)||kt&&(rm[Wr]||(br=Wr,o(br)||f(br)||g(br)||me(br)||nt(br))));if(Br.imageName){const Ti=dt[Br.imageName];if(!Ti)continue;ui=Br.imageName,Ae.iconsInText=Ae.iconsInText||!0,er=Ti.paddedRect;const Nr=Ti.displaySize;Bn=Bn*Kr/pn,Ur={width:Nr[0],height:Nr[1],left:1,top:-3,advance:wi?Nr[1]:Nr[0],localGlyph:!1},hi=Sn?-Ur.height*Bn:dn*Kr-17-Nr[1]*Bn,Ir=Ur.advance;const ls=(wi?Nr[0]:Nr[1])*Bn-Kr*dn;ls>0&&ls>Sr&&(Sr=ls)}else{const Ti=$e[Br.fontStack];if(!Ti)continue;Ti[Wr]&&(er=Ti[Wr]);const Nr=Ge[Br.fontStack];if(!Nr)continue;const ls=Nr.glyphs[Wr];if(!ls)continue;if(Ur=ls.metrics,Ir=Wr!==8203?Kr:0,Sn){const Wu=Nr.ascender!==void 0?Math.abs(Nr.ascender):0,Uf=Nr.descender!==void 0?Math.abs(Nr.descender):0,Nf=(Wu+Uf)*Bn;Yr<Nf&&(Yr=Nf,zi=(Wu-Uf)/2*Bn),hi=-Wu*Bn}else hi=(dn-Bn)*Kr-17}wi?(Ae.verticalizable=!0,mr.push({glyph:Wr,imageName:ui,x:Vn,y:yn+hi,vertical:wi,scale:Bn,localGlyph:Ur.localGlyph,fontStack:Br.fontStack,sectionIndex:Oo,metrics:Ur,rect:er}),Vn+=Ir*Bn+wt):(mr.push({glyph:Wr,imageName:ui,x:Vn,y:yn+hi,vertical:wi,scale:Bn,localGlyph:Ur.localGlyph,fontStack:Br.fontStack,sectionIndex:Oo,metrics:Ur,rect:er}),Vn+=Ur.advance*Bn+wt)}mr.length!==0&&(vn=Math.max(Vn-wt,vn),Sn?tb(mr,st,Sr,zi,Ve*dn/2):tb(mr,st,Sr,0,Ve/2)),Vn=0;const Oi=Ve*dn+Sr;wr.lineOffset=Math.max(Sr,Jn),yn+=Oi,++bn}var br;const hr=yn,{horizontalAlign:Fr,verticalAlign:ci}=o0(ct);(function(An,dn,Jn,wr,mr,Sr){const Yr=(dn-Jn)*mr,zi=-Sr*wr;for(const Oi of An)for(const Kn of Oi.positionedGlyphs)Kn.x+=Yr,Kn.y+=zi})(Ae.positionedLines,st,Fr,ci,vn,hr),Ae.top+=-ci*hr,Ae.bottom=Ae.top+hr,Ae.left+=-Fr*vn,Ae.right=Ae.left+vn,Ae.hasBaseline=Sn}(Se,t,l,u,re,y,b,S,R,C,z,H),!function(Ae){for(const Ge of Ae)if(Ge.positionedGlyphs.length!==0)return!1;return!0}(Ee)&&Se}const rm={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ck={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Y1(i,t,l,u,d,p){if(t.imageName){const y=u[t.imageName];return y?y.displaySize[0]*t.scale*Kr/p+d:0}{const y=l[t.fontStack],b=y&&y.glyphs[i];return b?b.metrics.advance*t.scale+d:0}}function Q1(i,t,l,u){const d=Math.pow(i-t,2);return u?i<t?d/2:2*d:d+Math.abs(l)*l}function uk(i,t,l){let u=0;return i===10&&(u-=1e4),l&&(u+=150),i!==40&&i!==65288||(u+=50),t!==41&&t!==65289||(u+=50),u}function J1(i,t,l,u,d,p){let y=null,b=Q1(t,l,d,p);for(const S of u){const C=Q1(t-S.x,l,d,p)+S.badness;C<=b&&(y=S,b=C)}return{index:i,x:t,priorBreak:y,badness:b}}function eb(i){return i?eb(i.priorBreak).concat(i.index):[]}function i0(i,t,l,u,d,p,y){if(p!=="point")return[];if(!i)return[];const b=[],S=function(z,U,G,H,K,re){let he=0;for(let ye=0;ye<z.length();ye++){const Ee=z.getSection(ye);he+=Y1(z.getCharCode(ye),Ee,H,K,U,re)}return he/Math.max(1,Math.ceil(he/G))}(i,t,l,u,d,y),C=i.text.indexOf("\u200B")>=0;let D=0;for(let z=0;z<i.length();z++){const U=i.getSection(z),G=i.getCharCode(z);if(rm[G]||(D+=Y1(G,U,u,d,t,y)),z<i.length()-1){const H=!((R=G)<11904||!($(R)||F(R)||Le(R)||le(R)||J(R)||x(R)||W(R)||k(R)||de(R)||Y(R)||X(R)||et(R)||O(R)||A(R)||T(R)||Q(R)||L(R)||ke(R)||ue(R)||ce(R)));(ck[G]||H||U.imageName)&&b.push(J1(z+1,D,S,b,uk(G,i.getCharCode(z+1),H&&C),!1))}}var R;return eb(J1(i.length(),D,S,b,0,!0))}function o0(i){let t=.5,l=.5;switch(i){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:t,verticalAlign:l}}function tb(i,t,l,u,d){if(!(t||l||u||d))return;const p=i.length-1,y=i[p],b=(y.x+y.metrics.advance*y.scale)*t;for(let S=0;S<=p;S++)i[S].x-=b,i[S].y+=l+u+d}function hk(i,t,l){const{horizontalAlign:u,verticalAlign:d}=o0(l),p=t[0]-i.displaySize[0]*u,y=t[1]-i.displaySize[1]*d;return{image:i,top:y,bottom:y+i.displaySize[1],left:p,right:p+i.displaySize[0]}}function nb(i,t,l,u,d,p){const y=i.image;let b;if(y.content){const K=y.content,re=y.pixelRatio||1;b=[K[0]/re,K[1]/re,y.displaySize[0]-K[2]/re,y.displaySize[1]-K[3]/re]}const S=t.left*p,C=t.right*p;let D,R,z,U;l==="width"||l==="both"?(U=d[0]+S-u[3],R=d[0]+C+u[1]):(U=d[0]+(S+C-y.displaySize[0])/2,R=U+y.displaySize[0]);const G=t.top*p,H=t.bottom*p;return l==="height"||l==="both"?(D=d[1]+G-u[0],z=d[1]+H+u[2]):(D=d[1]+(G+H-y.displaySize[1])/2,z=D+y.displaySize[1]),{image:y,top:D,right:R,bottom:z,left:U,collisionPadding:b}}class la extends I{constructor(t,l,u,d,p){super(t,l),this.angle=d,this.z=u,p!==void 0&&(this.segment=p)}clone(){return new la(this.x,this.y,this.z,this.angle,this.segment)}}function rb(i,t,l,u,d){if(t.segment===void 0)return!0;let p=t,y=t.segment+1,b=0;for(;b>-l/2;){if(y--,y<0)return!1;b-=i[y].dist(p),p=i[y]}b+=i[y].dist(i[y+1]),y++;const S=[];let C=0;for(;b<l/2;){const D=i[y],R=i[y+1];if(!R)return!1;let z=i[y-1].angleTo(D)-D.angleTo(R);for(z=Math.abs((z+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:b,angleDelta:z}),C+=z;b-S[0].distance>u;)C-=S.shift().angleDelta;if(C>d)return!1;y++,b+=D.dist(R)}return!0}function ib(i){let t=0;for(let l=0;l<i.length-1;l++)t+=i[l].dist(i[l+1]);return t}function ob(i,t,l){return i?.6*t*l:0}function sb(i,t){return Math.max(i?i.right-i.left:0,t?t.right-t.left:0)}function fk(i,t,l,u,d,p){const y=ob(l,d,p),b=sb(l,u)*p;let S=0;const C=ib(i)/2;for(let D=0;D<i.length-1;D++){const R=i[D],z=i[D+1],U=R.dist(z);if(S+U>C){const G=(C-S)/U,H=In(R.x,z.x,G),K=In(R.y,z.y,G),re=new la(H,K,0,z.angleTo(R),D);return!y||rb(i,re,b,y,t)?re:void 0}S+=U}}function dk(i,t,l,u,d,p,y,b,S){const C=ob(u,p,y),D=sb(u,d),R=D*y,z=i[0].x===0||i[0].x===S||i[0].y===0||i[0].y===S;return t-R<t/4&&(t=R+t/4),ab(i,z?t/2*b%t:(D/2+2*p)*y*b%t,t,C,l,R,z,!1,S)}function ab(i,t,l,u,d,p,y,b,S){const C=p/2,D=ib(i);let R=0,z=t-l,U=[];for(let G=0;G<i.length-1;G++){const H=i[G],K=i[G+1],re=H.dist(K),he=K.angleTo(H);for(;z+l<R+re;){z+=l;const ye=(z-R)/re,Ee=In(H.x,K.x,ye),Se=In(H.y,K.y,ye);if(Ee>=0&&Ee<S&&Se>=0&&Se<S&&z-C>=0&&z+C<=D){const Ae=new la(Ee,Se,0,he,G);Ae._round(),u&&!rb(i,Ae,p,u,d)||U.push(Ae)}}R+=re}return b||U.length||y||(U=ab(i,R/2,l,u,d,p,y,!0,S)),U}function lb(i,t,l,u,d){const p=[];for(let y=0;y<i.length;y++){const b=i[y];let S;for(let C=0;C<b.length-1;C++){let D=b[C],R=b[C+1];D.x<t&&R.x<t||(D.x<t?D=new I(t,D.y+(t-D.x)/(R.x-D.x)*(R.y-D.y))._round():R.x<t&&(R=new I(t,D.y+(t-D.x)/(R.x-D.x)*(R.y-D.y))._round()),D.y<l&&R.y<l||(D.y<l?D=new I(D.x+(l-D.y)/(R.y-D.y)*(R.x-D.x),l)._round():R.y<l&&(R=new I(D.x+(l-D.y)/(R.y-D.y)*(R.x-D.x),l)._round()),D.x>=u&&R.x>=u||(D.x>=u?D=new I(u,D.y+(u-D.x)/(R.x-D.x)*(R.y-D.y))._round():R.x>=u&&(R=new I(u,D.y+(u-D.x)/(R.x-D.x)*(R.y-D.y))._round()),D.y>=d&&R.y>=d||(D.y>=d?D=new I(D.x+(d-D.y)/(R.y-D.y)*(R.x-D.x),d)._round():R.y>=d&&(R=new I(D.x+(d-D.y)/(R.y-D.y)*(R.x-D.x),d)._round()),S&&D.equals(S[S.length-1])||(S=[D],p.push(S)),S.push(R)))))}}return p}Ct("Anchor",la);const Rf=1e20;function cb(i,t,l,u,d,p,y,b,S){for(let C=t;C<t+u;C++)ub(i,l*p+C,p,d,y,b,S);for(let C=l;C<l+d;C++)ub(i,C*p+t,1,u,y,b,S)}function ub(i,t,l,u,d,p,y){p[0]=0,y[0]=-Rf,y[1]=Rf,d[0]=i[t];for(let b=1,S=0,C=0;b<u;b++){d[b]=i[t+b*l];const D=b*b;do{const R=p[S];C=(d[b]-d[R]+D-R*R)/(b-R)/2}while(C<=y[S]&&--S>-1);S++,p[S]=b,y[S]=C,y[S+1]=Rf}for(let b=0,S=0;b<u;b++){for(;y[S+1]<b;)S++;const C=p[S],D=b-C;i[t+b*l]=d[C]+D*D}}const s0={none:0,ideographs:1,all:2};class $u{constructor(t,l,u){this.requestManager=t,this.localGlyphMode=l,this.localFontFamily=u,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t){this.url=t}getGlyphs(t,l){const u=[];for(const d in t)for(const p of t[d])u.push({stack:d,id:p});Ue(u,({stack:d,id:p},y)=>{let b=this.entries[d];b||(b=this.entries[d]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let S=b.glyphs[p];if(S!==void 0)return void y(null,{stack:d,id:p,glyph:S});if(S=this._tinySDF(b,d,p),S)return b.glyphs[p]=S,void y(null,{stack:d,id:p,glyph:S});const C=Math.floor(p/256);if(256*C>65535)return void y(new Error("glyphs > 65535 not supported"));if(b.ranges[C])return void y(null,{stack:d,id:p,glyph:S});let D=b.requests[C];D||(D=b.requests[C]=[],$u.loadGlyphRange(d,C,this.url,this.requestManager,(R,z)=>{if(z){b.ascender=z.ascender,b.descender=z.descender;for(const U in z.glyphs)this._doesCharSupportLocalGlyph(+U)||(b.glyphs[+U]=z.glyphs[+U]);b.ranges[C]=!0}for(const U of D)U(R,z);delete b.requests[C]})),D.push((R,z)=>{R?y(R):z&&y(null,{stack:d,id:p,glyph:z.glyphs[p]||null})})},(d,p)=>{if(d)l(d);else if(p){const y={};for(const{stack:b,id:S,glyph:C}of p)y[b]===void 0&&(y[b]={}),y[b].glyphs===void 0&&(y[b].glyphs={}),y[b].glyphs[S]=C&&{id:C.id,bitmap:C.bitmap.clone(),metrics:C.metrics},y[b].ascender=this.entries[b].ascender,y[b].descender=this.entries[b].descender;l(null,y)}})}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==s0.none&&(this.localGlyphMode===s0.all?!!this.localFontFamily:!!this.localFontFamily&&(Y(t)||ae(t)||O(t)||L(t))||k(t))}_tinySDF(t,l,u){const d=this.localFontFamily;if(!d||!this._doesCharSupportLocalGlyph(u))return;let p=t.tinySDF;if(!p){let H="400";/bold/i.test(l)?H="900":/medium/i.test(l)?H="500":/light/i.test(l)&&(H="200"),p=t.tinySDF=new $u.TinySDF({fontFamily:d,fontWeight:H,fontSize:48,buffer:6,radius:16}),p.fontWeight=H}if(this.localGlyphs[p.fontWeight][u])return this.localGlyphs[p.fontWeight][u];const y=String.fromCharCode(u),{data:b,width:S,height:C,glyphWidth:D,glyphHeight:R,glyphLeft:z,glyphTop:U,glyphAdvance:G}=p.draw(y);return this.localGlyphs[p.fontWeight][u]={id:u,bitmap:new Ga({width:S,height:C},b),metrics:{width:D/2,height:R/2,left:z/2,top:U/2-27,advance:G/2,localGlyph:!0}}}}function hb(i,t,l,u){const d=[],p=i.image,y=p.pixelRatio,b=p.paddedRect.w-2,S=p.paddedRect.h-2,C=i.right-i.left,D=i.bottom-i.top,R=p.stretchX||[[0,b]],z=p.stretchY||[[0,S]],U=(Ve,ct)=>Ve+ct[1]-ct[0],G=R.reduce(U,0),H=z.reduce(U,0),K=b-G,re=S-H;let he=0,ye=G,Ee=0,Se=H,Ae=0,Ge=K,$e=0,dt=re;if(p.content&&u){const Ve=p.content;he=im(R,0,Ve[0]),Ee=im(z,0,Ve[1]),ye=im(R,Ve[0],Ve[2]),Se=im(z,Ve[1],Ve[3]),Ae=Ve[0]-he,$e=Ve[1]-Ee,Ge=Ve[2]-Ve[0]-ye,dt=Ve[3]-Ve[1]-Se}const lt=(Ve,ct,gt,Xe)=>{const wt=om(Ve.stretch-he,ye,C,i.left),kt=sm(Ve.fixed-Ae,Ge,Ve.stretch,G),pn=om(ct.stretch-Ee,Se,D,i.top),Vn=sm(ct.fixed-$e,dt,ct.stretch,H),yn=om(gt.stretch-he,ye,C,i.left),vn=sm(gt.fixed-Ae,Ge,gt.stretch,G),st=om(Xe.stretch-Ee,Se,D,i.top),Sn=sm(Xe.fixed-$e,dt,Xe.stretch,H),bn=new I(wt,pn),br=new I(yn,pn),hr=new I(yn,st),Fr=new I(wt,st),ci=new I(kt/y,Vn/y),An=new I(vn/y,Sn/y),dn=t*Math.PI/180;if(dn){const mr=Math.sin(dn),Sr=Math.cos(dn),Yr=[Sr,-mr,mr,Sr];bn._matMult(Yr),br._matMult(Yr),Fr._matMult(Yr),hr._matMult(Yr)}const Jn=Ve.stretch+Ve.fixed,wr=ct.stretch+ct.fixed;return{tl:bn,tr:br,bl:Fr,br:hr,tex:{x:p.paddedRect.x+1+Jn,y:p.paddedRect.y+1+wr,w:gt.stretch+gt.fixed-Jn,h:Xe.stretch+Xe.fixed-wr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ci,pixelOffsetBR:An,minFontScaleX:Ge/y/C,minFontScaleY:dt/y/D,isSDF:l}};if(u&&(p.stretchX||p.stretchY)){const Ve=fb(R,K,G),ct=fb(z,re,H);for(let gt=0;gt<Ve.length-1;gt++){const Xe=Ve[gt],wt=Ve[gt+1];for(let kt=0;kt<ct.length-1;kt++)d.push(lt(Xe,ct[kt],wt,ct[kt+1]))}}else d.push(lt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:b+1},{fixed:0,stretch:S+1}));return d}function im(i,t,l){let u=0;for(const d of i)u+=Math.max(t,Math.min(l,d[1]))-Math.max(t,Math.min(l,d[0]));return u}function fb(i,t,l){const u=[{fixed:-1,stretch:0}];for(const[d,p]of i){const y=u[u.length-1];u.push({fixed:d-y.stretch,stretch:y.stretch}),u.push({fixed:d-y.stretch,stretch:y.stretch+(p-d)})}return u.push({fixed:t+1,stretch:l}),u}function om(i,t,l,u){return i/t*l+u}function sm(i,t,l,u){return i-t*l/u}function pk(i,t,l,u){const d=t+i.positionedLines[u].lineOffset;return u===0?l+d/2:l+(d+(t+i.positionedLines[u-1].lineOffset))/2}$u.loadGlyphRange=function(i,t,l,u,d){const p=256*t,y=p+255,b=u.transformRequest(u.normalizeGlyphsURL(l).replace("{fontstack}",i).replace("{range}",`${p}-${y}`),Hc.Glyphs);Dl(b,(S,C)=>{if(S)d(S);else if(C){const D={},R=function(z){return new Pf(z).readFields(sk,{})}(C);for(const z of R.glyphs)D[z.id]=z;d(null,{glyphs:D,ascender:R.ascender,descender:R.descender})}})},$u.TinySDF=class{constructor({fontSize:i=24,buffer:t=3,radius:l=8,cutoff:u=.25,fontFamily:d="sans-serif",fontWeight:p="normal",fontStyle:y="normal"}){this.buffer=t,this.cutoff=u,this.radius=l;const b=this.size=i+4*t,S=this._createCanvas(b),C=this.ctx=S.getContext("2d",{willReadFrequently:!0});C.font=`${y} ${p} ${i}px ${d}`,C.textBaseline="alphabetic",C.textAlign="left",C.fillStyle="black",this.gridOuter=new Float64Array(b*b),this.gridInner=new Float64Array(b*b),this.f=new Float64Array(b),this.z=new Float64Array(b+1),this.v=new Uint16Array(b)}_createCanvas(i){const t=document.createElement("canvas");return t.width=t.height=i,t}draw(i){const{width:t,actualBoundingBoxAscent:l,actualBoundingBoxDescent:u,actualBoundingBoxLeft:d,actualBoundingBoxRight:p}=this.ctx.measureText(i),y=Math.floor(l),b=Math.min(this.size-this.buffer,Math.ceil(p-d)),S=Math.min(this.size-this.buffer,Math.ceil(l)+Math.ceil(u)),C=b+2*this.buffer,D=S+2*this.buffer,R=C*D,z=new Uint8ClampedArray(R),U={data:z,width:C,height:D,glyphWidth:b,glyphHeight:S,glyphTop:y,glyphLeft:0,glyphAdvance:t};if(b===0||S===0)return U;const{ctx:G,buffer:H,gridInner:K,gridOuter:re}=this;G.clearRect(H,H,b,S),G.fillText(i,H,H+y+1);const he=G.getImageData(H,H,b,S);re.fill(Rf,0,R),K.fill(0,0,R);for(let ye=0;ye<S;ye++)for(let Ee=0;Ee<b;Ee++){const Se=he.data[4*(ye*b+Ee)+3]/255;if(Se===0)continue;const Ae=(ye+H)*C+Ee+H;if(Se===1)re[Ae]=0,K[Ae]=Rf;else{const Ge=.5-Se;re[Ae]=Ge>0?Ge*Ge:0,K[Ae]=Ge<0?Ge*Ge:0}}cb(re,0,0,C,D,C,this.f,this.v,this.z),cb(K,H,H,b,S,C,this.f,this.v,this.z);for(let ye=0;ye<R;ye++){const Ee=Math.sqrt(re[ye])-Math.sqrt(K[ye]);z[ye]=Math.round(255-255*(Ee/this.radius+this.cutoff))}return U}};class mk{constructor(t=[],l=_k){if(this.data=t,this.length=this.data.length,this.compare=l,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:l,compare:u}=this,d=l[t];for(;t>0;){const p=t-1>>1,y=l[p];if(u(d,y)>=0)break;l[t]=y,t=p}l[t]=d}_down(t){const{data:l,compare:u}=this,d=this.length>>1,p=l[t];for(;t<d;){let y=1+(t<<1),b=l[y];const S=y+1;if(S<this.length&&u(l[S],b)<0&&(y=S,b=l[S]),u(b,p)>=0)break;l[t]=b,t=y}l[t]=p}}function _k(i,t){return i<t?-1:i>t?1:0}function gk(i,t=1,l=!1){let u=1/0,d=1/0,p=-1/0,y=-1/0;const b=i[0];for(let U=0;U<b.length;U++){const G=b[U];(!U||G.x<u)&&(u=G.x),(!U||G.y<d)&&(d=G.y),(!U||G.x>p)&&(p=G.x),(!U||G.y>y)&&(y=G.y)}const S=Math.min(p-u,y-d);let C=S/2;const D=new mk([],yk);if(S===0)return new I(u,d);for(let U=u;U<p;U+=S)for(let G=d;G<y;G+=S)D.push(new Vu(U+C,G+C,C,i));let R=function(U){let G=0,H=0,K=0;const re=U[0];for(let he=0,ye=re.length,Ee=ye-1;he<ye;Ee=he++){const Se=re[he],Ae=re[Ee],Ge=Se.x*Ae.y-Ae.x*Se.y;H+=(Se.x+Ae.x)*Ge,K+=(Se.y+Ae.y)*Ge,G+=3*Ge}return new Vu(H/G,K/G,0,U)}(i),z=D.length;for(;D.length;){const U=D.pop();(U.d>R.d||!R.d)&&(R=U,l&&console.log("found best %d after %d probes",Math.round(1e4*U.d)/1e4,z)),U.max-R.d<=t||(C=U.h/2,D.push(new Vu(U.p.x-C,U.p.y-C,C,i)),D.push(new Vu(U.p.x+C,U.p.y-C,C,i)),D.push(new Vu(U.p.x-C,U.p.y+C,C,i)),D.push(new Vu(U.p.x+C,U.p.y+C,C,i)),z+=4)}return l&&(console.log(`num probes: ${z}`),console.log(`best distance: ${R.d}`)),R.p}function yk(i,t){return t.max-i.max}function Vu(i,t,l,u){this.p=new I(i,t),this.h=l,this.d=function(d,p){let y=!1,b=1/0;for(let S=0;S<p.length;S++){const C=p[S];for(let D=0,R=C.length,z=R-1;D<R;z=D++){const U=C[D],G=C[z];U.y>d.y!=G.y>d.y&&d.x<(G.x-U.x)*(d.y-U.y)/(G.y-U.y)+U.x&&(y=!y),b=Math.min(b,x1(d,U,G))}}return(y?1:-1)*Math.sqrt(b)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}const a0=Number.POSITIVE_INFINITY,vk=Math.sqrt(2);function db(i,t){return t[1]!==a0?function(l,u,d){let p=0,y=0;switch(u=Math.abs(u),d=Math.abs(d),l){case"top-right":case"top-left":case"top":y=d-7;break;case"bottom-right":case"bottom-left":case"bottom":y=7-d}switch(l){case"top-right":case"bottom-right":case"right":p=-u;break;case"top-left":case"bottom-left":case"left":p=u}return[p,y]}(i,t[0],t[1]):function(l,u){let d=0,p=0;u<0&&(u=0);const y=u/vk;switch(l){case"top-right":case"top-left":p=y-7;break;case"bottom-right":case"bottom-left":p=7-y;break;case"bottom":p=7-u;break;case"top":p=u-7}switch(l){case"top-right":case"bottom-right":d=-y;break;case"top-left":case"bottom-left":d=y;break;case"left":d=u;break;case"right":d=-u}return[d,p]}(i,t[0])}function xk(i,t,l,u,d,p,y,b,S,C){i.createArrays(),i.tilePixelRatio=ln/(512*i.overscaling),i.compareText={},i.iconsNeedLinear=!1;const D=i.layers[0].layout,R=i.layers[0]._unevaluatedLayout._values,z={};if(i.textSizeData.kind==="composite"){const{minZoom:H,maxZoom:K}=i.textSizeData;z.compositeTextSizes=[R["text-size"].possiblyEvaluate(new Wt(H),b),R["text-size"].possiblyEvaluate(new Wt(K),b)]}if(i.iconSizeData.kind==="composite"){const{minZoom:H,maxZoom:K}=i.iconSizeData;z.compositeIconSizes=[R["icon-size"].possiblyEvaluate(new Wt(H),b),R["icon-size"].possiblyEvaluate(new Wt(K),b)]}z.layoutTextSize=R["text-size"].possiblyEvaluate(new Wt(S+1),b),z.layoutIconSize=R["icon-size"].possiblyEvaluate(new Wt(S+1),b),z.textMaxSize=R["text-size"].possiblyEvaluate(new Wt(18),b);const U=D.get("text-rotation-alignment")==="map"&&D.get("symbol-placement")!=="point",G=D.get("text-size");for(const H of i.features){const K=D.get("text-font").evaluate(H,{},b).join(","),re=G.evaluate(H,{},b),he=z.layoutTextSize.evaluate(H,{},b),ye=(z.layoutIconSize.evaluate(H,{},b),{horizontal:{},vertical:void 0}),Ee=H.text;let Se,Ae=[0,0];if(Ee){const dt=Ee.toString(),lt=D.get("text-letter-spacing").evaluate(H,{},b)*Kr,Ve=D.get("text-line-height").evaluate(H,{},b)*Kr,ct=Re(dt)?lt:0,gt=D.get("text-anchor").evaluate(H,{},b),Xe=D.get("text-variable-anchor");if(!Xe){const vn=D.get("text-radial-offset").evaluate(H,{},b);Ae=vn?db(gt,[vn*Kr,a0]):D.get("text-offset").evaluate(H,{},b).map(st=>st*Kr)}let wt=U?"center":D.get("text-justify").evaluate(H,{},b);const kt=D.get("symbol-placement"),pn=kt==="point",Vn=kt==="point"?D.get("text-max-width").evaluate(H,{},b)*Kr:0,yn=vn=>{i.allowVerticalPlacement&&je(dt)&&(ye.vertical=r0(Ee,t,l,d,K,Vn,Ve,gt,vn,ct,Ae,po.vertical,!0,kt,he,re))};if(!U&&Xe){const vn=wt==="auto"?Xe.map(Sn=>l0(Sn)):[wt];let st=!1;for(let Sn=0;Sn<vn.length;Sn++){const bn=vn[Sn];if(!ye.horizontal[bn])if(st)ye.horizontal[bn]=ye.horizontal[0];else{const br=r0(Ee,t,l,d,K,Vn,Ve,"center",bn,ct,Ae,po.horizontal,!1,kt,he,re);br&&(ye.horizontal[bn]=br,st=br.positionedLines.length===1)}}yn("left")}else{if(wt==="auto"&&(wt=l0(gt)),pn||D.get("text-writing-mode").indexOf("horizontal")>=0||!je(dt)){const vn=r0(Ee,t,l,d,K,Vn,Ve,gt,wt,ct,Ae,po.horizontal,!1,kt,he,re);vn&&(ye.horizontal[wt]=vn)}yn(kt==="point"?"left":wt)}}let Ge=!1;if(H.icon&&H.icon.name){const dt=u[H.icon.name];dt&&(Se=hk(d[H.icon.name],D.get("icon-offset").evaluate(H,{},b),D.get("icon-anchor").evaluate(H,{},b)),Ge=dt.sdf,i.sdfIcons===void 0?i.sdfIcons=dt.sdf:i.sdfIcons!==dt.sdf&&wn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(dt.pixelRatio!==i.pixelRatio||D.get("icon-rotate").constantOr(1)!==0)&&(i.iconsNeedLinear=!0))}const $e=mb(ye.horizontal)||ye.vertical;i.iconsInText||(i.iconsInText=!!$e&&$e.iconsInText),($e||Se)&&bk(i,H,ye,Se,u,z,he,0,Ae,Ge,y,b,C)}p&&i.generateCollisionDebugBuffers(S,i.collisionBoxArray)}function l0(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function bk(i,t,l,u,d,p,y,b,S,C,D,R,z){let U=p.textMaxSize.evaluate(t,{},R);U===void 0&&(U=y);const G=i.layers[0].layout,H=G.get("icon-offset").evaluate(t,{},R),K=mb(l.horizontal)||l.vertical,re=y/24,he=i.tilePixelRatio*U/24,ye=i.tilePixelRatio*G.get("symbol-spacing"),Ee=G.get("text-padding")*i.tilePixelRatio,Se=G.get("icon-padding")*i.tilePixelRatio,Ae=_e(G.get("text-max-angle")),Ge=G.get("text-rotation-alignment")==="map"&&G.get("symbol-placement")!=="point",$e=G.get("icon-rotation-alignment")==="map"&&G.get("symbol-placement")!=="point",dt=G.get("symbol-placement"),lt=ye/2,Ve=G.get("icon-text-fit");let ct;u&&Ve!=="none"&&(i.allowVerticalPlacement&&l.vertical&&(ct=nb(u,l.vertical,Ve,G.get("icon-text-fit-padding"),H,re)),K&&(u=nb(u,K,Ve,G.get("icon-text-fit-padding"),H,re)));const gt=(Xe,wt,kt)=>{if(wt.x<0||wt.x>=ln||wt.y<0||wt.y>=ln)return;const{x:pn,y:Vn,z:yn}=z.projectTilePoint(wt.x,wt.y,kt),vn=new la(pn,Vn,yn,0,void 0);(function(st,Sn,bn,br,hr,Fr,ci,An,dn,Jn,wr,mr,Sr,Yr,zi,Oi,Kn,Br,Oo,Wr,Bn,Ur,er,ui,Ir){const hi=st.addToLineVertexArray(Sn,br);let wi,Ti,Nr,ls,Wu,Uf,Nf,Kb=0,Yb=0,Qb=0,Jb=0,C0=-1,I0=-1;const Ls={};let ew=wf(""),M0=0,k0=0;if(dn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[M0,k0]=dn.layout.get("text-offset").evaluate(Bn,{},Ir).map(Zi=>Zi*Kr):(M0=dn.layout.get("text-radial-offset").evaluate(Bn,{},Ir)*Kr,k0=a0),st.allowVerticalPlacement&&hr.vertical){const Zi=hr.vertical;if(zi)Uf=c0(Zi),An&&(Nf=c0(An));else{const Wi=dn.layout.get("text-rotate").evaluate(Bn,{},Ir)+90;Nr=am(Jn,bn,Sn,wr,mr,Sr,Zi,Yr,Wi,Oi),An&&(ls=am(Jn,bn,Sn,wr,mr,Sr,An,Br,Wi))}}if(Fr){const Zi=dn.layout.get("icon-rotate").evaluate(Bn,{},Ir),Wi=dn.layout.get("icon-text-fit")!=="none",jf=hb(Fr,Zi,er,Wi),D0=An?hb(An,Zi,er,Wi):void 0;Ti=am(Jn,bn,Sn,wr,mr,Sr,Fr,Br,Zi),Kb=4*jf.length;const tw=st.iconSizeData;let fc=null;tw.kind==="source"?(fc=[Ds*dn.layout.get("icon-size").evaluate(Bn,{},Ir)],fc[0]>Za&&wn(`${st.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):tw.kind==="composite"&&(fc=[Ds*Ur.compositeIconSizes[0].evaluate(Bn,{},Ir),Ds*Ur.compositeIconSizes[1].evaluate(Bn,{},Ir)],(fc[0]>Za||fc[1]>Za)&&wn(`${st.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),st.addSymbols(st.icon,jf,fc,Wr,Oo,Bn,!1,bn,Sn,hi.lineStartIndex,hi.lineLength,-1,ui,Ir),C0=st.icon.placedSymbolArray.length-1,D0&&(Yb=4*D0.length,st.addSymbols(st.icon,D0,fc,Wr,Oo,Bn,po.vertical,bn,Sn,hi.lineStartIndex,hi.lineLength,-1,ui,Ir),I0=st.icon.placedSymbolArray.length-1)}for(const Zi in hr.horizontal){const Wi=hr.horizontal[Zi];wi||(ew=wf(Wi.text),zi?Wu=c0(Wi):wi=am(Jn,bn,Sn,wr,mr,Sr,Wi,Yr,dn.layout.get("text-rotate").evaluate(Bn,{},Ir),Oi));const jf=Wi.positionedLines.length===1;if(Qb+=pb(st,bn,Sn,Wi,ci,dn,zi,Bn,Oi,hi,hr.vertical?po.horizontal:po.horizontalOnly,jf?Object.keys(hr.horizontal):[Zi],Ls,C0,Ur,ui,Ir),jf)break}hr.vertical&&(Jb+=pb(st,bn,Sn,hr.vertical,ci,dn,zi,Bn,Oi,hi,po.vertical,["vertical"],Ls,I0,Ur,ui,Ir));let Ya=-1;const P0=(Zi,Wi)=>Zi?Math.max(Zi,Wi):Wi;Ya=P0(Wu,Ya),Ya=P0(Uf,Ya),Ya=P0(Nf,Ya);const Kk=Ya>-1?1:0;st.glyphOffsetArray.length>=Wa.MAX_GLYPHS&&wn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Bn.sortKey!==void 0&&st.addToSortKeyRanges(st.symbolInstances.length,Bn.sortKey),st.symbolInstances.emplaceBack(bn.x,bn.y,bn.z,Sn.x,Sn.y,Ls.right>=0?Ls.right:-1,Ls.center>=0?Ls.center:-1,Ls.left>=0?Ls.left:-1,Ls.vertical>=0?Ls.vertical:-1,C0,I0,ew,wi!==void 0?wi:st.collisionBoxArray.length,wi!==void 0?wi+1:st.collisionBoxArray.length,Nr!==void 0?Nr:st.collisionBoxArray.length,Nr!==void 0?Nr+1:st.collisionBoxArray.length,Ti!==void 0?Ti:st.collisionBoxArray.length,Ti!==void 0?Ti+1:st.collisionBoxArray.length,ls||st.collisionBoxArray.length,ls?ls+1:st.collisionBoxArray.length,wr,Qb,Jb,Kb,Yb,Kk,0,M0,k0,Ya)})(i,wt,vn,Xe,l,u,d,ct,i.layers[0],i.collisionBoxArray,t.index,t.sourceLayerIndex,i.index,Ee,Ge,S,0,Se,$e,H,t,p,C,D,R)};if(dt==="line")for(const Xe of lb(t.geometry,0,0,ln,ln)){const wt=dk(Xe,ye,Ae,l.vertical||K,u,24,he,i.overscaling,ln);for(const kt of wt){const pn=K;pn&&wk(i,pn.text,lt,kt)||gt(Xe,kt,R)}}else if(dt==="line-center"){for(const Xe of t.geometry)if(Xe.length>1){const wt=fk(Xe,Ae,l.vertical||K,u,24,he);wt&&gt(Xe,wt,R)}}else if(t.type==="Polygon")for(const Xe of Xg(t.geometry,0)){const wt=gk(Xe,16);gt(Xe[0],new la(wt.x,wt.y,0,0,void 0),R)}else if(t.type==="LineString")for(const Xe of t.geometry)gt(Xe,new la(Xe[0].x,Xe[0].y,0,0,void 0),R);else if(t.type==="Point")for(const Xe of t.geometry)for(const wt of Xe)gt([wt],new la(wt.x,wt.y,0,0,void 0),R)}const Za=32640;function pb(i,t,l,u,d,p,y,b,S,C,D,R,z,U,G,H,K){const re=function(Ee,Se,Ae,Ge,$e,dt,lt,Ve){const ct=[];if(Se.positionedLines.length===0)return ct;const gt=Ge.layout.get("text-rotate").evaluate(dt,{})*Math.PI/180,Xe=function(yn){const vn=yn[0],st=yn[1],Sn=vn*st;return Sn>0?[vn,-st]:Sn<0?[-vn,st]:vn===0?[st,vn]:[st,-vn]}(Ae);let wt=Math.abs(Se.top-Se.bottom);for(const yn of Se.positionedLines)wt-=yn.lineOffset;const kt=Se.positionedLines.length,pn=wt/kt;let Vn=Se.top-Ae[1];for(let yn=0;yn<kt;++yn){const vn=Se.positionedLines[yn];Vn=pk(Se,pn,Vn,yn);for(const st of vn.positionedGlyphs){if(!st.rect)continue;const Sn=st.rect||{};let bn=4,br=!0,hr=1,Fr=0;if(st.imageName){const er=lt[st.imageName];if(!er)continue;if(er.sdf){wn("SDF images are not supported in formatted text and will be ignored.");continue}br=!1,hr=er.pixelRatio,bn=1/hr}const ci=($e||Ve)&&st.vertical,An=st.metrics.advance*st.scale/2,dn=st.metrics,Jn=st.rect;if(Jn===null)continue;Ve&&Se.verticalizable&&(Fr=st.imageName?An-st.metrics.width*st.scale/2:0);const wr=$e?[st.x+An,st.y]:[0,0];let mr=[0,0],Sr=[0,0],Yr=!1;$e||(ci?(Sr=[st.x+An+Xe[0],st.y+Xe[1]-Fr],Yr=!0):mr=[st.x+An+Ae[0],st.y+Ae[1]-Fr]);const zi=Jn.w*st.scale/(hr*(st.localGlyph?2:1)),Oi=Jn.h*st.scale/(hr*(st.localGlyph?2:1));let Kn,Br,Oo,Wr;if(ci){const er=st.y-Vn,ui=new I(-An,An-er),Ir=-Math.PI/2,hi=new I(...Sr);Kn=new I(-An+mr[0],mr[1]),Kn._rotateAround(Ir,ui)._add(hi),Kn.x+=-er+An,Kn.y-=(dn.left-bn)*st.scale;const wi=st.imageName?dn.advance*st.scale:Kr*st.scale,Ti=String.fromCharCode(st.glyph);XM(Ti)?Kn.x+=(1-bn)*st.scale:KM(Ti)?Kn.x+=wi-dn.height*st.scale+(-bn-1)*st.scale:Kn.x+=st.imageName||dn.width+2*bn===Jn.w&&dn.height+2*bn===Jn.h?(wi-Oi)/2:(wi-(dn.height+2*bn)*st.scale)/2,Br=new I(Kn.x,Kn.y-zi),Oo=new I(Kn.x+Oi,Kn.y),Wr=new I(Kn.x+Oi,Kn.y-zi)}else{const er=(dn.left-bn)*st.scale-An+mr[0],ui=(-dn.top-bn)*st.scale+mr[1],Ir=er+zi,hi=ui+Oi;Kn=new I(er,ui),Br=new I(Ir,ui),Oo=new I(er,hi),Wr=new I(Ir,hi)}if(gt){let er;er=$e?new I(0,0):Yr?new I(Xe[0],Xe[1]):new I(Ae[0],Ae[1]),Kn._rotateAround(gt,er),Br._rotateAround(gt,er),Oo._rotateAround(gt,er),Wr._rotateAround(gt,er)}const Bn=new I(0,0),Ur=new I(0,0);ct.push({tl:Kn,tr:Br,bl:Oo,br:Wr,tex:Sn,writingMode:Se.writingMode,glyphOffset:wr,sectionIndex:st.sectionIndex,isSDF:br,pixelOffsetTL:Bn,pixelOffsetBR:Ur,minFontScaleX:0,minFontScaleY:0})}}return ct}(0,u,S,p,y,b,d,i.allowVerticalPlacement),he=i.textSizeData;let ye=null;he.kind==="source"?(ye=[Ds*p.layout.get("text-size").evaluate(b,{},K)],ye[0]>Za&&wn(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):he.kind==="composite"&&(ye=[Ds*G.compositeTextSizes[0].evaluate(b,{},K),Ds*G.compositeTextSizes[1].evaluate(b,{},K)],(ye[0]>Za||ye[1]>Za)&&wn(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),i.addSymbols(i.text,re,ye,S,y,b,D,t,l,C.lineStartIndex,C.lineLength,U,H,K);for(const Ee of R)z[Ee]=i.text.placedSymbolArray.length-1;return 4*re.length}function mb(i){for(const t in i)return i[t];return null}function am(i,t,l,u,d,p,y,b,S,C){let D=y.top,R=y.bottom,z=y.left,U=y.right;const G=y.collisionPadding;if(G&&(z-=G[0],D-=G[1],U+=G[2],R+=G[3]),S){const H=new I(z,D),K=new I(U,D),re=new I(z,R),he=new I(U,R),ye=_e(S);let Ee=new I(0,0);C&&(Ee=new I(C[0],C[1])),H._rotateAround(ye,Ee),K._rotateAround(ye,Ee),re._rotateAround(ye,Ee),he._rotateAround(ye,Ee),z=Math.min(H.x,K.x,re.x,he.x),U=Math.max(H.x,K.x,re.x,he.x),D=Math.min(H.y,K.y,re.y,he.y),R=Math.max(H.y,K.y,re.y,he.y)}return i.emplaceBack(t.x,t.y,t.z,l.x,l.y,z,D,U,R,b,u,d,p),i.length-1}function c0(i){i.collisionPadding&&(i.top-=i.collisionPadding[1],i.bottom+=i.collisionPadding[3]);const t=i.bottom-i.top;return t>0?Math.max(10,t):null}function wk(i,t,l,u){const d=i.compareText;if(t in d){const p=d[t];for(let y=p.length-1;y>=0;y--)if(u.dist(p[y])<l)return!0}else d[t]=[];return d[t].push(u),!1}const Tk=lc.VectorTileFeature.types,Ek=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function lm(i,t,l,u,d,p,y,b,S,C,D,R,z,U,G,H){const K=D?Math.min(Za,Math.round(D[0])):0,re=D?Math.min(Za,Math.round(D[1])):0;i.emplaceBack(t,l,Math.round(32*y),Math.round(32*b),S,C,(K<<1)+(R?1:0),re,16*z,16*U,256*G,256*H,u,d,p,0)}function u0(i,t,l){i.emplaceBack(t.x,t.y,l),i.emplaceBack(t.x,t.y,l),i.emplaceBack(t.x,t.y,l),i.emplaceBack(t.x,t.y,l)}function Sk(i){for(const t of i.sections)if(ut(t.text))return!0;return!1}class h0{constructor(t){this.layoutVertexArray=new Eg,this.indexArray=new ho,this.programConfigurations=t,this.segments=new vr,this.dynamicLayoutVertexArray=new ku,this.opacityVertexArray=new Sg,this.placedSymbolArray=new Jx}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,l,u,d){this.isEmpty()||(u&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,$M.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,VM.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Ek,!0),this.opacityVertexBuffer.itemSize=1),(u||d)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ct("SymbolBuffers",h0);class f0{constructor(t,l,u){this.layoutVertexArray=new t,this.layoutAttributes=l,this.indexArray=new u,this.segments=new vr,this.collisionVertexArray=new Ig,this.collisionVertexArrayExt=new ku}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,GM.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,qM.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Ct("CollisionBuffers",f0);class Wa{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(y=>y.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=V([]),this.placementViewportMatrix=V([]);const l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Jg(this.zoom,l["text-size"]),this.iconSizeData=Jg(this.zoom,l["icon-size"]);const u=this.layers[0].layout,d=u.get("symbol-sort-key"),p=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=p!=="viewport-y"&&d.constantOr(1)!==void 0,this.sortFeaturesByY=(p==="viewport-y"||p==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=u.get("text-writing-mode").map(y=>po[y]),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=t.sourceID}createArrays(){this.text=new h0(new oc(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new h0(new oc(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new n1,this.lineVertexArray=new r1,this.symbolInstances=new t1}calculateGlyphDependencies(t,l,u,d,p){for(let y=0;y<t.length;y++)if(l[t.charCodeAt(y)]=!0,d&&p){const b=kf[t.charAt(y)];b&&(l[b.charCodeAt(0)]=!0)}}populate(t,l,u,d){const p=this.layers[0],y=p.layout,b=y.get("text-font"),S=y.get("text-field"),C=y.get("icon-image"),D=(S.value.kind!=="constant"||S.value.value instanceof Xt&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&(b.value.kind!=="constant"||b.value.value.length>0),R=C.value.kind!=="constant"||!!C.value.value||Object.keys(C.parameters).length>0,z=y.get("symbol-sort-key");if(this.features=[],!D&&!R)return;const U=l.iconDependencies,G=l.glyphDependencies,H=l.availableImages,K=new Wt(this.zoom);for(const{feature:re,id:he,index:ye,sourceLayerIndex:Ee}of t){const Se=p._featureFilter.needGeometry,Ae=ac(re,Se);if(!p._featureFilter.filter(K,Ae,u))continue;let Ge,$e;if(Se||(Ae.geometry=sa(re,u,d)),D){const lt=p.getValueAndResolveTokens("text-field",Ae,u,H),Ve=Xt.factory(lt);Sk(Ve)&&(this.hasRTLText=!0),(!this.hasRTLText||Vi()==="unavailable"||this.hasRTLText&&gn.isParsed())&&(Ge=HM(Ve,p,Ae))}if(R){const lt=p.getValueAndResolveTokens("icon-image",Ae,u,H);$e=lt instanceof Ni?lt:Ni.fromString(lt)}if(!Ge&&!$e)continue;const dt=this.sortFeaturesByKey?z.evaluate(Ae,{},u):void 0;if(this.features.push({id:he,text:Ge,icon:$e,index:ye,sourceLayerIndex:Ee,geometry:Ae.geometry,properties:re.properties,type:Tk[re.type],sortKey:dt}),$e&&(U[$e.name]=!0),Ge){const lt=b.evaluate(Ae,{},u).join(","),Ve=y.get("text-rotation-alignment")==="map"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(po.vertical)>=0;for(const ct of Ge.sections)if(ct.image)U[ct.image.name]=!0;else{const gt=je(Ge.toString()),Xe=ct.fontStack||lt,wt=G[Xe]=G[Xe]||{};this.calculateGlyphDependencies(ct.text,wt,Ve,this.allowVerticalPlacement,gt)}}}y.get("symbol-placement")==="line"&&(this.features=function(re){const he={},ye={},Ee=[];let Se=0;function Ae(lt){Ee.push(re[lt]),Se++}function Ge(lt,Ve,ct){const gt=ye[lt];return delete ye[lt],ye[Ve]=gt,Ee[gt].geometry[0].pop(),Ee[gt].geometry[0]=Ee[gt].geometry[0].concat(ct[0]),gt}function $e(lt,Ve,ct){const gt=he[Ve];return delete he[Ve],he[lt]=gt,Ee[gt].geometry[0].shift(),Ee[gt].geometry[0]=ct[0].concat(Ee[gt].geometry[0]),gt}function dt(lt,Ve,ct){const gt=ct?Ve[0][Ve[0].length-1]:Ve[0][0];return`${lt}:${gt.x}:${gt.y}`}for(let lt=0;lt<re.length;lt++){const Ve=re[lt],ct=Ve.geometry,gt=Ve.text?Ve.text.toString():null;if(!gt){Ae(lt);continue}const Xe=dt(gt,ct),wt=dt(gt,ct,!0);if(Xe in ye&&wt in he&&ye[Xe]!==he[wt]){const kt=$e(Xe,wt,ct),pn=Ge(Xe,wt,Ee[kt].geometry);delete he[Xe],delete ye[wt],ye[dt(gt,Ee[pn].geometry,!0)]=pn,Ee[kt].geometry=null}else Xe in ye?Ge(Xe,wt,ct):wt in he?$e(Xe,wt,ct):(Ae(lt),he[Xe]=Se-1,ye[wt]=Se-1)}return Ee.filter(lt=>lt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((re,he)=>re.sortKey-he.sortKey)}update(t,l,u,d){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,l,this.layers,u,d),this.icon.programConfigurations.updatePaintArrays(t,l,this.layers,u,d))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,l){const u=this.lineVertexArray.length;if(t.segment!==void 0){let d=t.dist(l[t.segment+1]),p=t.dist(l[t.segment]);const y={};for(let b=t.segment+1;b<l.length;b++)y[b]={x:l[b].x,y:l[b].y,tileUnitDistanceFromAnchor:d},b<l.length-1&&(d+=l[b+1].dist(l[b]));for(let b=t.segment||0;b>=0;b--)y[b]={x:l[b].x,y:l[b].y,tileUnitDistanceFromAnchor:p},b>0&&(p+=l[b-1].dist(l[b]));for(let b=0;b<l.length;b++){const S=y[b];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(t,l,u,d,p,y,b,S,C,D,R,z,U,G){const H=t.indexArray,K=t.layoutVertexArray,re=t.segments.prepareSegment(4*l.length,K,H,this.canOverlap?y.sortKey:void 0),he=this.glyphOffsetArray.length,ye=re.vertexLength,Ee=this.allowVerticalPlacement&&b===po.vertical?Math.PI/2:0,Se=y.text&&y.text.sections;for(let Ae=0;Ae<l.length;Ae++){const{tl:Ge,tr:$e,bl:dt,br:lt,tex:Ve,pixelOffsetTL:ct,pixelOffsetBR:gt,minFontScaleX:Xe,minFontScaleY:wt,glyphOffset:kt,isSDF:pn,sectionIndex:Vn}=l[Ae],yn=re.vertexLength,vn=kt[1];lm(K,S.x,S.y,S.z,C.x,C.y,Ge.x,vn+Ge.y,Ve.x,Ve.y,u,pn,ct.x,ct.y,Xe,wt),lm(K,S.x,S.y,S.z,C.x,C.y,$e.x,vn+$e.y,Ve.x+Ve.w,Ve.y,u,pn,gt.x,ct.y,Xe,wt),lm(K,S.x,S.y,S.z,C.x,C.y,dt.x,vn+dt.y,Ve.x,Ve.y+Ve.h,u,pn,ct.x,gt.y,Xe,wt),lm(K,S.x,S.y,S.z,C.x,C.y,lt.x,vn+lt.y,Ve.x+Ve.w,Ve.y+Ve.h,u,pn,gt.x,gt.y,Xe,wt),u0(t.dynamicLayoutVertexArray,S,Ee),H.emplaceBack(yn,yn+1,yn+2),H.emplaceBack(yn+1,yn+2,yn+3),re.vertexLength+=4,re.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(kt[0]),Ae!==l.length-1&&Vn===l[Ae+1].sectionIndex||t.programConfigurations.populatePaintArrays(K.length,y,y.index,{},U,G,Se&&Se[Vn])}t.placedSymbolArray.emplaceBack(S.x,S.y,S.z,C.x,C.y,he,this.glyphOffsetArray.length-he,ye,D,R,C.segment,u?u[0]:0,u?u[1]:0,d[0],d[1],b,0,!1,0,z,0)}_commitLayoutVertex(t,l,u,d,p,y,b){t.emplaceBack(l,u,d,p,y,Math.round(b.x),Math.round(b.y))}_addCollisionDebugVertices(t,l,u,d,p,y,b){const S=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),C=S.vertexLength,D=b.tileAnchorX,R=b.tileAnchorY;for(let U=0;U<4;U++)u.collisionVertexArray.emplaceBack(0,0,0,0);u.collisionVertexArrayExt.emplaceBack(l,-t.padding,-t.padding),u.collisionVertexArrayExt.emplaceBack(l,t.padding,-t.padding),u.collisionVertexArrayExt.emplaceBack(l,t.padding,t.padding),u.collisionVertexArrayExt.emplaceBack(l,-t.padding,t.padding),this._commitLayoutVertex(u.layoutVertexArray,d,p,y,D,R,new I(t.x1,t.y1)),this._commitLayoutVertex(u.layoutVertexArray,d,p,y,D,R,new I(t.x2,t.y1)),this._commitLayoutVertex(u.layoutVertexArray,d,p,y,D,R,new I(t.x2,t.y2)),this._commitLayoutVertex(u.layoutVertexArray,d,p,y,D,R,new I(t.x1,t.y2)),S.vertexLength+=4;const z=u.indexArray;z.emplaceBack(C,C+1),z.emplaceBack(C+1,C+2),z.emplaceBack(C+2,C+3),z.emplaceBack(C+3,C),S.primitiveLength+=4}_addTextDebugCollisionBoxes(t,l,u,d,p,y){for(let b=d;b<p;b++){const S=u.get(b),C=this.getSymbolInstanceTextSize(t,y,l,b);this._addCollisionDebugVertices(S,C,this.textCollisionBox,S.projectedAnchorX,S.projectedAnchorY,S.projectedAnchorZ,y)}}_addIconDebugCollisionBoxes(t,l,u,d,p,y){for(let b=d;b<p;b++){const S=u.get(b),C=this.getSymbolInstanceIconSize(t,l,b);this._addCollisionDebugVertices(S,C,this.iconCollisionBox,S.projectedAnchorX,S.projectedAnchorY,S.projectedAnchorZ,y)}}generateCollisionDebugBuffers(t,l){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new f0(Fp,V1.members,$a),this.iconCollisionBox=new f0(Fp,V1.members,$a);const u=Bu(this.iconSizeData,t),d=Bu(this.textSizeData,t);for(let p=0;p<this.symbolInstances.length;p++){const y=this.symbolInstances.get(p);this._addTextDebugCollisionBoxes(d,t,l,y.textBoxStartIndex,y.textBoxEndIndex,y),this._addTextDebugCollisionBoxes(d,t,l,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y),this._addIconDebugCollisionBoxes(u,t,l,y.iconBoxStartIndex,y.iconBoxEndIndex,y),this._addIconDebugCollisionBoxes(u,t,l,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex,y)}}getSymbolInstanceTextSize(t,l,u,d){const p=this.text.placedSymbolArray.get(l.rightJustifiedTextSymbolIndex>=0?l.rightJustifiedTextSymbolIndex:l.centerJustifiedTextSymbolIndex>=0?l.centerJustifiedTextSymbolIndex:l.leftJustifiedTextSymbolIndex>=0?l.leftJustifiedTextSymbolIndex:l.verticalPlacedTextSymbolIndex>=0?l.verticalPlacedTextSymbolIndex:d),y=tm(this.textSizeData,t,p)/Kr;return this.tilePixelRatio*y}getSymbolInstanceIconSize(t,l,u){const d=this.icon.placedSymbolArray.get(u),p=tm(this.iconSizeData,t,d);return this.tilePixelRatio*p}_commitDebugCollisionVertexUpdate(t,l,u){t.emplaceBack(l,-u,-u),t.emplaceBack(l,u,-u),t.emplaceBack(l,u,u),t.emplaceBack(l,-u,u)}_updateTextDebugCollisionBoxes(t,l,u,d,p,y){for(let b=d;b<p;b++){const S=u.get(b),C=this.getSymbolInstanceTextSize(t,y,l,b);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,C,S.padding)}}_updateIconDebugCollisionBoxes(t,l,u,d,p){for(let y=d;y<p;y++){const b=u.get(y),S=this.getSymbolInstanceIconSize(t,l,y);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,S,b.padding)}}updateCollisionDebugBuffers(t,l){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const u=Bu(this.iconSizeData,t),d=Bu(this.textSizeData,t);for(let p=0;p<this.symbolInstances.length;p++){const y=this.symbolInstances.get(p);this._updateTextDebugCollisionBoxes(d,t,l,y.textBoxStartIndex,y.textBoxEndIndex,y),this._updateTextDebugCollisionBoxes(d,t,l,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y),this._updateIconDebugCollisionBoxes(u,t,l,y.iconBoxStartIndex,y.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(u,t,l,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,l,u,d,p,y,b,S,C){const D={};for(let R=l;R<u;R++){const z=t.get(R);D.textBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,padding:z.padding,projectedAnchorX:z.projectedAnchorX,projectedAnchorY:z.projectedAnchorY,projectedAnchorZ:z.projectedAnchorZ,tileAnchorX:z.tileAnchorX,tileAnchorY:z.tileAnchorY},D.textFeatureIndex=z.featureIndex;break}for(let R=d;R<p;R++){const z=t.get(R);D.verticalTextBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,padding:z.padding,projectedAnchorX:z.projectedAnchorX,projectedAnchorY:z.projectedAnchorY,projectedAnchorZ:z.projectedAnchorZ,tileAnchorX:z.tileAnchorX,tileAnchorY:z.tileAnchorY},D.verticalTextFeatureIndex=z.featureIndex;break}for(let R=y;R<b;R++){const z=t.get(R);D.iconBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,padding:z.padding,projectedAnchorX:z.projectedAnchorX,projectedAnchorY:z.projectedAnchorY,projectedAnchorZ:z.projectedAnchorZ,tileAnchorX:z.tileAnchorX,tileAnchorY:z.tileAnchorY},D.iconFeatureIndex=z.featureIndex;break}for(let R=S;R<C;R++){const z=t.get(R);D.verticalIconBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,padding:z.padding,projectedAnchorX:z.projectedAnchorX,projectedAnchorY:z.projectedAnchorY,projectedAnchorZ:z.projectedAnchorZ,tileAnchorX:z.tileAnchorX,tileAnchorY:z.tileAnchorY},D.verticalIconFeatureIndex=z.featureIndex;break}return D}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const u=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,l){const u=t.placedSymbolArray.get(l),d=u.vertexStartIndex+4*u.numGlyphs;for(let p=u.vertexStartIndex;p<d;p+=4)t.indexArray.emplaceBack(p,p+1,p+2),t.indexArray.emplaceBack(p+1,p+2,p+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const l=Math.sin(t),u=Math.cos(t),d=[],p=[],y=[];for(let b=0;b<this.symbolInstances.length;++b){y.push(b);const S=this.symbolInstances.get(b);d.push(0|Math.round(l*S.tileAnchorX+u*S.tileAnchorY)),p.push(S.featureIndex)}return y.sort((b,S)=>d[b]-d[S]||p[S]-p[b]),y}addToSortKeyRanges(t,l){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===l?u.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const u=this.symbolInstances.get(l);this.featureSortOrder.push(u.featureIndex),[u.rightJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.leftJustifiedTextSymbolIndex].forEach((d,p,y)=>{d>=0&&y.indexOf(d)===p&&this.addIndicesForPlacedSymbol(this.text,d)}),u.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,u.verticalPlacedTextSymbolIndex),u.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.placedIconSymbolIndex),u.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Ct("SymbolBucket",Wa,{omit:["layers","collisionBoxArray","features","compareText"]}),Wa.MAX_GLYPHS=65535,Wa.addDynamicAttributes=u0;const Ak=new Zr({"symbol-placement":new Mt(Ne.layout_symbol["symbol-placement"]),"symbol-spacing":new Mt(Ne.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Mt(Ne.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Bt(Ne.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Mt(Ne.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Mt(Ne.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Mt(Ne.layout_symbol["icon-ignore-placement"]),"icon-optional":new Mt(Ne.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Mt(Ne.layout_symbol["icon-rotation-alignment"]),"icon-size":new Bt(Ne.layout_symbol["icon-size"]),"icon-text-fit":new Mt(Ne.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Mt(Ne.layout_symbol["icon-text-fit-padding"]),"icon-image":new Bt(Ne.layout_symbol["icon-image"]),"icon-rotate":new Bt(Ne.layout_symbol["icon-rotate"]),"icon-padding":new Mt(Ne.layout_symbol["icon-padding"]),"icon-keep-upright":new Mt(Ne.layout_symbol["icon-keep-upright"]),"icon-offset":new Bt(Ne.layout_symbol["icon-offset"]),"icon-anchor":new Bt(Ne.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Mt(Ne.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Mt(Ne.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Mt(Ne.layout_symbol["text-rotation-alignment"]),"text-field":new Bt(Ne.layout_symbol["text-field"]),"text-font":new Bt(Ne.layout_symbol["text-font"]),"text-size":new Bt(Ne.layout_symbol["text-size"]),"text-max-width":new Bt(Ne.layout_symbol["text-max-width"]),"text-line-height":new Bt(Ne.layout_symbol["text-line-height"]),"text-letter-spacing":new Bt(Ne.layout_symbol["text-letter-spacing"]),"text-justify":new Bt(Ne.layout_symbol["text-justify"]),"text-radial-offset":new Bt(Ne.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Mt(Ne.layout_symbol["text-variable-anchor"]),"text-anchor":new Bt(Ne.layout_symbol["text-anchor"]),"text-max-angle":new Mt(Ne.layout_symbol["text-max-angle"]),"text-writing-mode":new Mt(Ne.layout_symbol["text-writing-mode"]),"text-rotate":new Bt(Ne.layout_symbol["text-rotate"]),"text-padding":new Mt(Ne.layout_symbol["text-padding"]),"text-keep-upright":new Mt(Ne.layout_symbol["text-keep-upright"]),"text-transform":new Bt(Ne.layout_symbol["text-transform"]),"text-offset":new Bt(Ne.layout_symbol["text-offset"]),"text-allow-overlap":new Mt(Ne.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Mt(Ne.layout_symbol["text-ignore-placement"]),"text-optional":new Mt(Ne.layout_symbol["text-optional"])});var d0={paint:new Zr({"icon-opacity":new Bt(Ne.paint_symbol["icon-opacity"]),"icon-color":new Bt(Ne.paint_symbol["icon-color"]),"icon-halo-color":new Bt(Ne.paint_symbol["icon-halo-color"]),"icon-halo-width":new Bt(Ne.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Bt(Ne.paint_symbol["icon-halo-blur"]),"icon-translate":new Mt(Ne.paint_symbol["icon-translate"]),"icon-translate-anchor":new Mt(Ne.paint_symbol["icon-translate-anchor"]),"text-opacity":new Bt(Ne.paint_symbol["text-opacity"]),"text-color":new Bt(Ne.paint_symbol["text-color"],{runtimeType:ko,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new Bt(Ne.paint_symbol["text-halo-color"]),"text-halo-width":new Bt(Ne.paint_symbol["text-halo-width"]),"text-halo-blur":new Bt(Ne.paint_symbol["text-halo-blur"]),"text-translate":new Mt(Ne.paint_symbol["text-translate"]),"text-translate-anchor":new Mt(Ne.paint_symbol["text-translate-anchor"])}),layout:Ak};class _b{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:ws,this.defaultValue=t}evaluate(t){if(t.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(t.formattedSection))return l.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ct("FormatSectionOverride",_b,{omit:["defaultValue"]});class cm extends is{constructor(t){super(t,d0)}recalculate(t,l){super.recalculate(t,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const u=this.layout.get("text-writing-mode");if(u){const d=[];for(const p of u)d.indexOf(p)<0&&d.push(p);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(t,l,u,d){const p=this.layout.get(t).evaluate(l,{},u,d),y=this._unevaluatedLayout._values[t];return y.isDataDriven()||Ra(y.value)||!p?p:function(b,S){return S.replace(/{([^{}]+)}/g,(C,D)=>D in b?String(b[D]):"")}(l.properties,p)}createBucket(t){return new Wa(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of d0.paint.overridableProperties){if(!cm.hasPaintOverride(this.layout,t))continue;const l=this.paint.get(t),u=new _b(l),d=new sf(u,l.property.specification);let p=null;p=l.value.kind==="constant"||l.value.kind==="source"?new Yl("source",d):new af("composite",d,l.value.zoomStops,l.value._interpolationType),this.paint._values[t]=new bi(l.property,p,l.parameters)}}_handleOverridablePaintPropertyUpdate(t,l,u){return!(!this.layout||l.isDataDriven()||u.isDataDriven())&&cm.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,l){const u=t.get("text-field"),d=d0.paint.properties[l];let p=!1;const y=b=>{for(const S of b)if(d.overrides&&d.overrides.hasOverride(S))return void(p=!0)};if(u.value.kind==="constant"&&u.value.value instanceof Xt)y(u.value.value.sections);else if(u.value.kind==="source"){const b=C=>{p||(C instanceof Es&&gr(C.value)===Ts?y(C.value.sections):C instanceof Po?y(C.sections):C.eachChild(b))},S=u.value;S._styleExpression&&b(S._styleExpression.expression)}return p}getProgramConfiguration(t){return new ia(this,t)}}var Ck={paint:new Zr({"background-color":new Mt(Ne.paint_background["background-color"]),"background-pattern":new ta(Ne.paint_background["background-pattern"]),"background-opacity":new Mt(Ne.paint_background["background-opacity"])})},Ik={paint:new Zr({"raster-opacity":new Mt(Ne.paint_raster["raster-opacity"]),"raster-hue-rotate":new Mt(Ne.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Mt(Ne.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Mt(Ne.paint_raster["raster-brightness-max"]),"raster-saturation":new Mt(Ne.paint_raster["raster-saturation"]),"raster-contrast":new Mt(Ne.paint_raster["raster-contrast"]),"raster-resampling":new Mt(Ne.paint_raster["raster-resampling"]),"raster-fade-duration":new Mt(Ne.paint_raster["raster-fade-duration"])})};class Mk extends is{constructor(t){super(t,{}),this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}var kk={paint:new Zr({"sky-type":new Mt(Ne.paint_sky["sky-type"]),"sky-atmosphere-sun":new Mt(Ne.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Mt(Ne.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Mt(Ne.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Mt(Ne.paint_sky["sky-gradient-radius"]),"sky-gradient":new ks(Ne.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Mt(Ne.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Mt(Ne.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Mt(Ne.paint_sky["sky-opacity"])})};function p0(i,t,l){const u=ze(0,0,1),d=Tn(Lt());return function(p,y,b){b*=.5;var S=y[0],C=y[1],D=y[2],R=y[3],z=Math.sin(b),U=Math.cos(b);p[0]=S*U-D*z,p[1]=C*U+R*z,p[2]=D*U+S*z,p[3]=R*U-C*z}(d,d,l?-_e(i)+Math.PI:_e(i)),Cn(d,d,-_e(t)),Zn(u,u,d),It(u,u)}const Pk={circle:class extends is{constructor(i){super(i,eM)}createBucket(i){return new Ug(i)}queryRadius(i){const t=i;return Ou("circle-radius",this,t)+Ou("circle-stroke-width",this,t)+Wp(this.paint.get("circle-translate"))}queryIntersectsFeature(i,t,l,u,d,p,y,b){const S=E1(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),p.angle,i.pixelToTileUnitsFactor),C=this.paint.get("circle-radius").evaluate(t,l)+this.paint.get("circle-stroke-width").evaluate(t,l);return S1(i,u,p,y,b,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",S,C)}getProgramIds(){return["circle"]}getProgramConfiguration(i){return new ia(this,i)}},heatmap:class extends is{createBucket(i){return new C1(i)}constructor(i){super(i,iM),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=qg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(i){return Ou("heatmap-radius",this,i)}queryIntersectsFeature(i,t,l,u,d,p,y,b){const S=this.paint.get("heatmap-radius").evaluate(t,l);return S1(i,u,p,y,b,!0,!0,new I(0,0),S)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(i){return new ia(this,i)}},hillshade:class extends is{constructor(i){super(i,oM)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getProgramConfiguration(i){return new ia(this,i)}},fill:class extends is{constructor(i){super(i,wM)}getProgramIds(){const i=this.paint.get("fill-pattern"),t=i&&i.constantOr(1),l=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&l.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),l}getProgramConfiguration(i){return new ia(this,i)}recalculate(i,t){super.recalculate(i,t);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new Jp(i)}queryRadius(){return Wp(this.paint.get("fill-translate"))}queryIntersectsFeature(i,t,l,u,d,p){return!i.queryGeometry.isAboveHorizon&&v1(T1(i.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),p.angle,i.pixelToTileUnitsFactor),u)}isTileClipped(){return!0}},"fill-extrusion":class extends is{constructor(i){super(i,RM)}createBucket(i){return new Qg(i)}queryRadius(){return Wp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(i){return new ia(this,i)}queryIntersectsFeature(i,t,l,u,d,p,y,b,S){const C=E1(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),p.angle,i.pixelToTileUnitsFactor),D=this.paint.get("fill-extrusion-height").evaluate(t,l),R=this.paint.get("fill-extrusion-base").evaluate(t,l),z=[0,0],U=b&&p.elevation,G=p.elevation?p.elevation.exaggeration():1;if(U){const re=i.tile.getBucket(this).centroidVertexArray,he=S+1;if(he<re.length){const ye=re.get(he);z[0]=ye.a_centroid_pos0,z[1]=ye.a_centroid_pos1}}if(z[0]===0&&z[1]===1)return!1;const H=function(re,he,ye,Ee,Se,Ae,Ge,$e,dt){return Ae?function(lt,Ve,ct,gt,Xe,wt,kt,pn,Vn){const yn=[],vn=[],st=[0,0,0,1];for(const Sn of lt){const bn=[],br=[];for(const hr of Sn){const Fr=hr.x+gt.x,ci=hr.y+gt.y,An=zM(Fr,ci,Ve,ct,wt,kt,pn,Vn);st[0]=Fr,st[1]=ci,st[2]=An.base,st[3]=1,yt(st,st,Xe),st[3]=Math.max(st[3],1e-5);const dn=U1([st[0]/st[3],st[1]/st[3],st[2]/st[3]]);st[0]=Fr,st[1]=ci,st[2]=An.top,st[3]=1,yt(st,st,Xe),st[3]=Math.max(st[3],1e-5);const Jn=U1([st[0]/st[3],st[1]/st[3],st[2]/st[3]]);bn.push(dn),br.push(Jn)}yn.push(bn),vn.push(br)}return[yn,vn]}(re,he,ye,Ee,Se,Ae,Ge,$e,dt):function(lt,Ve,ct,gt,Xe){const wt=[],kt=[],pn=Xe[8]*Ve,Vn=Xe[9]*Ve,yn=Xe[10]*Ve,vn=Xe[11]*Ve,st=Xe[8]*ct,Sn=Xe[9]*ct,bn=Xe[10]*ct,br=Xe[11]*ct;for(const hr of lt){const Fr=[],ci=[];for(const An of hr){const dn=An.x+gt.x,Jn=An.y+gt.y,wr=Xe[0]*dn+Xe[4]*Jn+Xe[12],mr=Xe[1]*dn+Xe[5]*Jn+Xe[13],Sr=Xe[2]*dn+Xe[6]*Jn+Xe[14],Yr=Xe[3]*dn+Xe[7]*Jn+Xe[15],zi=wr+pn,Oi=mr+Vn,Kn=Sr+yn,Br=Math.max(Yr+vn,1e-5),Oo=wr+st,Wr=mr+Sn,Bn=Sr+bn,Ur=Math.max(Yr+br,1e-5),er=new I(zi/Br,Oi/Br);er.z=Kn/Br,Fr.push(er);const ui=new I(Oo/Ur,Wr/Ur);ui.z=Bn/Ur,ci.push(ui)}wt.push(Fr),kt.push(ci)}return[wt,kt]}(re,he,ye,Ee,Se)}(u,R,D,C,y,U?b:null,z,G,p.center.lat),K=i.queryGeometry;return function(re,he,ye){let Ee=1/0;v1(ye,he)&&(Ee=B1(ye,he[0]));for(let Se=0;Se<he.length;Se++){const Ae=he[Se],Ge=re[Se];for(let $e=0;$e<Ae.length-1;$e++){const dt=Ae[$e],lt=[dt,Ae[$e+1],Ge[$e+1],Ge[$e],dt];y1(ye,lt)&&(Ee=Math.min(Ee,B1(ye,lt)))}}return Ee!==1/0&&Ee}(H[0],H[1],K.isPointQuery()?K.screenBounds:K.screenGeometry)}},line:class extends is{constructor(i){super(i,N1),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(i){if(i==="line-gradient"){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof $l,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(i,t){super.recalculate(i,t),this.paint._values["line-floorwidth"]=j1.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new em(i)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(i){return new ia(this,i)}queryRadius(i){const t=i,l=$1(Ou("line-width",this,t),Ou("line-gap-width",this,t)),u=Ou("line-offset",this,t);return l/2+Math.abs(u)+Wp(this.paint.get("line-translate"))}queryIntersectsFeature(i,t,l,u,d,p){if(i.queryGeometry.isAboveHorizon)return!1;const y=T1(i.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),p.angle,i.pixelToTileUnitsFactor),b=i.pixelToTileUnitsFactor/2*$1(this.paint.get("line-width").evaluate(t,l),this.paint.get("line-gap-width").evaluate(t,l)),S=this.paint.get("line-offset").evaluate(t,l);return S&&(u=function(C,D){const R=[],z=new I(0,0);for(let U=0;U<C.length;U++){const G=C[U],H=[];for(let K=0;K<G.length;K++){const re=G[K-1],he=G[K],ye=G[K+1],Ee=K===0?z:he.sub(re)._unit()._perp(),Se=K===G.length-1?z:ye.sub(he)._unit()._perp(),Ae=Ee._add(Se)._unit();Ae._mult(1/(Ae.x*Se.x+Ae.y*Se.y)),H.push(Ae._mult(D)._add(he))}R.push(H)}return R}(u,S*i.pixelToTileUnitsFactor)),function(C,D,R){for(let z=0;z<D.length;z++){const U=D[z];if(C.length>=3){for(let G=0;G<U.length;G++)if(zu(C,U[G]))return!0}if(KI(C,U,R))return!0}return!1}(y,u,b)}isTileClipped(){return!0}},symbol:cm,background:class extends is{constructor(i){super(i,Ck)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends is{constructor(i){super(i,Ik)}getProgramIds(){return["raster"]}},sky:class extends is{constructor(i){super(i,kk),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="sky-gradient"?this._updateColorRamp():i!=="sky-atmosphere-sun"&&i!=="sky-atmosphere-halo-color"&&i!=="sky-atmosphere-color"&&i!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=qg({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(i){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=i.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}}getCenter(i,t){const l=this.paint.get("sky-type");if(l==="atmosphere"){const u=this.paint.get("sky-atmosphere-sun"),d=!u,p=i.style.light,y=p.properties.get("position");return d&&p.properties.get("anchor")==="viewport"&&wn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),d?p0(y.azimuthal,90-y.polar,t):p0(u[0],90-u[1],t)}if(l==="gradient"){const u=this.paint.get("sky-gradient-center");return p0(u[0],90-u[1],t)}}is3D(){return!1}isSky(){return!0}markSkyboxValid(i){this._skyboxInvalidated=!1,this._lightPosition=i.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const i=this.paint.get("sky-type");return i==="atmosphere"?["skyboxCapture","skybox"]:i==="gradient"?["skyboxGradient"]:null}}},{HTMLImageElement:gb,HTMLCanvasElement:yb,HTMLVideoElement:vb,ImageData:xb,ImageBitmap:um}=P;class hm{constructor(t,l,u,d){this.context=t,this.format=u,this.texture=t.gl.createTexture(),this.update(l,d)}update(t,l,u){const{width:d,height:p}=t,{context:y}=this,{gl:b}=y;if(b.bindTexture(b.TEXTURE_2D,this.texture),y.pixelStoreUnpackFlipY.set(!1),y.pixelStoreUnpack.set(1),y.pixelStoreUnpackPremultiplyAlpha.set(this.format===b.RGBA&&(!l||l.premultiply!==!1)),u||this.size&&this.size[0]===d&&this.size[1]===p){const{x:S,y:C}=u||{x:0,y:0};t instanceof gb||t instanceof yb||t instanceof vb||t instanceof xb||um&&t instanceof um?b.texSubImage2D(b.TEXTURE_2D,0,S,C,b.RGBA,b.UNSIGNED_BYTE,t):b.texSubImage2D(b.TEXTURE_2D,0,S,C,d,p,b.RGBA,b.UNSIGNED_BYTE,t.data)}else this.size=[d,p],t instanceof gb||t instanceof yb||t instanceof vb||t instanceof xb||um&&t instanceof um?b.texImage2D(b.TEXTURE_2D,0,this.format,this.format,b.UNSIGNED_BYTE,t):b.texImage2D(b.TEXTURE_2D,0,this.format,d,p,0,this.format,b.UNSIGNED_BYTE,t.data);this.useMipmap=Boolean(l&&l.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&b.generateMipmap(b.TEXTURE_2D)}bind(t,l){const{context:u}=this,{gl:d}=u;d.bindTexture(d.TEXTURE_2D,this.texture),t!==this.filter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,t),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,this.useMipmap?t===d.NEAREST?d.NEAREST_MIPMAP_NEAREST:d.LINEAR_MIPMAP_NEAREST:t),this.filter=t),l!==this.wrap&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,l),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,l),this.wrap=l)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class m0{constructor(t,l){this.width=t,this.height=l,this.nextRow=0,this.image=new Ga({width:t,height:l}),this.positions={},this.uploaded=!1}getDash(t,l){const u=this.getKey(t,l);return this.positions[u]}trim(){const t=this.width,l=this.height=tn(this.nextRow);this.image.resize({width:t,height:l})}getKey(t,l){return t.join(",")+l}getDashRanges(t,l,u){const d=[];let p=t.length%2==1?-t[t.length-1]*u:0,y=t[0]*u,b=!0;d.push({left:p,right:y,isDash:b,zeroLength:t[0]===0});let S=t[0];for(let C=1;C<t.length;C++){b=!b;const D=t[C];p=S*u,S+=D,y=S*u,d.push({left:p,right:y,isDash:b,zeroLength:D===0})}return d}addRoundDash(t,l,u){const d=l/2;for(let p=-u;p<=u;p++){const y=this.width*(this.nextRow+u+p);let b=0,S=t[b];for(let C=0;C<this.width;C++){C/S.right>1&&(S=t[++b]);const D=Math.abs(C-S.left),R=Math.abs(C-S.right),z=Math.min(D,R);let U;const G=p/u*(d+1);if(S.isDash){const H=d-Math.abs(G);U=Math.sqrt(z*z+H*H)}else U=d-Math.sqrt(z*z+G*G);this.image.data[y+C]=Math.max(0,Math.min(255,U+128))}}}addRegularDash(t,l){for(let S=t.length-1;S>=0;--S){const C=t[S],D=t[S+1];C.zeroLength?t.splice(S,1):D&&D.isDash===C.isDash&&(D.left=C.left,t.splice(S,1))}const u=t[0],d=t[t.length-1];u.isDash===d.isDash&&(u.left=d.left-this.width,d.right=u.right+this.width);const p=this.width*this.nextRow;let y=0,b=t[y];for(let S=0;S<this.width;S++){S/b.right>1&&(b=t[++y]);const C=Math.abs(S-b.left),D=Math.abs(S-b.right),R=Math.min(C,D);this.image.data[p+S]=Math.max(0,Math.min(255,(b.isDash?R:-R)+l+128))}}addDash(t,l){const u=this.getKey(t,l);if(this.positions[u])return this.positions[u];const d=l==="round",p=d?7:0,y=2*p+1;if(this.nextRow+y>this.height)return wn("LineAtlas out of space"),null;t.length===0&&t.push(1);let b=0;for(let D=0;D<t.length;D++)t[D]<0&&(wn("Negative value is found in line dasharray, replacing values with 0"),t[D]=0),b+=t[D];if(b!==0){const D=this.width/b,R=this.getDashRanges(t,this.width,D);d?this.addRoundDash(R,D,p):this.addRegularDash(R,l==="square"?.5*D:0)}const S=this.nextRow+p;this.nextRow+=y;const C={tl:[S,p],br:[b,0]};return this.positions[u]=C,C}}Ct("LineAtlas",m0);class Dk{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const Rk=P.performance;function bb(i){const t=i?i.url.toString():void 0;return Rk.getEntriesByName(t)}class zk{constructor(){this.tasks={},this.taskQueue=[],Dr(["process"],this),this.invoker=new Dk(this.process),this.nextId=0}add(t,l){const u=this.nextId++,d=function({type:p,isSymbolTile:y,zoom:b}){return b=b||0,p==="message"?0:p!=="maybePrepare"||y?p!=="parseTile"||y?p==="parseTile"&&y?300-b:p==="maybePrepare"&&y?400-b:500:200-b:100-b}(l);if(d===0){So();try{t()}finally{}return{cancel:()=>{}}}return this.tasks[u]={fn:t,metadata:l,priority:d,id:u},this.taskQueue.push(u),this.invoker.trigger(),{cancel:()=>{delete this.tasks[u]}}}process(){So();try{if(this.taskQueue=this.taskQueue.filter(u=>!!this.tasks[u]),!this.taskQueue.length)return;const t=this.pick();if(t===null)return;const l=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!l)return;l.fn()}finally{}}pick(){let t=null,l=1/0;for(let d=0;d<this.taskQueue.length;d++){const p=this.tasks[this.taskQueue[d]];p.priority<l&&(l=p.priority,t=d)}if(t===null)return null;const u=this.taskQueue[t];return this.taskQueue.splice(t,1),u}remove(){this.invoker.remove()}}function wb(i,t,l){var u=2*Math.PI*6378137/256/Math.pow(2,l);return[i*u-2*Math.PI*6378137/2,t*u-2*Math.PI*6378137/2]}class fm{constructor(t,l,u){this.z=t,this.x=l,this.y=u,this.key=zf(0,t,t,l,u)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,l){const u=function(p,y,b){var S=wb(256*p,256*(y=Math.pow(2,b)-y-1),b),C=wb(256*(p+1),256*(y+1),b);return S[0]+","+S[1]+","+C[0]+","+C[1]}(this.x,this.y,this.z),d=function(p,y,b){let S,C="";for(let D=p;D>0;D--)S=1<<D-1,C+=(y&S?1:0)+(b&S?2:0);return C}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",d).replace("{bbox-epsg-3857}",u)}toString(){return`${this.z}/${this.x}/${this.y}`}}class _0{constructor(t,l){this.wrap=t,this.canonical=l,this.key=zf(t,l.z,l.z,l.x,l.y)}}class Ri{constructor(t,l,u,d,p){this.overscaledZ=t,this.wrap=l,this.canonical=new fm(u,+d,+p),this.key=l===0&&t===u?this.canonical.key:zf(l,t,u,d,p)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const l=this.canonical.z-t;return t>this.canonical.z?new Ri(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ri(t,this.wrap,t,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(t,l=!0){if(this.overscaledZ===t&&l)return this.key;if(t>this.canonical.z)return zf(this.wrap*+l,t,this.canonical.z,this.canonical.x,this.canonical.y);{const u=this.canonical.z-t;return zf(this.wrap*+l,t,t,this.canonical.x>>u,this.canonical.y>>u)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const l=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>l&&t.canonical.y===this.canonical.y>>l}children(t){if(this.overscaledZ>=t)return[new Ri(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,u=2*this.canonical.x,d=2*this.canonical.y;return[new Ri(l,this.wrap,l,u,d),new Ri(l,this.wrap,l,u+1,d),new Ri(l,this.wrap,l,u,d+1),new Ri(l,this.wrap,l,u+1,d+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Ri(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Ri(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new _0(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function zf(i,t,l,u,d){const p=1<<Math.min(l,22);let y=p*(d%p)+u%p;return i&&l<22&&(y+=p*p*((i<0?-2*i-1:2*i)%(1<<2*(22-l)))),16*(32*y+l)+(t-l)}Ct("CanonicalTileID",fm),Ct("OverscaledTileID",Ri,{omit:["projMatrix"]});class Gu{constructor(t,l,u){this.func=t,this.mask=l,this.range=u}}Gu.ReadOnly=!1,Gu.ReadWrite=!0,Gu.disabled=new Gu(519,Gu.ReadOnly,[0,1]);const g0=7680;class y0{constructor(t,l,u,d,p,y){this.test=t,this.ref=l,this.mask=u,this.fail=d,this.depthFail=p,this.pass=y}}y0.disabled=new y0({func:519,mask:0},0,0,g0,g0,g0);class Rs{constructor(t,l,u){this.blendFunction=t,this.blendColor=l,this.mask=u}}Rs.Replace=[1,0],Rs.disabled=new Rs(Rs.Replace,xn.transparent,[!1,!1,!1,!1]),Rs.unblended=new Rs(Rs.Replace,xn.transparent,[!0,!0,!0,!0]),Rs.alphaBlended=new Rs([1,771],xn.transparent,[!0,!0,!0,!0]);const v0=1029,x0=2305;class as{constructor(t,l,u){this.enable=t,this.mode=l,this.frontFace=u}}as.disabled=new as(!1,v0,x0),as.backCCW=new as(!0,v0,x0),as.backCW=new as(!0,v0,2304),as.frontCW=new as(!0,1028,2304),as.frontCCW=new as(!0,1028,x0);class Tb{constructor(t){this._stringToNumber={},this._numberToString=[];for(let l=0;l<t.length;l++){const u=t[l];this._stringToNumber[u]=l,this._numberToString[l]=u}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}class Eb{constructor(t,l,u,d,p){this.type="Feature",this._vectorTileFeature=t,t._z=l,t._x=u,t._y=d,this.properties=t.properties,this.id=p}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const l in this)l!=="_geometry"&&l!=="_vectorTileFeature"&&(t[l]=this[l]);return t}}class Ok{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,l,u){const d=String(l);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][d]=this.stateChanges[t][d]||{},mt(this.stateChanges[t][d],u),this.deletedStates[t]===null){this.deletedStates[t]={};for(const p in this.state[t])p!==d&&(this.deletedStates[t][p]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][d]===null){this.deletedStates[t][d]={};for(const p in this.state[t][d])u[p]||(this.deletedStates[t][d][p]=null)}else for(const p in u)this.deletedStates[t]&&this.deletedStates[t][d]&&this.deletedStates[t][d][p]===null&&delete this.deletedStates[t][d][p]}removeFeatureState(t,l,u){if(this.deletedStates[t]===null)return;const d=String(l);if(this.deletedStates[t]=this.deletedStates[t]||{},u&&l!==void 0)this.deletedStates[t][d]!==null&&(this.deletedStates[t][d]=this.deletedStates[t][d]||{},this.deletedStates[t][d][u]=null);else if(l!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][d])for(u in this.deletedStates[t][d]={},this.stateChanges[t][d])this.deletedStates[t][d][u]=null;else this.deletedStates[t][d]=null;else this.deletedStates[t]=null}getState(t,l){const u=String(l),d=mt({},(this.state[t]||{})[u],(this.stateChanges[t]||{})[u]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const p=this.deletedStates[t][l];if(p===null)return{};for(const y in p)delete d[y]}return d}initializeTileState(t,l){t.setFeatureState(this.state,l)}coalesceChanges(t,l){const u={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const p={};for(const y in this.stateChanges[d])this.state[d][y]||(this.state[d][y]={}),mt(this.state[d][y],this.stateChanges[d][y]),p[y]=this.state[d][y];u[d]=p}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const p={};if(this.deletedStates[d]===null)for(const y in this.state[d])p[y]={},this.state[d][y]={};else for(const y in this.deletedStates[d]){if(this.deletedStates[d][y]===null)this.state[d][y]={};else for(const b of Object.keys(this.deletedStates[d][y]))delete this.state[d][y][b];p[y]=this.state[d][y]}u[d]=u[d]||{},mt(u[d],p)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(const d in t)t[d].setFeatureState(u,l)}}class Sb{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,l){const u=this.toIdx(t,l);return{min:this.minimums[u],max:this.maximums[u]}}isLeaf(t,l){return this.leaves[this.toIdx(t,l)]}toIdx(t,l){return l*this.size+t}}function Ab(i,t,l,u){let d=0,p=Number.MAX_VALUE;for(let y=0;y<3;y++)if(Math.abs(u[y])<1e-15){if(l[y]<i[y]||l[y]>t[y])return null}else{const b=1/u[y];let S=(i[y]-l[y])*b,C=(t[y]-l[y])*b;if(S>C){const D=S;S=C,C=D}if(S>d&&(d=S),C<p&&(p=C),d>p)return null}return d}function Cb(i,t,l,u,d,p,y,b,S,C,D){const R=u-i,z=d-t,U=p-l,G=y-i,H=b-t,K=S-l,re=D[1]*K-D[2]*H,he=D[2]*G-D[0]*K,ye=D[0]*H-D[1]*G,Ee=R*re+z*he+U*ye;if(Math.abs(Ee)<1e-15)return null;const Se=1/Ee,Ae=C[0]-i,Ge=C[1]-t,$e=C[2]-l,dt=(Ae*re+Ge*he+$e*ye)*Se;if(dt<0||dt>1)return null;const lt=Ge*U-$e*z,Ve=$e*R-Ae*U,ct=Ae*z-Ge*R,gt=(D[0]*lt+D[1]*Ve+D[2]*ct)*Se;return gt<0||dt+gt>1?null:(G*lt+H*Ve+K*ct)*Se}function Ib(i,t,l){return(i-t)/(l-t)}function Mb(i,t,l,u,d,p,y,b,S){const C=1<<l,D=p-u,R=y-d,z=(i+1)/C*D+u,U=(t+0)/C*R+d,G=(t+1)/C*R+d;b[0]=(i+0)/C*D+u,b[1]=U,S[0]=z,S[1]=G}class kb{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const l=function(p){const y=Math.ceil(Math.log2(p.dim/8)),b=[];let S=Math.ceil(Math.pow(2,y));const C=1/S,D=(U,G,H,K,re)=>{const he=K?1:0,ye=(U+1)*H-he,Ee=G*H,Se=(G+1)*H-he;re[0]=U*H,re[1]=Ee,re[2]=ye,re[3]=Se};let R=new Sb(S);const z=[];for(let U=0;U<S*S;U++){D(U%S,Math.floor(U/S),C,!1,z);const G=Ha(z[0],z[1],p),H=Ha(z[2],z[1],p),K=Ha(z[2],z[3],p),re=Ha(z[0],z[3],p);R.minimums.push(Math.min(G,H,K,re)),R.maximums.push(Math.max(G,H,K,re)),R.leaves.push(1)}for(b.push(R),S/=2;S>=1;S/=2){const U=b[b.length-1];R=new Sb(S);for(let G=0;G<S*S;G++){D(G%S,Math.floor(G/S),2,!0,z);const H=U.getElevation(z[0],z[1]),K=U.getElevation(z[2],z[1]),re=U.getElevation(z[2],z[3]),he=U.getElevation(z[0],z[3]),ye=U.isLeaf(z[0],z[1]),Ee=U.isLeaf(z[2],z[1]),Se=U.isLeaf(z[2],z[3]),Ae=U.isLeaf(z[0],z[3]),Ge=Math.min(H.min,K.min,re.min,he.min),$e=Math.max(H.max,K.max,re.max,he.max),dt=ye&&Ee&&Se&&Ae;R.maximums.push($e),R.minimums.push(Ge),R.leaves.push($e-Ge<=5&&dt?1:0)}b.push(R)}return b}(this.dem),u=l.length-1,d=l[u];this._addNode(d.minimums[0],d.maximums[0],d.leaves[0]),this._construct(l,0,0,u,0)}raycastRoot(t,l,u,d,p,y,b=1){return Ab([t,l,-100],[u,d,this.maximums[0]*b],p,y)}raycast(t,l,u,d,p,y,b=1){if(!this.nodeCount)return null;const S=this.raycastRoot(t,l,u,d,p,y,b);if(S==null)return null;const C=[],D=[],R=[],z=[],U=[{idx:0,t:S,nodex:0,nodey:0,depth:0}];for(;U.length>0;){const{idx:G,t:H,nodex:K,nodey:re,depth:he}=U.pop();if(this.leaves[G]){Mb(K,re,he,t,l,u,d,R,z);const Ee=1<<he,Se=(K+0)/Ee,Ae=(K+1)/Ee,Ge=(re+0)/Ee,$e=(re+1)/Ee,dt=Ha(Se,Ge,this.dem)*b,lt=Ha(Ae,Ge,this.dem)*b,Ve=Ha(Ae,$e,this.dem)*b,ct=Ha(Se,$e,this.dem)*b,gt=Cb(R[0],R[1],dt,z[0],R[1],lt,z[0],z[1],Ve,p,y),Xe=Cb(z[0],z[1],Ve,R[0],z[1],ct,R[0],R[1],dt,p,y),wt=Math.min(gt!==null?gt:Number.MAX_VALUE,Xe!==null?Xe:Number.MAX_VALUE);if(wt!==Number.MAX_VALUE)return wt;{const kt=_t([],p,y,H);if(Pb(dt,lt,ct,Ve,Ib(kt[0],R[0],z[0]),Ib(kt[1],R[1],z[1]))>=kt[2])return H}continue}let ye=0;for(let Ee=0;Ee<this._siblingOffset.length;Ee++){Mb((K<<1)+this._siblingOffset[Ee][0],(re<<1)+this._siblingOffset[Ee][1],he+1,t,l,u,d,R,z),R[2]=-100,z[2]=this.maximums[this.childOffsets[G]+Ee]*b;const Se=Ab(R,z,p,y);if(Se!=null){const Ae=Se;C[Ee]=Ae;let Ge=!1;for(let $e=0;$e<ye&&!Ge;$e++)Ae>=C[D[$e]]&&(D.splice($e,0,Ee),Ge=!0);Ge||(D[ye]=Ee),ye++}}for(let Ee=0;Ee<ye;Ee++){const Se=D[Ee];U.push({idx:this.childOffsets[G]+Se,t:C[Se],nodex:(K<<1)+this._siblingOffset[Se][0],nodey:(re<<1)+this._siblingOffset[Se][1],depth:he+1})}}return null}_addNode(t,l,u){return this.minimums.push(t),this.maximums.push(l),this.leaves.push(u),this.childOffsets.push(0),this.nodeCount++}_construct(t,l,u,d,p){if(t[d].isLeaf(l,u)===1)return;this.childOffsets[p]||(this.childOffsets[p]=this.nodeCount);const y=d-1,b=t[y];let S,C=0;for(let D=0;D<this._siblingOffset.length;D++){const R=2*l+this._siblingOffset[D][0],z=2*u+this._siblingOffset[D][1],U=b.getElevation(R,z),G=b.isLeaf(R,z),H=this._addNode(U.min,U.max,G);G&&(C|=1<<D),S||(S=H)}for(let D=0;D<this._siblingOffset.length;D++)C&1<<D||this._construct(t,2*l+this._siblingOffset[D][0],2*u+this._siblingOffset[D][1],y,S+D)}}function Pb(i,t,l,u,d,p){return In(In(i,l,p),In(t,u,p),d)}function Ha(i,t,l){const u=l.dim,d=Ye(i*u-.5,0,u-1),p=Ye(t*u-.5,0,u-1),y=Math.floor(d),b=Math.floor(p),S=Math.min(y+1,u-1),C=Math.min(b+1,u-1);return Pb(l.get(y,b),l.get(S,b),l.get(y,C),l.get(S,C),d-y,p-b)}const Db={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class dm{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,l,u,d=!1,p=!1){if(this.uid=t,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return wn(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=l.height;const y=this.dim=l.height-2;if(this.data=new Uint32Array(l.data.buffer),this.encoding=u||"mapbox",this.borderReady=d,!d){for(let b=0;b<y;b++)this.data[this._idx(-1,b)]=this.data[this._idx(0,b)],this.data[this._idx(y,b)]=this.data[this._idx(y-1,b)],this.data[this._idx(b,-1)]=this.data[this._idx(b,0)],this.data[this._idx(b,y)]=this.data[this._idx(b,y-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(y,-1)]=this.data[this._idx(y-1,0)],this.data[this._idx(-1,y)]=this.data[this._idx(0,y-1)],this.data[this._idx(y,y)]=this.data[this._idx(y-1,y-1)],p&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new kb(this)}get(t,l,u=!1){const d=new Uint8Array(this.data.buffer);u&&(t=Ye(t,-1,this.dim),l=Ye(l,-1,this.dim));const p=4*this._idx(t,l);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(d[p],d[p+1],d[p+2])}static getUnpackVector(t){return Db[t]}get unpackVector(){return Db[this.encoding]}_idx(t,l){if(t<-1||t>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(t+1)}_unpackMapbox(t,l,u){return(256*t*256+256*l+u)/10-1e4}_unpackTerrarium(t,l,u){return 256*t+l+u/256-32768}static pack(t,l){const u=[0,0,0,0],d=dm.getUnpackVector(l);let p=Math.floor((t+d[3])/d[2]);return u[2]=p%256,p=Math.floor(p/256),u[1]=p%256,p=Math.floor(p/256),u[0]=p,u}getPixels(){return new fo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,l,u){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let d=l*this.dim,p=l*this.dim+this.dim,y=u*this.dim,b=u*this.dim+this.dim;switch(l){case-1:d=p-1;break;case 1:p=d+1}switch(u){case-1:y=b-1;break;case 1:b=y+1}const S=-l*this.dim,C=-u*this.dim;for(let D=y;D<b;D++)for(let R=d;R<p;R++)this.data[this._idx(R,D)]=t.data[this._idx(R+S,D+C)]}onDeserialize(){this._tree&&(this._tree.dem=this)}}Ct("DEMData",dm),Ct("DemMinMaxQuadTree",kb,{omit:["dem"]});class Lk{constructor(t,l){this.max=t,this.onRemove=l,this.reset()}reset(){for(const t in this.data)for(const l of this.data[t])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(t,l,u){const d=t.wrapped().key;this.data[d]===void 0&&(this.data[d]=[]);const p={value:l,timeout:void 0};if(u!==void 0&&(p.timeout=setTimeout(()=>{this.remove(t,p)},u)),this.data[d].push(p),this.order.push(d),this.order.length>this.max){const y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const l=this.data[t].shift();return l.timeout&&clearTimeout(l.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),l.value}getByKey(t){const l=this.data[t];return l?l[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,l){if(!this.has(t))return this;const u=t.wrapped().key,d=l===void 0?0:this.data[u].indexOf(l),p=this.data[u][d];return this.data[u].splice(d,1),p.timeout&&clearTimeout(p.timeout),this.data[u].length===0&&delete this.data[u],this.onRemove(p.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(t){const l=[];for(const u in this.data)for(const d of this.data[u])t(d.value)||l.push(d);for(const u of l)this.remove(u.value.tileID,u)}}class cc extends xs{constructor(t,l,u){super(),this.id=t,this._onlySymbols=u,l.on("data",d=>{d.dataType==="source"&&d.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&d.dataType==="source"&&d.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),l.on("error",()=>{this._sourceErrored=!0}),this._source=l,this._tiles={},this._cache=new Lk(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=null,this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Ok}onAdd(t){this.map=t,this._minTileCacheSize=t?t._minTileCacheSize:null,this._maxTileCacheSize=t?t._maxTileCacheSize:null}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const t in this._tiles){const l=this._tiles[t];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,l){return t.isSymbolTile=this._onlySymbols,this._source.loadTile(t,l)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t,()=>{})}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const u=this._tiles[l];u.upload(t),u.prepare(this.map.style.imageManager)}}getIds(){return At(this._tiles).map(t=>t.tileID).sort(Rb).map(t=>t.key)}getRenderableIds(t){const l=[];for(const u in this._tiles)this._isIdRenderable(+u,t)&&l.push(this._tiles[u]);return t?l.sort((u,d)=>{const p=u.tileID,y=d.tileID,b=new I(p.canonical.x,p.canonical.y)._rotate(this.transform.angle),S=new I(y.canonical.x,y.canonical.y)._rotate(this.transform.angle);return p.overscaledZ-y.overscaledZ||S.y-b.y||S.x-b.x}).map(u=>u.tileID.key):l.map(u=>u.tileID).sort(Rb).map(u=>u.key)}hasRenderableParent(t){const l=this.findLoadedParent(t,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(t,l){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(l||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(+t,"reloading")}}_reloadTile(t,l){const u=this._tiles[t];u&&(u.state!=="loading"&&(u.state=l),this._loadTile(u,this._tileLoaded.bind(this,u,t,l)))}_tileLoaded(t,l,u,d){if(d)if(t.state="errored",d.status!==404)this._source.fire(new Kc(d,{tile:t}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const p=this.map.painter.terrain;this.update(this.transform,p.getScaledDemTileSize(),!0),p.resetTileLookupCache(this.id)}else this.update(this.transform);else t.timeAdded=Mi.now(),u==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(l,t),this._source.type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new vs("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const l=this.getRenderableIds();for(let d=0;d<l.length;d++){const p=l[d];if(t.neighboringTiles&&t.neighboringTiles[p]){const y=this.getTileByID(p);u(t,y),u(y,t)}}function u(d,p){if(!d.dem||d.dem.borderReady)return;d.needsHillshadePrepare=!0,d.needsDEMTextureUpload=!0;let y=p.tileID.canonical.x-d.tileID.canonical.x;const b=p.tileID.canonical.y-d.tileID.canonical.y,S=Math.pow(2,d.tileID.canonical.z),C=p.tileID.key;y===0&&b===0||Math.abs(b)>1||(Math.abs(y)>1&&(Math.abs(y+S)===1?y+=S:Math.abs(y-S)===1&&(y-=S)),p.dem&&d.dem&&(d.dem.backfillBorder(p.dem,y,b),d.neighboringTiles&&d.neighboringTiles[C]&&(d.neighboringTiles[C].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,l,u,d){for(const p in this._tiles){let y=this._tiles[p];if(d[p]||!y.hasData()||y.tileID.overscaledZ<=l||y.tileID.overscaledZ>u)continue;let b=y.tileID;for(;y&&y.tileID.overscaledZ>l+1;){const C=y.tileID.scaledTo(y.tileID.overscaledZ-1);y=this._tiles[C.key],y&&y.hasData()&&(b=C)}let S=b;for(;S.overscaledZ>l;)if(S=S.scaledTo(S.overscaledZ-1),t[S.key]){d[b.key]=b;break}}}findLoadedParent(t,l){if(t.key in this._loadedParentTiles){const u=this._loadedParentTiles[t.key];return u&&u.tileID.overscaledZ>=l?u:null}for(let u=t.overscaledZ-1;u>=l;u--){const d=t.scaledTo(u),p=this._getLoadedTile(d);if(p)return p}}_getLoadedTile(t){const l=this._tiles[t.key];return l&&l.hasData()?l:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,l){l=l||this._source.tileSize;const u=Math.ceil(t.width/l)+1,d=Math.ceil(t.height/l)+1,p=Math.floor(u*d*5),y=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,p):p,b=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,y):y;this._cache.setMaxSize(b)}handleWrapJump(t){const l=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,l){const u={};for(const d in this._tiles){const p=this._tiles[d];p.tileID=p.tileID.unwrapTo(p.tileID.wrap+l),u[p.tileID.key]=p}this._tiles=u;for(const d in this._timers)clearTimeout(this._timers[d]),delete this._timers[d];for(const d in this._tiles)this._setTileReloadTimer(+d,this._tiles[d])}}update(t,l,u){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!u)return;let d;this.updateCacheSize(t,l),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?d=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(b=>new Ri(b.canonical.z,b.wrap,b.canonical.z,b.canonical.x,b.canonical.y)):(d=t.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!u,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(d=d.filter(b=>this._source.hasTile(b)))):d=[];const p=this._updateRetainedTiles(d);if(zb(this._source.type)&&d.length!==0){const b={},S={},C=Object.keys(p);for(const R of C){const z=p[R],U=this._tiles[R];if(!U||U.fadeEndTime&&U.fadeEndTime<=Mi.now())continue;const G=this.findLoadedParent(z,Math.max(z.overscaledZ-cc.maxOverzooming,this._source.minzoom));G&&(this._addTile(G.tileID),b[G.tileID.key]=G.tileID),S[R]=z}const D=d[d.length-1].overscaledZ;for(const R in this._tiles){const z=this._tiles[R];if(p[R]||!z.hasData())continue;let U=z.tileID;for(;U.overscaledZ>D;){U=U.scaledTo(U.overscaledZ-1);const G=this._tiles[U.key];if(G&&G.hasData()&&S[U.key]){p[R]=z.tileID;break}}}for(const R in b)p[R]||(this._coveredTiles[R]=!0,p[R]=b[R])}for(const b in p)this._tiles[b].clearFadeHold();const y=function(b,S){const C=[];for(const D in b)D in S||C.push(D);return C}(this._tiles,p);for(const b of y){const S=this._tiles[b];S.hasSymbolBuckets&&!S.holdingForFade()?S.setHoldDuration(this.map._fadeDuration):S.hasSymbolBuckets&&!S.symbolFadeFinished()||this._removeTile(+b)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const l={};if(t.length===0)return l;const u={},d=t.reduce((C,D)=>Math.min(C,D.overscaledZ),1/0),p=t[0].overscaledZ,y=Math.max(p-cc.maxOverzooming,this._source.minzoom),b=Math.max(p+cc.maxUnderzooming,this._source.minzoom),S={};for(const C of t){const D=this._addTile(C);l[C.key]=C,D.hasData()||d<this._source.maxzoom&&(S[C.key]=C)}this._retainLoadedChildren(S,d,b,l);for(const C of t){let D=this._tiles[C.key];if(D.hasData())continue;if(C.canonical.z>=this._source.maxzoom){const z=C.children(this._source.maxzoom)[0],U=this.getTile(z);if(U&&U.hasData()){l[z.key]=z;continue}}else{const z=C.children(this._source.maxzoom);if(l[z[0].key]&&l[z[1].key]&&l[z[2].key]&&l[z[3].key])continue}let R=D.wasRequested();for(let z=C.overscaledZ-1;z>=y;--z){const U=C.scaledTo(z);if(u[U.key]||(u[U.key]=!0,D=this.getTile(U),!D&&R&&(D=this._addTile(U)),D&&(l[U.key]=U,R=D.wasRequested(),D.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const l=[];let u,d=this._tiles[t].tileID;for(;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){u=this._loadedParentTiles[d.key];break}l.push(d.key);const p=d.scaledTo(d.overscaledZ-1);if(u=this._getLoadedTile(p),u)break;d=p}for(const p of l)this._loadedParentTiles[p]=u}}_addTile(t){let l=this._tiles[t.key];if(l)return l;l=this._cache.getAndRemove(t),l&&(this._setTileReloadTimer(t.key,l),l.tileID=t,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,l)));const u=Boolean(l);if(!u){const d=this.map?this.map.painter:null,p=this._source.type==="raster"||this._source.type==="raster-dem";l=new w0(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom,d,p),this._loadTile(l,this._tileLoaded.bind(this,l,t.key,l.state))}return l?(l.uses++,this._tiles[t.key]=l,u||this._source.fire(new vs("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null}_setTileReloadTimer(t,l){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const u=l.getExpiryTimeout();u&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},u))}_removeTile(t){const l=this._tiles[t];l&&(l.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),l.uses>0||(l.hasData()&&l.state!=="reloading"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._source._clear&&this._source._clear(),this._cache.reset()}tilesIn(t,l,u){const d=[],p=this.transform;if(!p)return d;for(const y in this._tiles){const b=this._tiles[y];if(u&&b.clearQueryDebugViz(),b.holdingForFade())continue;const S=t.containsTile(b,p,l);S&&d.push(S)}return d}getVisibleCoordinates(t){const l=this.getRenderableIds(t).map(u=>this._tiles[u].tileID);for(const u of l)u.projMatrix=this.transform.calculateProjMatrix(u.toUnwrapped());return l}hasTransition(){if(this._source.hasTransition())return!0;if(zb(this._source.type))for(const t in this._tiles){const l=this._tiles[t];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=Mi.now())return!0}return!1}setFeatureState(t,l,u){this._state.updateState(t=t||"_geojsonTileLayer",l,u)}removeFeatureState(t,l,u){this._state.removeFeatureState(t=t||"_geojsonTileLayer",l,u)}getFeatureState(t,l){return this._state.getState(t=t||"_geojsonTileLayer",l)}setDependencies(t,l,u){const d=this._tiles[t];d&&d.setDependencies(l,u)}reloadTilesForDependencies(t,l){for(const u in this._tiles)this._tiles[u].hasDependency(t,l)&&this._reloadTile(+u,"reloading");this._cache.filter(u=>!u.hasDependency(t,l))}_preloadTiles(t,l){const u=new Map,d=Array.isArray(t)?t:[t],p=this.map.painter.terrain,y=this.usedForTerrain&&p?p.getScaledDemTileSize():this._source.tileSize;for(const C of d){const D=C.coveringTiles({tileSize:y,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const R of D)u.set(R.key,R);this.usedForTerrain&&C.updateElevation(!1)}const b=Array.from(u.values()),S=this._source.type==="raster"||this._source.type==="raster-dem";Ue(b,(C,D)=>{const R=new w0(C,this._source.tileSize*C.overscaleFactor(),this.transform.tileZoom,this.map.painter,S);this._loadTile(R,z=>{this._source.type==="raster-dem"&&R.dem&&this._backfillDEM(R),D(z,R)})},l)}}function Rb(i,t){const l=Math.abs(2*i.wrap)-+(i.wrap<0),u=Math.abs(2*t.wrap)-+(t.wrap<0);return i.overscaledZ-t.overscaledZ||u-l||t.canonical.y-i.canonical.y||t.canonical.x-i.canonical.x}function zb(i){return i==="raster"||i==="image"||i==="video"}cc.maxOverzooming=10,cc.maxUnderzooming=3;class pm{constructor(t,l,u){this._demTile=t,this._dem=this._demTile.dem,this._scale=l,this._offset=u}static create(t,l,u){const d=u||t.findDEMTileFor(l);if(!d||!d.dem)return;const p=d.dem,y=d.tileID,b=1<<l.canonical.z-y.canonical.z;return new pm(d,d.tileSize/ln/b,[(l.canonical.x/b-y.canonical.x)*p.dim,(l.canonical.y/b-y.canonical.y)*p.dim])}tileCoordToPixel(t,l){const u=l*this._scale+this._offset[1],d=Math.floor(t*this._scale+this._offset[0]),p=Math.floor(u);return new I(d,p)}getElevationAt(t,l,u,d){const p=t*this._scale+this._offset[0],y=l*this._scale+this._offset[1],b=Math.floor(p),S=Math.floor(y),C=this._dem;return d=!!d,u?In(In(C.get(b,S,d),C.get(b,S+1,d),y-S),In(C.get(b+1,S,d),C.get(b+1,S+1,d),y-S),p-b):C.get(b,S,d)}getElevationAtPixel(t,l,u){return this._dem.get(t,l,!!u)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*os(1,t)*this._dem.stride}}class Ob{constructor(t,l){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new ec(ln,16,0),this.featureIndexArray=new o1,this.promoteId=l}insert(t,l,u,d,p,y=0){const b=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,d,p,y);const S=this.grid;for(let C=0;C<l.length;C++){const D=l[C],R=[1/0,1/0,-1/0,-1/0];for(let z=0;z<D.length;z++){const U=D[z];R[0]=Math.min(R[0],U.x),R[1]=Math.min(R[1],U.y),R[2]=Math.max(R[2],U.x),R[3]=Math.max(R[3],U.y)}R[0]<ln&&R[1]<ln&&R[2]>=0&&R[3]>=0&&S.insert(b,R[0],R[1],R[2],R[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new lc.VectorTile(new Pf(this.rawTileData)).layers,this.sourceLayerCoder=new Tb(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,l,u,d){this.loadVTLayers();const p=t.params||{},y=Eu(p.filter),b=t.tileResult,S=t.transform,C=b.bufferedTilespaceBounds,D=this.grid.query(C.min.x,C.min.y,C.max.x,C.max.y,(G,H,K,re)=>w1(b.bufferedTilespaceGeometry,G,H,K,re));D.sort(Fk);let R=null;S.elevation&&D.length>0&&(R=pm.create(S.elevation,this.tileID));const z={};let U;for(let G=0;G<D.length;G++){const H=D[G];if(H===U)continue;U=H;const K=this.featureIndexArray.get(H);let re=null;this.loadMatchingFeature(z,K,y,p.layers,p.availableImages,l,u,d,(he,ye,Ee,Se=0)=>(re||(re=sa(he,this.tileID.canonical,t.tileTransform)),ye.queryIntersectsFeature(b,he,Ee,re,this.z,t.transform,t.pixelPosMatrix,R,Se)))}return z}loadMatchingFeature(t,l,u,d,p,y,b,S,C){const{featureIndex:D,bucketIndex:R,sourceLayerIndex:z,layoutVertexArrayOffset:U}=l,G=this.bucketLayerIDs[R];if(d&&!function(he,ye){for(let Ee=0;Ee<he.length;Ee++)if(ye.indexOf(he[Ee])>=0)return!0;return!1}(d,G))return;const H=this.sourceLayerCoder.decode(z),K=this.vtLayers[H].feature(D);if(u.needGeometry){const he=ac(K,!0);if(!u.filter(new Wt(this.tileID.overscaledZ),he,this.tileID.canonical))return}else if(!u.filter(new Wt(this.tileID.overscaledZ),K))return;const re=this.getId(K,H);for(let he=0;he<G.length;he++){const ye=G[he];if(d&&d.indexOf(ye)<0)continue;const Ee=y[ye];if(!Ee)continue;let Se={};re!==void 0&&S&&(Se=S.getState(Ee.sourceLayer||"_geojsonTileLayer",re));const Ae=mt({},b[ye]);Ae.paint=Lb(Ae.paint,Ee.paint,K,Se,p),Ae.layout=Lb(Ae.layout,Ee.layout,K,Se,p);const Ge=!C||C(K,Ee,Se,U);if(!Ge)continue;const $e=new Eb(K,this.z,this.x,this.y,re);$e.layer=Ae;let dt=t[ye];dt===void 0&&(dt=t[ye]=[]),dt.push({featureIndex:D,feature:$e,intersectionZ:Ge})}}lookupSymbolFeatures(t,l,u,d,p,y,b,S){const C={};this.loadVTLayers();const D=Eu(p);for(const R of t)this.loadMatchingFeature(C,{bucketIndex:u,sourceLayerIndex:d,featureIndex:R,layoutVertexArrayOffset:0},D,y,b,S,l);return C}loadFeature(t){const{featureIndex:l,sourceLayerIndex:u}=t;this.loadVTLayers();const d=this.sourceLayerCoder.decode(u),p=this.vtFeatures[d];if(p[l])return p[l];const y=this.vtLayers[d].feature(l);return p[l]=y,y}hasLayer(t){for(const l of this.bucketLayerIDs)for(const u of l)if(t===u)return!0;return!1}getId(t,l){let u=t.id;return this.promoteId&&(u=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[l]],typeof u=="boolean"&&(u=Number(u))),u}}function Lb(i,t,l,u,d){return io(i,(p,y)=>{const b=t instanceof ea?t.get(y):null;return b&&b.evaluate?b.evaluate(l,u,d):b})}function Fk(i,t){return t-i}Ct("FeatureIndex",Ob,{omit:["rawTileData","sourceLayerCoder"]});var Bk=ar([{name:"a_pos",type:"Int16",components:2}]);const zo=32,zs=33,Xa=new Uint16Array(8184);for(let i=0;i<2046;i++){let t=i+2,l=0,u=0,d=0,p=0,y=0,b=0;for(1&t?d=p=y=zo:l=u=b=zo;(t>>=1)>1;){const C=l+d>>1,D=u+p>>1;1&t?(d=l,p=u,l=y,u=b):(l=d,u=p,d=y,p=b),y=C,b=D}const S=4*i;Xa[S+0]=l,Xa[S+1]=u,Xa[S+2]=d,Xa[S+3]=p}const Os=new Uint16Array(2178),Ka=new Uint8Array(1089),mm=new Uint16Array(1089);function Fb(i){return i===0?-.03125:i===32?.03125:0}var b0=ar([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Bb={type:2,extent:ln,loadGeometry:()=>[[new I(0,0),new I(8193,0),new I(8193,8193),new I(0,8193),new I(0,0)]]};class w0{constructor(t,l,u,d,p){this.tileID=t,this.uid=Qt(),this.uses=0,this.tileSize=l,this.tileZoom=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=p,this.expiredRequestCount=0,this.state="loading",d&&d.transform&&(this.projection=d.transform.projection)}registerFadeDuration(t){const l=t+this.timeAdded;l<Mi.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=qu(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,l,u){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(d,p){const y={};if(!p)return y;for(const b of d){const S=b.layerIds.map(C=>p.getLayer(C)).filter(Boolean);if(S.length!==0){b.layers=S,b.stateDependentLayerIds&&(b.stateDependentLayers=b.stateDependentLayerIds.map(C=>S.filter(D=>D.id===C)[0]));for(const C of S)y[C.id]=b}}return y}(t.buckets,l.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const p=this.buckets[d];if(p instanceof Wa){if(this.hasSymbolBuckets=!0,!u)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const p=this.buckets[d];if(p instanceof Wa&&p.hasRTLText){this.hasRTLText=!0,gn.isLoading()||gn.isLoaded()||Vi()!=="deferred"||uo();break}}this.queryPadding=0;for(const d in this.buckets){const p=this.buckets[d];this.queryPadding=Math.max(this.queryPadding,l.style.getLayer(d).queryRadius(p))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas)}else this.collisionBoxArray=new zg}unloadVectorData(){if(this.hasData()){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugIndexBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this.globeGridBuffer&&(this.globeGridBuffer.destroy(),this.globeGridBuffer=null),this.globePoleBuffer&&(this.globePoleBuffer.destroy(),this.globePoleBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(t){return this.buckets[t.id]}upload(t){for(const u in this.buckets){const d=this.buckets[u];d.uploadPending()&&d.upload(t)}const l=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new hm(t,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new hm(t,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new hm(t,this.lineAtlas.image,l.ALPHA),this.lineAtlas.uploaded=!0)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,l,u,d,p,y,b,S){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:d,pixelPosMatrix:b,transform:y,params:p,tileTransform:this.tileTransform},t,l,u):{}}querySourceFeatures(t,l){const u=this.latestFeatureIndex;if(!u||!u.rawTileData)return;const d=u.loadVTLayers(),p=l?l.sourceLayer:"",y=d._geojsonTileLayer||d[p];if(!y)return;const b=Eu(l&&l.filter),{z:S,x:C,y:D}=this.tileID.canonical,R={z:S,x:C,y:D};for(let z=0;z<y.length;z++){const U=y.feature(z);if(b.needGeometry){const K=ac(U,!0);if(!b.filter(new Wt(this.tileID.overscaledZ),K,this.tileID.canonical))continue}else if(!b.filter(new Wt(this.tileID.overscaledZ),U))continue;const G=u.getId(U,p),H=new Eb(U,S,C,D,G);H.tile=R,t.push(H)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const l=this.expirationTime;if(t.cacheControl){const u=Ta(t.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const u=Date.now();let d=!1;if(this.expirationTime>u)d=!1;else if(l)if(this.expirationTime<l)d=!0;else{const p=this.expirationTime-l;p?this.expirationTime=u+Math.max(p,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,l){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0||!l)return;const u=this.latestFeatureIndex.loadVTLayers(),d=l.style.listImages();for(const p in this.buckets){if(!l.style.hasLayer(p))continue;const y=this.buckets[p],b=y.layers[0].sourceLayer||"_geojsonTileLayer",S=u[b],C=t[b];if(!S||!C||Object.keys(C).length===0)continue;if(y.update(C,S,d,this.imageAtlas&&this.imageAtlas.patternPositions||{}),y instanceof em||y instanceof Jp){const R=l.style._getSourceCache(y.layers[0].source);l._terrain&&l._terrain.enabled&&R&&y.programConfigurations.needsUpload&&l._terrain._clearRenderCacheForTile(R.id,this.tileID)}const D=l&&l.style&&l.style.getLayer(p);D&&(this.queryPadding=Math.max(this.queryPadding,D.queryRadius(y)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Mi.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=Mi.now()+t}setDependencies(t,l){const u={};for(const d of l)u[d]=!0;this.dependencies[t]=u}hasDependency(t,l){for(const u of t){const d=this.dependencies[u];if(d){for(const p of l)if(d[p])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,l){if(!l||l.name==="mercator"||this._tileDebugBuffer)return;const u=sa(Bb,this.tileID.canonical,this.tileTransform)[0],d=new Iu,p=new Up;for(let y=0;y<u.length;y++){const{x:b,y:S}=u[y];d.emplaceBack(b,S),p.emplaceBack(y)}p.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(p),this._tileDebugBuffer=t.createVertexBuffer(d,b0.members),this._tileDebugSegments=vr.simpleSegment(0,0,d.length,p.length)}_makeTileBoundsBuffers(t,l){if(this._tileBoundsBuffer||!l||l.name==="mercator")return;const u=sa(Bb,this.tileID.canonical,this.tileTransform)[0];let d,p;if(this.isRaster){const y=function(b,S){const C=qu(b,S),D=Math.pow(2,b.z);for(let K=0;K<zs;K++)for(let re=0;re<zs;re++){const he=oa((b.x+(re+Fb(re))/zo)/D),ye=Ro((b.y+(K+Fb(K))/zo)/D),Ee=S.project(he,ye),Se=K*zs+re;Os[2*Se+0]=Math.round((Ee.x*C.scale-C.x)*ln),Os[2*Se+1]=Math.round((Ee.y*C.scale-C.y)*ln)}Ka.fill(0),mm.fill(0);for(let K=2045;K>=0;K--){const re=4*K,he=Xa[re+0],ye=Xa[re+1],Ee=Xa[re+2],Se=Xa[re+3],Ae=he+Ee>>1,Ge=ye+Se>>1,$e=Ae+Ge-ye,dt=Ge+he-Ae,lt=ye*zs+he,Ve=Se*zs+Ee,ct=Ge*zs+Ae,gt=Math.hypot((Os[2*lt+0]+Os[2*Ve+0])/2-Os[2*ct+0],(Os[2*lt+1]+Os[2*Ve+1])/2-Os[2*ct+1])>=16;if(Ka[ct]=Ka[ct]||(gt?1:0),K<1022){const Xe=(ye+dt>>1)*zs+(he+$e>>1),wt=(Se+dt>>1)*zs+(Ee+$e>>1);Ka[ct]=Ka[ct]||Ka[Xe]||Ka[wt]}}const R=new Mu,z=new ho;let U=0;function G(K,re){const he=re*zs+K;return mm[he]===0&&(R.emplaceBack(Os[2*he+0],Os[2*he+1],K*ln/zo,re*ln/zo),mm[he]=++U),mm[he]-1}function H(K,re,he,ye,Ee,Se){const Ae=K+he>>1,Ge=re+ye>>1;if(Math.abs(K-Ee)+Math.abs(re-Se)>1&&Ka[Ge*zs+Ae])H(Ee,Se,K,re,Ae,Ge),H(he,ye,Ee,Se,Ae,Ge);else{const $e=G(K,re),dt=G(he,ye),lt=G(Ee,Se);z.emplaceBack($e,dt,lt)}}return H(0,0,zo,zo,zo,0),H(zo,zo,0,0,0,zo),{vertices:R,indices:z}}(this.tileID.canonical,l);d=y.vertices,p=y.indices}else{d=new Mu,p=new ho;for(const{x:b,y:S}of u)d.emplaceBack(b,S,0,0);const y=Hp(d.int16,void 0,4);for(let b=0;b<y.length;b+=3)p.emplaceBack(y[b],y[b+1],y[b+2])}this._tileBoundsBuffer=t.createVertexBuffer(d,b0.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(p),this._tileBoundsSegments=vr.simpleSegment(0,0,d.length,p.length)}}const Uk=ar([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_merc_pos",components:2},{type:"Float32",name:"a_uv",components:2}]),Nk=ar([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Ub}=Uk;function uc(i,t){const l=i.fovAboveCenter,u=i.elevation?i.elevation.getMinElevationBelowMSL()*t:0,d=(i._camera.position[2]*i.worldSize-u)/Math.cos(i._pitch),p=Math.sin(l)*d/Math.sin(Math.max(Math.PI/2-i._pitch-l,.01)),y=Math.sin(i._pitch)*p+d;return Math.min(1.01*y,d*(1/i._horizonShift))}const T0=ln/Math.PI/2,Gi=-T0,qi=T0,jk=[new ss([Gi,Gi,Gi],[qi,qi,qi]),new ss([Gi,Gi,Gi],[0,0,qi]),new ss([0,Gi,Gi],[qi,0,qi]),new ss([Gi,0,Gi],[0,qi,qi]),new ss([0,0,Gi],[qi,qi,qi])];function _m(i){if(i.z<=1)return jk[i.z+2*i.y+i.x];const[t,l]=Nb(i),u=[gm(t[0],t[1]),gm(t[0],l[1]),gm(l[0],t[1]),gm(l[0],l[1])],d=[qi,qi,qi],p=[Gi,Gi,Gi];for(const y of u)d[0]=Math.min(d[0],y[0]),d[1]=Math.min(d[1],y[1]),d[2]=Math.min(d[2],y[2]),p[0]=Math.max(p[0],y[0]),p[1]=Math.max(p[1],y[1]),p[2]=Math.max(p[2],y[2]);return new ss(d,p)}function Nb(i){const t=Math.pow(2,i.z),l=i.x/t,u=(i.x+1)/t,d=(i.y+1)/t;return[[Ro(i.y/t),oa(l)],[Ro(d),oa(u)]]}function E0(i,t,l,u){return l=_e(l),u||(u=T0),[i*Math.sin(l)*u,-t*u,i*Math.cos(l)*u]}function gm(i,t,l){return E0(Math.cos(_e(i)),Math.sin(_e(i)),t,l)}function jb(i){return 16383/Math.max(..._r([],i.max,i.min))}function $b(i){const t=V(new Float64Array(16)),l=1/jb(i);return oe(t,t,i.min),pe(t,t,[l,l,l]),t}function Vb(i,t,l){const u=t/(2*Math.PI),d=function(y){const b=ln/(2*Math.PI);return y/(2*Math.PI)/b}(t);if(!l){const y=Ye(i.center.lat,-85.051129,Ps);l=[Du(i.center.lng)*t,Ru(y)*t]}const p=V(new Float64Array(16));return oe(p,p,[l[0],l[1],-u]),pe(p,p,[d,d,d]),se(p,p,_e(-i._center.lat)),xe(p,p,_e(-i._center.lng)),p}class S0{constructor(t){const l=this._createGridIndices();this.gridIndexBuffer=t.createIndexBuffer(l,!0),this.gridSegments=vr.simpleSegment(0,0,4225,8192);const u=this._createPoleTriangleIndices();this.poleIndexBuffer=t.createIndexBuffer(u,!0),this.poleSegments=vr.simpleSegment(0,0,66,64);const d=new bf;d.emplaceBack(-1,1,1,0,0,0,0),d.emplaceBack(1,1,1,0,0,1,0),d.emplaceBack(1,-1,1,0,0,1,1),d.emplaceBack(-1,-1,1,0,0,0,1);const p=new ho;p.emplaceBack(0,1,2),p.emplaceBack(2,3,0),this.atmosphereVertexBuffer=t.createVertexBuffer(d,Nk.members),this.atmosphereIndexBuffer=t.createIndexBuffer(p),this.atmosphereSegments=vr.simpleSegment(0,0,4,2)}destroy(){this.poleIndexBuffer.destroy(),this.gridIndexBuffer.destroy(),this.poleSegments.destroy(),this.gridSegments.destroy(),this.atmosphereVertexBuffer.destroy(),this.atmosphereIndexBuffer.destroy(),this.atmosphereSegments.destroy(),this.wireframeIndexBuffer&&(this.wireframeIndexBuffer.destroy(),this.wireframeSegments.destroy())}static createPoleTriangleVertices(t,l,u){const d=new bf,p=l/Math.PI/2;d.emplaceBack(0,-p,0,0,0,.5,u?0:1);const y=360/t,b=Math.cos(_e(85)),S=Math.sin(_e(85));for(let D=0;D<=64;D++){const R=D/64,z=E0(b,S,0*(1-(C=R))+y*C,p);d.emplaceBack(z[0],z[1],z[2],0,0,R,u?0:1)}var C;return d}_createPoleTriangleIndices(){const t=new ho;for(let l=0;l<=64;l++)t.emplaceBack(0,l+1,l+2);return t}static createGridVertices(t){const l=Math.pow(2,t.z),u=(S,C,D)=>S*(1-D)+C*D,[d,p]=Nb(t),y=new bf,b=function(S){const C=V(new Float64Array(16)),D=jb(S);var R,z;return pe(C,C,[D,D,D]),oe(C,C,((R=[])[0]=-(z=S.min)[0],R[1]=-z[1],R[2]=-z[2],R)),C}(_m(t));y.reserve(4096);for(let S=0;S<65;S++){const C=u(d[0],p[0],S/64),D=Ru(C),R=D*l-t.y,z=Math.sin(_e(C)),U=Math.cos(_e(C));for(let G=0;G<65;G++){const H=G/64,K=u(d[1],p[1],H),re=E0(U,z,K);Ot(re,re,b);const he=Du(K);y.emplaceBack(re[0],re[1],re[2],he,D,H,R)}}return y}_createGridIndices(){const t=new ho,l=(u,d)=>{const p=65*d+u;t.emplaceBack(p+1,p,p+65),t.emplaceBack(p+65,p+65+1,p+1)};for(let u=0;u<64;u++)for(let d=0;d<64;d++)l(d,u);return t}getWirefameBuffer(t){if(!this.wireframeSegments){const l=this._createWireframeGrid();this.wireframeIndexBuffer=t.createIndexBuffer(l),this.wireframeSegments=vr.simpleSegment(0,0,4096,l.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}_createWireframeGrid(){const t=new $a,l=(u,d)=>{const p=65*d+u;t.emplaceBack(p,p+1),t.emplaceBack(p,p+65),t.emplaceBack(p,p+65+1)};for(let u=0;u<64;u++)for(let d=0;d<64;d++)l(d,u);return t}}function qu(i,t){if(!t.isReprojectedInTileSpace)return{scale:1<<i.z,x:i.x,y:i.y,x2:i.x+1,y2:i.y+1,projection:t};const l=Math.pow(2,-i.z),u=i.x*l,d=(i.x+1)*l,p=i.y*l,y=(i.y+1)*l,b=oa(u),S=oa(d),C=Ro(p),D=Ro(y),R=t.project(b,C),z=t.project(S,C),U=t.project(S,D),G=t.project(b,D);let H=Math.min(R.x,z.x,U.x,G.x),K=Math.min(R.y,z.y,U.y,G.y),re=Math.max(R.x,z.x,U.x,G.x),he=Math.max(R.y,z.y,U.y,G.y);const ye=l/16;function Ee(Ae,Ge,$e,dt,lt,Ve){const ct=($e+lt)/2,gt=(dt+Ve)/2,Xe=t.project(oa(ct),Ro(gt)),wt=Math.max(0,H-Xe.x,K-Xe.y,Xe.x-re,Xe.y-he);H=Math.min(H,Xe.x),re=Math.max(re,Xe.x),K=Math.min(K,Xe.y),he=Math.max(he,Xe.y),wt>ye&&(Ee(Ae,Xe,$e,dt,ct,gt),Ee(Xe,Ge,ct,gt,lt,Ve))}Ee(R,z,u,p,d,p),Ee(z,U,d,p,d,y),Ee(U,G,d,y,u,y),Ee(G,R,u,y,u,p),H-=ye,K-=ye,re+=ye,he+=ye;const Se=1/Math.max(re-H,he-K);return{scale:Se,x:H*Se,y:K*Se,x2:re*Se,y2:he*Se,projection:t}}class Gb{constructor(t){const l={},u=[];for(const b in t){const S=t[b],C=l[b]={};for(const D in S.glyphs){const R=S.glyphs[+D];if(!R||R.bitmap.width===0||R.bitmap.height===0)continue;const z=R.metrics.localGlyph?2:1,U={x:0,y:0,w:R.bitmap.width+2*z,h:R.bitmap.height+2*z};u.push(U),C[D]=U}}const{w:d,h:p}=t0(u),y=new Ga({width:d||1,height:p||1});for(const b in t){const S=t[b];for(const C in S.glyphs){const D=S.glyphs[+C];if(!D||D.bitmap.width===0||D.bitmap.height===0)continue;const R=l[b][C],z=D.metrics.localGlyph?2:1;Ga.copy(D.bitmap,y,{x:0,y:0},{x:R.x+z,y:R.y+z},D.bitmap)}}this.image=y,this.positions=l}}Ct("GlyphAtlas",Gb);class $k{constructor(t){this.tileID=new Ri(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.enableTerrain=!!t.enableTerrain,this.isSymbolTile=t.isSymbolTile,this.tileTransform=qu(t.tileID.canonical,t.projection),this.projection=t.projection}parse(t,l,u,d,p){this.status="parsing",this.data=t,this.collisionBoxArray=new zg;const y=new Tb(Object.keys(t.layers).sort()),b=new Ob(this.tileID,this.promoteId);b.bucketLayerIDs=[];const S={},C=new m0(256,256),D={featureIndex:b,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:C,availableImages:u},R=l.familiesBySource[this.source];for(const Se in R){const Ae=t.layers[Se];if(!Ae)continue;let Ge=!1,$e=!1;for(const Ve of R[Se])Ve[0].type==="symbol"?Ge=!0:$e=!0;if(this.isSymbolTile===!0&&!Ge||this.isSymbolTile===!1&&!$e)continue;Ae.version===1&&wn(`Vector tile source "${this.source}" layer "${Se}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const dt=y.encode(Se),lt=[];for(let Ve=0;Ve<Ae.length;Ve++){const ct=Ae.feature(Ve),gt=b.getId(ct,Se);lt.push({feature:ct,id:gt,index:Ve,sourceLayerIndex:dt})}for(const Ve of R[Se]){const ct=Ve[0];this.isSymbolTile!==void 0&&ct.type==="symbol"!==this.isSymbolTile||ct.minzoom&&this.zoom<Math.floor(ct.minzoom)||ct.maxzoom&&this.zoom>=ct.maxzoom||ct.visibility!=="none"&&(A0(Ve,this.zoom,u),(S[ct.id]=ct.createBucket({index:b.bucketLayerIDs.length,layers:Ve,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:dt,sourceID:this.source,enableTerrain:this.enableTerrain,availableImages:u})).populate(lt,D,this.tileID.canonical,this.tileTransform),b.bucketLayerIDs.push(Ve.map(gt=>gt.id)))}}let z,U,G,H;C.trim();const K={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},re=io(D.glyphDependencies,Se=>Object.keys(Se).map(Number));Object.keys(re).length?d.send("getGlyphs",{uid:this.uid,stacks:re},(Se,Ae)=>{z||(z=Se,U=Ae,Ee.call(this))},void 0,!1,K):U={};const he=Object.keys(D.iconDependencies);he.length?d.send("getImages",{icons:he,source:this.source,tileID:this.tileID,type:"icons"},(Se,Ae)=>{z||(z=Se,G=Ae,Ee.call(this))},void 0,!1,K):G={};const ye=Object.keys(D.patternDependencies);function Ee(){if(z)return p(z);if(U&&G&&H){const Se=new Gb(U),Ae=new K1(G,H);for(const Ge in S){const $e=S[Ge];$e instanceof Wa?(A0($e.layers,this.zoom,u),xk($e,U,Se.positions,G,Ae.iconPositions,this.showCollisionBoxes,u,this.tileID.canonical,this.tileZoom,this.projection),$e.projection=this.projection.name):$e.hasPattern&&($e instanceof em||$e instanceof Jp||$e instanceof Qg)&&(A0($e.layers,this.zoom,u),$e.addFeatures(D,this.tileID.canonical,Ae.patternPositions,u))}this.status="done",p(null,{buckets:At(S).filter(Ge=>!Ge.isEmpty()),featureIndex:b,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Se.image,lineAtlas:C,imageAtlas:Ae,glyphMap:this.returnDependencies?U:null,iconMap:this.returnDependencies?G:null,glyphPositions:this.returnDependencies?Se.positions:null})}}ye.length?d.send("getImages",{icons:ye,source:this.source,tileID:this.tileID,type:"patterns"},(Se,Ae)=>{z||(z=Se,H=Ae,Ee.call(this))},void 0,!1,K):H={},Ee.call(this)}}function A0(i,t,l){const u=new Wt(t);for(const d of i)d.recalculate(u,l)}class qb{constructor(t){this.entries={},this.scheduler=t}request(t,l,u,d){const p=this.entries[t]=this.entries[t]||{callbacks:[]};if(p.result){const[y,b]=p.result;return this.scheduler?this.scheduler.add(()=>{d(y,b)},l):d(y,b),()=>{}}return p.callbacks.push(d),p.cancel||(p.cancel=u((y,b)=>{p.result=[y,b];for(const S of p.callbacks)this.scheduler?this.scheduler.add(()=>{S(y,b)},l):S(y,b);setTimeout(()=>delete this.entries[t],3e3)})),()=>{p.result||(p.callbacks=p.callbacks.filter(y=>y!==d),p.callbacks.length||(p.cancel(),delete this.entries[t]))}}}function Zb(i,t,l){const u=JSON.stringify(i.request);return i.data&&(this.deduped.entries[u]={result:[null,i.data]}),this.deduped.request(u,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom},d=>{const p=Dl(i.request,(y,b,S,C)=>{y?d(y):b&&d(null,{vectorTile:l?void 0:new lc.VectorTile(new Pf(b)),rawData:b,cacheControl:S,expires:C})});return()=>{p.cancel(),d()}},t)}const Vk=V(new Float64Array(16));class hc{constructor(t,l){this._tr=t,this._worldSize=l}createInversionMatrix(){return Vk}createTileMatrix(t){let l,u,d;const p=t.canonical,y=V(new Float64Array(16)),b=this._tr.projection;if(b.isReprojectedInTileSpace){const S=qu(p,b);l=1,u=S.x+t.wrap*S.scale,d=S.y,pe(y,y,[l/S.scale,l/S.scale,this._tr.pixelsPerMeter/this._worldSize])}else l=this._worldSize/this._tr.zoomScale(p.z),u=(p.x+Math.pow(2,p.z)*t.wrap)*l,d=p.y*l;return oe(y,y,[u,d,0]),pe(y,y,[l/ln,l/ln,1]),y}pointCoordinate(t,l,u){const d=this._tr.horizonLineFromTop(!1),p=new I(t,Math.max(d,l));return this._tr.rayIntersectionCoordinate(this._tr.pointRayIntersection(p,u))}upVector(){return[0,0,1]}upVectorScale(){return 1}}var Gk={name:"albers",range:[4,7],center:[-96,37.5],parallels:[29.5,45.5],zAxisUnit:"meters",conic:!0,isReprojectedInTileSpace:!0,unsupportedLayers:["custom"],initializeConstants(){if(this.constants&&Kt(this.parallels,this.constants.parallels))return;const i=Math.sin(_e(this.parallels[0])),t=(i+Math.sin(_e(this.parallels[1])))/2,l=1+i*(2*t-i),u=Math.sqrt(l)/t;this.constants={n:t,c:l,r0:u,parallels:this.parallels}},project(i,t){this.initializeConstants();const l=_e(i-this.center[0]),u=_e(t),{n:d,c:p,r0:y}=this.constants,b=Math.sqrt(p-2*d*Math.sin(u))/d;return{x:b*Math.sin(l*d),y:b*Math.cos(l*d)-y,z:0}},unproject(i,t){this.initializeConstants();const{n:l,c:u,r0:d}=this.constants,p=d+t;let y=Math.atan2(i,Math.abs(p))*Math.sign(p);p*l<0&&(y-=Math.PI*Math.sign(i)*Math.sign(p));const b=_e(this.center[0])*l;y=we(y,-Math.PI-b,Math.PI-b);const S=Oe(y/l)+this.center[0],C=Math.asin(Ye((u-(i*i+p*p)*l*l)/(2*l),-1,1)),D=Ye(Oe(C),-85.051129,Ps);return new Fn(S,D)},projectTilePoint:(i,t)=>({x:i,y:t,z:0}),locationPoint:(i,t)=>i._coordinatePoint(i.locationCoordinate(t),!1),pixelsPerMeter:(i,t)=>os(1,i)*t,farthestPixelDistance(i){return uc(i,this.pixelsPerMeter(i.center.lat,i.worldSize))},createTileTransform:(i,t)=>new hc(i,t)};const Of=1.340264,Lf=-.081106,Ff=893e-6,Bf=.003796,ym=Math.sqrt(3)/2;var qk={name:"equalEarth",center:[0,0],range:[3.5,7],zAxisUnit:"meters",isReprojectedInTileSpace:!0,unsupportedLayers:["custom"],project(i,t){t=t/180*Math.PI,i=i/180*Math.PI;const l=Math.asin(ym*Math.sin(t)),u=l*l,d=u*u*u;return{x:.5*(i*Math.cos(l)/(ym*(Of+3*Lf*u+d*(7*Ff+9*Bf*u)))/Math.PI+.5),y:1-.5*(l*(Of+Lf*u+d*(Ff+Bf*u))/Math.PI+1),z:0}},unproject(i,t){i=(2*i-.5)*Math.PI;let l=t=(2*(1-t)-1)*Math.PI,u=l*l,d=u*u*u;for(let C,D,R,z=0;z<12&&(D=l*(Of+Lf*u+d*(Ff+Bf*u))-t,R=Of+3*Lf*u+d*(7*Ff+9*Bf*u),C=D/R,l=Ye(l-C,-Math.PI/3,Math.PI/3),u=l*l,d=u*u*u,!(Math.abs(C)<1e-12));++z);const p=ym*i*(Of+3*Lf*u+d*(7*Ff+9*Bf*u))/Math.cos(l),y=Math.asin(Math.sin(l)/ym),b=Ye(180*p/Math.PI,-180,180),S=Ye(180*y/Math.PI,-85.051129,Ps);return new Fn(b,S)},projectTilePoint:(i,t)=>({x:i,y:t,z:0}),locationPoint:(i,t)=>i._coordinatePoint(i.locationCoordinate(t),!1),pixelsPerMeter:(i,t)=>os(1,i)*t,farthestPixelDistance(i){return uc(i,this.pixelsPerMeter(i.center.lat,i.worldSize))},createTileTransform:(i,t)=>new hc(i,t)},Zk={name:"equirectangular",supportsWorldCopies:!0,center:[0,0],range:[3.5,7],zAxisUnit:"meters",wrap:!0,isReprojectedInTileSpace:!0,unsupportedLayers:["custom"],project:(i,t)=>({x:.5+i/360,y:.5-t/360,z:0}),unproject(i,t){const l=360*(i-.5),u=Ye(360*(.5-t),-85.051129,Ps);return new Fn(l,u)},projectTilePoint:(i,t)=>({x:i,y:t,z:0}),locationPoint:(i,t)=>i._coordinatePoint(i.locationCoordinate(t),!1),pixelsPerMeter:(i,t)=>os(1,i)*t,farthestPixelDistance(i){return uc(i,this.pixelsPerMeter(i.center.lat,i.worldSize))},createTileTransform:(i,t)=>new hc(i,t)};const Zu=Math.PI/2;function vm(i){return Math.tan((Zu+i)/2)}var Wk={name:"lambertConformalConic",range:[3.5,7],zAxisUnit:"meters",center:[0,30],parallels:[30,30],conic:!0,isReprojectedInTileSpace:!0,unsupportedLayers:["custom"],initializeConstants(){if(this.constants&&Kt(this.parallels,this.constants.parallels))return;const i=_e(this.parallels[0]),t=_e(this.parallels[1]),l=Math.cos(i),u=i===t?Math.sin(i):Math.log(l/Math.cos(t))/Math.log(vm(t)/vm(i)),d=l*Math.pow(vm(i),u)/u;this.constants={n:u,f:d,parallels:this.parallels}},project(i,t){this.initializeConstants(),t=_e(t),i=_e(i-this.center[0]);const l=1e-6,{n:u,f:d}=this.constants;d>0?t<-Zu+l&&(t=-Zu+l):t>Zu-l&&(t=Zu-l);const p=d/Math.pow(vm(t),u),y=p*Math.sin(u*i),b=d-p*Math.cos(u*i);return{x:.5*(y/Math.PI+.5),y:1-.5*(b/Math.PI+.5),z:0}},unproject(i,t){this.initializeConstants(),i=(2*i-.5)*Math.PI,t=(2*(1-t)-.5)*Math.PI;const{n:l,f:u}=this.constants,d=u-t,p=Math.sign(d),y=Math.sign(l)*Math.sqrt(i*i+d*d);let b=Math.atan2(i,Math.abs(d))*p;d*l<0&&(b-=Math.PI*Math.sign(i)*p);const S=Ye(Oe(b/l)+this.center[0],-180,180),C=Ye(Oe(2*Math.atan(Math.pow(u/y,1/l))-Zu),-85.051129,Ps);return new Fn(S,C)},projectTilePoint:(i,t)=>({x:i,y:t,z:0}),locationPoint:(i,t)=>i._coordinatePoint(i.locationCoordinate(t),!1),pixelsPerMeter:(i,t)=>os(1,i)*t,farthestPixelDistance(i){return uc(i,this.pixelsPerMeter(i.center.lat,i.worldSize))},createTileTransform:(i,t)=>new hc(i,t)},Hk={name:"mercator",wrap:!0,requiresDraping:!1,supportsWorldCopies:!0,supportsTerrain:!0,supportsFog:!0,supportsFreeCamera:!0,zAxisUnit:"meters",center:[0,0],project:(i,t)=>({x:Du(i),y:Ru(t),z:0}),unproject(i,t){const l=oa(i),u=Ro(t);return new Fn(l,u)},projectTilePoint:(i,t)=>({x:i,y:t,z:0}),locationPoint:(i,t)=>i._coordinatePoint(i.locationCoordinate(t),!1),pixelsPerMeter:(i,t)=>os(1,i)*t,farthestPixelDistance(i){return uc(i,this.pixelsPerMeter(i.center.lat,i.worldSize))},createTileTransform:(i,t)=>new hc(i,t)};const Wb=_e(Ps);var Xk={name:"naturalEarth",center:[0,0],range:[3.5,7],isReprojectedInTileSpace:!0,zAxisUnit:"meters",unsupportedLayers:["custom"],project(i,t){const l=(t=_e(t))*t,u=l*l;return{x:.5*((i=_e(i))*(.8707-.131979*l+u*(u*(.003971*l-.001529*u)-.013791))/Math.PI+.5),y:1-.5*(t*(1.007226+l*(.015085+u*(.028874*l-.044475-.005916*u)))/Math.PI+1),z:0}},unproject(i,t){i=(2*i-.5)*Math.PI;let l=t=(2*(1-t)-1)*Math.PI,u=25,d=0,p=l*l;do{p=l*l;const S=p*p;d=(l*(1.007226+p*(.015085+S*(.028874*p-.044475-.005916*S)))-t)/(1.007226+p*(.045255+S*(.259866*p-.311325-.005916*11*S))),l=Ye(l-d,-Wb,Wb)}while(Math.abs(d)>1e-6&&--u>0);p=l*l;const y=Ye(Oe(i/(.8707+p*(p*(p*p*p*(.003971-.001529*p)-.013791)-.131979))),-180,180),b=Oe(l);return new Fn(y,b)},projectTilePoint:(i,t)=>({x:i,y:t,z:0}),locationPoint:(i,t)=>i._coordinatePoint(i.locationCoordinate(t),!1),pixelsPerMeter:(i,t)=>os(1,i)*t,farthestPixelDistance(i){return uc(i,this.pixelsPerMeter(i.center.lat,i.worldSize))},createTileTransform:(i,t)=>new hc(i,t)};const Hb=_e(Ps),Xb={albers:Gk,equalEarth:qk,equirectangular:Zk,lambertConformalConic:Wk,mercator:Hk,naturalEarth:Xk,winkelTripel:{name:"winkelTripel",center:[0,0],range:[3.5,7],zAxisUnit:"meters",isReprojectedInTileSpace:!0,unsupportedLayers:["custom"],project(i,t){t=_e(t),i=_e(i);const l=Math.cos(t),u=2/Math.PI,d=Math.acos(l*Math.cos(i/2)),p=Math.sin(d)/d,y=.5*(i*u+2*l*Math.sin(i/2)/p)||0,b=.5*(t+Math.sin(t)/p)||0;return{x:.5*(y/Math.PI+.5),y:1-.5*(b/Math.PI+1),z:0}},unproject(i,t){let l=i=(2*i-.5)*Math.PI,u=t=(2*(1-t)-1)*Math.PI,d=25;const p=1e-6;let y=0,b=0;do{const S=Math.cos(u),C=Math.sin(u),D=2*C*S,R=C*C,z=S*S,U=Math.cos(l/2),G=Math.sin(l/2),H=2*U*G,K=G*G,re=1-z*U*U,he=re?1/re:0,ye=re?Math.acos(S*U)*Math.sqrt(1/re):0,Ee=.5*(2*ye*S*G+2*l/Math.PI)-i,Se=.5*(ye*C+u)-t,Ae=.5*he*(z*K+ye*S*U*R)+1/Math.PI,Ge=he*(H*D/4-ye*C*G),$e=.125*he*(D*G-ye*C*z*H),dt=.5*he*(R*U+ye*K*S)+.5,lt=Ge*$e-dt*Ae;y=(Se*Ge-Ee*dt)/lt,b=(Ee*$e-Se*Ae)/lt,l=Ye(l-y,-Math.PI,Math.PI),u=Ye(u-b,-Hb,Hb)}while((Math.abs(y)>p||Math.abs(b)>p)&&--d>0);return new Fn(Oe(l),Oe(u))},projectTilePoint:(i,t)=>({x:i,y:t,z:0}),locationPoint:(i,t)=>i._coordinatePoint(i.locationCoordinate(t),!1),pixelsPerMeter:(i,t)=>os(1,i)*t,farthestPixelDistance(i){return uc(i,this.pixelsPerMeter(i.center.lat,i.worldSize))},createTileTransform:(i,t)=>new hc(i,t)}};a.ARRAY_TYPE=N,a.AUTH_ERR_MSG=Pe,a.Aabb=ss,a.Actor=class{constructor(i,t,l){this.target=i,this.parent=t,this.mapId=l,this.callbacks={},this.cancelCallbacks={},Dr(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=So()?i:P,this.scheduler=new zk}send(i,t,l,u,d=!1,p){const y=Math.round(1e18*Math.random()).toString(36).substring(0,10);l&&(l.metadata=p,this.callbacks[y]=l);const b=Ao(this.globalScope)?void 0:[];return this.target.postMessage({id:y,type:i,hasCallback:!!l,targetMapId:u,mustQueue:d,sourceMapId:this.mapId,data:rc(t,b)},b),{cancel:()=>{l&&delete this.callbacks[y],this.target.postMessage({id:y,type:"<cancel>",targetMapId:u,sourceMapId:this.mapId})}}}receive(i){const t=i.data,l=t.id;if(l&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){const u=this.cancelCallbacks[l];delete this.cancelCallbacks[l],u&&u.cancel()}else if(t.mustQueue||So()){const u=this.callbacks[l];this.cancelCallbacks[l]=this.scheduler.add(()=>this.processTask(l,t),u&&u.metadata||{type:"message"})}else this.processTask(l,t)}processTask(i,t){if(t.type==="<response>"){const l=this.callbacks[i];delete this.callbacks[i],l&&(t.error?l(Ms(t.error)):l(null,Ms(t.data)))}else{const l=Ao(this.globalScope)?void 0:[],u=t.hasCallback?(p,y)=>{delete this.cancelCallbacks[i],this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:p?rc(p):null,data:rc(y,l)},l)}:p=>{},d=Ms(t.data);if(this.parent[t.type])this.parent[t.type](t.sourceMapId,d,u);else if(this.parent.getWorkerSource){const p=t.type.split(".");this.parent.getWorkerSource(t.sourceMapId,p[0],d.source)[p[1]](d,u)}else u(new Error(`Could not find function ${t.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.CanonicalTileID=fm,a.Color=xn,a.ColorMode=Rs,a.CullFaceMode=as,a.DEMData=dm,a.DataConstantProperty=Mt,a.DedupedRequest=qb,a.DepthMode=Gu,a.EXTENT=ln,a.Elevation=class{getAtPointOrZero(i,t=0){return this.getAtPoint(i,t)||0}getAtPoint(i,t,l=!0){t==null&&(t=null);const u=this._source();if(!u||i.y<0||i.y>1)return t;const d=u.getSource().maxzoom,p=1<<d,y=Math.floor(i.x),b=i.x-y,S=new Ri(d,y,d,Math.floor(b*p),Math.floor(i.y*p)),C=this.findDEMTileFor(S);if(!C||!C.dem)return t;const D=C.dem,R=1<<C.tileID.canonical.z,z=(b*R-C.tileID.canonical.x)*D.dim,U=(i.y*R-C.tileID.canonical.y)*D.dim,G=Math.floor(z),H=Math.floor(U);return(l?this.exaggeration():1)*In(In(D.get(G,H),D.get(G,H+1),U-H),In(D.get(G+1,H),D.get(G+1,H+1),U-H),z-G)}getAtTileOffset(i,t,l){const u=1<<i.canonical.z;return this.getAtPointOrZero(new qp(i.wrap+(i.canonical.x+t/ln)/u,(i.canonical.y+l/ln)/u))}getAtTileOffsetFunc(i,t){return l=>{const u=this.getAtTileOffset(i,l.x,l.y),d=t.upVector(i.canonical,l.x,l.y);return Ke(d,d,u*t.upVectorScale(i.canonical)),d}}getForTilePoints(i,t,l,u){const d=pm.create(this,i,u);return!!d&&(t.forEach(p=>{p[2]=this.exaggeration()*d.getElevationAt(p[0],p[1],l)}),!0)}getMinMaxForTile(i){const t=this.findDEMTileFor(i);if(!t||!t.dem)return null;const l=t.dem.tree,u=t.tileID,d=1<<i.canonical.z-u.canonical.z;let p=i.canonical.x/d-u.canonical.x,y=i.canonical.y/d-u.canonical.y,b=0;for(let S=0;S<i.canonical.z-u.canonical.z&&!l.leaves[b];S++){p*=2,y*=2;const C=2*Math.floor(y)+Math.floor(p);b=l.childOffsets[b]+C,p%=1,y%=1}return{min:this.exaggeration()*l.minimums[b],max:this.exaggeration()*l.maximums[b]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(i,t,l){throw new Error("Pure virtual method called.")}pointCoordinate(i){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(i){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},a.ErrorEvent=Kc,a.EvaluationParameters=Wt,a.Event=vs,a.Evented=xs,a.Frustum=$g,a.GLOBE_ZOOM_THRESHOLD_MAX=6,a.GlobeSharedBuffers=S0,a.GlyphManager=$u,a.ImagePosition=n0,a.LineAtlas=m0,a.LngLat=Fn,a.LngLatBounds=sc,a.LocalGlyphMode=s0,a.MAX_MERCATOR_LATITUDE=Ps,a.MercatorCoordinate=qp,a.ONE_EM=Kr,a.OverscaledTileID=Ri,a.Properties=Zr,a.RGBAImage=fo,a.Ray=class{constructor(i,t){this.pos=i,this.dir=t}intersectsPlane(i,t,l){const u=Tt(t,this.dir);if(Math.abs(u)<1e-6)return!1;const d=((i[0]-this.pos[0])*t[0]+(i[1]-this.pos[1])*t[1]+(i[2]-this.pos[2])*t[2])/u;return l[0]=this.pos[0]+this.dir[0]*d,l[1]=this.pos[1]+this.dir[1]*d,l[2]=this.pos[2]+this.dir[2]*d,!0}closestPointOnSphere(i,t,l){if(function(z,U){var G=z[0],H=z[1],K=z[2],re=U[0],he=U[1],ye=U[2];return Math.abs(G-re)<=j*Math.max(1,Math.abs(G),Math.abs(re))&&Math.abs(H-he)<=j*Math.max(1,Math.abs(H),Math.abs(he))&&Math.abs(K-ye)<=j*Math.max(1,Math.abs(K),Math.abs(ye))}(this.pos,i)||t===0)return l[0]=l[1]=l[2]=0,!1;const[u,d,p]=this.dir,y=this.pos[0]-i[0],b=this.pos[1]-i[1],S=this.pos[2]-i[2],C=u*u+d*d+p*p,D=2*(y*u+b*d+S*p),R=D*D-4*C*(y*y+b*b+S*S-t*t);if(R<0){const z=Math.max(-D/2,0),U=y+u*z,G=b+d*z,H=S+p*z,K=Math.hypot(U,G,H);return l[0]=U*t/K,l[1]=G*t/K,l[2]=H*t/K,!1}{const z=(-D-Math.sqrt(R))/(2*C);if(z<0){const U=Math.hypot(y,b,S);return l[0]=y*t/U,l[1]=b*t/U,l[2]=S*t/U,!1}return l[0]=y+u*z,l[1]=b+d*z,l[2]=S+p*z,!0}}},a.RequestManager=class{constructor(i,t,l){this._transformRequestFn=i,this._customAccessToken=t,this._silenceAuthErrors=!!l,this._createSkuToken()}_createSkuToken(){const i=function(){let t="";for(let l=0;l<10;l++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ve,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=i.token,this._skuTokenExpiresAt=i.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(i,t){return this._transformRequestFn&&this._transformRequestFn(i,t)||{url:i}}normalizeStyleURL(i,t){if(!Ze(i))return i;const l=Rt(i);return l.path=`/styles/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||t)}normalizeGlyphsURL(i,t){if(!Ze(i))return i;const l=Rt(i);return l.path=`/fonts/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||t)}normalizeSourceURL(i,t){if(!Ze(i))return i;const l=Rt(i);return l.path=`/v4/${l.authority}.json`,l.params.push("secure"),this._makeAPIURL(l,this._customAccessToken||t)}normalizeSpriteURL(i,t,l,u){const d=Rt(i);return Ze(i)?(d.path=`/styles/v1${d.path}/sprite${t}${l}`,this._makeAPIURL(d,this._customAccessToken||u)):(d.path+=`${t}${l}`,Ut(d))}normalizeTileURL(i,t,l){if(this._isSkuTokenExpired()&&this._createSkuToken(),i&&!Ze(i))return i;const u=Rt(i);u.path=u.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${t||l&&u.authority!=="raster"&&l===512?"@2x":""}${Z.supported?".webp":"$1"}`),u.authority==="raster"?u.path=`/${B.RASTER_URL_PREFIX}${u.path}`:(u.path=u.path.replace(/^.+\/v4\//,"/"),u.path=`/${B.TILE_URL_VERSION}${u.path}`);const d=this._customAccessToken||function(p){for(const y of p){const b=y.match(/^access_token=(.*)$/);if(b)return b[1]}return null}(u.params)||B.ACCESS_TOKEN;return B.REQUIRE_ACCESS_TOKEN&&d&&this._skuToken&&u.params.push(`sku=${this._skuToken}`),this._makeAPIURL(u,d)}canonicalizeTileURL(i,t){const l=Rt(i);if(!l.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!l.path.match(/\.[\w]+$/))return i;let u="mapbox://";l.path.match(/^\/raster\/v1\//)?u+=`raster/${l.path.replace(`/${B.RASTER_URL_PREFIX}/`,"")}`:u+=`tiles/${l.path.replace(`/${B.TILE_URL_VERSION}/`,"")}`;let d=l.params;return t&&(d=d.filter(p=>!p.match(/^access_token=/))),d.length&&(u+=`?${d.join("&")}`),u}canonicalizeTileset(i,t){const l=!!t&&Ze(t),u=[];for(const d of i.tiles||[])He(d)?u.push(this.canonicalizeTileURL(d,l)):u.push(d);return u}_makeAPIURL(i,t){const l="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",u=Rt(B.API_URL);if(i.protocol=u.protocol,i.authority=u.authority,i.protocol==="http"){const d=i.params.indexOf("secure");d>=0&&i.params.splice(d,1)}if(u.path!=="/"&&(i.path=`${u.path}${i.path}`),!B.REQUIRE_ACCESS_TOKEN)return Ut(i);if(t=t||B.ACCESS_TOKEN,!this._silenceAuthErrors){if(!t)throw new Error(`An API access token is required to use Mapbox GL. ${l}`);if(t[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${l}`)}return i.params=i.params.filter(d=>d.indexOf("access_token")===-1),i.params.push(`access_token=${t||""}`),Ut(i)}},a.ResourceType=Hc,a.SegmentVector=vr,a.SourceCache=cc,a.StencilMode=y0,a.StructArrayLayout1ui2=Up,a.StructArrayLayout2f1f2i16=Cg,a.StructArrayLayout2i4=Iu,a.StructArrayLayout2ui4=$a,a.StructArrayLayout3f12=ku,a.StructArrayLayout3ui6=ho,a.StructArrayLayout4i8=Mu,a.Texture=hm,a.Tile=w0,a.Transitionable=Pi,a.Uniform1f=Vp,a.Uniform1i=class extends na{constructor(i,t){super(i,t),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},a.Uniform2f=class extends na{constructor(i,t){super(i,t),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},a.Uniform3f=class extends na{constructor(i,t){super(i,t),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},a.Uniform4f=u1,a.UniformColor=h1,a.UniformMatrix2f=class extends na{constructor(i,t){super(i,t),this.current=NI}set(i){for(let t=0;t<4;t++)if(i[t]!==this.current[t]){this.current=i,this.gl.uniformMatrix2fv(this.location,!1,i);break}}},a.UniformMatrix3f=class extends na{constructor(i,t){super(i,t),this.current=UI}set(i){for(let t=0;t<9;t++)if(i[t]!==this.current[t]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}},a.UniformMatrix4f=class extends na{constructor(i,t){super(i,t),this.current=BI}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let t=1;t<16;t++)if(i[t]!==this.current[t]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},a.UnwrappedTileID=_0,a.ValidationError=bt,a.VectorTileWorkerSource=class extends xs{constructor(i,t,l,u,d){super(),this.actor=i,this.layerIndex=t,this.availableImages=l,this.loadVectorData=d||Zb,this.loading={},this.loaded={},this.deduped=new qb(i.scheduler),this.isSpriteLoaded=u,this.scheduler=i.scheduler}loadTile(i,t){const l=i.uid,u=i&&i.request,d=u&&u.collectResourceTiming,p=this.loading[l]=new $k(i);p.abort=this.loadVectorData(i,(y,b)=>{const S=!this.loading[l];if(delete this.loading[l],S||y||!b)return p.status="done",S||(this.loaded[l]=p),t(y);const C=b.rawData,D={};b.expires&&(D.expires=b.expires),b.cacheControl&&(D.cacheControl=b.cacheControl),p.vectorTile=b.vectorTile||new lc.VectorTile(new Pf(C));const R=()=>{p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,(z,U)=>{if(z||!U)return t(z);const G={};if(d){const H=bb(u);H.length>0&&(G.resourceTiming=JSON.parse(JSON.stringify(H)))}t(null,mt({rawTileData:C.slice(0)},U,D,G))})};this.isSpriteLoaded?R():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(R,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom}):R()}),this.loaded=this.loaded||{},this.loaded[l]=p})}reloadTile(i,t){const l=this.loaded,u=i.uid,d=this;if(l&&l[u]){const p=l[u];p.showCollisionBoxes=i.showCollisionBoxes,p.enableTerrain=!!i.enableTerrain,p.projection=i.projection;const y=(b,S)=>{const C=p.reloadCallback;C&&(delete p.reloadCallback,p.parse(p.vectorTile,d.layerIndex,this.availableImages,d.actor,C)),t(b,S)};p.status==="parsing"?p.reloadCallback=y:p.status==="done"&&(p.vectorTile?p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,y):y())}}abortTile(i,t){const l=i.uid,u=this.loading[l];u&&(u.abort&&u.abort(),delete this.loading[l]),t()}removeTile(i,t){const l=this.loaded,u=i.uid;l&&l[u]&&delete l[u],t()}},a.WritingMode=po,a.ZoomHistory=_,a.add=Fe,a.addDynamicAttributes=u0,a.adjoint=function(i,t){var l=t[0],u=t[1],d=t[2],p=t[3],y=t[4],b=t[5],S=t[6],C=t[7],D=t[8];return i[0]=y*D-b*C,i[1]=d*C-u*D,i[2]=u*b-d*y,i[3]=b*S-p*D,i[4]=l*D-d*S,i[5]=d*p-l*b,i[6]=p*C-y*S,i[7]=u*S-l*C,i[8]=l*y-u*p,i},a.asyncAll=Ue,a.bezier=vt,a.bindAll=Dr,a.boundsAttributes=b0,a.bufferConvexPolygon=function(i,t){const l=[];for(let u=0;u<i.length;u++){const d=we(u-1,-1,i.length-1),p=we(u+1,-1,i.length-1),y=i[u],b=i[p],S=i[d].sub(y).unit(),C=b.sub(y).unit(),D=C.angleWithSep(S.x,S.y),R=S.add(C).unit().mult(-1*t/Math.sin(D/2));l.push(y.add(R))}return l},a.cacheEntryPossiblyAdded=function(i){Wc++,Wc>$h&&(i.getActor().send("enforceCacheSizeLimit",Yd),Wc=0)},a.calculateGlobeMatrix=Vb,a.calculateGlobeMercatorMatrix=function(i){const t=i.worldSize,l=Ye(i.center.lat,-85.051129,Ps),u=new I(Du(i.center.lng)*t,Ru(l)*t),d=os(1,i.center.lat)*t,p=i.pixelsPerMeter,y=t/(d/i.pixelsPerMeter),b=V(new Float64Array(16));return oe(b,b,[u.x,u.y,0]),pe(b,b,[y,y,p]),b},a.clamp=Ye,a.clearTileCache=function(i){const t=P.caches.delete(Gr);i&&t.catch(i).then(()=>i())},a.clipLine=lb,a.clone=function(i){var t=new N(16);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],t},a.clone$1=si,a.collisionCircleLayout=ZM,a.config=B,a.conjugate=function(i,t){return i[0]=-t[0],i[1]=-t[1],i[2]=-t[2],i[3]=t[3],i},a.create=function(){var i=new N(16);return N!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},a.create$1=q,a.createExpression=Kl,a.createLayout=ar,a.createStyleLayer=function(i){return i.type==="custom"?new Mk(i):new Pk[i.type](i)},a.cross=Dn,a.degToRad=_e,a.div=function(i,t,l){return i[0]=t[0]/l[0],i[1]=t[1]/l[1],i[2]=t[2]/l[2],i},a.dot=Tt,a.ease=St,a.easeCubicInOut=ot,a.emitValidationErrors=zp,a.endsWith=Ii,a.enforceCacheSizeLimit=function(i){kl(),Co&&Co.then(t=>{t.keys().then(l=>{for(let u=0;u<l.length-i;u++)t.delete(l[u])})})},a.evaluateSizeForFeature=tm,a.evaluateSizeForZoom=Bu,a.evaluateVariableOffset=db,a.evented=xi,a.exactEquals=function(i,t){return i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]&&i[3]===t[3]},a.exactEquals$1=function(i,t){return i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]},a.exported=Mi,a.exported$1=Z,a.extend=mt,a.extend$1=bs,a.filterObject=Bi,a.fromMat4=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[4],i[4]=t[5],i[5]=t[6],i[6]=t[8],i[7]=t[9],i[8]=t[10],i},a.fromQuat=function(i,t){var l=t[0],u=t[1],d=t[2],p=t[3],y=l+l,b=u+u,S=d+d,C=l*y,D=u*y,R=u*b,z=d*y,U=d*b,G=d*S,H=p*y,K=p*b,re=p*S;return i[0]=1-R-G,i[1]=D+re,i[2]=z-K,i[3]=0,i[4]=D-re,i[5]=1-C-G,i[6]=U+H,i[7]=0,i[8]=z+K,i[9]=U-H,i[10]=1-C-R,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},a.fromRotation=function(i,t){var l=Math.sin(t),u=Math.cos(t);return i[0]=u,i[1]=l,i[2]=0,i[3]=-l,i[4]=u,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},a.fromScaling=function(i,t){return i[0]=t[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=t[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=t[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},a.furthestTileCorner=function(i){const t=Math.round((i+45+360)%360/90)%4;return rt[t]},a.getAABBPointSquareDist=function(i,t,l){let u=0;for(let d=0;d<2;++d){const p=l?l[d]:0;i[d]>p&&(u+=(i[d]-p)*(i[d]-p)),t[d]<p&&(u+=(p-t[d])*(p-t[d]))}return u},a.getAnchorAlignment=o0,a.getAnchorJustification=l0,a.getBounds=function(i){let t=1/0,l=1/0,u=-1/0,d=-1/0;for(const p of i)t=Math.min(t,p.x),l=Math.min(l,p.y),u=Math.max(u,p.x),d=Math.max(d,p.y);return{min:new I(t,l),max:new I(u,d)}},a.getColumn=function(i,t){return[i[4*t],i[4*t+1],i[4*t+2],i[4*t+3]]},a.getImage=Jd,a.getJSON=function(i,t){return so(mt(i,{type:"json"}),t)},a.getMapSessionAPI=ys,a.getPerformanceMeasurement=bb,a.getProjection=function(i){const t=Xb[i.name];if(!t)throw new Error(`Invalid projection name: ${i.name}`);return t.conic?function(l,u){if(u.parallels&&Math.abs(u.parallels[0]+u.parallels[1])<.01){let d=function(p){const y=Math.max(.01,Math.cos(_e(p))),b=1/(2*Math.max(Math.PI*y,1/y));return{wrap:!0,supportsWorldCopies:!0,unsupportedLayers:["custom"],project(S,C){const D=_e(S)*y,R=Math.sin(_e(C))/y;return{x:D*b+.5,y:-R*b+.5,z:0}},unproject(S,C){const D=-(C-.5)/b,R=Ye(Oe((S-.5)/b)/y,-180,180),z=Math.asin(Ye(D*y,-1,1)),U=Ye(Oe(z),-85.051129,Ps);return new Fn(R,U)}}}(u.parallels[0]);if(u.name==="lambertConformalConic"){const{project:p,unproject:y}=Xb.mercator;d={wrap:!0,supportsWorldCopies:!0,project:p,unproject:y}}return mt({},l,u,d)}return mt({},l,u)}(t,i):t},a.getRTLTextPluginStatus=Vi,a.getReferrer=Gh,a.getTilePoint=function(i,{x:t,y:l},u=0){return new I(((t-u)*i.scale-i.x)*ln,(l*i.scale-i.y)*ln)},a.getTileVec3=function(i,t,l=0){return ze(((t.x-l)*i.scale-i.x)*ln,(t.y*i.scale-i.y)*ln,_1(t.z,t.y))},a.getVideo=function(i,t){const l=P.document.createElement("video");l.muted=!0,l.onloadstart=function(){t(null,l)};for(let u=0;u<i.length;u++){const d=P.document.createElement("source");Qd(i[u])||(l.crossOrigin="Anonymous"),d.src=i[u],l.appendChild(d)}return{cancel:()=>{}}},a.globeBuffersForTileMesh=function(i,t,l,u){const d=i.context,p=i.transform;let y=t.globeGridBuffer,b=t.globePoleBuffer;if(!y){const S=S0.createGridVertices(l.canonical);y=t.globeGridBuffer=d.createVertexBuffer(S,Ub,!1)}if(!b){const S=S0.createPoleTriangleVertices(u,p.tileSize*u,l.canonical.y===0);b=t.globePoleBuffer=d.createVertexBuffer(S,Ub,!1)}return[y,b]},a.globeDenormalizeECEF=$b,a.globeMatrixForTile=function(i,t){const l=$b(_m(i)),u=((d=new Float64Array(16))[0]=(p=t)[0],d[1]=p[1],d[2]=p[2],d[3]=p[3],d[4]=p[4],d[5]=p[5],d[6]=p[6],d[7]=p[7],d[8]=p[8],d[9]=p[9],d[10]=p[10],d[11]=p[11],d[12]=p[12],d[13]=p[13],d[14]=p[14],d[15]=p[15],d);var d,p;return Te(u,u,l),u},a.globePoleMatrixForTile=function(i,t,l){const u=V(new Float64Array(16)),d=Math.pow(2,i.z),p=(i.x-d/2)/d*Math.PI*2,y=l.point,b=l.worldSize/(l.tileSize*d);return oe(u,u,[y.x,y.y,-l.worldSize/Math.PI/2]),pe(u,u,[b,b,b]),se(u,u,_e(-l._center.lat)),xe(u,u,_e(-l._center.lng)),xe(u,u,p),t&&pe(u,u,[1,-1,1]),u},a.globeTileBounds=_m,a.globeToMercatorTransition=function(i){return at(5,6,i)},a.identity=V,a.identity$1=Tn,a.invert=function(i,t){var l=t[0],u=t[1],d=t[2],p=t[3],y=t[4],b=t[5],S=t[6],C=t[7],D=t[8],R=t[9],z=t[10],U=t[11],G=t[12],H=t[13],K=t[14],re=t[15],he=l*b-u*y,ye=l*S-d*y,Ee=l*C-p*y,Se=u*S-d*b,Ae=u*C-p*b,Ge=d*C-p*S,$e=D*H-R*G,dt=D*K-z*G,lt=D*re-U*G,Ve=R*K-z*H,ct=R*re-U*H,gt=z*re-U*K,Xe=he*gt-ye*ct+Ee*Ve+Se*lt-Ae*dt+Ge*$e;return Xe?(i[0]=(b*gt-S*ct+C*Ve)*(Xe=1/Xe),i[1]=(d*ct-u*gt-p*Ve)*Xe,i[2]=(H*Ge-K*Ae+re*Se)*Xe,i[3]=(z*Ae-R*Ge-U*Se)*Xe,i[4]=(S*lt-y*gt-C*dt)*Xe,i[5]=(l*gt-d*lt+p*dt)*Xe,i[6]=(K*Ee-G*Ge-re*ye)*Xe,i[7]=(D*Ge-z*Ee+U*ye)*Xe,i[8]=(y*ct-b*lt+C*$e)*Xe,i[9]=(u*lt-l*ct-p*$e)*Xe,i[10]=(G*Ae-H*Ee+re*he)*Xe,i[11]=(R*Ee-D*Ae-U*he)*Xe,i[12]=(b*dt-y*Ve-S*$e)*Xe,i[13]=(l*Ve-u*dt+d*$e)*Xe,i[14]=(H*ye-G*Se-K*he)*Xe,i[15]=(D*Se-R*ye+z*he)*Xe,i):null},a.isMapAuthenticated=function(i){return Qo.has(i)},a.isMapboxURL=Ze,a.latFromMercatorY=Ro,a.len=Dt,a.length=Be,a.length$1=function(i){return Math.hypot(i[0],i[1],i[2],i[3])},a.loadVectorTile=Zb,a.makeRequest=so,a.mercatorXfromLng=Du,a.mercatorYfromLat=Ru,a.mercatorZfromAltitude=os,a.mul=Te,a.mul$1=it,a.multiply=function(i,t,l){var u=t[0],d=t[1],p=t[2],y=t[3],b=t[4],S=t[5],C=t[6],D=t[7],R=t[8],z=l[0],U=l[1],G=l[2],H=l[3],K=l[4],re=l[5],he=l[6],ye=l[7],Ee=l[8];return i[0]=z*u+U*y+G*C,i[1]=z*d+U*b+G*D,i[2]=z*p+U*S+G*R,i[3]=H*u+K*y+re*C,i[4]=H*d+K*b+re*D,i[5]=H*p+K*S+re*R,i[6]=he*u+ye*y+Ee*C,i[7]=he*d+ye*b+Ee*D,i[8]=he*p+ye*S+Ee*R,i},a.multiply$1=ee,a.multiply$2=be,a.nextPowerOfTwo=tn,a.normalize=It,a.normalize$1=function(i,t){var l=t[0],u=t[1],d=t[2],p=t[3],y=l*l+u*u+d*d+p*p;return y>0&&(y=1/Math.sqrt(y)),i[0]=l*y,i[1]=u*y,i[2]=d*y,i[3]=p*y,i},a.number=In,a.ortho=function(i,t,l,u,d,p,y){var b=1/(t-l),S=1/(u-d),C=1/(p-y);return i[0]=-2*b,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*S,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*C,i[11]=0,i[12]=(t+l)*b,i[13]=(d+u)*S,i[14]=(y+p)*C,i[15]=1,i},a.pbf=Pf,a.perspective=function(i,t,l,u,d){var p,y=1/Math.tan(t/2);return i[0]=y/l,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=y,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,d!=null&&d!==1/0?(i[10]=(d+u)*(p=1/(u-d)),i[14]=2*d*u*p):(i[10]=-1,i[14]=-2*u),i},a.pick=function(i,t){const l={};for(let u=0;u<t.length;u++){const d=t[u];d in i&&(l[d]=i[d])}return l},a.plugin=gn,a.pointGeometry=I,a.polygonIntersectsBox=w1,a.polygonIntersectsPolygon=y1,a.polygonizeBounds=function(i,t,l=0,u=!0){const d=new I(l,l),p=i.sub(d),y=t.add(d),b=[p,new I(y.x,p.y),y,new I(p.x,y.y)];return u&&b.push(p),b},a.posAttributes=Bk,a.postMapLoadEvent=Nn,a.postTurnstileEvent=Gn,a.potpack=t0,a.prevPowerOfTwo=function(i){return i<=1?1:Math.pow(2,Math.floor(Math.log(i)/Math.LN2))},a.radToDeg=Oe,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.registerForPluginStateChange=function(i){return i({pluginStatus:qt,pluginURL:sn}),xi.on("pluginStateChange",i),i},a.removeAuthState=function(i){Qo.delete(i)},a.renderColorRamp=qg,a.rotateX=se,a.rotateX$1=Cn,a.rotateY=xe,a.rotateZ=function(i,t,l){var u=Math.sin(l),d=Math.cos(l),p=t[0],y=t[1],b=t[2],S=t[3],C=t[4],D=t[5],R=t[6],z=t[7];return t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=p*d+C*u,i[1]=y*d+D*u,i[2]=b*d+R*u,i[3]=S*d+z*u,i[4]=C*d-p*u,i[5]=D*d-y*u,i[6]=R*d-b*u,i[7]=z*d-S*u,i},a.rotateZ$1=function(i,t,l){l*=.5;var u=t[0],d=t[1],p=t[2],y=t[3],b=Math.sin(l),S=Math.cos(l);return i[0]=u*S+d*b,i[1]=d*S-u*b,i[2]=p*S+y*b,i[3]=y*S-p*b,i},a.scale=pe,a.scale$1=function(i,t,l){return i[0]=t[0]*l,i[1]=t[1]*l,i[2]=t[2]*l,i[3]=t[3]*l,i},a.scale$2=Ke,a.scaleAndAdd=_t,a.setCacheLimits=function(i,t){Yd=i,$h=t},a.setColumn=function(i,t,l){i[4*t+0]=l[0],i[4*t+1]=l[1],i[4*t+2]=l[2],i[4*t+3]=l[3]},a.setRTLTextPlugin=function(i,t,l=!1){if(qt===Ft||qt===Zt||qt===Pn)throw new Error("setRTLTextPlugin cannot be called multiple times.");sn=Mi.resolveURL(i),qt=Ft,jn=t,Er(),l||uo()},a.smoothstep=at,a.spec=Ne,a.storeAuthState=function(i,t){t?Qo.add(i):Qo.delete(i)},a.sub=_r,a.subtract=Je,a.symbolSize=WM,a.tileAABB=function(i,t,l,u,d,p,y,b,S){if(S.name==="globe"){const U=_m(new _0(p,new fm(l,u,d)).canonical).getCorners(),G=Number.MAX_VALUE,H=[-G,-G,-G],K=[G,G,G],re=Vb(i,t);for(let he=0;he<U.length;he++)Ot(U[he],U[he],re),D=K,R=U[he],(C=K)[0]=Math.min(D[0],R[0]),C[1]=Math.min(D[1],R[1]),C[2]=Math.min(D[2],R[2]),qe(H,H,U[he]);return new ss(K,H)}var C,D,R;const z=qu({z:l,x:u,y:d},S);return new ss([(p+z.x/z.scale)*t,t*(z.y/z.scale),y],[(p+z.x2/z.scale)*t,t*(z.y2/z.scale),b])},a.tileTransform=qu,a.transformMat3=function(i,t,l){var u=t[0],d=t[1],p=t[2];return i[0]=u*l[0]+d*l[3]+p*l[6],i[1]=u*l[1]+d*l[4]+p*l[7],i[2]=u*l[2]+d*l[5]+p*l[8],i},a.transformMat4=Ot,a.transformMat4$1=yt,a.transformQuat=Zn,a.translate=oe,a.transpose=function(i,t){if(i===t){var l=t[1],u=t[2],d=t[5];i[1]=t[3],i[2]=t[6],i[3]=l,i[5]=t[7],i[6]=u,i[7]=d}else i[0]=t[0],i[1]=t[3],i[2]=t[6],i[3]=t[1],i[4]=t[4],i[5]=t[7],i[6]=t[2],i[7]=t[5],i[8]=t[8];return i},a.triggerPluginCompletionEvent=Xn,a.uniqueId=Qt,a.validateCustomStyleLayer=function(i){const t=[],l=i.id;return l===void 0&&t.push({message:`layers.${l}: missing required property "id"`}),i.render===void 0&&t.push({message:`layers.${l}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&t.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),t},a.validateFog=bg,a.validateLight=Ba,a.validateStyle=Fa,a.values=At,a.vectorTile=lc,a.version=v,a.warnOnce=wn,a.window=P,a.wrap=we}),h(["./shared"],function(a){function v(ne){const B=typeof ne;if(B==="number"||B==="boolean"||B==="string"||ne==null)return JSON.stringify(ne);if(Array.isArray(ne)){let ie="[";for(const ge of ne)ie+=`${v(ge)},`;return`${ie}]`}const Z=Object.keys(ne).sort();let te="{";for(let ie=0;ie<Z.length;ie++)te+=`${JSON.stringify(Z[ie])}:${v(ne[Z[ie]])},`;return`${te}}`}function w(ne){let B="";for(const Z of a.refProperties)B+=`/${v(ne[Z])}`;return B}class E{constructor(B){this.keyCache={},B&&this.replace(B)}replace(B){this._layerConfigs={},this._layers={},this.update(B,[])}update(B,Z){for(const ie of B)this._layerConfigs[ie.id]=ie,(this._layers[ie.id]=a.createStyleLayer(ie)).compileFilter(),this.keyCache[ie.id]&&delete this.keyCache[ie.id];for(const ie of Z)delete this.keyCache[ie],delete this._layerConfigs[ie],delete this._layers[ie];this.familiesBySource={};const te=function(ie,ge){const Ce={};for(let ve=0;ve<ie.length;ve++){const Pe=ge&&ge[ie[ve].id]||w(ie[ve]);ge&&(ge[ie[ve].id]=Pe);let Ze=Ce[Pe];Ze||(Ze=Ce[Pe]=[]),Ze.push(ie[ve])}const Ie=[];for(const ve in Ce)Ie.push(Ce[ve]);return Ie}(a.values(this._layerConfigs),this.keyCache);for(const ie of te){const ge=ie.map(He=>this._layers[He.id]),Ce=ge[0];if(Ce.visibility==="none")continue;const Ie=Ce.source||"";let ve=this.familiesBySource[Ie];ve||(ve=this.familiesBySource[Ie]={});const Pe=Ce.sourceLayer||"_geojsonTileLayer";let Ze=ve[Pe];Ze||(Ze=ve[Pe]=[]),Ze.push(ge)}}}const{ImageBitmap:I}=a.window;class M{loadTile(B,Z){const{uid:te,encoding:ie,rawImageData:ge,padding:Ce,buildQuadTree:Ie}=B,ve=I&&ge instanceof I?this.getImageData(ge,Ce):ge;Z(null,new a.DEMData(te,ve,ie,Ce<1,Ie))}getImageData(B,Z){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(B.width,B.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=B.width,this.offscreenCanvas.height=B.height,this.offscreenCanvasContext.drawImage(B,0,0,B.width,B.height);const te=this.offscreenCanvasContext.getImageData(-Z,-Z,B.width+2*Z,B.height+2*Z);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:te.width,height:te.height},te.data)}}var P=function ne(B,Z){var te,ie=B&&B.type;if(ie==="FeatureCollection")for(te=0;te<B.features.length;te++)ne(B.features[te],Z);else if(ie==="GeometryCollection")for(te=0;te<B.geometries.length;te++)ne(B.geometries[te],Z);else if(ie==="Feature")ne(B.geometry,Z);else if(ie==="Polygon")j(B.coordinates,Z);else if(ie==="MultiPolygon")for(te=0;te<B.coordinates.length;te++)j(B.coordinates[te],Z);return B};function j(ne,B){if(ne.length!==0){N(ne[0],B);for(var Z=1;Z<ne.length;Z++)N(ne[Z],!B)}}function N(ne,B){for(var Z=0,te=0,ie=0,ge=ne.length,Ce=ge-1;ie<ge;Ce=ie++){var Ie=(ne[ie][0]-ne[Ce][0])*(ne[Ce][1]+ne[ie][1]),ve=Z+Ie;te+=Math.abs(Z)>=Math.abs(Ie)?Z-ve+Ie:Ie-ve+Z,Z=ve}Z+te>=0!=!!B&&ne.reverse()}const q=a.vectorTile.VectorTileFeature.prototype.toGeoJSON;class V{constructor(B){this._feature=B,this.extent=a.EXTENT,this.type=B.type,this.properties=B.tags,"id"in B&&!isNaN(B.id)&&(this.id=parseInt(B.id,10))}loadGeometry(){if(this._feature.type===1){const B=[];for(const Z of this._feature.geometry)B.push([new a.pointGeometry(Z[0],Z[1])]);return B}{const B=[];for(const Z of this._feature.geometry){const te=[];for(const ie of Z)te.push(new a.pointGeometry(ie[0],ie[1]));B.push(te)}return B}}toGeoJSON(B,Z,te){return q.call(this,B,Z,te)}}class ee{constructor(B){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=B.length,this._features=B}feature(B){return new V(this._features[B])}}var oe=a.vectorTile.VectorTileFeature,pe=se;function se(ne,B){this.options=B||{},this.features=ne,this.length=ne.length}function xe(ne,B){this.id=typeof ne.id=="number"?ne.id:void 0,this.type=ne.type,this.rawGeometry=ne.type===1?[ne.geometry]:ne.geometry,this.properties=ne.tags,this.extent=B||4096}se.prototype.feature=function(ne){return new xe(this.features[ne],this.options.extent)},xe.prototype.loadGeometry=function(){var ne=this.rawGeometry;this.geometry=[];for(var B=0;B<ne.length;B++){for(var Z=ne[B],te=[],ie=0;ie<Z.length;ie++)te.push(new a.pointGeometry(Z[ie][0],Z[ie][1]));this.geometry.push(te)}return this.geometry},xe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ne=this.geometry,B=1/0,Z=-1/0,te=1/0,ie=-1/0,ge=0;ge<ne.length;ge++)for(var Ce=ne[ge],Ie=0;Ie<Ce.length;Ie++){var ve=Ce[Ie];B=Math.min(B,ve.x),Z=Math.max(Z,ve.x),te=Math.min(te,ve.y),ie=Math.max(ie,ve.y)}return[B,te,Z,ie]},xe.prototype.toGeoJSON=oe.prototype.toGeoJSON;var Te=Me,De=pe;function Me(ne){var B=new a.pbf;return function(Z,te){for(var ie in Z.layers)te.writeMessage(3,Be,Z.layers[ie])}(ne,B),B.finish()}function Be(ne,B){var Z;B.writeVarintField(15,ne.version||1),B.writeStringField(1,ne.name||""),B.writeVarintField(5,ne.extent||4096);var te={keys:[],values:[],keycache:{},valuecache:{}};for(Z=0;Z<ne.length;Z++)te.feature=ne.feature(Z),B.writeMessage(2,ze,te);var ie=te.keys;for(Z=0;Z<ie.length;Z++)B.writeStringField(3,ie[Z]);var ge=te.values;for(Z=0;Z<ge.length;Z++)B.writeMessage(4,Ke,ge[Z])}function ze(ne,B){var Z=ne.feature;Z.id!==void 0&&B.writeVarintField(1,Z.id),B.writeMessage(2,Fe,ne),B.writeVarintField(3,Z.type),B.writeMessage(4,qe,Z)}function Fe(ne,B){var Z=ne.feature,te=ne.keys,ie=ne.values,ge=ne.keycache,Ce=ne.valuecache;for(var Ie in Z.properties){var ve=Z.properties[Ie],Pe=ge[Ie];if(ve!==null){Pe===void 0&&(te.push(Ie),ge[Ie]=Pe=te.length-1),B.writeVarint(Pe);var Ze=typeof ve;Ze!=="string"&&Ze!=="boolean"&&Ze!=="number"&&(ve=JSON.stringify(ve));var He=Ze+":"+ve,tt=Ce[He];tt===void 0&&(ie.push(ve),Ce[He]=tt=ie.length-1),B.writeVarint(tt)}}}function Je(ne,B){return(B<<3)+(7&ne)}function be(ne){return ne<<1^ne>>31}function qe(ne,B){for(var Z=ne.loadGeometry(),te=ne.type,ie=0,ge=0,Ce=Z.length,Ie=0;Ie<Ce;Ie++){var ve=Z[Ie],Pe=1;te===1&&(Pe=ve.length),B.writeVarint(Je(1,Pe));for(var Ze=te===3?ve.length-1:ve.length,He=0;He<Ze;He++){He===1&&te!==1&&B.writeVarint(Je(2,Ze-1));var tt=ve[He].x-ie,Rt=ve[He].y-ge;B.writeVarint(be(tt)),B.writeVarint(be(Rt)),ie+=tt,ge+=Rt}te===3&&B.writeVarint(Je(7,1))}}function Ke(ne,B){var Z=typeof ne;Z==="string"?B.writeStringField(1,ne):Z==="boolean"?B.writeBooleanField(7,ne):Z==="number"&&(ne%1!=0?B.writeDoubleField(3,ne):ne<0?B.writeSVarintField(6,ne):B.writeVarintField(5,ne))}function _t(ne,B,Z,te,ie,ge){if(ie-te<=Z)return;const Ce=te+ie>>1;It(ne,B,Ce,te,ie,ge%2),_t(ne,B,Z,te,Ce-1,ge+1),_t(ne,B,Z,Ce+1,ie,ge+1)}function It(ne,B,Z,te,ie,ge){for(;ie>te;){if(ie-te>600){const Pe=ie-te+1,Ze=Z-te+1,He=Math.log(Pe),tt=.5*Math.exp(2*He/3),Rt=.5*Math.sqrt(He*tt*(Pe-tt)/Pe)*(Ze-Pe/2<0?-1:1);It(ne,B,Z,Math.max(te,Math.floor(Z-Ze*tt/Pe+Rt)),Math.min(ie,Math.floor(Z+(Pe-Ze)*tt/Pe+Rt)),ge)}const Ce=B[2*Z+ge];let Ie=te,ve=ie;for(Tt(ne,B,te,Z),B[2*ie+ge]>Ce&&Tt(ne,B,te,ie);Ie<ve;){for(Tt(ne,B,Ie,ve),Ie++,ve--;B[2*Ie+ge]<Ce;)Ie++;for(;B[2*ve+ge]>Ce;)ve--}B[2*te+ge]===Ce?Tt(ne,B,te,ve):(ve++,Tt(ne,B,ve,ie)),ve<=Z&&(te=ve+1),Z<=ve&&(ie=ve-1)}}function Tt(ne,B,Z,te){Dn(ne,Z,te),Dn(B,2*Z,2*te),Dn(B,2*Z+1,2*te+1)}function Dn(ne,B,Z){const te=ne[B];ne[B]=ne[Z],ne[Z]=te}function Ot(ne,B,Z,te){const ie=ne-Z,ge=B-te;return ie*ie+ge*ge}Te.fromVectorTileJs=Me,Te.fromGeojsonVt=function(ne,B){B=B||{};var Z={};for(var te in ne)Z[te]=new pe(ne[te].features,B),Z[te].name=te,Z[te].version=B.version,Z[te].extent=B.extent;return Me({layers:Z})},Te.GeoJSONWrapper=De;const Zn=ne=>ne[0],Rn=ne=>ne[1];class _r{constructor(B,Z=Zn,te=Rn,ie=64,ge=Float64Array){this.nodeSize=ie,this.points=B;const Ce=B.length<65536?Uint16Array:Uint32Array,Ie=this.ids=new Ce(B.length),ve=this.coords=new ge(2*B.length);for(let Pe=0;Pe<B.length;Pe++)Ie[Pe]=Pe,ve[2*Pe]=Z(B[Pe]),ve[2*Pe+1]=te(B[Pe]);_t(Ie,ve,ie,0,Ie.length-1,0)}range(B,Z,te,ie){return function(ge,Ce,Ie,ve,Pe,Ze,He){const tt=[0,ge.length-1,0],Rt=[];let Ut,Nt;for(;tt.length;){const $t=tt.pop(),on=tt.pop(),Gn=tt.pop();if(on-Gn<=He){for(let Hn=Gn;Hn<=on;Hn++)Ut=Ce[2*Hn],Nt=Ce[2*Hn+1],Ut>=Ie&&Ut<=Pe&&Nt>=ve&&Nt<=Ze&&Rt.push(ge[Hn]);continue}const Wn=Math.floor((Gn+on)/2);Ut=Ce[2*Wn],Nt=Ce[2*Wn+1],Ut>=Ie&&Ut<=Pe&&Nt>=ve&&Nt<=Ze&&Rt.push(ge[Wn]);const Nn=($t+1)%2;($t===0?Ie<=Ut:ve<=Nt)&&(tt.push(Gn),tt.push(Wn-1),tt.push(Nn)),($t===0?Pe>=Ut:Ze>=Nt)&&(tt.push(Wn+1),tt.push(on),tt.push(Nn))}return Rt}(this.ids,this.coords,B,Z,te,ie,this.nodeSize)}within(B,Z,te){return function(ie,ge,Ce,Ie,ve,Pe){const Ze=[0,ie.length-1,0],He=[],tt=ve*ve;for(;Ze.length;){const Rt=Ze.pop(),Ut=Ze.pop(),Nt=Ze.pop();if(Ut-Nt<=Pe){for(let Nn=Nt;Nn<=Ut;Nn++)Ot(ge[2*Nn],ge[2*Nn+1],Ce,Ie)<=tt&&He.push(ie[Nn]);continue}const $t=Math.floor((Nt+Ut)/2),on=ge[2*$t],Gn=ge[2*$t+1];Ot(on,Gn,Ce,Ie)<=tt&&He.push(ie[$t]);const Wn=(Rt+1)%2;(Rt===0?Ce-ve<=on:Ie-ve<=Gn)&&(Ze.push(Nt),Ze.push($t-1),Ze.push(Wn)),(Rt===0?Ce+ve>=on:Ie+ve>=Gn)&&(Ze.push($t+1),Ze.push(Ut),Ze.push(Wn))}return He}(this.ids,this.coords,B,Z,te,this.nodeSize)}}const it={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ne=>ne},Dt=Math.fround||(yt=new Float32Array(1),ne=>(yt[0]=+ne,yt[0]));var yt;class Lt{constructor(B){this.options=rt(Object.create(it),B),this.trees=new Array(this.options.maxZoom+1)}load(B){const{log:Z,minZoom:te,maxZoom:ie,nodeSize:ge}=this.options;Z&&console.time("total time");const Ce=`prepare ${B.length} points`;Z&&console.time(Ce),this.points=B;let Ie=[];for(let ve=0;ve<B.length;ve++)B[ve].geometry&&Ie.push(Cn(B[ve],ve));this.trees[ie+1]=new _r(Ie,ot,vt,ge,Float32Array),Z&&console.timeEnd(Ce);for(let ve=ie;ve>=te;ve--){const Pe=+Date.now();Ie=this._cluster(Ie,ve),this.trees[ve]=new _r(Ie,ot,vt,ge,Float32Array),Z&&console.log("z%d: %d clusters in %dms",ve,Ie.length,+Date.now()-Pe)}return Z&&console.timeEnd("total time"),this}getClusters(B,Z){let te=((B[0]+180)%360+360)%360-180;const ie=Math.max(-90,Math.min(90,B[1]));let ge=B[2]===180?180:((B[2]+180)%360+360)%360-180;const Ce=Math.max(-90,Math.min(90,B[3]));if(B[2]-B[0]>=360)te=-180,ge=180;else if(te>ge){const Ze=this.getClusters([te,ie,180,Ce],Z),He=this.getClusters([-180,ie,ge,Ce],Z);return Ze.concat(He)}const Ie=this.trees[this._limitZoom(Z)],ve=Ie.range(fe(te),_e(Ce),fe(ge),_e(ie)),Pe=[];for(const Ze of ve){const He=Ie.points[Ze];Pe.push(He.numPoints?Kt(He):this.points[He.index])}return Pe}getChildren(B){const Z=this._getOriginId(B),te=this._getOriginZoom(B),ie="No cluster with the specified id.",ge=this.trees[te];if(!ge)throw new Error(ie);const Ce=ge.points[Z];if(!Ce)throw new Error(ie);const Ie=this.options.radius/(this.options.extent*Math.pow(2,te-1)),ve=ge.within(Ce.x,Ce.y,Ie),Pe=[];for(const Ze of ve){const He=ge.points[Ze];He.parentId===B&&Pe.push(He.numPoints?Kt(He):this.points[He.index])}if(Pe.length===0)throw new Error(ie);return Pe}getLeaves(B,Z,te){const ie=[];return this._appendLeaves(ie,B,Z=Z||10,te=te||0,0),ie}getTile(B,Z,te){const ie=this.trees[this._limitZoom(B)],ge=Math.pow(2,B),{extent:Ce,radius:Ie}=this.options,ve=Ie/Ce,Pe=(te-ve)/ge,Ze=(te+1+ve)/ge,He={features:[]};return this._addTileFeatures(ie.range((Z-ve)/ge,Pe,(Z+1+ve)/ge,Ze),ie.points,Z,te,ge,He),Z===0&&this._addTileFeatures(ie.range(1-ve/ge,Pe,1,Ze),ie.points,ge,te,ge,He),Z===ge-1&&this._addTileFeatures(ie.range(0,Pe,ve/ge,Ze),ie.points,-1,te,ge,He),He.features.length?He:null}getClusterExpansionZoom(B){let Z=this._getOriginZoom(B)-1;for(;Z<=this.options.maxZoom;){const te=this.getChildren(B);if(Z++,te.length!==1)break;B=te[0].properties.cluster_id}return Z}_appendLeaves(B,Z,te,ie,ge){const Ce=this.getChildren(Z);for(const Ie of Ce){const ve=Ie.properties;if(ve&&ve.cluster?ge+ve.point_count<=ie?ge+=ve.point_count:ge=this._appendLeaves(B,ve.cluster_id,te,ie,ge):ge<ie?ge++:B.push(Ie),B.length===te)break}return ge}_addTileFeatures(B,Z,te,ie,ge,Ce){for(const Ie of B){const ve=Z[Ie],Pe=ve.numPoints;let Ze,He,tt;if(Pe)Ze=Ht(ve),He=ve.x,tt=ve.y;else{const Nt=this.points[ve.index];Ze=Nt.properties,He=fe(Nt.geometry.coordinates[0]),tt=_e(Nt.geometry.coordinates[1])}const Rt={type:1,geometry:[[Math.round(this.options.extent*(He*ge-te)),Math.round(this.options.extent*(tt*ge-ie))]],tags:Ze};let Ut;Pe?Ut=ve.id:this.options.generateId?Ut=ve.index:this.points[ve.index].id&&(Ut=this.points[ve.index].id),Ut!==void 0&&(Rt.id=Ut),Ce.features.push(Rt)}}_limitZoom(B){return Math.max(this.options.minZoom,Math.min(+B,this.options.maxZoom+1))}_cluster(B,Z){const te=[],{radius:ie,extent:ge,reduce:Ce,minPoints:Ie}=this.options,ve=ie/(ge*Math.pow(2,Z));for(let Pe=0;Pe<B.length;Pe++){const Ze=B[Pe];if(Ze.zoom<=Z)continue;Ze.zoom=Z;const He=this.trees[Z+1],tt=He.within(Ze.x,Ze.y,ve),Rt=Ze.numPoints||1;let Ut=Rt;for(const Nt of tt){const $t=He.points[Nt];$t.zoom>Z&&(Ut+=$t.numPoints||1)}if(Ut>Rt&&Ut>=Ie){let Nt=Ze.x*Rt,$t=Ze.y*Rt,on=Ce&&Rt>1?this._map(Ze,!0):null;const Gn=(Pe<<5)+(Z+1)+this.points.length;for(const Wn of tt){const Nn=He.points[Wn];if(Nn.zoom<=Z)continue;Nn.zoom=Z;const Hn=Nn.numPoints||1;Nt+=Nn.x*Hn,$t+=Nn.y*Hn,Nn.parentId=Gn,Ce&&(on||(on=this._map(Ze,!0)),Ce(on,this._map(Nn)))}Ze.parentId=Gn,te.push(Tn(Nt/Ut,$t/Ut,Gn,Ut,on))}else if(te.push(Ze),Ut>1)for(const Nt of tt){const $t=He.points[Nt];$t.zoom<=Z||($t.zoom=Z,te.push($t))}}return te}_getOriginId(B){return B-this.points.length>>5}_getOriginZoom(B){return(B-this.points.length)%32}_map(B,Z){if(B.numPoints)return Z?rt({},B.properties):B.properties;const te=this.points[B.index].properties,ie=this.options.map(te);return Z&&ie===te?rt({},ie):ie}}function Tn(ne,B,Z,te,ie){return{x:Dt(ne),y:Dt(B),zoom:1/0,id:Z,parentId:-1,numPoints:te,properties:ie}}function Cn(ne,B){const[Z,te]=ne.geometry.coordinates;return{x:Dt(fe(Z)),y:Dt(_e(te)),zoom:1/0,index:B,parentId:-1}}function Kt(ne){return{type:"Feature",id:ne.id,properties:Ht(ne),geometry:{type:"Point",coordinates:[(B=ne.x,360*(B-.5)),Oe(ne.y)]}};var B}function Ht(ne){const B=ne.numPoints,Z=B>=1e4?`${Math.round(B/1e3)}k`:B>=1e3?Math.round(B/100)/10+"k":B;return rt(rt({},ne.properties),{cluster:!0,cluster_id:ne.id,point_count:B,point_count_abbreviated:Z})}function fe(ne){return ne/360+.5}function _e(ne){const B=Math.sin(ne*Math.PI/180),Z=.5-.25*Math.log((1+B)/(1-B))/Math.PI;return Z<0?0:Z>1?1:Z}function Oe(ne){const B=(180-360*ne)*Math.PI/180;return 360*Math.atan(Math.exp(B))/Math.PI-90}function rt(ne,B){for(const Z in B)ne[Z]=B[Z];return ne}function ot(ne){return ne.x}function vt(ne){return ne.y}function St(ne,B,Z,te){for(var ie,ge=te,Ce=Z-B>>1,Ie=Z-B,ve=ne[B],Pe=ne[B+1],Ze=ne[Z],He=ne[Z+1],tt=B+3;tt<Z;tt+=3){var Rt=Ye(ne[tt],ne[tt+1],ve,Pe,Ze,He);if(Rt>ge)ie=tt,ge=Rt;else if(Rt===ge){var Ut=Math.abs(tt-Ce);Ut<Ie&&(ie=tt,Ie=Ut)}}ge>te&&(ie-B>3&&St(ne,B,ie,te),ne[ie+2]=ge,Z-ie>3&&St(ne,ie,Z,te))}function Ye(ne,B,Z,te,ie,ge){var Ce=ie-Z,Ie=ge-te;if(Ce!==0||Ie!==0){var ve=((ne-Z)*Ce+(B-te)*Ie)/(Ce*Ce+Ie*Ie);ve>1?(Z=ie,te=ge):ve>0&&(Z+=Ce*ve,te+=Ie*ve)}return(Ce=ne-Z)*Ce+(Ie=B-te)*Ie}function at(ne,B,Z,te){var ie={id:ne===void 0?null:ne,type:B,geometry:Z,tags:te,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ge){var Ce=ge.geometry,Ie=ge.type;if(Ie==="Point"||Ie==="MultiPoint"||Ie==="LineString")we(ge,Ce);else if(Ie==="Polygon"||Ie==="MultiLineString")for(var ve=0;ve<Ce.length;ve++)we(ge,Ce[ve]);else if(Ie==="MultiPolygon")for(ve=0;ve<Ce.length;ve++)for(var Pe=0;Pe<Ce[ve].length;Pe++)we(ge,Ce[ve][Pe])}(ie),ie}function we(ne,B){for(var Z=0;Z<B.length;Z+=3)ne.minX=Math.min(ne.minX,B[Z]),ne.minY=Math.min(ne.minY,B[Z+1]),ne.maxX=Math.max(ne.maxX,B[Z]),ne.maxY=Math.max(ne.maxY,B[Z+1])}function Ue(ne,B,Z,te){if(B.geometry){var ie=B.geometry.coordinates,ge=B.geometry.type,Ce=Math.pow(Z.tolerance/((1<<Z.maxZoom)*Z.extent),2),Ie=[],ve=B.id;if(Z.promoteId?ve=B.properties[Z.promoteId]:Z.generateId&&(ve=te||0),ge==="Point")At(ie,Ie);else if(ge==="MultiPoint")for(var Pe=0;Pe<ie.length;Pe++)At(ie[Pe],Ie);else if(ge==="LineString")mt(ie,Ie,Ce,!1);else if(ge==="MultiLineString"){if(Z.lineMetrics){for(Pe=0;Pe<ie.length;Pe++)mt(ie[Pe],Ie=[],Ce,!1),ne.push(at(ve,"LineString",Ie,B.properties));return}Gt(ie,Ie,Ce,!1)}else if(ge==="Polygon")Gt(ie,Ie,Ce,!0);else{if(ge!=="MultiPolygon"){if(ge==="GeometryCollection"){for(Pe=0;Pe<B.geometry.geometries.length;Pe++)Ue(ne,{id:ve,geometry:B.geometry.geometries[Pe],properties:B.properties},Z,te);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Pe=0;Pe<ie.length;Pe++){var Ze=[];Gt(ie[Pe],Ze,Ce,!0),Ie.push(Ze)}}ne.push(at(ve,ge,Ie,B.properties))}}function At(ne,B){B.push(Qt(ne[0])),B.push(_n(ne[1])),B.push(0)}function mt(ne,B,Z,te){for(var ie,ge,Ce=0,Ie=0;Ie<ne.length;Ie++){var ve=Qt(ne[Ie][0]),Pe=_n(ne[Ie][1]);B.push(ve),B.push(Pe),B.push(0),Ie>0&&(Ce+=te?(ie*Pe-ve*ge)/2:Math.sqrt(Math.pow(ve-ie,2)+Math.pow(Pe-ge,2))),ie=ve,ge=Pe}var Ze=B.length-3;B[2]=1,St(B,0,Ze,Z),B[Ze+2]=1,B.size=Math.abs(Ce),B.start=0,B.end=B.size}function Gt(ne,B,Z,te){for(var ie=0;ie<ne.length;ie++){var ge=[];mt(ne[ie],ge,Z,te),B.push(ge)}}function Qt(ne){return ne/360+.5}function _n(ne){var B=Math.sin(ne*Math.PI/180),Z=.5-.25*Math.log((1+B)/(1-B))/Math.PI;return Z<0?0:Z>1?1:Z}function tn(ne,B,Z,te,ie,ge,Ce,Ie){if(te/=B,ge>=(Z/=B)&&Ce<te)return ne;if(Ce<Z||ge>=te)return null;for(var ve=[],Pe=0;Pe<ne.length;Pe++){var Ze=ne[Pe],He=Ze.geometry,tt=Ze.type,Rt=ie===0?Ze.minX:Ze.minY,Ut=ie===0?Ze.maxX:Ze.maxY;if(Rt>=Z&&Ut<te)ve.push(Ze);else if(!(Ut<Z||Rt>=te)){var Nt=[];if(tt==="Point"||tt==="MultiPoint")zn(He,Nt,Z,te,ie);else if(tt==="LineString")Dr(He,Nt,Z,te,ie,!1,Ie.lineMetrics);else if(tt==="MultiLineString")io(He,Nt,Z,te,ie,!1);else if(tt==="Polygon")io(He,Nt,Z,te,ie,!0);else if(tt==="MultiPolygon")for(var $t=0;$t<He.length;$t++){var on=[];io(He[$t],on,Z,te,ie,!0),on.length&&Nt.push(on)}if(Nt.length){if(Ie.lineMetrics&&tt==="LineString"){for($t=0;$t<Nt.length;$t++)ve.push(at(Ze.id,tt,Nt[$t],Ze.tags));continue}tt!=="LineString"&&tt!=="MultiLineString"||(Nt.length===1?(tt="LineString",Nt=Nt[0]):tt="MultiLineString"),tt!=="Point"&&tt!=="MultiPoint"||(tt=Nt.length===3?"Point":"MultiPoint"),ve.push(at(Ze.id,tt,Nt,Ze.tags))}}}return ve.length?ve:null}function zn(ne,B,Z,te,ie){for(var ge=0;ge<ne.length;ge+=3){var Ce=ne[ge+ie];Ce>=Z&&Ce<=te&&(B.push(ne[ge]),B.push(ne[ge+1]),B.push(ne[ge+2]))}}function Dr(ne,B,Z,te,ie,ge,Ce){for(var Ie,ve,Pe=Ii(ne),Ze=ie===0?si:Rr,He=ne.start,tt=0;tt<ne.length-3;tt+=3){var Rt=ne[tt],Ut=ne[tt+1],Nt=ne[tt+2],$t=ne[tt+3],on=ne[tt+4],Gn=ie===0?Rt:Ut,Wn=ie===0?$t:on,Nn=!1;Ce&&(Ie=Math.sqrt(Math.pow(Rt-$t,2)+Math.pow(Ut-on,2))),Gn<Z?Wn>Z&&(ve=Ze(Pe,Rt,Ut,$t,on,Z),Ce&&(Pe.start=He+Ie*ve)):Gn>te?Wn<te&&(ve=Ze(Pe,Rt,Ut,$t,on,te),Ce&&(Pe.start=He+Ie*ve)):Bi(Pe,Rt,Ut,Nt),Wn<Z&&Gn>=Z&&(ve=Ze(Pe,Rt,Ut,$t,on,Z),Nn=!0),Wn>te&&Gn<=te&&(ve=Ze(Pe,Rt,Ut,$t,on,te),Nn=!0),!ge&&Nn&&(Ce&&(Pe.end=He+Ie*ve),B.push(Pe),Pe=Ii(ne)),Ce&&(He+=Ie)}var Hn=ne.length-3;Rt=ne[Hn],Ut=ne[Hn+1],Nt=ne[Hn+2],(Gn=ie===0?Rt:Ut)>=Z&&Gn<=te&&Bi(Pe,Rt,Ut,Nt),Hn=Pe.length-3,ge&&Hn>=3&&(Pe[Hn]!==Pe[0]||Pe[Hn+1]!==Pe[1])&&Bi(Pe,Pe[0],Pe[1],Pe[2]),Pe.length&&B.push(Pe)}function Ii(ne){var B=[];return B.size=ne.size,B.start=ne.start,B.end=ne.end,B}function io(ne,B,Z,te,ie,ge){for(var Ce=0;Ce<ne.length;Ce++)Dr(ne[Ce],B,Z,te,ie,ge,!1)}function Bi(ne,B,Z,te){ne.push(B),ne.push(Z),ne.push(te)}function si(ne,B,Z,te,ie,ge){var Ce=(ge-B)/(te-B);return ne.push(ge),ne.push(Z+(ie-Z)*Ce),ne.push(1),Ce}function Rr(ne,B,Z,te,ie,ge){var Ce=(ge-Z)/(ie-Z);return ne.push(B+(te-B)*Ce),ne.push(ge),ne.push(1),Ce}function wn(ne,B){for(var Z=[],te=0;te<ne.length;te++){var ie,ge=ne[te],Ce=ge.type;if(Ce==="Point"||Ce==="MultiPoint"||Ce==="LineString")ie=ai(ge.geometry,B);else if(Ce==="MultiLineString"||Ce==="Polygon"){ie=[];for(var Ie=0;Ie<ge.geometry.length;Ie++)ie.push(ai(ge.geometry[Ie],B))}else if(Ce==="MultiPolygon")for(ie=[],Ie=0;Ie<ge.geometry.length;Ie++){for(var ve=[],Pe=0;Pe<ge.geometry[Ie].length;Pe++)ve.push(ai(ge.geometry[Ie][Pe],B));ie.push(ve)}Z.push(at(ge.id,Ce,ie,ge.tags))}return Z}function ai(ne,B){var Z=[];Z.size=ne.size,ne.start!==void 0&&(Z.start=ne.start,Z.end=ne.end);for(var te=0;te<ne.length;te+=3)Z.push(ne[te]+B,ne[te+1],ne[te+2]);return Z}function wa(ne,B){if(ne.transformed)return ne;var Z,te,ie,ge=1<<ne.z,Ce=ne.x,Ie=ne.y;for(Z=0;Z<ne.features.length;Z++){var ve=ne.features[Z],Pe=ve.geometry,Ze=ve.type;if(ve.geometry=[],Ze===1)for(te=0;te<Pe.length;te+=2)ve.geometry.push(So(Pe[te],Pe[te+1],B,ge,Ce,Ie));else for(te=0;te<Pe.length;te++){var He=[];for(ie=0;ie<Pe[te].length;ie+=2)He.push(So(Pe[te][ie],Pe[te][ie+1],B,ge,Ce,Ie));ve.geometry.push(He)}}return ne.transformed=!0,ne}function So(ne,B,Z,te,ie,ge){return[Math.round(Z*(ne*te-ie)),Math.round(Z*(B*te-ge))]}function Ta(ne,B,Z,te,ie){for(var ge=B===ie.maxZoom?0:ie.tolerance/((1<<B)*ie.extent),Ce={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Z,y:te,z:B,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ie=0;Ie<ne.length;Ie++){Ce.numFeatures++,Ks(Ce,ne[Ie],ge,ie);var ve=ne[Ie].minX,Pe=ne[Ie].minY,Ze=ne[Ie].maxX,He=ne[Ie].maxY;ve<Ce.minX&&(Ce.minX=ve),Pe<Ce.minY&&(Ce.minY=Pe),Ze>Ce.maxX&&(Ce.maxX=Ze),He>Ce.maxY&&(Ce.maxY=He)}return Ce}function Ks(ne,B,Z,te){var ie=B.geometry,ge=B.type,Ce=[];if(ge==="Point"||ge==="MultiPoint")for(var Ie=0;Ie<ie.length;Ie+=3)Ce.push(ie[Ie]),Ce.push(ie[Ie+1]),ne.numPoints++,ne.numSimplified++;else if(ge==="LineString")Yo(Ce,ie,ne,Z,!1,!1);else if(ge==="MultiLineString"||ge==="Polygon")for(Ie=0;Ie<ie.length;Ie++)Yo(Ce,ie[Ie],ne,Z,ge==="Polygon",Ie===0);else if(ge==="MultiPolygon")for(var ve=0;ve<ie.length;ve++){var Pe=ie[ve];for(Ie=0;Ie<Pe.length;Ie++)Yo(Ce,Pe[Ie],ne,Z,!0,Ie===0)}if(Ce.length){var Ze=B.tags||null;if(ge==="LineString"&&te.lineMetrics){for(var He in Ze={},B.tags)Ze[He]=B.tags[He];Ze.mapbox_clip_start=ie.start/ie.size,Ze.mapbox_clip_end=ie.end/ie.size}var tt={geometry:Ce,type:ge==="Polygon"||ge==="MultiPolygon"?3:ge==="LineString"||ge==="MultiLineString"?2:1,tags:Ze};B.id!==null&&(tt.id=B.id),ne.features.push(tt)}}function Yo(ne,B,Z,te,ie,ge){var Ce=te*te;if(te>0&&B.size<(ie?Ce:te))Z.numPoints+=B.length/3;else{for(var Ie=[],ve=0;ve<B.length;ve+=3)(te===0||B[ve+2]>Ce)&&(Z.numSimplified++,Ie.push(B[ve]),Ie.push(B[ve+1])),Z.numPoints++;ie&&function(Pe,Ze){for(var He=0,tt=0,Rt=Pe.length,Ut=Rt-2;tt<Rt;Ut=tt,tt+=2)He+=(Pe[tt]-Pe[Ut])*(Pe[tt+1]+Pe[Ut+1]);if(He>0===Ze)for(tt=0,Rt=Pe.length;tt<Rt/2;tt+=2){var Nt=Pe[tt],$t=Pe[tt+1];Pe[tt]=Pe[Rt-2-tt],Pe[tt+1]=Pe[Rt-1-tt],Pe[Rt-2-tt]=Nt,Pe[Rt-1-tt]=$t}}(Ie,ge),ne.push(Ie)}}function oo(ne,B){var Z=(B=this.options=function(ie,ge){for(var Ce in ge)ie[Ce]=ge[Ce];return ie}(Object.create(this.options),B)).debug;if(Z&&console.time("preprocess data"),B.maxZoom<0||B.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(B.promoteId&&B.generateId)throw new Error("promoteId and generateId cannot be used together.");var te=function(ie,ge){var Ce=[];if(ie.type==="FeatureCollection")for(var Ie=0;Ie<ie.features.length;Ie++)Ue(Ce,ie.features[Ie],ge,Ie);else Ue(Ce,ie.type==="Feature"?ie:{geometry:ie},ge);return Ce}(ne,B);this.tiles={},this.tileCoords=[],Z&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",B.indexMaxZoom,B.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(te=function(ie,ge){var Ce=ge.buffer/ge.extent,Ie=ie,ve=tn(ie,1,-1-Ce,Ce,0,-1,2,ge),Pe=tn(ie,1,1-Ce,2+Ce,0,-1,2,ge);return(ve||Pe)&&(Ie=tn(ie,1,-Ce,1+Ce,0,-1,2,ge)||[],ve&&(Ie=wn(ve,1).concat(Ie)),Pe&&(Ie=Ie.concat(wn(Pe,-1)))),Ie}(te,B)).length&&this.splitTile(te,0,0,0),Z&&(te.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function gs(ne,B,Z){return 32*((1<<ne)*Z+B)+ne}function Ao(ne,B){const Z=ne.tileID.canonical;if(!this._geoJSONIndex)return B(null,null);const te=this._geoJSONIndex.getTile(Z.z,Z.x,Z.y);if(!te)return B(null,null);const ie=new ee(te.features);let ge=Te(ie);ge.byteOffset===0&&ge.byteLength===ge.buffer.byteLength||(ge=new Uint8Array(ge)),B(null,{vectorTile:ie,rawData:ge.buffer})}oo.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},oo.prototype.splitTile=function(ne,B,Z,te,ie,ge,Ce){for(var Ie=[ne,B,Z,te],ve=this.options,Pe=ve.debug;Ie.length;){te=Ie.pop(),Z=Ie.pop(),B=Ie.pop(),ne=Ie.pop();var Ze=1<<B,He=gs(B,Z,te),tt=this.tiles[He];if(!tt&&(Pe>1&&console.time("creation"),tt=this.tiles[He]=Ta(ne,B,Z,te,ve),this.tileCoords.push({z:B,x:Z,y:te}),Pe)){Pe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",B,Z,te,tt.numFeatures,tt.numPoints,tt.numSimplified),console.timeEnd("creation"));var Rt="z"+B;this.stats[Rt]=(this.stats[Rt]||0)+1,this.total++}if(tt.source=ne,ie){if(B===ve.maxZoom||B===ie)continue;var Ut=1<<ie-B;if(Z!==Math.floor(ge/Ut)||te!==Math.floor(Ce/Ut))continue}else if(B===ve.indexMaxZoom||tt.numPoints<=ve.indexMaxPoints)continue;if(tt.source=null,ne.length!==0){Pe>1&&console.time("clipping");var Nt,$t,on,Gn,Wn,Nn,Hn=.5*ve.buffer/ve.extent,ys=.5-Hn,Qo=.5+Hn,Gr=1+Hn;Nt=$t=on=Gn=null,Wn=tn(ne,Ze,Z-Hn,Z+Qo,0,tt.minX,tt.maxX,ve),Nn=tn(ne,Ze,Z+ys,Z+Gr,0,tt.minX,tt.maxX,ve),ne=null,Wn&&(Nt=tn(Wn,Ze,te-Hn,te+Qo,1,tt.minY,tt.maxY,ve),$t=tn(Wn,Ze,te+ys,te+Gr,1,tt.minY,tt.maxY,ve),Wn=null),Nn&&(on=tn(Nn,Ze,te-Hn,te+Qo,1,tt.minY,tt.maxY,ve),Gn=tn(Nn,Ze,te+ys,te+Gr,1,tt.minY,tt.maxY,ve),Nn=null),Pe>1&&console.timeEnd("clipping"),Ie.push(Nt||[],B+1,2*Z,2*te),Ie.push($t||[],B+1,2*Z,2*te+1),Ie.push(on||[],B+1,2*Z+1,2*te),Ie.push(Gn||[],B+1,2*Z+1,2*te+1)}}},oo.prototype.getTile=function(ne,B,Z){var te=this.options,ie=te.extent,ge=te.debug;if(ne<0||ne>24)return null;var Ce=1<<ne,Ie=gs(ne,B=(B%Ce+Ce)%Ce,Z);if(this.tiles[Ie])return wa(this.tiles[Ie],ie);ge>1&&console.log("drilling down to z%d-%d-%d",ne,B,Z);for(var ve,Pe=ne,Ze=B,He=Z;!ve&&Pe>0;)Pe--,Ze=Math.floor(Ze/2),He=Math.floor(He/2),ve=this.tiles[gs(Pe,Ze,He)];return ve&&ve.source?(ge>1&&console.log("found parent tile z%d-%d-%d",Pe,Ze,He),ge>1&&console.time("drilling down"),this.splitTile(ve.source,Pe,Ze,He,ne,B,Z),ge>1&&console.timeEnd("drilling down"),this.tiles[Ie]?wa(this.tiles[Ie],ie):null):null};class Ea extends a.VectorTileWorkerSource{constructor(B,Z,te,ie,ge){super(B,Z,te,ie,Ao),ge&&(this.loadGeoJSON=ge)}loadData(B,Z){const te=B&&B.request,ie=te&&te.collectResourceTiming;this.loadGeoJSON(B,(ge,Ce)=>{if(ge||!Ce)return Z(ge);if(typeof Ce!="object")return Z(new Error(`Input data given to '${B.source}' is not a valid GeoJSON object.`));{P(Ce,!0);try{if(B.filter){const ve=a.createExpression(B.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ve.result==="error")throw new Error(ve.value.map(Ze=>`${Ze.key}: ${Ze.message}`).join(", "));const Pe=Ce.features.filter(Ze=>ve.value.evaluate({zoom:0},Ze));Ce={type:"FeatureCollection",features:Pe}}this._geoJSONIndex=B.cluster?new Lt(function({superclusterOptions:ve,clusterProperties:Pe}){if(!Pe||!ve)return ve;const Ze={},He={},tt={accumulated:null,zoom:0},Rt={properties:null},Ut=Object.keys(Pe);for(const Nt of Ut){const[$t,on]=Pe[Nt],Gn=a.createExpression(on),Wn=a.createExpression(typeof $t=="string"?[$t,["accumulated"],["get",Nt]]:$t);Ze[Nt]=Gn.value,He[Nt]=Wn.value}return ve.map=Nt=>{Rt.properties=Nt;const $t={};for(const on of Ut)$t[on]=Ze[on].evaluate(tt,Rt);return $t},ve.reduce=(Nt,$t)=>{Rt.properties=$t;for(const on of Ut)tt.accumulated=Nt[on],Nt[on]=He[on].evaluate(tt,Rt)},ve}(B)).load(Ce.features):function(ve,Pe){return new oo(ve,Pe)}(Ce,B.geojsonVtOptions)}catch(ve){return Z(ve)}this.loaded={};const Ie={};if(ie){const ve=a.getPerformanceMeasurement(te);ve&&(Ie.resourceTiming={},Ie.resourceTiming[B.source]=JSON.parse(JSON.stringify(ve)))}Z(null,Ie)}})}reloadTile(B,Z){const te=this.loaded;return te&&te[B.uid]?super.reloadTile(B,Z):this.loadTile(B,Z)}loadGeoJSON(B,Z){if(B.request)a.getJSON(B.request,Z);else{if(typeof B.data!="string")return Z(new Error(`Input data given to '${B.source}' is not a valid GeoJSON object.`));try{return Z(null,JSON.parse(B.data))}catch{return Z(new Error(`Input data given to '${B.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(B,Z){try{Z(null,this._geoJSONIndex.getClusterExpansionZoom(B.clusterId))}catch(te){Z(te)}}getClusterChildren(B,Z){try{Z(null,this._geoJSONIndex.getChildren(B.clusterId))}catch(te){Z(te)}}getClusterLeaves(B,Z){try{Z(null,this._geoJSONIndex.getLeaves(B.clusterId,B.limit,B.offset))}catch(te){Z(te)}}}class Mi{constructor(B){this.self=B,this.actor=new a.Actor(B,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=a.getProjection({name:"mercator"}),this.workerSourceTypes={vector:a.VectorTileWorkerSource,geojson:Ea},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Z,te)=>{if(this.workerSourceTypes[Z])throw new Error(`Worker source with name "${Z}" already registered.`);this.workerSourceTypes[Z]=te},this.self.registerRTLTextPlugin=Z=>{if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=Z.applyArabicShaping,a.plugin.processBidirectionalText=Z.processBidirectionalText,a.plugin.processStyledBidirectionalText=Z.processStyledBidirectionalText}}clearCaches(B,Z,te){delete this.layerIndexes[B],delete this.availableImages[B],delete this.workerSources[B],delete this.demWorkerSources[B],te()}checkIfReady(B,Z,te){te()}setReferrer(B,Z){this.referrer=Z}spriteLoaded(B,Z){this.isSpriteLoaded[B]=Z;for(const te in this.workerSources[B]){const ie=this.workerSources[B][te];for(const ge in ie)ie[ge]instanceof a.VectorTileWorkerSource&&(ie[ge].isSpriteLoaded=Z,ie[ge].fire(new a.Event("isSpriteLoaded")))}}setImages(B,Z,te){this.availableImages[B]=Z;for(const ie in this.workerSources[B]){const ge=this.workerSources[B][ie];for(const Ce in ge)ge[Ce].availableImages=Z}te()}enableTerrain(B,Z,te){this.terrain=Z,te()}setProjection(B,Z){this.projections[B]=a.getProjection(Z)}setLayers(B,Z,te){this.getLayerIndex(B).replace(Z),te()}updateLayers(B,Z,te){this.getLayerIndex(B).update(Z.layers,Z.removedIds),te()}loadTile(B,Z,te){const ie=this.enableTerrain?a.extend({enableTerrain:this.terrain},Z):Z;ie.projection=this.projections[B]||this.defaultProjection,this.getWorkerSource(B,Z.type,Z.source).loadTile(ie,te)}loadDEMTile(B,Z,te){const ie=this.enableTerrain?a.extend({buildQuadTree:this.terrain},Z):Z;this.getDEMWorkerSource(B,Z.source).loadTile(ie,te)}reloadTile(B,Z,te){const ie=this.enableTerrain?a.extend({enableTerrain:this.terrain},Z):Z;ie.projection=this.projections[B]||this.defaultProjection,this.getWorkerSource(B,Z.type,Z.source).reloadTile(ie,te)}abortTile(B,Z,te){this.getWorkerSource(B,Z.type,Z.source).abortTile(Z,te)}removeTile(B,Z,te){this.getWorkerSource(B,Z.type,Z.source).removeTile(Z,te)}removeSource(B,Z,te){if(!this.workerSources[B]||!this.workerSources[B][Z.type]||!this.workerSources[B][Z.type][Z.source])return;const ie=this.workerSources[B][Z.type][Z.source];delete this.workerSources[B][Z.type][Z.source],ie.removeSource!==void 0?ie.removeSource(Z,te):te()}loadWorkerSource(B,Z,te){try{this.self.importScripts(Z.url),te()}catch(ie){te(ie.toString())}}syncRTLPluginState(B,Z,te){try{a.plugin.setState(Z);const ie=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&ie!=null){this.self.importScripts(ie);const ge=a.plugin.isParsed();te(ge?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ie}`),ge)}}catch(ie){te(ie.toString())}}getAvailableImages(B){let Z=this.availableImages[B];return Z||(Z=[]),Z}getLayerIndex(B){let Z=this.layerIndexes[B];return Z||(Z=this.layerIndexes[B]=new E),Z}getWorkerSource(B,Z,te){return this.workerSources[B]||(this.workerSources[B]={}),this.workerSources[B][Z]||(this.workerSources[B][Z]={}),this.workerSources[B][Z][te]||(this.workerSources[B][Z][te]=new this.workerSourceTypes[Z]({send:(ie,ge,Ce,Ie,ve,Pe)=>{this.actor.send(ie,ge,Ce,B,ve,Pe)},scheduler:this.actor.scheduler},this.getLayerIndex(B),this.getAvailableImages(B),this.isSpriteLoaded[B])),this.workerSources[B][Z][te]}getDEMWorkerSource(B,Z){return this.demWorkerSources[B]||(this.demWorkerSources[B]={}),this.demWorkerSources[B][Z]||(this.demWorkerSources[B][Z]=new M),this.demWorkerSources[B][Z]}enforceCacheSizeLimit(B,Z){a.enforceCacheSizeLimit(Z)}getWorkerPerformanceMetrics(B,Z,te){te(void 0,void 0)}}return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Mi(self)),Mi}),h(["./shared"],function(a){var v=w;function w(_){return!function(o){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var g,x,T=new Blob([""],{type:"text/javascript"}),A=URL.createObjectURL(T);try{x=new Worker(A),g=!0}catch{g=!1}return x&&x.terminate(),URL.revokeObjectURL(A),g}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var g=document.createElement("canvas");g.width=g.height=1;var x=g.getContext("2d");if(!x)return!1;var T=x.getImageData(0,0,1,1);return T&&T.width===g.width}()?(E[f=o&&o.failIfMajorPerformanceCaveat]===void 0&&(E[f]=function(g){var x,T=function(A){var k=document.createElement("canvas"),O=Object.create(w.webGLContextAttributes);return O.failIfMajorPerformanceCaveat=A,k.getContext("webgl",O)||k.getContext("experimental-webgl",O)}(g);if(!T)return!1;try{x=T.createShader(T.VERTEX_SHADER)}catch{return!1}return!(!x||T.isContextLost())&&(T.shaderSource(x,"void main() {}"),T.compileShader(x),T.getShaderParameter(x,T.COMPILE_STATUS)===!0)}(f)),E[f]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var f}(_)}var E={};function I(_,o){var f=o[0],g=o[1],x=o[2],T=o[3],A=f*T-x*g;return A?(_[0]=T*(A=1/A),_[1]=-g*A,_[2]=-x*A,_[3]=f*A,_):null}function M(_,o){if(Array.isArray(_)){if(!Array.isArray(o)||_.length!==o.length)return!1;for(let f=0;f<_.length;f++)if(!M(_[f],o[f]))return!1;return!0}if(typeof _=="object"&&_!==null&&o!==null){if(typeof o!="object"||Object.keys(_).length!==Object.keys(o).length)return!1;for(const f in _)if(!M(_[f],o[f]))return!1;return!0}return _===o}w.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const P={create:function(_,o,f){const g=a.window.document.createElement(_);return o!==void 0&&(g.className=o),f&&f.appendChild(g),g},createSVG:function(_,o,f){const g=a.window.document.createElementNS("http://www.w3.org/2000/svg",_);for(const x of Object.keys(o))g.setAttributeNS(null,x,o[x]);return f&&f.appendChild(g),g}},j=a.window.document&&a.window.document.documentElement.style,N=j&&j.userSelect!==void 0?"userSelect":"WebkitUserSelect";let q;P.disableDrag=function(){j&&N&&(q=j[N],j[N]="none")},P.enableDrag=function(){j&&N&&(j[N]=q)};const V=function(_){_.preventDefault(),_.stopPropagation(),a.window.removeEventListener("click",V,!0)};function ee(_,o,f){const g=_.offsetWidth===o.width?1:_.offsetWidth/o.width;return new a.pointGeometry((f.clientX-o.left)*g,(f.clientY-o.top)*g)}function oe(_){const{userImage:o}=_;return!!(o&&o.render&&o.render())&&(_.data.replace(new Uint8Array(o.data.buffer)),!0)}P.suppressClick=function(){a.window.addEventListener("click",V,!0),a.window.setTimeout(()=>{a.window.removeEventListener("click",V,!0)},0)},P.mousePos=function(_,o){const f=_.getBoundingClientRect();return ee(_,f,o)},P.touchPos=function(_,o){const f=_.getBoundingClientRect(),g=[];for(let x=0;x<o.length;x++)g.push(ee(_,f,o[x]));return g},P.mouseButton=function(_){return a.window.InstallTrigger!==void 0&&_.button===2&&_.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:_.button};class pe extends a.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:f,callback:g}of this.requestors)this._notify(f,g);this.requestors=[]}}getImage(o){return this.images[o]}addImage(o,f){this._validate(o,f)&&(this.images[o]=f)}_validate(o,f){let g=!0;return this._validateStretch(f.stretchX,f.data&&f.data.width)||(this.fire(new a.ErrorEvent(new Error(`Image "${o}" has invalid "stretchX" value`))),g=!1),this._validateStretch(f.stretchY,f.data&&f.data.height)||(this.fire(new a.ErrorEvent(new Error(`Image "${o}" has invalid "stretchY" value`))),g=!1),this._validateContent(f.content,f)||(this.fire(new a.ErrorEvent(new Error(`Image "${o}" has invalid "content" value`))),g=!1),g}_validateStretch(o,f){if(!o)return!0;let g=0;for(const x of o){if(x[0]<g||x[1]<x[0]||f<x[1])return!1;g=x[1]}return!0}_validateContent(o,f){return!(o&&(o.length!==4||o[0]<0||f.data.width<o[0]||o[1]<0||f.data.height<o[1]||o[2]<0||f.data.width<o[2]||o[3]<0||f.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))}updateImage(o,f){f.version=this.images[o].version+1,this.images[o]=f,this.updatedImages[o]=!0}removeImage(o){const f=this.images[o];delete this.images[o],delete this.patterns[o],f.userImage&&f.userImage.onRemove&&f.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o,f){let g=!0;if(!this.isLoaded())for(const x of o)this.images[x]||(g=!1);this.isLoaded()||g?this._notify(o,f):this.requestors.push({ids:o,callback:f})}_notify(o,f){const g={};for(const x of o){this.images[x]||this.fire(new a.Event("styleimagemissing",{id:x}));const T=this.images[x];T?g[x]={data:T.data.clone(),pixelRatio:T.pixelRatio,sdf:T.sdf,version:T.version,stretchX:T.stretchX,stretchY:T.stretchY,content:T.content,hasRenderCallback:Boolean(T.userImage&&T.userImage.render)}:a.warnOnce(`Image "${x}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}f(null,g)}getPixelSize(){const{width:o,height:f}=this.atlasImage;return{width:o,height:f}}getPattern(o){const f=this.patterns[o],g=this.getImage(o);if(!g)return null;if(f&&f.position.version===g.version)return f.position;if(f)f.position.version=g.version;else{const x={w:g.data.width+2,h:g.data.height+2,x:0,y:0},T=new a.ImagePosition(x,g);this.patterns[o]={bin:x,position:T}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const f=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(o,this.atlasImage,f.RGBA),this.atlasTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const T in this.patterns)o.push(this.patterns[T].bin);const{w:f,h:g}=a.potpack(o),x=this.atlasImage;x.resize({width:f||1,height:g||1});for(const T in this.patterns){const{bin:A}=this.patterns[T],k=A.x+1,O=A.y+1,L=this.images[T].data,F=L.width,$=L.height;a.RGBAImage.copy(L,x,{x:0,y:0},{x:k,y:O},{width:F,height:$}),a.RGBAImage.copy(L,x,{x:0,y:$-1},{x:k,y:O-1},{width:F,height:1}),a.RGBAImage.copy(L,x,{x:0,y:0},{x:k,y:O+$},{width:F,height:1}),a.RGBAImage.copy(L,x,{x:F-1,y:0},{x:k-1,y:O},{width:1,height:$}),a.RGBAImage.copy(L,x,{x:0,y:0},{x:k+F,y:O},{width:1,height:$})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const f of o){if(this.callbackDispatchedThisFrame[f])continue;this.callbackDispatchedThisFrame[f]=!0;const g=this.images[f];oe(g)&&this.updateImage(f,g)}}}const se=new a.Properties({anchor:new a.DataConstantProperty(a.spec.light.anchor),position:new class{constructor(){this.specification=a.spec.light.position}possiblyEvaluate(_,o){return function([f,g,x]){const T=a.degToRad(g+90),A=a.degToRad(x);return{x:f*Math.cos(T)*Math.sin(A),y:f*Math.sin(T)*Math.sin(A),z:f*Math.cos(A),azimuthal:g,polar:x}}(_.expression.evaluate(o))}interpolate(_,o,f){return{x:a.number(_.x,o.x,f),y:a.number(_.y,o.y,f),z:a.number(_.z,o.z,f),azimuthal:a.number(_.azimuthal,o.azimuthal,f),polar:a.number(_.polar,o.polar,f)}}},color:new a.DataConstantProperty(a.spec.light.color),intensity:new a.DataConstantProperty(a.spec.light.intensity)}),xe="-transition";class Te extends a.Evented{constructor(o){super(),this._transitionable=new a.Transitionable(se),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,f={}){if(!this._validate(a.validateLight,o,f))for(const g in o){const x=o[g];a.endsWith(g,xe)?this._transitionable.setTransition(g.slice(0,-xe.length),x):this._transitionable.setValue(g,x)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,f,g){return(!g||g.validate!==!1)&&a.emitValidationErrors(this,o.call(a.validateStyle,a.extend({value:f,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}const De=new a.Properties({source:new a.DataConstantProperty(a.spec.terrain.source),exaggeration:new a.DataConstantProperty(a.spec.terrain.exaggeration)}),Me="-transition";class Be extends a.Evented{constructor(o,f){super(),this._transitionable=new a.Transitionable(De),this.set(o),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=f}get(){return this._transitionable.serialize()}set(o){for(const f in o){const g=o[f];a.endsWith(f,Me)?this._transitionable.setTransition(f.slice(0,-Me.length),g):this._transitionable.setValue(f,g)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}}function ze(_,o,f,g){const x=a.smoothstep(45,65,f),[T,A]=Fe(_,g),k=a.length(o);let O=1-Math.min(1,Math.exp((k-T)/(A-T)*-6));return O*=O*O,O=Math.min(1,1.00747*O),O*x*_.alpha}function Fe(_,o){const f=.5/Math.tan(.5*o);return[_.range[0]+f,_.range[1]+f]}const Je=new a.Properties({range:new a.DataConstantProperty(a.spec.fog.range),color:new a.DataConstantProperty(a.spec.fog.color),"horizon-blend":new a.DataConstantProperty(a.spec.fog["horizon-blend"])}),be="-transition";class qe extends a.Evented{constructor(o,f){super(),this._transitionable=new a.Transitionable(Je),this.set(o),this._transitioning=this._transitionable.untransitioned(),this._transform=f}get state(){return{range:this.properties.get("range"),horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(o,f={}){if(!this._validate(a.validateFog,o,f))for(const g in o){const x=o[g];a.endsWith(g,be)?this._transitionable.setTransition(g.slice(0,-be.length),x):this._transitionable.setValue(g,x)}}getOpacity(o){if(!this._transform.projection.supportsFog)return 0;const f=this.properties&&this.properties.get("color")||1;return a.smoothstep(45,65,o)*f.a}getOpacityAtLatLng(o,f){return this._transform.projection.supportsFog?function(g,x,T){const A=a.MercatorCoordinate.fromLngLat(x),k=T.elevation?T.elevation.getAtPointOrZero(A):0,O=[A.x,A.y,k];return a.transformMat4(O,O,T.mercatorFogMatrix),ze(g,O,T.pitch,T._fov)}(this.state,o,f):0}getFovAdjustedRange(o){return this._transform.projection.supportsFog?Fe(this.state,o):[0,1]}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,f,g){return(!g||g.validate!==!1)&&a.emitValidationErrors(this,o.call(a.validateStyle,a.extend({value:f,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}class Ke{constructor(o,f){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=a.uniqueId();const g=this.workerPool.acquire(this.id);for(let x=0;x<g.length;x++){const T=new Ke.Actor(g[x],f,this.id);T.name=`Worker ${x}`,this.actors.push(T)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(o,f,g){a.asyncAll(this.actors,(x,T)=>{x.send(o,f,T)},g=g||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(o=>{o.remove()}),this.actors=[],this.workerPool.release(this.id)}}function _t(_,o,f){return o*(a.EXTENT/(_.tileSize*Math.pow(2,f-_.tileID.overscaledZ)))}Ke.Actor=a.Actor;class It{constructor(o,f,g){this.context=o;const x=o.gl;this.buffer=x.createBuffer(),this.dynamicDraw=Boolean(g),this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),x.bufferData(x.ELEMENT_ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete f.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const f=this.context.gl;this.context.unbindVAO(),this.bind(),f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Tt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Dn{constructor(o,f,g,x){this.length=f.length,this.attributes=g,this.itemSize=f.bytesPerElement,this.dynamicDraw=x,this.context=o;const T=o.gl;this.buffer=T.createBuffer(),o.bindVertexBuffer.set(this.buffer),T.bufferData(T.ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||delete f.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){const f=this.context.gl;this.bind(),f.bufferSubData(f.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,f){for(let g=0;g<this.attributes.length;g++){const x=f.attributes[this.attributes[g].name];x!==void 0&&o.enableVertexAttribArray(x)}}setVertexAttribPointers(o,f,g){for(let x=0;x<this.attributes.length;x++){const T=this.attributes[x],A=f.attributes[T.name];A!==void 0&&o.vertexAttribPointer(A,T.components,o[Tt[T.type]],!1,this.itemSize,T.offset+this.itemSize*(g||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Ot{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Zn extends Ot{getDefault(){return a.Color.transparent}set(o){const f=this.current;(o.r!==f.r||o.g!==f.g||o.b!==f.b||o.a!==f.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Rn extends Ot{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class _r extends Ot{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class it extends Ot{getDefault(){return[!0,!0,!0,!0]}set(o){const f=this.current;(o[0]!==f[0]||o[1]!==f[1]||o[2]!==f[2]||o[3]!==f[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Dt extends Ot{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class yt extends Ot{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class Lt extends Ot{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const f=this.current;(o.func!==f.func||o.ref!==f.ref||o.mask!==f.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Tn extends Ot{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const f=this.current;(o[0]!==f[0]||o[1]!==f[1]||o[2]!==f[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class Cn extends Ot{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;o?f.enable(f.STENCIL_TEST):f.disable(f.STENCIL_TEST),this.current=o,this.dirty=!1}}class Kt extends Ot{getDefault(){return[0,1]}set(o){const f=this.current;(o[0]!==f[0]||o[1]!==f[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class Ht extends Ot{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;o?f.enable(f.DEPTH_TEST):f.disable(f.DEPTH_TEST),this.current=o,this.dirty=!1}}class fe extends Ot{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class _e extends Ot{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;o?f.enable(f.BLEND):f.disable(f.BLEND),this.current=o,this.dirty=!1}}class Oe extends Ot{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const f=this.current;(o[0]!==f[0]||o[1]!==f[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class rt extends Ot{getDefault(){return a.Color.transparent}set(o){const f=this.current;(o.r!==f.r||o.g!==f.g||o.b!==f.b||o.a!==f.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class ot extends Ot{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class vt extends Ot{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;o?f.enable(f.CULL_FACE):f.disable(f.CULL_FACE),this.current=o,this.dirty=!1}}class St extends Ot{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class Ye extends Ot{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class at extends Ot{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class we extends Ot{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class Ue extends Ot{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const f=this.current;(o[0]!==f[0]||o[1]!==f[1]||o[2]!==f[2]||o[3]!==f[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class At extends Ot{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.bindFramebuffer(f.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class mt extends Ot{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.bindRenderbuffer(f.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Gt extends Ot{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.bindTexture(f.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class Qt extends Ot{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.bindBuffer(f.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class _n extends Ot{getDefault(){return null}set(o){const f=this.gl;f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class tn extends Ot{constructor(o){super(o),this.vao=o.extVertexArrayObject}getDefault(){return null}set(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)}}class zn extends Ot{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Dr extends Ot{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class Ii extends Ot{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class io extends Ot{constructor(o,f){super(o),this.context=o,this.parent=f}getDefault(){return null}}class Bi extends io{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class si extends io{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferRenderbuffer(f.FRAMEBUFFER,this.attachment(),f.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Rr extends si{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class wn{constructor(o,f,g,x){this.context=o,this.width=f,this.height=g;const T=this.framebuffer=o.gl.createFramebuffer();this.colorAttachment=new Bi(o,T),x&&(this.depthAttachment=new si(o,T))}destroy(){const o=this.context.gl,f=this.colorAttachment.get();if(f&&o.deleteTexture(f),this.depthAttachment){const g=this.depthAttachment.get();g&&o.deleteRenderbuffer(g)}o.deleteFramebuffer(this.framebuffer)}}class ai{constructor(o){this.gl=o,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Zn(this),this.clearDepth=new Rn(this),this.clearStencil=new _r(this),this.colorMask=new it(this),this.depthMask=new Dt(this),this.stencilMask=new yt(this),this.stencilFunc=new Lt(this),this.stencilOp=new Tn(this),this.stencilTest=new Cn(this),this.depthRange=new Kt(this),this.depthTest=new Ht(this),this.depthFunc=new fe(this),this.blend=new _e(this),this.blendFunc=new Oe(this),this.blendColor=new rt(this),this.blendEquation=new ot(this),this.cullFace=new vt(this),this.cullFaceSide=new St(this),this.frontFace=new Ye(this),this.program=new at(this),this.activeTexture=new we(this),this.viewport=new Ue(this),this.bindFramebuffer=new At(this),this.bindRenderbuffer=new mt(this),this.bindTexture=new Gt(this),this.bindVertexBuffer=new Qt(this),this.bindElementBuffer=new _n(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new tn(this),this.pixelStoreUnpack=new zn(this),this.pixelStoreUnpackPremultiplyAlpha=new Dr(this),this.pixelStoreUnpackFlipY=new Ii(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extTextureHalfFloat=o.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(o.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,f){return new It(this,o,f)}createVertexBuffer(o,f,g){return new Dn(this,o,f,g)}createRenderbuffer(o,f,g){const x=this.gl,T=x.createRenderbuffer();return this.bindRenderbuffer.set(T),x.renderbufferStorage(x.RENDERBUFFER,o,f,g),this.bindRenderbuffer.set(null),T}createFramebuffer(o,f,g){return new wn(this,o,f,g)}clear({color:o,depth:f,stencil:g}){const x=this.gl;let T=0;o&&(T|=x.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),f!==void 0&&(T|=x.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(f),this.depthMask.set(!0)),g!==void 0&&(T|=x.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),x.clear(T)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){M(o.blendFunction,a.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class wa{constructor(o,f,g,x){this.screenBounds=o,this.cameraPoint=f,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=g,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this.screenGeometry.map(T=>x.pointCoordinate3D(T)),this.cameraGeometry=this.bufferedCameraGeometry(0)}static createFromScreenPoints(o,f){let g,x;if(o instanceof a.pointGeometry||typeof o[0]=="number"){const T=a.pointGeometry.convert(o);g=[a.pointGeometry.convert(o)],x=f.isPointAboveHorizon(T)}else{const T=a.pointGeometry.convert(o[0]),A=a.pointGeometry.convert(o[1]);g=[T,A],x=a.polygonizeBounds(T,A).every(k=>f.isPointAboveHorizon(k))}return new wa(g,f.getCameraPoint(),x,f)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(o){return a.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],o)}bufferedCameraGeometry(o){const f=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new a.pointGeometry(1,1)):this.screenBounds[1],x=a.polygonizeBounds(f,g,0,!1);return this.cameraPoint.y>g.y&&(this.cameraPoint.x>f.x&&this.cameraPoint.x<g.x?x.splice(3,0,this.cameraPoint):this.cameraPoint.x>=g.x?x[2]=this.cameraPoint:this.cameraPoint.x<=f.x&&(x[3]=this.cameraPoint)),a.bufferConvexPolygon(x,o)}containsTile(o,f,g){const x=o.queryPadding+1,T=o.tileID.wrap,A=g?this._bufferedCameraMercator(x,f).map(X=>a.getTilePoint(o.tileTransform,X,T)):this._bufferedScreenMercator(x,f).map(X=>a.getTilePoint(o.tileTransform,X,T)),k=this.screenGeometryMercator.map(X=>a.getTileVec3(o.tileTransform,X,T)),O=k.map(X=>new a.pointGeometry(X[0],X[1])),L=f.getFreeCameraOptions().position||new a.MercatorCoordinate(0,0,0),F=a.getTileVec3(o.tileTransform,L,T),$=k.map(X=>{const J=a.sub(X,X,F);return a.normalize(J,J),new a.Ray(F,J)}),W=_t(o,1,f.zoom);if(a.polygonIntersectsBox(A,0,0,a.EXTENT,a.EXTENT))return{queryGeometry:this,tilespaceGeometry:O,tilespaceRays:$,bufferedTilespaceGeometry:A,bufferedTilespaceBounds:(Q=a.getBounds(A),Q.min.x=a.clamp(Q.min.x,0,a.EXTENT),Q.min.y=a.clamp(Q.min.y,0,a.EXTENT),Q.max.x=a.clamp(Q.max.x,0,a.EXTENT),Q.max.y=a.clamp(Q.max.y,0,a.EXTENT),Q),tile:o,tileID:o.tileID,pixelToTileUnitsFactor:W};var Q}_bufferedScreenMercator(o,f){const g=So(o);if(this._screenRaycastCache[g])return this._screenRaycastCache[g];{const x=this.bufferedScreenGeometry(o).map(T=>f.pointCoordinate3D(T));return this._screenRaycastCache[g]=x,x}}_bufferedCameraMercator(o,f){const g=So(o);if(this._cameraRaycastCache[g])return this._cameraRaycastCache[g];{const x=this.bufferedCameraGeometry(o).map(T=>f.pointCoordinate3D(T));return this._cameraRaycastCache[g]=x,x}}}function So(_){return 100*_|0}function Ta(_,o,f){const g=function(x,T){if(x)return f(x);if(T){const A=a.pick(a.extend(T,_),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);T.vector_layers&&(A.vectorLayers=T.vector_layers,A.vectorLayerIds=A.vectorLayers.map(k=>k.id)),A.tiles=o.canonicalizeTileset(A,_.url),f(null,A)}};return _.url?a.getJSON(o.transformRequest(o.normalizeSourceURL(_.url),a.ResourceType.Source),g):a.exported.frame(()=>g(null,_))}class Ks{constructor(o,f,g){this.bounds=a.LngLatBounds.convert(this.validateBounds(o)),this.minzoom=f||0,this.maxzoom=g||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const f=Math.pow(2,o.z),g=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*f),x=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*f),T=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*f),A=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*f);return o.x>=g&&o.x<T&&o.y>=x&&o.y<A}}class Yo extends a.Evented{constructor(o,f,g,x){super(),this.id=o,this.dispatcher=g,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},f),a.extend(this,a.pick(f,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ta(this._options,this.map._requestManager,(o,f)=>{this._tileJSONRequest=null,this._loaded=!0,o?this.fire(new a.ErrorEvent(o)):f&&(a.extend(this,f),f.bounds&&(this.tileBounds=new Ks(f.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(f.tiles),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,f){const g=a.exported.devicePixelRatio>=2,x=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),g,this.tileSize);o.request=a.getImage(this.map._requestManager.transformRequest(x,a.ResourceType.Tile),(T,A,k,O)=>{if(delete o.request,o.aborted)o.state="unloaded",f(null);else if(T)o.state="errored",f(T);else if(A){this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:k,expires:O});const L=this.map.painter.context,F=L.gl;o.texture=this.map.painter.getTileTexture(A.width),o.texture?o.texture.update(A,{useMipmap:!0}):(o.texture=new a.Texture(L,A,F.RGBA,{useMipmap:!0}),o.texture.bind(F.LINEAR,F.CLAMP_TO_EDGE),L.extTextureFilterAnisotropic&&F.texParameterf(F.TEXTURE_2D,L.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,L.extTextureFilterAnisotropicMax)),o.state="loaded",a.cacheEntryPossiblyAdded(this.dispatcher),f(null)}})}abortTile(o,f){o.request&&(o.request.cancel(),delete o.request),f()}unloadTile(o,f){o.texture&&this.map.painter.saveTileTexture(o.texture),f()}hasTransition(){return!1}}let oo;function gs(_,o,f,g,x,T,A,k){const O=[_,f,x,o,g,T,1,1,1],L=[A,k,1],F=a.adjoint([],O),[$,W,Q]=a.transformMat3(L,L,a.transpose(F,F));return a.multiply(O,[$,0,0,0,W,0,0,0,Q],O)}class Ao extends a.Evented{constructor(o,f,g,x){super(),this.id=o,this.dispatcher=g,this.coordinates=f.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(x),this.options=f}load(o,f){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),(g,x)=>{this._loaded=!0,g?this.fire(new a.ErrorEvent(g)):x&&(this.image=a.exported.getImageData(x),this.width=this.image.width,this.height=this.image.height,o&&(this.coordinates=o),f&&f(),this._finishLoading())})}loaded(){return this._loaded}updateImage(o){return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}setCoordinates(o){this.coordinates=o,delete this._boundsArray;const f=o.map(a.MercatorCoordinate.fromLngLat);return this.tileID=function(g){let x=1/0,T=1/0,A=-1/0,k=-1/0;for(const $ of g)x=Math.min(x,$.x),T=Math.min(T,$.y),A=Math.max(A,$.x),k=Math.max(k,$.y);const O=Math.max(A-x,k-T),L=Math.max(0,Math.floor(-Math.log(O)/Math.LN2)),F=Math.pow(2,L);return new a.CanonicalTileID(L,Math.floor((x+A)/2*F),Math.floor((T+k)/2*F))}(f),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){delete this._boundsArray}_makeBoundsArray(){const o=a.tileTransform(this.tileID,this.map.transform.projection),[f,g,x,T]=this.coordinates.map(A=>{const k=o.projection.project(A[0],A[1]);return a.getTilePoint(o,k)._round()});return this.perspectiveTransform=function(A,k,O,L,F,$,W,Q,X,J){const de=gs(0,0,A,0,0,k,A,k),Y=gs(O,L,F,$,W,Q,X,J);return a.multiply(Y,a.adjoint(de,de),Y),[Y[6]/Y[8]*A/a.EXTENT,Y[7]/Y[8]*k/a.EXTENT]}(this.width,this.height,f.x,f.y,g.x,g.y,T.x,T.y,x.x,x.y),this._boundsArray=new a.StructArrayLayout4i8,this._boundsArray.emplaceBack(f.x,f.y,0,0),this._boundsArray.emplaceBack(g.x,g.y,a.EXTENT,0),this._boundsArray.emplaceBack(T.x,T.y,0,a.EXTENT),this._boundsArray.emplaceBack(x.x,x.y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const o=this.map.painter.context,f=o.gl;this._boundsArray||this._makeBoundsArray(),this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,a.boundsAttributes.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new a.Texture(o,this.image,f.RGBA),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE));for(const g in this.tiles){const x=this.tiles[g];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture)}}loadTile(o,f){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},f(null)):(o.state="errored",f(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Ea={vector:class extends a.Evented{constructor(_,o,f,g){if(super(),this.id=_,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(o,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},o),this._collectResourceTiming=o.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(g),this._tileWorkers={},this._deduped=new a.DedupedRequest}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ta(this._options,this.map._requestManager,(_,o)=>{this._tileJSONRequest=null,this._loaded=!0,_?this.fire(new a.ErrorEvent(_)):o&&(a.extend(this,o),o.bounds&&(this.tileBounds=new Ks(o.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(o.tiles,this.map._requestManager._customAccessToken),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(_){return!this.tileBounds||this.tileBounds.contains(_.canonical)}onAdd(_){this.map=_,this.load()}setSourceProperty(_){this._tileJSONRequest&&this._tileJSONRequest.cancel(),_();const o=this.map.style._getSourceCaches(this.id);for(const f of o)f.clearTiles();this.load()}setTiles(_){return this.setSourceProperty(()=>{this._options.tiles=_}),this}setUrl(_){return this.setSourceProperty(()=>{this.url=_,this._options.url=_}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}loadTile(_,o){const f=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme)),g={request:this.map._requestManager.transformRequest(f,a.ResourceType.Tile),data:void 0,uid:_.uid,tileID:_.tileID,tileZoom:_.tileZoom,zoom:_.tileID.overscaledZ,tileSize:this.tileSize*_.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:_.isSymbolTile};if(g.request.collectResourceTiming=this._collectResourceTiming,_.actor&&_.state!=="expired")_.state==="loading"?_.reloadCallback=o:_.request=_.actor.send("reloadTile",g,x.bind(this));else if(_.actor=this._tileWorkers[f]=this._tileWorkers[f]||this.dispatcher.getActor(),this.dispatcher.ready)_.request=_.actor.send("loadTile",g,x.bind(this),void 0,!0);else{const T=a.loadVectorTile.call({deduped:this._deduped},g,(A,k)=>{A||!k?x.call(this,A):(g.data={cacheControl:k.cacheControl,expires:k.expires,rawData:k.rawData.slice(0)},_.actor&&_.actor.send("loadTile",g,x.bind(this),void 0,!0))},!0);_.request={cancel:T}}function x(T,A){return delete _.request,_.aborted?o(null):T&&T.status!==404?o(T):(A&&A.resourceTiming&&(_.resourceTiming=A.resourceTiming),this.map._refreshExpiredTiles&&A&&_.setExpiryData(A),_.loadVectorData(A,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),o(null),void(_.reloadCallback&&(this.loadTile(_,_.reloadCallback),_.reloadCallback=null)))}}abortTile(_){_.request&&(_.request.cancel(),delete _.request),_.actor&&_.actor.send("abortTile",{uid:_.uid,type:this.type,source:this.id})}unloadTile(_){_.unloadVectorData(),_.actor&&_.actor.send("removeTile",{uid:_.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:Yo,"raster-dem":class extends Yo{constructor(_,o,f,g){super(_,o,f,g),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}loadTile(_,o){const f=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function g(x,T){x&&(_.state="errored",o(x)),T&&(_.dem=T,_.dem.onDeserialize(),_.needsHillshadePrepare=!0,_.needsDEMTextureUpload=!0,_.state="loaded",o(null))}_.request=a.getImage(this.map._requestManager.transformRequest(f,a.ResourceType.Tile),function(x,T,A,k){if(delete _.request,_.aborted)_.state="unloaded",o(null);else if(x)_.state="errored",o(x);else if(T){this.map._refreshExpiredTiles&&_.setExpiryData({cacheControl:A,expires:k});const O=a.window.ImageBitmap&&T instanceof a.window.ImageBitmap&&(oo==null&&(oo=a.window.OffscreenCanvas&&new a.window.OffscreenCanvas(1,1).getContext("2d")&&typeof a.window.createImageBitmap=="function"),oo),L=1-(T.width-a.prevPowerOfTwo(T.width))/2;L<1||_.neighboringTiles||(_.neighboringTiles=this._getNeighboringTiles(_.tileID));const F=O?T:a.exported.getImageData(T,L),$={uid:_.uid,coord:_.tileID,source:this.id,rawImageData:F,encoding:this.encoding,padding:L};_.actor&&_.state!=="expired"||(_.actor=this.dispatcher.getActor(),_.actor.send("loadDEMTile",$,g.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(_){const o=_.canonical,f=Math.pow(2,o.z),g=(o.x-1+f)%f,x=o.x===0?_.wrap-1:_.wrap,T=(o.x+1+f)%f,A=o.x+1===f?_.wrap+1:_.wrap,k={};return k[new a.OverscaledTileID(_.overscaledZ,x,o.z,g,o.y).key]={backfilled:!1},k[new a.OverscaledTileID(_.overscaledZ,A,o.z,T,o.y).key]={backfilled:!1},o.y>0&&(k[new a.OverscaledTileID(_.overscaledZ,x,o.z,g,o.y-1).key]={backfilled:!1},k[new a.OverscaledTileID(_.overscaledZ,_.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},k[new a.OverscaledTileID(_.overscaledZ,A,o.z,T,o.y-1).key]={backfilled:!1}),o.y+1<f&&(k[new a.OverscaledTileID(_.overscaledZ,x,o.z,g,o.y+1).key]={backfilled:!1},k[new a.OverscaledTileID(_.overscaledZ,_.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},k[new a.OverscaledTileID(_.overscaledZ,A,o.z,T,o.y+1).key]={backfilled:!1}),k}unloadTile(_){_.demTexture&&this.map.painter.saveTileTexture(_.demTexture),_.fbo&&(_.fbo.destroy(),delete _.fbo),_.dem&&delete _.dem,delete _.neighboringTiles,_.state="unloaded"}},geojson:class extends a.Evented{constructor(_,o,f,g){super(),this.id=_,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=f.getActor(),this.setEventedParent(g),this._data=o.data,this._options=a.extend({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const x=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*x,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*x,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:a.EXTENT,radius:(o.clusterRadius!==void 0?o.clusterRadius:50)*x,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions)}onAdd(_){this.map=_,this.setData(this._data)}setData(_){return this._data=_,this._updateWorkerData(),this}getClusterExpansionZoom(_,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:_,source:this.id},o),this}getClusterChildren(_,o){return this.actor.send("geojson.getClusterChildren",{clusterId:_,source:this.id},o),this}getClusterLeaves(_,o,f,g){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:_,limit:o,offset:f},g),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.Event("dataloading",{dataType:"source"})),this._loaded=!1;const _=a.extend({},this.workerOptions),o=this._data;typeof o=="string"?(_.request=this.map._requestManager.transformRequest(a.exported.resolveURL(o),a.ResourceType.Source),_.request.collectResourceTiming=this._collectResourceTiming):_.data=JSON.stringify(o),this._pendingLoad=this.actor.send(`${this.type}.loadData`,_,(f,g)=>{if(this._loaded=!0,this._pendingLoad=null,f)this.fire(new a.ErrorEvent(f));else{const x={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&g&&g.resourceTiming&&g.resourceTiming[this.id]&&(x.resourceTiming=g.resourceTiming[this.id]),this.fire(new a.Event("data",x)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(_,o){const f=_.actor?"reloadTile":"loadTile";_.actor=this.actor,_.request=this.actor.send(f,{type:this.type,uid:_.uid,tileID:_.tileID,tileZoom:_.tileZoom,zoom:_.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(g,x)=>(delete _.request,_.unloadVectorData(),_.aborted?o(null):g?o(g):(_.loadVectorData(x,this.map.painter,f==="reloadTile"),o(null))),void 0,f==="loadTile")}abortTile(_){_.request&&(_.request.cancel(),delete _.request),_.aborted=!0}unloadTile(_){_.unloadVectorData(),this.actor.send("removeTile",{uid:_.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Ao{constructor(_,o,f,g){super(_,o,f,g),this.roundZoom=!0,this.type="video",this.options=o}load(){this._loaded=!1;const _=this.options;this.urls=[];for(const o of _.urls)this.urls.push(this.map._requestManager.transformRequest(o,a.ResourceType.Source).url);a.getVideo(this.urls,(o,f)=>{this._loaded=!0,o?this.fire(new a.ErrorEvent(o)):f&&(this.video=f,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(_){if(this.video){const o=this.video.seekable;_<o.start(0)||_>o.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=_}}getVideo(){return this.video}onAdd(_){this.map||(this.map=_,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const _=this.map.painter.context,o=_.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(_,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._boundsArray||this._makeBoundsArray(),this.boundsBuffer||(this.boundsBuffer=_.createVertexBuffer(this._boundsArray,a.boundsAttributes.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2));for(const f in this.tiles){const g=this.tiles[f];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Ao,canvas:class extends Ao{constructor(_,o,f,g){super(_,o,f,g),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(T=>typeof T!="number"))||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${_}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${_}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${_}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${_}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${_}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(_){this.map=_,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let _=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,_=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,_=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context,f=o.gl;this._boundsArray||this._makeBoundsArray(),this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,a.boundsAttributes.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(_||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(o,this.canvas,f.RGBA,{premultiply:!0});for(const g in this.tiles){const x=this.tiles[g];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const _ of[this.canvas.width,this.canvas.height])if(isNaN(_)||_<=0)return!0;return!1}}},Mi=function(_,o,f,g){const x=new Ea[o.type](_,o,f,g);if(x.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${x.id}`);return a.bindAll(["load","abort","unload","serialize","prepare"],x),x};function ne(_,o){const f=a.identity([]);return a.scale(f,f,[.5*_.width,.5*-_.height,1]),a.translate(f,f,[1,-1,0]),a.multiply$1(f,f,_.calculateProjMatrix(o.toUnwrapped()))}function B(_,o,f,g,x,T,A,k=!1){const O=_.tilesIn(g,A,k);O.sort(te);const L=[];for(const $ of O)L.push({wrappedTileID:$.tile.tileID.wrapped().key,queryResults:$.tile.queryRenderedFeatures(o,f,_._state,$,x,T,ne(_.transform,$.tile.tileID),k)});const F=function($){const W={},Q={};for(const X of $){const J=X.queryResults,de=X.wrappedTileID,Y=Q[de]=Q[de]||{};for(const ce in J){const ue=J[ce],ae=Y[ce]=Y[ce]||{},le=W[ce]=W[ce]||[];for(const me of ue)ae[me.featureIndex]||(ae[me.featureIndex]=!0,le.push(me))}}return W}(L);for(const $ in F)F[$].forEach(W=>{const Q=W.feature,X=_.getFeatureState(Q.layer["source-layer"],Q.id);Q.source=Q.layer.source,Q.layer["source-layer"]&&(Q.sourceLayer=Q.layer["source-layer"]),Q.state=X});return F}function Z(_,o){const f=_.getRenderableIds().map(T=>_.getTileByID(T)),g=[],x={};for(let T=0;T<f.length;T++){const A=f[T],k=A.tileID.canonical.key;x[k]||(x[k]=!0,A.querySourceFeatures(g,o))}return g}function te(_,o){const f=_.tileID,g=o.tileID;return f.overscaledZ-g.overscaledZ||f.canonical.y-g.canonical.y||f.wrap-g.wrap||f.canonical.x-g.canonical.x}function ie(){return Ms.workerClass!=null?new Ms.workerClass:new a.window.Worker(Ms.workerUrl)}const ge="mapboxgl_preloaded_worker_pool";class Ce{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<Ce.workerCount;)this.workers.push(new ie);return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach(f=>{f.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[ge]}numActive(){return Object.keys(this.active).length}}let Ie;function ve(){return Ie||(Ie=new Ce),Ie}function Pe(_,o){const f={};for(const g in _)g!=="ref"&&(f[g]=_[g]);return a.refProperties.forEach(g=>{g in o&&(f[g]=o[g])}),f}function Ze(_){_=_.slice();const o=Object.create(null);for(let f=0;f<_.length;f++)o[_[f].id]=_[f];for(let f=0;f<_.length;f++)"ref"in _[f]&&(_[f]=Pe(_[f],o[_[f].ref]));return _}Ce.workerCount=2;const He={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function tt(_,o,f){f.push({command:He.addSource,args:[_,o[_]]})}function Rt(_,o,f){o.push({command:He.removeSource,args:[_]}),f[_]=!0}function Ut(_,o,f,g){Rt(_,f,g),tt(_,o,f)}function Nt(_,o,f){let g;for(g in _[f])if(_[f].hasOwnProperty(g)&&g!=="data"&&!M(_[f][g],o[f][g]))return!1;for(g in o[f])if(o[f].hasOwnProperty(g)&&g!=="data"&&!M(_[f][g],o[f][g]))return!1;return!0}function $t(_,o,f,g,x,T){let A;for(A in o=o||{},_=_||{})_.hasOwnProperty(A)&&(M(_[A],o[A])||f.push({command:T,args:[g,A,o[A],x]}));for(A in o)o.hasOwnProperty(A)&&!_.hasOwnProperty(A)&&(M(_[A],o[A])||f.push({command:T,args:[g,A,o[A],x]}))}function on(_){return _.id}function Gn(_,o){return _[o.id]=o,_}class Wn{constructor(o,f){this.reset(o,f)}reset(o,f){this.points=o||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(f||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=a.clamp(o,0,1);let f=1,g=this._distances[f];const x=o*this.paddedLength+this.padding;for(;g<x&&f<this._distances.length;)g=this._distances[++f];const T=f-1,A=this._distances[T],k=g-A,O=k>0?(x-A)/k:0;return this.points[T].mult(1-O).add(this.points[f].mult(O))}}class Nn{constructor(o,f,g){const x=this.boxCells=[],T=this.circleCells=[];this.xCellCount=Math.ceil(o/g),this.yCellCount=Math.ceil(f/g);for(let A=0;A<this.xCellCount*this.yCellCount;A++)x.push([]),T.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=f,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/f,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,f,g,x,T){this._forEachCell(f,g,x,T,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(f),this.bboxes.push(g),this.bboxes.push(x),this.bboxes.push(T)}insertCircle(o,f,g,x){this._forEachCell(f-x,g-x,f+x,g+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(f),this.circles.push(g),this.circles.push(x)}_insertBoxCell(o,f,g,x,T,A){this.boxCells[T].push(A)}_insertCircleCell(o,f,g,x,T,A){this.circleCells[T].push(A)}_query(o,f,g,x,T,A){if(g<0||o>this.width||x<0||f>this.height)return!T&&[];const k=[];if(o<=0&&f<=0&&this.width<=g&&this.height<=x){if(T)return!0;for(let O=0;O<this.boxKeys.length;O++)k.push({key:this.boxKeys[O],x1:this.bboxes[4*O],y1:this.bboxes[4*O+1],x2:this.bboxes[4*O+2],y2:this.bboxes[4*O+3]});for(let O=0;O<this.circleKeys.length;O++){const L=this.circles[3*O],F=this.circles[3*O+1],$=this.circles[3*O+2];k.push({key:this.circleKeys[O],x1:L-$,y1:F-$,x2:L+$,y2:F+$})}return A?k.filter(A):k}return this._forEachCell(o,f,g,x,this._queryCell,k,{hitTest:T,seenUids:{box:{},circle:{}}},A),T?k.length>0:k}_queryCircle(o,f,g,x,T){const A=o-g,k=o+g,O=f-g,L=f+g;if(k<0||A>this.width||L<0||O>this.height)return!x&&[];const F=[];return this._forEachCell(A,O,k,L,this._queryCellCircle,F,{hitTest:x,circle:{x:o,y:f,radius:g},seenUids:{box:{},circle:{}}},T),x?F.length>0:F}query(o,f,g,x,T){return this._query(o,f,g,x,!1,T)}hitTest(o,f,g,x,T){return this._query(o,f,g,x,!0,T)}hitTestCircle(o,f,g,x){return this._queryCircle(o,f,g,!0,x)}_queryCell(o,f,g,x,T,A,k,O){const L=k.seenUids,F=this.boxCells[T];if(F!==null){const W=this.bboxes;for(const Q of F)if(!L.box[Q]){L.box[Q]=!0;const X=4*Q;if(o<=W[X+2]&&f<=W[X+3]&&g>=W[X+0]&&x>=W[X+1]&&(!O||O(this.boxKeys[Q]))){if(k.hitTest)return A.push(!0),!0;A.push({key:this.boxKeys[Q],x1:W[X],y1:W[X+1],x2:W[X+2],y2:W[X+3]})}}}const $=this.circleCells[T];if($!==null){const W=this.circles;for(const Q of $)if(!L.circle[Q]){L.circle[Q]=!0;const X=3*Q;if(this._circleAndRectCollide(W[X],W[X+1],W[X+2],o,f,g,x)&&(!O||O(this.circleKeys[Q]))){if(k.hitTest)return A.push(!0),!0;{const J=W[X],de=W[X+1],Y=W[X+2];A.push({key:this.circleKeys[Q],x1:J-Y,y1:de-Y,x2:J+Y,y2:de+Y})}}}}}_queryCellCircle(o,f,g,x,T,A,k,O){const L=k.circle,F=k.seenUids,$=this.boxCells[T];if($!==null){const Q=this.bboxes;for(const X of $)if(!F.box[X]){F.box[X]=!0;const J=4*X;if(this._circleAndRectCollide(L.x,L.y,L.radius,Q[J+0],Q[J+1],Q[J+2],Q[J+3])&&(!O||O(this.boxKeys[X])))return A.push(!0),!0}}const W=this.circleCells[T];if(W!==null){const Q=this.circles;for(const X of W)if(!F.circle[X]){F.circle[X]=!0;const J=3*X;if(this._circlesCollide(Q[J],Q[J+1],Q[J+2],L.x,L.y,L.radius)&&(!O||O(this.circleKeys[X])))return A.push(!0),!0}}}_forEachCell(o,f,g,x,T,A,k,O){const L=this._convertToXCellCoord(o),F=this._convertToYCellCoord(f),$=this._convertToXCellCoord(g),W=this._convertToYCellCoord(x);for(let Q=L;Q<=$;Q++)for(let X=F;X<=W;X++)if(T.call(this,o,f,g,x,this.xCellCount*X+Q,A,k,O))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,f,g,x,T,A){const k=x-o,O=T-f,L=g+A;return L*L>k*k+O*O}_circleAndRectCollide(o,f,g,x,T,A,k){const O=(A-x)/2,L=Math.abs(o-(x+O));if(L>O+g)return!1;const F=(k-T)/2,$=Math.abs(f-(T+F));if($>F+g)return!1;if(L<=O||$<=F)return!0;const W=L-O,Q=$-F;return W*W+Q*Q<=g*g}}const Hn=Math.tan(85*Math.PI/180);function ys(_,o,f,g,x,T){let A=a.create();if(f){if(x.projection.name==="globe")A=a.calculateGlobeMatrix(x,x.worldSize/x._projectionScaler,[0,0]),a.multiply$1(A,A,a.globeDenormalizeECEF(a.globeTileBounds(o)));else{const k=I([],T);A[0]=k[0],A[1]=k[1],A[4]=k[2],A[5]=k[3]}g||a.rotateZ(A,A,x.angle)}else a.multiply$1(A,x.labelPlaneMatrix,_);return A}function Qo(_,o,f,g,x,T){if(f){if(x.projection.name==="globe"){const A=ys(_,o,f,g,x,T);return a.invert(A,A),a.multiply$1(A,_,A),A}{const A=a.clone(_),k=a.identity([]);return k[0]=T[0],k[1]=T[1],k[4]=T[2],k[5]=T[3],a.multiply$1(A,A,k),g||a.rotateZ(A,A,-x.angle),A}}return x.glCoordMatrix}function Gr(_,o,f=0){const g=[_.x,_.y,f,1];f?a.transformMat4$1(g,g,o):Dl(g,g,o);const x=g[3];return{point:new a.pointGeometry(g[0]/x,g[1]/x),signedDistanceFromCamera:x}}function Co(_,o){return Math.min(.5+_/o*.5,1.5)}function Zc(_,o){const f=_[0]/_[3],g=_[1]/_[3];return f>=-o[0]&&f<=o[0]&&g>=-o[1]&&g<=o[1]}function Yd(_,o,f,g,x,T,A,k,O,L){const F=f.transform,$=g?_.textSizeData:_.iconSizeData,W=a.evaluateSizeForZoom($,f.transform.zoom),Q=[256/f.width*2+1,256/f.height*2+1],X=g?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;X.clear();const J=_.lineVertexArray,de=g?_.text.placedSymbolArray:_.icon.placedSymbolArray,Y=f.transform.width/f.transform.height;let ce=!1;for(let ue=0;ue<de.length;ue++){const ae=de.get(ue);if(ae.writingMode!==a.WritingMode.vertical||ce||ue!==0&&de.get(ue-1).writingMode===a.WritingMode.horizontal||(ce=!0),ae.hidden||ae.writingMode===a.WritingMode.vertical&&!ce){so(ae.numGlyphs,X);continue}ce=!1;const le=new a.pointGeometry(ae.tileAnchorX,ae.tileAnchorY),me=O?O(le):[0,0,0],ke=F.projection.projectTilePoint(le.x,le.y,L.canonical),Le=[ke.x+me[0],ke.y+me[1],ke.z+me[2]],ht=[...Le,1];if(a.transformMat4$1(ht,ht,o),!Zc(ht,Q)){so(ae.numGlyphs,X);continue}const nt=Co(f.transform.cameraToCenterDistance,ht[3]),et=a.evaluateSizeForFeature($,W,ae),je=A?et/nt:et*nt,Re=Gr(new a.pointGeometry(Le[0],Le[1]),x,Le[2]);if(Re.signedDistanceFromCamera<=0){so(ae.numGlyphs,X);continue}let Qe={};const We=A?null:O,zt=Vh(ae,je,!1,k,o,x,T,_.glyphOffsetArray,J,X,Re.point,le,Qe,Y,We,F.projection,L);ce=zt.useVertical,We&&zt.needsFlipping&&(Qe={}),(zt.notEnoughRoom||ce||zt.needsFlipping&&Vh(ae,je,!0,k,o,x,T,_.glyphOffsetArray,J,X,Re.point,le,Qe,Y,We,F.projection,L).notEnoughRoom)&&so(ae.numGlyphs,X)}g?_.text.dynamicLayoutVertexBuffer.updateData(X):_.icon.dynamicLayoutVertexBuffer.updateData(X)}function $h(_,o,f,g,x,T,A,k,O,L,F,$,W,Q,X){const J=k.glyphStartIndex+k.numGlyphs,de=k.lineStartIndex,Y=k.lineStartIndex+k.lineLength,ce=o.getoffsetX(k.glyphStartIndex),ue=o.getoffsetX(J-1),ae=Pl(_*ce,f,g,x,T,A,k.segment,de,Y,O,L,F,$,W,!0,Q,X);if(!ae)return null;const le=Pl(_*ue,f,g,x,T,A,k.segment,de,Y,O,L,F,$,W,!0,Q,X);return le?{first:ae,last:le}:null}function kl(_,o,f,g){return _.writingMode===a.WritingMode.horizontal&&Math.abs(f.y-o.y)>Math.abs(f.x-o.x)*g?{useVertical:!0}:_.writingMode===a.WritingMode.vertical?o.y<f.y?{needsFlipping:!0}:null:_.flipState!==0&&function(x,T,A){const k=(T.x-x.x)*A;return k===0||Math.abs((T.y-x.y)/k)>Hn}(o,f,g)?_.flipState===1?{needsFlipping:!0}:null:o.x>f.x?{needsFlipping:!0}:null}function Vh(_,o,f,g,x,T,A,k,O,L,F,$,W,Q,X,J,de){const Y=o/24,ce=_.lineOffsetX*Y,ue=_.lineOffsetY*Y;let ae;if(_.numGlyphs>1){const le=_.glyphStartIndex+_.numGlyphs,me=_.lineStartIndex,ke=_.lineStartIndex+_.lineLength,Le=$h(Y,k,ce,ue,f,F,$,_,O,T,W,X,!1,J,de);if(!Le)return{notEnoughRoom:!0};const ht=Gr(Le.first.point,A).point,nt=Gr(Le.last.point,A).point;if(g&&!f){const et=kl(_,ht,nt,Q);if(_.flipState=et&&et.needsFlipping?1:2,et)return et}ae=[Le.first];for(let et=_.glyphStartIndex+1;et<le-1;et++)ae.push(Pl(Y*k.getoffsetX(et),ce,ue,f,F,$,_.segment,me,ke,O,T,W,X,!1,!1,J,de));ae.push(Le.last)}else{if(g&&!f){const me=Gr($,x).point,ke=_.lineStartIndex+_.segment+1,Le=new a.pointGeometry(O.getx(ke),O.gety(ke)),ht=Gr(Le,x),nt=kl(_,me,ht.signedDistanceFromCamera>0?ht.point:Hc($,Le,me,1,x,void 0,J,de.canonical),Q);if(_.flipState=nt&&nt.needsFlipping?1:2,nt)return nt}const le=Pl(Y*k.getoffsetX(_.glyphStartIndex),ce,ue,f,F,$,_.segment,_.lineStartIndex,_.lineStartIndex+_.lineLength,O,T,W,X,!1,!1,J,de);if(!le)return{notEnoughRoom:!0};ae=[le]}for(const le of ae)a.addDynamicAttributes(L,le.point,le.angle);return{}}function Wc(_,o,f,g,x){const T=g.projectTilePoint(_.x,_.y,o);if(!x)return Gr(T,f,T.z);const A=x(_);return Gr(new a.pointGeometry(T.x+A[0],T.y+A[1]),f,T.z+A[2])}function Hc(_,o,f,g,x,T,A,k){const O=Wc(_.add(_.sub(o)._unit()),k,x,A,T).point,L=f.sub(O);return f.add(L._mult(g/L.mag()))}function Pl(_,o,f,g,x,T,A,k,O,L,F,$,W,Q,X,J,de){const Y=g?_-o:_+o;let ce=Y>0?1:-1,ue=0;g&&(ce*=-1,ue=Math.PI),ce<0&&(ue+=Math.PI);let ae=ce>0?k+A:k+A+1,le=x,me=x,ke=0,Le=0;const ht=Math.abs(Y),nt=[],et=[];let je=T;const Re=()=>{const ut=ae-ce;return ke===0?T:new a.pointGeometry(L.getx(ut),L.gety(ut))},Qe=()=>Hc(Re(),je,me,ht-ke+1,F,W,J,de.canonical);for(;ke+Le<=ht;){if(ae+=ce,ae<k||ae>=O)return null;if(me=le,nt.push(le),Q&&et.push(je||Re()),le=$[ae],le===void 0){je=new a.pointGeometry(L.getx(ae),L.gety(ae));const ut=Wc(je,de.canonical,F,J,W);le=ut.signedDistanceFromCamera>0?$[ae]=ut.point:Qe()}else je=null;ke+=Le,Le=me.dist(le)}X&&W&&(je=je||new a.pointGeometry(L.getx(ae),L.gety(ae)),$[ae]=le=$[ae]===void 0?le:Qe(),Le=me.dist(le));const We=(ht-ke)/Le,zt=le.sub(me),jt=zt.mult(We)._add(me);f&&jt._add(zt._unit()._perp()._mult(f*ce));const Jt=ue+Math.atan2(le.y-me.y,le.x-me.x);return nt.push(jt),Q&&(je=je||new a.pointGeometry(L.getx(ae),L.gety(ae)),et.push(function(ut,Ft,Zt){const Pn=1-Zt;return new a.pointGeometry(ut.x*Pn+Ft.x*Zt,ut.y*Pn+Ft.y*Zt)}(et.length>0?et[et.length-1]:je,je,We))),{point:jt,angle:Jt,path:nt,tilePath:et}}const Gh=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function so(_,o){for(let f=0;f<_;f++){const g=o.length;o.resize(g+4),o.float32.set(Gh,3*g)}}function Dl(_,o,f){const g=o[0],x=o[1];return _[0]=f[0]*g+f[4]*x+f[12],_[1]=f[1]*g+f[5]*x+f[13],_[3]=f[3]*g+f[7]*x+f[15],_}const Io=100;class cg{constructor(o,f,g=new Nn(o.width+200,o.height+200,25),x=new Nn(o.width+200,o.height+200,25)){this.transform=o,this.grid=g,this.ignoredGrid=x,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+Io,this.screenBottomBoundary=o.height+Io,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.fogState=f}placeCollisionBox(o,f,g,x,T,A,k){let O=f.projectedAnchorX,L=f.projectedAnchorY,F=f.projectedAnchorZ;const $=f.elevation,W=f.tileID;if($&&W){const ae=this.transform.projection.createTileTransform(this.transform,this.transform.worldSize),le=ae.upVector(W.canonical,f.tileAnchorX,f.tileAnchorY),me=ae.upVectorScale(W.canonical);O+=le[0]*$*me,L+=le[1]*$*me,F+=le[2]*$*me}const Q=this.projectAndGetPerspectiveRatio(A,O,L,F,f.tileID),X=T*Q.perspectiveRatio,J=(f.x1*o+g.x-f.padding)*X+Q.point.x,de=(f.y1*o+g.y-f.padding)*X+Q.point.y,Y=(f.x2*o+g.x+f.padding)*X+Q.point.x,ce=(f.y2*o+g.y+f.padding)*X+Q.point.y,ue=Q.perspectiveRatio<=.55||Q.aboveHorizon;return!this.isInsideGrid(J,de,Y,ce)||!x&&this.grid.hitTest(J,de,Y,ce,k)||ue?{box:[],offscreen:!1}:{box:[J,de,Y,ce],offscreen:this.isOffscreen(J,de,Y,ce)}}placeCollisionCircles(o,f,g,x,T,A,k,O,L,F,$,W,Q,X){const J=[],de=this.transform.elevation,Y=this.transform.projection.createTileTransform(this.transform,this.transform.worldSize),ce=de?de.getAtTileOffsetFunc(X,Y):We=>[0,0,0],ue=new a.pointGeometry(f.tileAnchorX,f.tileAnchorY),ae=this.transform.projection.projectTilePoint(f.tileAnchorX,f.tileAnchorY,X.canonical),le=ce(ue),me=[ae.x+le[0],ae.y+le[1],ae.z+le[2]],ke=this.projectAndGetPerspectiveRatio(A,me[0],me[1],me[2],X),{perspectiveRatio:Le}=ke,ht=(F?T/Le:T*Le)/a.ONE_EM,nt=Gr(new a.pointGeometry(me[0],me[1]),k,me[2]).point,et=ke.signedDistanceFromCamera>0?$h(ht,x,f.lineOffsetX*ht,f.lineOffsetY*ht,!1,nt,ue,f,g,k,{},de&&!F?ce:null,F&&!!de,this.transform.projection,X):null;let je=!1,Re=!1,Qe=!0;if(et&&!ke.aboveHorizon){const We=.5*W*Le+Q,zt=new a.pointGeometry(-100,-100),jt=new a.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),Jt=new Wn,ut=et.first,Ft=et.last;let Zt=[];for(let qt=ut.path.length-1;qt>=1;qt--)Zt.push(ut.path[qt]);for(let qt=1;qt<Ft.path.length;qt++)Zt.push(Ft.path[qt]);const Pn=2.5*We;if(O){const qt=Zt.map(de?(sn,Xn)=>{const Er=ce(Xn<ut.path.length-1?ut.tilePath[ut.path.length-1-Xn]:Ft.tilePath[Xn-ut.path.length+2]);return Gr(sn,O,Er[2])}:sn=>Gr(sn,O));Zt=qt.some(sn=>sn.signedDistanceFromCamera<=0)?[]:qt.map(sn=>sn.point)}let jn=[];if(Zt.length>0){const qt=Zt[0].clone(),sn=Zt[0].clone();for(let Xn=1;Xn<Zt.length;Xn++)qt.x=Math.min(qt.x,Zt[Xn].x),qt.y=Math.min(qt.y,Zt[Xn].y),sn.x=Math.max(sn.x,Zt[Xn].x),sn.y=Math.max(sn.y,Zt[Xn].y);jn=qt.x>=zt.x&&sn.x<=jt.x&&qt.y>=zt.y&&sn.y<=jt.y?[Zt]:sn.x<zt.x||qt.x>jt.x||sn.y<zt.y||qt.y>jt.y?[]:a.clipLine([Zt],zt.x,zt.y,jt.x,jt.y)}for(const qt of jn){Jt.reset(qt,.25*We);let sn=0;sn=Jt.length<=.5*We?1:Math.ceil(Jt.paddedLength/Pn)+1;for(let Xn=0;Xn<sn;Xn++){const Er=Xn/Math.max(sn-1,1),xi=Jt.lerp(Er),Vi=xi.x+Io,uo=xi.y+Io;J.push(Vi,uo,We,0);const gn=Vi-We,Wt=uo-We,fn=Vi+We,ur=uo+We;if(Qe=Qe&&this.isOffscreen(gn,Wt,fn,ur),Re=Re||this.isInsideGrid(gn,Wt,fn,ur),!o&&this.grid.hitTestCircle(Vi,uo,We,$)&&(je=!0,!L))return{circles:[],offscreen:!1,collisionDetected:je}}}}return{circles:!L&&je||!Re?[]:J,offscreen:Qe,collisionDetected:je}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const f=[];let g=1/0,x=1/0,T=-1/0,A=-1/0;for(const F of o){const $=new a.pointGeometry(F.x+Io,F.y+Io);g=Math.min(g,$.x),x=Math.min(x,$.y),T=Math.max(T,$.x),A=Math.max(A,$.y),f.push($)}const k=this.grid.query(g,x,T,A).concat(this.ignoredGrid.query(g,x,T,A)),O={},L={};for(const F of k){const $=F.key;if(O[$.bucketInstanceId]===void 0&&(O[$.bucketInstanceId]={}),O[$.bucketInstanceId][$.featureIndex])continue;const W=[new a.pointGeometry(F.x1,F.y1),new a.pointGeometry(F.x2,F.y1),new a.pointGeometry(F.x2,F.y2),new a.pointGeometry(F.x1,F.y2)];a.polygonIntersectsPolygon(f,W)&&(O[$.bucketInstanceId][$.featureIndex]=!0,L[$.bucketInstanceId]===void 0&&(L[$.bucketInstanceId]=[]),L[$.bucketInstanceId].push($.featureIndex))}return L}insertCollisionBox(o,f,g,x,T){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:x,collisionGroupID:T},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,f,g,x,T){const A=f?this.ignoredGrid:this.grid,k={bucketInstanceId:g,featureIndex:x,collisionGroupID:T};for(let O=0;O<o.length;O+=4)A.insertCircle(k,o[O],o[O+1],o[O+2])}projectAndGetPerspectiveRatio(o,f,g,x,T){const A=[f,g,x||0,1];let k=!1;if(x||this.transform.pitch>0){a.transformMat4$1(A,A,o);let O=!1;this.fogState&&T&&(O=function(L,F,$,W,Q,X){const J=X.calculateFogTileMatrix(Q),de=[F,$,W];return a.transformMat4(de,de,J),ze(L,de,X.pitch,X._fov)}(this.fogState,f,g,x||0,T.toUnwrapped(),this.transform)>.9),k=A[2]>A[3]||O}else Dl(A,A,o);return{point:new a.pointGeometry((A[0]/A[3]+1)/2*this.transform.width+Io,(-A[1]/A[3]+1)/2*this.transform.height+Io),perspectiveRatio:Math.min(.5+this.transform.cameraToCenterDistance/A[3]*.5,1.5),signedDistanceFromCamera:A[3],aboveHorizon:k}}isOffscreen(o,f,g,x){return g<Io||o>=this.screenRightBoundary||x<Io||f>this.screenBottomBoundary}isInsideGrid(o,f,g,x){return g>=0&&o<this.gridRightBoundary&&x>=0&&f<this.gridBottomBoundary}getViewportMatrix(){const o=a.identity([]);return a.translate(o,o,[-100,-100,0]),o}}class Qd{constructor(o,f,g,x){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?f:-f))):x&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class Sa{constructor(o,f,g,x,T,A=!1){this.text=new Qd(o?o.text:null,f,g,T),this.icon=new Qd(o?o.icon:null,f,x,T),this.clipped=A}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Aa{constructor(o,f,g,x=!1){this.text=o,this.icon=f,this.skipFade=g,this.clipped=x}}class Rl{constructor(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]}}class Jd{constructor(o,f,g,x,T){this.bucketInstanceId=o,this.featureIndex=f,this.sourceLayerIndex=g,this.bucketIndex=x,this.tileID=T}}class ep{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const f=++this.maxGroupID;this.collisionGroups[o]={ID:f,predicate:g=>g.collisionGroupID===f}}return this.collisionGroups[o]}}function Xc(_,o,f,g,x){const{horizontalAlign:T,verticalAlign:A}=a.getAnchorAlignment(_),k=-(T-.5)*o,O=-(A-.5)*f,L=a.evaluateVariableOffset(_,g);return new a.pointGeometry(k+L[0]*x,O+L[1]*x)}function vs(_,o,f,g,x){const T=new a.pointGeometry(_,o);return f&&T._rotate(g?x:-x),T}class Kc{constructor(o,f,g,x,T){this.transform=o.clone(),this.collisionIndex=new cg(this.transform,T),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new ep(g),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,f,g,x){const T=g.getBucket(f),A=g.latestFeatureIndex;if(!T||!A||f.id!==T.layerIds[0])return;const k=T.layers[0].layout,O=g.collisionBoxArray,L=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),F=g.tileSize/a.EXTENT,$=g.tileID.toUnwrapped(),W=this.transform.calculateProjMatrix($),Q=k.get("text-pitch-alignment")==="map",X=k.get("text-rotation-alignment")==="map";f.compileFilter();const J=f.dynamicFilter(),de=f.dynamicFilterNeedsFeature(),Y=this.transform.calculatePixelsToTileUnitsMatrix(g),ce=ys(W,g.tileID.canonical,Q,X,this.transform,Y);let ue=null;if(Q){const me=Qo(W,g.tileID.canonical,Q,X,this.transform,Y);ue=a.multiply$1([],this.transform.labelPlaneMatrix,me)}let ae=null;J&&g.latestFeatureIndex&&(ae={unwrappedTileID:$,dynamicFilter:J,dynamicFilterNeedsFeature:de,featureIndex:g.latestFeatureIndex}),this.retainedQueryData[T.bucketInstanceId]=new Jd(T.bucketInstanceId,A,T.sourceLayerIndex,T.index,g.tileID);const le={bucket:T,layout:k,posMatrix:W,textLabelPlaneMatrix:ce,labelToScreenMatrix:ue,clippingData:ae,scale:L,textPixelRatio:F,holdingForFade:g.holdingForFade(),collisionBoxArray:O,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(T.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:a.evaluateSizeForZoom(T.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(T.sourceID)};if(x)for(const me of T.sortKeyRanges){const{sortKey:ke,symbolInstanceStart:Le,symbolInstanceEnd:ht}=me;o.push({sortKey:ke,symbolInstanceStart:Le,symbolInstanceEnd:ht,parameters:le})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:T.symbolInstances.length,parameters:le})}attemptAnchorPlacement(o,f,g,x,T,A,k,O,L,F,$,W,Q,X,J,de,Y,ce){const ue=[W.textOffset0,W.textOffset1],ae=Xc(o,g,x,ue,T),le=this.collisionIndex.placeCollisionBox(T,f,vs(ae.x,ae.y,A,k,this.transform.angle),$,O,L,F.predicate);if((!de||this.collisionIndex.placeCollisionBox(X.getSymbolInstanceIconSize(ce,this.transform.zoom,Q),de,vs(ae.x,ae.y,A,k,this.transform.angle),$,O,L,F.predicate).box.length!==0)&&le.box.length>0){let me;return this.prevPlacement&&this.prevPlacement.variableOffsets[W.crossTileID]&&this.prevPlacement.placements[W.crossTileID]&&this.prevPlacement.placements[W.crossTileID].text&&(me=this.prevPlacement.variableOffsets[W.crossTileID].anchor),this.variableOffsets[W.crossTileID]={textOffset:ue,width:g,height:x,anchor:o,textScale:T,prevAnchor:me},this.markUsedJustification(X,o,W,J),X.allowVerticalPlacement&&(this.markUsedOrientation(X,J,W),this.placedOrientations[W.crossTileID]=J),{shift:ae,placedGlyphBoxes:le}}}placeLayerBucketPart(o,f,g,x){const{bucket:T,layout:A,posMatrix:k,textLabelPlaneMatrix:O,labelToScreenMatrix:L,clippingData:F,textPixelRatio:$,holdingForFade:W,collisionBoxArray:Q,partiallyEvaluatedTextSize:X,partiallyEvaluatedIconSize:J,collisionGroup:de}=o.parameters,Y=A.get("text-optional"),ce=A.get("icon-optional"),ue=A.get("text-allow-overlap"),ae=A.get("icon-allow-overlap"),le=A.get("text-rotation-alignment")==="map",me=A.get("text-pitch-alignment")==="map",ke=A.get("icon-text-fit")!=="none",Le=A.get("symbol-z-order")==="viewport-y",ht=ue&&(ae||!T.hasIconData()||ce),nt=ae&&(ue||!T.hasTextData()||Y);!T.collisionArrays&&Q&&T.deserializeCollisionBoxes(Q),g&&x&&T.updateCollisionDebugBuffers(this.transform.zoom,Q);const et=(je,Re,Qe)=>{if(F){const gn={zoom:this.transform.zoom,pitch:this.transform.pitch};let Wt=null;if(F.dynamicFilterNeedsFeature){const fn=this.retainedQueryData[T.bucketInstanceId];Wt=F.featureIndex.loadFeature({featureIndex:je.featureIndex,bucketIndex:fn.bucketIndex,sourceLayerIndex:fn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,F.dynamicFilter)(gn,Wt,this.retainedQueryData[T.bucketInstanceId].tileID.canonical,new a.pointGeometry(je.tileAnchorX,je.tileAnchorY),this.transform.calculateDistanceTileData(F.unwrappedTileID)))return this.placements[je.crossTileID]=new Aa(!1,!1,!1,!0),void(f[je.crossTileID]=!0)}if(f[je.crossTileID])return;if(W)return void(this.placements[je.crossTileID]=new Aa(!1,!1,!1));let We=!1,zt=!1,jt=!0,Jt=null,ut={box:null,offscreen:null},Ft={box:null,offscreen:null},Zt=null,Pn=null,jn=null,qt=0,sn=0,Xn=0;Qe.textFeatureIndex?qt=Qe.textFeatureIndex:je.useRuntimeCollisionCircles&&(qt=je.featureIndex),Qe.verticalTextFeatureIndex&&(sn=Qe.verticalTextFeatureIndex);const Er=gn=>{gn.tileID=this.retainedQueryData[T.bucketInstanceId].tileID,(this.transform.elevation||gn.elevation)&&(gn.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[T.bucketInstanceId].tileID,gn.tileAnchorX,gn.tileAnchorY):0)},xi=Qe.textBox;if(xi){Er(xi);const gn=fn=>{let ur=a.WritingMode.horizontal;if(T.allowVerticalPlacement&&!fn&&this.prevPlacement){const Pi=this.prevPlacement.placedOrientations[je.crossTileID];Pi&&(this.placedOrientations[je.crossTileID]=Pi,ur=Pi,this.markUsedOrientation(T,ur,je))}return ur},Wt=(fn,ur)=>{if(T.allowVerticalPlacement&&je.numVerticalGlyphVertices>0&&Qe.verticalTextBox){for(const Pi of T.writingModes)if(Pi===a.WritingMode.vertical?(ut=ur(),Ft=ut):ut=fn(),ut&&ut.box&&ut.box.length)break}else ut=fn()};if(A.get("text-variable-anchor")){let fn=A.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[je.crossTileID]){const qn=this.prevPlacement.variableOffsets[je.crossTileID];fn.indexOf(qn.anchor)>0&&(fn=fn.filter(Di=>Di!==qn.anchor),fn.unshift(qn.anchor))}const ur=(qn,Di,ic)=>{const bi=T.getSymbolInstanceTextSize(X,je,this.transform.zoom,Re),ea=(qn.x2-qn.x1)*bi+2*qn.padding,Mt=(qn.y2-qn.y1)*bi+2*qn.padding,Bt=ke&&!ae?Di:null;Bt&&Er(Bt);let Lr={box:[],offscreen:!1};const ta=ue?2*fn.length:fn.length;for(let ks=0;ks<ta;++ks){const Zr=this.attemptAnchorPlacement(fn[ks%fn.length],qn,ea,Mt,bi,le,me,$,k,de,ks>=fn.length,je,Re,T,ic,Bt,X,J);if(Zr&&(Lr=Zr.placedGlyphBoxes,Lr&&Lr.box&&Lr.box.length)){We=!0,Jt=Zr.shift;break}}return Lr};Wt(()=>ur(xi,Qe.iconBox,a.WritingMode.horizontal),()=>{const qn=Qe.verticalTextBox;return qn&&Er(qn),T.allowVerticalPlacement&&!(ut&&ut.box&&ut.box.length)&&je.numVerticalGlyphVertices>0&&qn?ur(qn,Qe.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),ut&&(We=ut.box,jt=ut.offscreen);const Pi=gn(ut&&ut.box);if(!We&&this.prevPlacement){const qn=this.prevPlacement.variableOffsets[je.crossTileID];qn&&(this.variableOffsets[je.crossTileID]=qn,this.markUsedJustification(T,qn.anchor,je,Pi))}}else{const fn=(ur,Pi)=>{const qn=T.getSymbolInstanceTextSize(X,je,this.transform.zoom,Re),Di=this.collisionIndex.placeCollisionBox(qn,ur,new a.pointGeometry(0,0),ue,$,k,de.predicate);return Di&&Di.box&&Di.box.length&&(this.markUsedOrientation(T,Pi,je),this.placedOrientations[je.crossTileID]=Pi),Di};Wt(()=>fn(xi,a.WritingMode.horizontal),()=>{const ur=Qe.verticalTextBox;return T.allowVerticalPlacement&&je.numVerticalGlyphVertices>0&&ur?(Er(ur),fn(ur,a.WritingMode.vertical)):{box:null,offscreen:null}}),gn(ut&&ut.box&&ut.box.length)}}if(Zt=ut,We=Zt&&Zt.box&&Zt.box.length>0,jt=Zt&&Zt.offscreen,je.useRuntimeCollisionCircles){const gn=T.text.placedSymbolArray.get(je.centerJustifiedTextSymbolIndex>=0?je.centerJustifiedTextSymbolIndex:je.verticalPlacedTextSymbolIndex),Wt=a.evaluateSizeForFeature(T.textSizeData,X,gn),fn=A.get("text-padding");Pn=this.collisionIndex.placeCollisionCircles(ue,gn,T.lineVertexArray,T.glyphOffsetArray,Wt,k,O,L,g,me,de.predicate,je.collisionCircleDiameter*Wt/a.ONE_EM,fn,this.retainedQueryData[T.bucketInstanceId].tileID),We=ue||Pn.circles.length>0&&!Pn.collisionDetected,jt=jt&&Pn.offscreen}if(Qe.iconFeatureIndex&&(Xn=Qe.iconFeatureIndex),Qe.iconBox){const gn=Wt=>{Er(Wt);const fn=ke&&Jt?vs(Jt.x,Jt.y,le,me,this.transform.angle):new a.pointGeometry(0,0),ur=T.getSymbolInstanceIconSize(J,this.transform.zoom,Re);return this.collisionIndex.placeCollisionBox(ur,Wt,fn,ae,$,k,de.predicate)};Ft&&Ft.box&&Ft.box.length&&Qe.verticalIconBox?(jn=gn(Qe.verticalIconBox),zt=jn.box.length>0):(jn=gn(Qe.iconBox),zt=jn.box.length>0),jt=jt&&jn.offscreen}const Vi=Y||je.numHorizontalGlyphVertices===0&&je.numVerticalGlyphVertices===0,uo=ce||je.numIconVertices===0;if(Vi||uo?uo?Vi||(zt=zt&&We):We=zt&&We:zt=We=zt&&We,We&&Zt&&Zt.box&&this.collisionIndex.insertCollisionBox(Zt.box,A.get("text-ignore-placement"),T.bucketInstanceId,Ft&&Ft.box&&sn?sn:qt,de.ID),zt&&jn&&this.collisionIndex.insertCollisionBox(jn.box,A.get("icon-ignore-placement"),T.bucketInstanceId,Xn,de.ID),Pn&&(We&&this.collisionIndex.insertCollisionCircles(Pn.circles,A.get("text-ignore-placement"),T.bucketInstanceId,qt,de.ID),g)){const gn=T.bucketInstanceId;let Wt=this.collisionCircleArrays[gn];Wt===void 0&&(Wt=this.collisionCircleArrays[gn]=new Rl);for(let fn=0;fn<Pn.circles.length;fn+=4)Wt.circles.push(Pn.circles[fn+0]),Wt.circles.push(Pn.circles[fn+1]),Wt.circles.push(Pn.circles[fn+2]),Wt.circles.push(Pn.collisionDetected?1:0)}this.placements[je.crossTileID]=new Aa(We||ht,zt||nt,jt||T.justReloaded),f[je.crossTileID]=!0};if(Le){const je=T.getSortedSymbolIndexes(this.transform.angle);for(let Re=je.length-1;Re>=0;--Re){const Qe=je[Re];et(T.symbolInstances.get(Qe),Qe,T.collisionArrays[Qe])}}else for(let je=o.symbolInstanceStart;je<o.symbolInstanceEnd;je++)et(T.symbolInstances.get(je),je,T.collisionArrays[je]);if(g&&T.bucketInstanceId in this.collisionCircleArrays){const je=this.collisionCircleArrays[T.bucketInstanceId];a.invert(je.invProjMatrix,k),je.viewportMatrix=this.collisionIndex.getViewportMatrix()}T.justReloaded=!1}markUsedJustification(o,f,g,x){let T;T=x===a.WritingMode.vertical?g.verticalPlacedTextSymbolIndex:{left:g.leftJustifiedTextSymbolIndex,center:g.centerJustifiedTextSymbolIndex,right:g.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(f)];const A=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex,g.verticalPlacedTextSymbolIndex];for(const k of A)k>=0&&(o.text.placedSymbolArray.get(k).crossTileID=T>=0&&k!==T?0:g.crossTileID)}markUsedOrientation(o,f,g){const x=f===a.WritingMode.horizontal||f===a.WritingMode.horizontalOnly?f:0,T=f===a.WritingMode.vertical?f:0,A=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex];for(const k of A)o.text.placedSymbolArray.get(k).placedOrientation=x;g.verticalPlacedTextSymbolIndex&&(o.text.placedSymbolArray.get(g.verticalPlacedTextSymbolIndex).placedOrientation=T)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const f=this.prevPlacement;let g=!1;this.prevZoomAdjustment=f?f.zoomAdjustment(this.transform.zoom):0;const x=f?f.symbolFadeChange(o):1,T=f?f.opacities:{},A=f?f.variableOffsets:{},k=f?f.placedOrientations:{};for(const O in this.placements){const L=this.placements[O],F=T[O];F?(this.opacities[O]=new Sa(F,x,L.text,L.icon,null,L.clipped),g=g||L.text!==F.text.placed||L.icon!==F.icon.placed):(this.opacities[O]=new Sa(null,x,L.text,L.icon,L.skipFade,L.clipped),g=g||L.text||L.icon)}for(const O in T){const L=T[O];if(!this.opacities[O]){const F=new Sa(L,x,!1,!1);F.isHidden()||(this.opacities[O]=F,g=g||L.text.placed||L.icon.placed)}}for(const O in A)this.variableOffsets[O]||!this.opacities[O]||this.opacities[O].isHidden()||(this.variableOffsets[O]=A[O]);for(const O in k)this.placedOrientations[O]||!this.opacities[O]||this.opacities[O].isHidden()||(this.placedOrientations[O]=k[O]);g?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=f?f.lastPlacementChangeTime:o)}updateLayerOpacities(o,f){const g={};for(const x of f){const T=x.getBucket(o);T&&x.latestFeatureIndex&&o.id===T.layerIds[0]&&this.updateBucketOpacities(T,g,x.collisionBoxArray)}}updateBucketOpacities(o,f,g){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const x=o.layers[0].layout,T=!!o.layers[0].dynamicFilter(),A=new Sa(null,0,!1,!1,!0),k=x.get("text-allow-overlap"),O=x.get("icon-allow-overlap"),L=x.get("text-variable-anchor"),F=x.get("text-rotation-alignment")==="map",$=x.get("text-pitch-alignment")==="map",W=x.get("icon-text-fit")!=="none",Q=new Sa(null,0,k&&(O||!o.hasIconData()||x.get("icon-optional")),O&&(k||!o.hasTextData()||x.get("text-optional")),!0);!o.collisionArrays&&g&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(g);const X=(de,Y,ce)=>{for(let ue=0;ue<Y/4;ue++)de.opacityVertexArray.emplaceBack(ce)};let J=0;for(let de=0;de<o.symbolInstances.length;de++){const Y=o.symbolInstances.get(de),{numHorizontalGlyphVertices:ce,numVerticalGlyphVertices:ue,crossTileID:ae}=Y;let le=this.opacities[ae];f[ae]?le=A:le||(le=Q,this.opacities[ae]=le),f[ae]=!0;const me=ce>0||ue>0,ke=Y.numIconVertices>0,Le=this.placedOrientations[Y.crossTileID],ht=Le===a.WritingMode.vertical,nt=Le===a.WritingMode.horizontal||Le===a.WritingMode.horizontalOnly;if(!me&&!ke||le.isHidden()||J++,me){const et=Yc(le.text);X(o.text,ce,ht?ws:et),X(o.text,ue,nt?ws:et);const je=le.text.isHidden();[Y.rightJustifiedTextSymbolIndex,Y.centerJustifiedTextSymbolIndex,Y.leftJustifiedTextSymbolIndex].forEach(We=>{We>=0&&(o.text.placedSymbolArray.get(We).hidden=je||ht?1:0)}),Y.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(Y.verticalPlacedTextSymbolIndex).hidden=je||nt?1:0);const Re=this.variableOffsets[Y.crossTileID];Re&&this.markUsedJustification(o,Re.anchor,Y,Le);const Qe=this.placedOrientations[Y.crossTileID];Qe&&(this.markUsedJustification(o,"left",Y,Qe),this.markUsedOrientation(o,Qe,Y))}if(ke){const et=Yc(le.icon);Y.placedIconSymbolIndex>=0&&(X(o.icon,Y.numIconVertices,ht?ws:et),o.icon.placedSymbolArray.get(Y.placedIconSymbolIndex).hidden=le.icon.isHidden()),Y.verticalPlacedIconSymbolIndex>=0&&(X(o.icon,Y.numVerticalIconVertices,nt?ws:et),o.icon.placedSymbolArray.get(Y.verticalPlacedIconSymbolIndex).hidden=le.icon.isHidden())}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const et=o.collisionArrays[de];if(et){let je=new a.pointGeometry(0,0),Re=!0;if(et.textBox||et.verticalTextBox){if(L){const We=this.variableOffsets[ae];We?(je=Xc(We.anchor,We.width,We.height,We.textOffset,We.textScale),F&&je._rotate($?this.transform.angle:-this.transform.angle)):Re=!1}T&&(Re=!le.clipped),et.textBox&&xs(o.textCollisionBox.collisionVertexArray,le.text.placed,!Re||ht,je.x,je.y),et.verticalTextBox&&xs(o.textCollisionBox.collisionVertexArray,le.text.placed,!Re||nt,je.x,je.y)}const Qe=Re&&Boolean(!nt&&et.verticalIconBox);et.iconBox&&xs(o.iconCollisionBox.collisionVertexArray,le.icon.placed,Qe,W?je.x:0,W?je.y:0),et.verticalIconBox&&xs(o.iconCollisionBox.collisionVertexArray,le.icon.placed,!Qe,W?je.x:0,W?je.y:0)}}}if(o.fullyClipped=J===0,o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){const de=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=de.invProjMatrix,o.placementViewportMatrix=de.viewportMatrix,o.collisionCircleArray=de.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,f){const g=this.zoomAtLastRecencyCheck===f?1-this.zoomAdjustment(f):1;return this.zoomAtLastRecencyCheck=f,this.commitTime+this.fadeDuration*g>o}setStale(){this.stale=!0}}function xs(_,o,f,g,x){_.emplaceBack(o?1:0,f?1:0,g||0,x||0),_.emplaceBack(o?1:0,f?1:0,g||0,x||0),_.emplaceBack(o?1:0,f?1:0,g||0,x||0),_.emplaceBack(o?1:0,f?1:0,g||0,x||0)}const Ne=Math.pow(2,25),bt=Math.pow(2,24),tp=Math.pow(2,17),bs=Math.pow(2,16),pr=Math.pow(2,9),Jo=Math.pow(2,8),Mo=Math.pow(2,1);function Yc(_){if(_.opacity===0&&!_.placed)return 0;if(_.opacity===1&&_.placed)return 4294967295;const o=_.placed?1:0,f=Math.floor(127*_.opacity);return f*Ne+o*bt+f*tp+o*bs+f*pr+o*Jo+f*Mo+o}const ws=0;class xt{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&o.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,f,g,x,T){const A=this._bucketParts;for(;this._currentTileIndex<o.length;)if(f.getBucketParts(A,x,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,T())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,A.sort((k,O)=>k.sortKey-O.sortKey));this._currentPartIndex<A.length;){const k=A[this._currentPartIndex];if(f.placeLayerBucketPart(k,this._seenCrossTileIDs,g,k.symbolInstanceStart===0),this._currentPartIndex++,T())return!0}return!1}}class hn{constructor(o,f,g,x,T,A,k,O){this.placement=new Kc(o,T,A,k,O),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(o,f,g){const x=a.exported.now(),T=()=>{const A=a.exported.now()-x;return!this._forceFullPlacement&&A>2};for(;this._currentPlacementIndex>=0;){const A=f[o[this._currentPlacementIndex]],k=this.placement.collisionIndex.transform.zoom;if(A.type==="symbol"&&(!A.minzoom||A.minzoom<=k)&&(!A.maxzoom||A.maxzoom>k)){if(this._inProgressLayer||(this._inProgressLayer=new xt(A)),this._inProgressLayer.continuePlacement(g[A.source],this.placement,this._showCollisionBoxes,A,T))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const nn=512/a.EXTENT/2;class ko{constructor(o,f,g){this.tileID=o,this.indexedSymbolInstances={},this.bucketInstanceId=g;for(let x=0;x<f.length;x++){const T=f.get(x),A=T.key;this.indexedSymbolInstances[A]||(this.indexedSymbolInstances[A]=[]),this.indexedSymbolInstances[A].push({crossTileID:T.crossTileID,coord:this.getScaledCoordinates(T,o)})}}getScaledCoordinates(o,f){const g=nn/Math.pow(2,f.canonical.z-this.tileID.canonical.z);return{x:Math.floor((f.canonical.x*a.EXTENT+o.tileAnchorX)*g),y:Math.floor((f.canonical.y*a.EXTENT+o.tileAnchorY)*g)}}findMatches(o,f,g){const x=this.tileID.canonical.z<f.canonical.z?1:Math.pow(2,this.tileID.canonical.z-f.canonical.z);for(let T=0;T<o.length;T++){const A=o.get(T);if(A.crossTileID)continue;const k=this.indexedSymbolInstances[A.key];if(!k)continue;const O=this.getScaledCoordinates(A,f);for(const L of k)if(Math.abs(L.coord.x-O.x)<=x&&Math.abs(L.coord.y-O.y)<=x&&!g[L.crossTileID]){g[L.crossTileID]=!0,A.crossTileID=L.crossTileID;break}}}}class Ca{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class rn{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const f=Math.round((o-this.lng)/360);if(f!==0)for(const g in this.indexes){const x=this.indexes[g],T={};for(const A in x){const k=x[A];k.tileID=k.tileID.unwrapTo(k.tileID.wrap+f),T[k.tileID.key]=k}this.indexes[g]=T}this.lng=o}addBucket(o,f,g){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===f.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let T=0;T<f.symbolInstances.length;T++)f.symbolInstances.get(T).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const x=this.usedCrossTileIDs[o.overscaledZ];for(const T in this.indexes){const A=this.indexes[T];if(Number(T)>o.overscaledZ)for(const k in A){const O=A[k];O.tileID.isChildOf(o)&&O.findMatches(f.symbolInstances,o,x)}else{const k=A[o.scaledTo(Number(T)).key];k&&k.findMatches(f.symbolInstances,o,x)}}for(let T=0;T<f.symbolInstances.length;T++){const A=f.symbolInstances.get(T);A.crossTileID||(A.crossTileID=g.generate(),x[A.crossTileID]=!0)}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new ko(o,f.symbolInstances,f.bucketInstanceId),!0}removeBucketCrossTileIDs(o,f){for(const g in f.indexedSymbolInstances)for(const x of f.indexedSymbolInstances[g])delete this.usedCrossTileIDs[o][x.crossTileID]}removeStaleBuckets(o){let f=!1;for(const g in this.indexes){const x=this.indexes[g];for(const T in x)o[x[T].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,x[T]),delete x[T],f=!0)}return f}}class zl{constructor(){this.layerIndexes={},this.crossTileIDs=new Ca,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,f,g,x){let T=this.layerIndexes[o.id];T===void 0&&(T=this.layerIndexes[o.id]=new rn);let A=!1;const k={};x.name!=="globe"&&T.handleWrapJump(g);for(const O of f){const L=O.getBucket(o);L&&o.id===L.layerIds[0]&&(L.bucketInstanceId||(L.bucketInstanceId=++this.maxBucketInstanceId),T.addBucket(O.tileID,L,this.crossTileIDs)&&(A=!0),k[L.bucketInstanceId]=!0)}return T.removeStaleBuckets(k)&&(A=!0),A}pruneUnusedLayers(o){const f={};o.forEach(g=>{f[g]=!0});for(const g in this.layerIndexes)f[g]||delete this.layerIndexes[g]}}const Ts=(_,o)=>a.emitValidationErrors(_,o&&o.filter(f=>f.identifier!=="source.canvas")),Ol=a.pick(He,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Ui=a.pick(He,["setCenter","setZoom","setBearing","setPitch"]),sr=function(){const _={},o=a.spec.$version;for(const f in a.spec.$root){const g=a.spec.$root[f];if(g.required){let x=null;x=f==="version"?o:g.type==="array"?[]:{},x!=null&&(_[f]=x)}}return _}(),ug={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class yi extends a.Evented{constructor(o,f={}){super(),this.map=o,this.dispatcher=new Ke(ve(),this),this.imageManager=new pe,this.imageManager.setEventedParent(this),this.glyphManager=new a.GlyphManager(o._requestManager,f.localFontFamily?a.LocalGlyphMode.all:f.localIdeographFontFamily?a.LocalGlyphMode.ideographs:a.LocalGlyphMode.none,f.localFontFamily||f.localIdeographFontFamily),this.lineAtlas=new a.LineAtlas(256,512),this.crossTileSymbolIndex=new zl,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());const g=this;this._rtlTextPluginCallback=yi.registerForPluginStateChange(x=>{g.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},(T,A)=>{if(a.triggerPluginCompletionEvent(T),A&&A.every(k=>k))for(const k in g._sourceCaches){const O=g._sourceCaches[k],L=O.getSource().type;L!=="vector"&&L!=="geojson"||O.reload()}})}),this.on("data",x=>{if(x.dataType!=="source"||x.sourceDataType!=="metadata")return;const T=this.getSource(x.sourceId);if(T&&T.vectorLayerIds)for(const A in this._layers){const k=this._layers[A];k.source===T.id&&this._validateLayer(k)}})}loadURL(o,f={}){this.fire(new a.Event("dataloading",{dataType:"style"}));const g=typeof f.validate=="boolean"?f.validate:!a.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,f.accessToken);const x=this.map._requestManager.transformRequest(o,a.ResourceType.Style);this._request=a.getJSON(x,(T,A)=>{this._request=null,T?this.fire(new a.ErrorEvent(T)):A&&this._load(A,g)})}loadJSON(o,f={}){this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.exported.frame(()=>{this._request=null,this._load(o,f.validate!==!1)})}loadEmpty(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(sr,!1)}_updateLayerCount(o,f){const g=f?1:-1;o.is3D()&&(this._num3DLayers+=g),o.type==="circle"&&(this._numCircleLayers+=g),o.type==="symbol"&&(this._numSymbolLayers+=g)}_load(o,f){if(f&&Ts(this,a.validateStyle(o)))return;this._loaded=!0,this.stylesheet=o,this.updateProjection();for(const x in o.sources)this.addSource(x,o.sources[x],{validate:!1});this._changed=!1,o.sprite?this._loadSprite(o.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(o.glyphs);const g=Ze(this.stylesheet.layers);this._order=g.map(x=>x.id),this._layers={},this._serializedLayers={};for(let x of g)x=a.createStyleLayer(x),x.setEventedParent(this,{layer:{id:x.id}}),this._layers[x.id]=x,this._serializedLayers[x.id]=x.serialize(),this._updateLayerCount(x,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Te(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}terrainSetForDrapingOnly(){return this.terrain&&this.terrain.drapeRenderMode===0}setProjection(o){o?this.stylesheet.projection=o:delete this.stylesheet.projection,this.updateProjection()}updateProjection(){const o=this.map.transform.projection,f=this.map.transform.setProjection(this.map._runtimeProjection||(this.stylesheet?this.stylesheet.projection:void 0)),g=this.map.transform.projection;if(this._loaded&&(g.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null)),this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),f){if(g.isReprojectedInTileSpace||o.isReprojectedInTileSpace){this.map.painter.clearBackgroundTiles();for(const x in this._sourceCaches)this._sourceCaches[x].clearTiles()}else this._forceSymbolLayerUpdate();this.map._update(!0)}}_loadSprite(o){this._spriteRequest=function(f,g,x){let T,A,k;const O=a.exported.devicePixelRatio>1?"@2x":"";let L=a.getJSON(g.transformRequest(g.normalizeSpriteURL(f,O,".json"),a.ResourceType.SpriteJSON),(W,Q)=>{L=null,k||(k=W,T=Q,$())}),F=a.getImage(g.transformRequest(g.normalizeSpriteURL(f,O,".png"),a.ResourceType.SpriteImage),(W,Q)=>{F=null,k||(k=W,A=Q,$())});function $(){if(k)x(k);else if(T&&A){const W=a.exported.getImageData(A),Q={};for(const X in T){const{width:J,height:de,x:Y,y:ce,sdf:ue,pixelRatio:ae,stretchX:le,stretchY:me,content:ke}=T[X],Le=new a.RGBAImage({width:J,height:de});a.RGBAImage.copy(W,Le,{x:Y,y:ce},{x:0,y:0},{width:J,height:de}),Q[X]={data:Le,pixelRatio:ae,sdf:ue,stretchX:le,stretchY:me,content:ke}}x(null,Q)}}return{cancel(){L&&(L.cancel(),L=null),F&&(F.cancel(),F=null)}}}(o,this.map._requestManager,(f,g)=>{if(this._spriteRequest=null,f)this.fire(new a.ErrorEvent(f));else if(g)for(const x in g)this.imageManager.addImage(x,g[x]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new a.Event("data",{dataType:"style"}))})}_validateLayer(o){const f=this.getSource(o.source);if(!f)return;const g=o.sourceLayer;g&&(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(g)===-1)&&this.fire(new a.ErrorEvent(new Error(`Source layer "${g}" does not exist on source "${f.id}" as specified by style layer "${o.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this._sourceCaches)if(!this._sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(o){const f=[];for(const g of o){const x=this._layers[g];x.type!=="custom"&&f.push(x.serialize())}return f}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const o in this._sourceCaches)if(this._sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(o){return!!this.terrain&&ug[o.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(o){if(!this._loaded)return;const f=this._changed;if(this._changed){const x=Object.keys(this._updatedLayers),T=Object.keys(this._removedLayers);(x.length||T.length)&&this._updateWorkerLayers(x,T);for(const A in this._updatedSources){const k=this._updatedSources[A];k==="reload"?this._reloadSource(A):k==="clear"&&this._clearSource(A)}this._updateTilesForChangedImages();for(const A in this._updatedPaintProps)this._layers[A].updateTransitions(o);this.light.updateTransitions(o),this.fog&&this.fog.updateTransitions(o),this._resetUpdates()}const g={};for(const x in this._sourceCaches){const T=this._sourceCaches[x];g[x]=T.used,T.used=!1}for(const x of this._order){const T=this._layers[x];if(T.recalculate(o,this._availableImages),!T.isHidden(o.zoom)){const k=this._getLayerSourceCache(T);k&&(k.used=!0)}const A=this.map.painter;if(A){const k=T.getProgramIds();if(!k)continue;const O=T.getProgramConfiguration(o.zoom);for(const L of k)A.useProgram(L,O)}}for(const x in g){const T=this._sourceCaches[x];g[x]!==T.used&&T.getSource().fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:T.getSource().id}))}this.light.recalculate(o),this.terrain&&this.terrain.recalculate(o),this.fog&&this.fog.recalculate(o),this.z=o.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),f&&this.fire(new a.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const f in this._sourceCaches)this._sourceCaches[f].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateWorkerLayers(o,f){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:f})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(o){if(this._checkLoaded(),Ts(this,a.validateStyle(o)))return!1;(o=a.clone$1(o)).layers=Ze(o.layers);const f=function(x,T){if(!x)return[{command:He.setStyle,args:[T]}];let A=[];try{if(!M(x.version,T.version))return[{command:He.setStyle,args:[T]}];M(x.center,T.center)||A.push({command:He.setCenter,args:[T.center]}),M(x.zoom,T.zoom)||A.push({command:He.setZoom,args:[T.zoom]}),M(x.bearing,T.bearing)||A.push({command:He.setBearing,args:[T.bearing]}),M(x.pitch,T.pitch)||A.push({command:He.setPitch,args:[T.pitch]}),M(x.sprite,T.sprite)||A.push({command:He.setSprite,args:[T.sprite]}),M(x.glyphs,T.glyphs)||A.push({command:He.setGlyphs,args:[T.glyphs]}),M(x.transition,T.transition)||A.push({command:He.setTransition,args:[T.transition]}),M(x.light,T.light)||A.push({command:He.setLight,args:[T.light]}),M(x.fog,T.fog)||A.push({command:He.setFog,args:[T.fog]}),M(x.projection,T.projection)||A.push({command:He.setProjection,args:[T.projection]});const k={},O=[];(function($,W,Q,X){let J;for(J in W=W||{},$=$||{})$.hasOwnProperty(J)&&(W.hasOwnProperty(J)||Rt(J,Q,X));for(J in W)W.hasOwnProperty(J)&&($.hasOwnProperty(J)?M($[J],W[J])||($[J].type==="geojson"&&W[J].type==="geojson"&&Nt($,W,J)?Q.push({command:He.setGeoJSONSourceData,args:[J,W[J].data]}):Ut(J,W,Q,X)):tt(J,W,Q))})(x.sources,T.sources,O,k);const L=[];x.layers&&x.layers.forEach($=>{k[$.source]?A.push({command:He.removeLayer,args:[$.id]}):L.push($)});let F=x.terrain;F&&k[F.source]&&(A.push({command:He.setTerrain,args:[void 0]}),F=void 0),A=A.concat(O),M(F,T.terrain)||A.push({command:He.setTerrain,args:[T.terrain]}),function($,W,Q){W=W||[];const X=($=$||[]).map(on),J=W.map(on),de=$.reduce(Gn,{}),Y=W.reduce(Gn,{}),ce=X.slice(),ue=Object.create(null);let ae,le,me,ke,Le,ht,nt;for(ae=0,le=0;ae<X.length;ae++)me=X[ae],Y.hasOwnProperty(me)?le++:(Q.push({command:He.removeLayer,args:[me]}),ce.splice(ce.indexOf(me,le),1));for(ae=0,le=0;ae<J.length;ae++)me=J[J.length-1-ae],ce[ce.length-1-ae]!==me&&(de.hasOwnProperty(me)?(Q.push({command:He.removeLayer,args:[me]}),ce.splice(ce.lastIndexOf(me,ce.length-le),1)):le++,ht=ce[ce.length-ae],Q.push({command:He.addLayer,args:[Y[me],ht]}),ce.splice(ce.length-ae,0,me),ue[me]=!0);for(ae=0;ae<J.length;ae++)if(me=J[ae],ke=de[me],Le=Y[me],!ue[me]&&!M(ke,Le))if(M(ke.source,Le.source)&&M(ke["source-layer"],Le["source-layer"])&&M(ke.type,Le.type)){for(nt in $t(ke.layout,Le.layout,Q,me,null,He.setLayoutProperty),$t(ke.paint,Le.paint,Q,me,null,He.setPaintProperty),M(ke.filter,Le.filter)||Q.push({command:He.setFilter,args:[me,Le.filter]}),M(ke.minzoom,Le.minzoom)&&M(ke.maxzoom,Le.maxzoom)||Q.push({command:He.setLayerZoomRange,args:[me,Le.minzoom,Le.maxzoom]}),ke)ke.hasOwnProperty(nt)&&nt!=="layout"&&nt!=="paint"&&nt!=="filter"&&nt!=="metadata"&&nt!=="minzoom"&&nt!=="maxzoom"&&(nt.indexOf("paint.")===0?$t(ke[nt],Le[nt],Q,me,nt.slice(6),He.setPaintProperty):M(ke[nt],Le[nt])||Q.push({command:He.setLayerProperty,args:[me,nt,Le[nt]]}));for(nt in Le)Le.hasOwnProperty(nt)&&!ke.hasOwnProperty(nt)&&nt!=="layout"&&nt!=="paint"&&nt!=="filter"&&nt!=="metadata"&&nt!=="minzoom"&&nt!=="maxzoom"&&(nt.indexOf("paint.")===0?$t(ke[nt],Le[nt],Q,me,nt.slice(6),He.setPaintProperty):M(ke[nt],Le[nt])||Q.push({command:He.setLayerProperty,args:[me,nt,Le[nt]]}))}else Q.push({command:He.removeLayer,args:[me]}),ht=ce[ce.lastIndexOf(me)+1],Q.push({command:He.addLayer,args:[Le,ht]})}(L,T.layers,A)}catch(k){console.warn("Unable to compute style diff:",k),A=[{command:He.setStyle,args:[T]}]}return A}(this.serialize(),o).filter(x=>!(x.command in Ui));if(f.length===0)return!1;const g=f.filter(x=>!(x.command in Ol));if(g.length>0)throw new Error(`Unimplemented: ${g.map(x=>x.command).join(", ")}.`);return f.forEach(x=>{x.command!=="setTransition"&&this[x.command].apply(this,x.args)}),this.stylesheet=o,this.updateProjection(),!0}addImage(o,f){if(this.getImage(o))return this.fire(new a.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(o,f),this._afterImageUpdated(o)}updateImage(o,f){this.imageManager.updateImage(o,f)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){if(!this.getImage(o))return this.fire(new a.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(o),this._afterImageUpdated(o)}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(o,f,g={}){if(this._checkLoaded(),this.getSource(o)!==void 0)throw new Error("There is already a source with this ID");if(!f.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(f).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(f.type)>=0&&this._validate(a.validateStyle.source,`sources.${o}`,f,null,g))return;this.map&&this.map._collectResourceTiming&&(f.collectResourceTiming=!0);const x=Mi(o,f,this.dispatcher,this);x.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:x.serialize(),sourceId:o}));const T=A=>{const k=(A?"symbol:":"other:")+o,O=this._sourceCaches[k]=new a.SourceCache(k,x,A);(A?this._symbolSourceCaches:this._otherSourceCaches)[o]=O,O.style=this,O.onAdd(this.map)};T(!1),f.type!=="vector"&&f.type!=="geojson"||T(!0),x.onAdd&&x.onAdd(this.map),this._changed=!0}removeSource(o){this._checkLoaded();const f=this.getSource(o);if(f===void 0)throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===o)return this.fire(new a.ErrorEvent(new Error(`Source "${o}" cannot be removed while layer "${x}" is using it.`)));if(this.terrain&&this.terrain.get().source===o)return this.fire(new a.ErrorEvent(new Error(`Source "${o}" cannot be removed while terrain is using it.`)));const g=this._getSourceCaches(o);for(const x of g)delete this._sourceCaches[x.id],delete this._updatedSources[x.id],x.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:x.getSource().id})),x.setEventedParent(null),x.clearTiles();delete this._otherSourceCaches[o],delete this._symbolSourceCaches[o],f.setEventedParent(null),f.onRemove&&f.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(o,f){this._checkLoaded(),this.getSource(o).setData(f),this._changed=!0}getSource(o){const f=this._getSourceCache(o);return f&&f.getSource()}addLayer(o,f,g={}){this._checkLoaded();const x=o.id;if(this.getLayer(x))return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${x}" already exists on this map`)));let T;if(o.type==="custom"){if(Ts(this,a.validateCustomStyleLayer(o)))return;T=a.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(x,o.source),o=a.clone$1(o),o=a.extend(o,{source:x})),this._validate(a.validateStyle.layer,`layers.${x}`,o,{arrayIndex:-1},g))return;T=a.createStyleLayer(o),this._validateLayer(T),T.setEventedParent(this,{layer:{id:x}}),this._serializedLayers[T.id]=T.serialize(),this._updateLayerCount(T,!0)}const A=f?this._order.indexOf(f):this._order.length;if(f&&A===-1)return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${f}" does not exist on this map.`)));this._order.splice(A,0,x),this._layerOrderChanged=!0,this._layers[x]=T;const k=this._getLayerSourceCache(T);if(this._removedLayers[x]&&T.source&&k&&T.type!=="custom"){const O=this._removedLayers[x];delete this._removedLayers[x],O.type!==T.type?this._updatedSources[T.source]="clear":(this._updatedSources[T.source]="reload",k.pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(o,f){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===f)return;const g=this._order.indexOf(o);this._order.splice(g,1);const x=f?this._order.indexOf(f):this._order.length;f&&x===-1?this.fire(new a.ErrorEvent(new Error(`Layer with id "${f}" does not exist on this map.`))):(this._order.splice(x,0,o),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(o){this._checkLoaded();const f=this._layers[o];if(!f)return void this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be removed.`)));f.setEventedParent(null),this._updateLayerCount(f,!1);const g=this._order.indexOf(o);this._order.splice(g,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=f,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],f.onRemove&&f.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(o){return this._layers[o]}hasLayer(o){return o in this._layers}hasLayerType(o){for(const f in this._layers)if(this._layers[f].type===o)return!0;return!1}setLayerZoomRange(o,f,g){this._checkLoaded();const x=this.getLayer(o);x?x.minzoom===f&&x.maxzoom===g||(f!=null&&(x.minzoom=f),g!=null&&(x.maxzoom=g),this._updateLayer(x)):this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(o,f,g={}){this._checkLoaded();const x=this.getLayer(o);if(x){if(!M(x.filter,f))return f==null?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(a.validateStyle.filter,`layers.${x.id}.filter`,f,{layerType:x.type},g)||(x.filter=a.clone$1(f),this._updateLayer(x)))}else this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be filtered.`)))}getFilter(o){return a.clone$1(this.getLayer(o).filter)}setLayoutProperty(o,f,g,x={}){this._checkLoaded();const T=this.getLayer(o);T?M(T.getLayoutProperty(f),g)||(T.setLayoutProperty(f,g,x),this._updateLayer(T)):this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(o,f){const g=this.getLayer(o);if(g)return g.getLayoutProperty(f);this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style.`)))}setPaintProperty(o,f,g,x={}){this._checkLoaded();const T=this.getLayer(o);T?M(T.getPaintProperty(f),g)||(T.setPaintProperty(f,g,x)&&this._updateLayer(T),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(o,f){return this.getLayer(o).getPaintProperty(f)}setFeatureState(o,f){this._checkLoaded();const g=o.source,x=o.sourceLayer,T=this.getSource(g);if(T===void 0)return void this.fire(new a.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)));const A=T.type;if(A==="geojson"&&x)return void this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(A==="vector"&&!x)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided.")));const k=this._getSourceCaches(g);for(const O of k)O.setFeatureState(x,o.id,f)}removeFeatureState(o,f){this._checkLoaded();const g=o.source,x=this.getSource(g);if(x===void 0)return void this.fire(new a.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)));const T=x.type,A=T==="vector"?o.sourceLayer:void 0;if(T==="vector"&&!A)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(f&&typeof o.id!="string"&&typeof o.id!="number")return void this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const k=this._getSourceCaches(g);for(const O of k)O.removeFeatureState(A,o.id,f)}getFeatureState(o){this._checkLoaded();const f=o.source,g=o.sourceLayer,x=this.getSource(f);if(x!==void 0){if(x.type!=="vector"||g)return o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(f)[0].getFeatureState(g,o.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)))}getTransition(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const o={};for(const f in this._sourceCaches){const g=this._sourceCaches[f].getSource();o[g.id]||(o[g.id]=g.serialize())}return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:o,layers:this._serializeLayers(this._order)},f=>f!==void 0)}_updateLayer(o){this._updatedLayers[o.id]=!0;const f=this._getLayerSourceCache(o);o.source&&!this._updatedSources[o.source]&&f&&f.getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",f.pause()),this._changed=!0,o.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(o){const f=A=>this._layers[A].type==="fill-extrusion",g={},x=[];for(let A=this._order.length-1;A>=0;A--){const k=this._order[A];if(f(k)){g[k]=A;for(const O of o){const L=O[k];if(L)for(const F of L)x.push(F)}}}x.sort((A,k)=>k.intersectionZ-A.intersectionZ);const T=[];for(let A=this._order.length-1;A>=0;A--){const k=this._order[A];if(f(k))for(let O=x.length-1;O>=0;O--){const L=x[O].feature;if(g[L.layer.id]<A)break;T.push(L),x.pop()}else for(const O of o){const L=O[k];if(L)for(const F of L)T.push(F.feature)}}return T}queryRenderedFeatures(o,f,g){f&&f.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",f.filter,null,f);const x={};if(f&&f.layers){if(!Array.isArray(f.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const O of f.layers){const L=this._layers[O];if(!L)return this.fire(new a.ErrorEvent(new Error(`The layer '${O}' does not exist in the map's style and cannot be queried for features.`))),[];x[L.source]=!0}}const T=[];f.availableImages=this._availableImages;const A=f&&f.layers?f.layers.some(O=>{const L=this.getLayer(O);return L&&L.is3D()}):this.has3DLayers(),k=wa.createFromScreenPoints(o,g);for(const O in this._sourceCaches){const L=this._sourceCaches[O].getSource().id;f.layers&&!x[L]||T.push(B(this._sourceCaches[O],this._layers,this._serializedLayers,k,f,g,A,!!this.map._showQueryGeometry))}return this.placement&&T.push(function(O,L,F,$,W,Q,X){const J={},de=Q.queryRenderedSymbols($),Y=[];for(const ce of Object.keys(de).map(Number))Y.push(X[ce]);Y.sort(te);for(const ce of Y){const ue=ce.featureIndex.lookupSymbolFeatures(de[ce.bucketInstanceId],L,ce.bucketIndex,ce.sourceLayerIndex,W.filter,W.layers,W.availableImages,O);for(const ae in ue){const le=J[ae]=J[ae]||[],me=ue[ae];me.sort((ke,Le)=>{const ht=ce.featureSortOrder;if(ht){const nt=ht.indexOf(ke.featureIndex);return ht.indexOf(Le.featureIndex)-nt}return Le.featureIndex-ke.featureIndex});for(const ke of me)le.push(ke)}}for(const ce in J)J[ce].forEach(ue=>{const ae=ue.feature,le=F(O[ce]).getFeatureState(ae.layer["source-layer"],ae.id);ae.source=ae.layer.source,ae.layer["source-layer"]&&(ae.sourceLayer=ae.layer["source-layer"]),ae.state=le});return J}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),k.screenGeometry,f,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(T)}querySourceFeatures(o,f){f&&f.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",f.filter,null,f);const g=this._getSourceCaches(o);let x=[];for(const T of g)x=x.concat(Z(T,f));return x}addSourceType(o,f,g){return yi.getSourceType(o)?g(new Error(`A source type called "${o}" already exists.`)):(yi.setSourceType(o,f),f.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:f.workerSourceURL},g):g(null,null))}getLight(){return this.light.getLight()}setLight(o,f={}){this._checkLoaded();const g=this.light.getLight();let x=!1;for(const A in o)if(!M(o[A],g[A])){x=!0;break}if(!x)return;const T={now:a.exported.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,f),this.light.updateTransitions(T)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(o,f=1){if(this._checkLoaded(),!o)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(f===1){if(typeof o.source=="object"){const g="terrain-dem-src";this.addSource(g,o.source),o=a.clone$1(o),o=a.extend(o,{source:g})}if(this._validate(a.validateStyle.terrain,"terrain",o))return}if(!this.terrain||this.terrain&&f!==this.terrain.drapeRenderMode)this._createTerrain(o,f);else{const g=this.terrain,x=g.get();for(const T in o)if(!M(o[T],x[T])){g.set(o),this.stylesheet.terrain=o;const A={now:a.exported.now(),transition:a.extend({duration:0},this.stylesheet.transition)};g.updateTransitions(A);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(o){const f=this.fog=new qe(o,this.map.transform);this.stylesheet.fog=o;const g={now:a.exported.now(),transition:a.extend({duration:0},this.stylesheet.transition)};f.updateTransitions(g)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const o of this.map._markers)o._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(o){if(this._checkLoaded(),!o)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const f=this.fog,g=f.get();for(const x in o)if(!M(o[x],g[x])){f.set(o),this.stylesheet.fog=o;const T={now:a.exported.now(),transition:a.extend({duration:0},this.stylesheet.transition)};f.updateTransitions(T);break}}else this._createFog(o);this._markersNeedUpdate=!0}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const o=this._order.filter(g=>this.isLayerDraped(this._layers[g])),f=this._order.filter(g=>!this.isLayerDraped(this._layers[g]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...o),this._drapedFirstOrder.push(...f)}_createTerrain(o,f){const g=this.terrain=new Be(o,f);this.stylesheet.terrain=o,this.dispatcher.broadcast("enableTerrain",!0),this._force3DLayerUpdate();const x={now:a.exported.now(),transition:a.extend({duration:0},this.stylesheet.transition)};g.updateTransitions(x)}_force3DLayerUpdate(){for(const o in this._layers){const f=this._layers[o];f.type==="fill-extrusion"&&this._updateLayer(f)}}_forceSymbolLayerUpdate(){for(const o in this._layers){const f=this._layers[o];f.type==="symbol"&&this._updateLayer(f)}}_validate(o,f,g,x,T={}){return(!T||T.validate!==!1)&&Ts(this,o.call(a.validateStyle,a.extend({key:f,style:this.serialize(),value:g,styleSpec:a.spec},x)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this._sourceCaches)this._sourceCaches[o].clearTiles(),this._sourceCaches[o].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(o){const f=this._getSourceCaches(o);for(const g of f)g.clearTiles()}_reloadSource(o){const f=this._getSourceCaches(o);for(const g of f)g.resume(),g.reload()}_updateSources(o){for(const f in this._sourceCaches)this._sourceCaches[f].update(o)}_generateCollisionBoxes(){for(const o in this._sourceCaches){const f=this._sourceCaches[o];f.resume(),f.reload()}}_updatePlacement(o,f,g,x,T=!1){let A=!1,k=!1;const O={};for(const L of this._order){const F=this._layers[L];if(F.type!=="symbol")continue;if(!O[F.source]){const W=this._getLayerSourceCache(F);if(!W)continue;O[F.source]=W.getRenderableIds(!0).map(Q=>W.getTileByID(Q)).sort((Q,X)=>X.tileID.overscaledZ-Q.tileID.overscaledZ||(Q.tileID.isLessThan(X.tileID)?-1:1))}const $=this.crossTileSymbolIndex.addLayer(F,O[F.source],o.center.lng,o.projection);A=A||$}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),T=T||this._layerOrderChanged||g===0,this._layerOrderChanged&&this.fire(new a.Event("neworder")),(T||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.exported.now(),o.zoom))&&(this.pauseablePlacement=new hn(o,this._order,T,f,g,x,this.placement,this.fog&&o.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,O),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.exported.now()),k=!0),A&&this.pauseablePlacement.placement.setStale()),k||A)for(const L of this._order){const F=this._layers[L];F.type==="symbol"&&this.placement.updateLayerOpacities(F,O[F.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.exported.now())}_releaseSymbolFadeTiles(){for(const o in this._sourceCaches)this._sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,f,g){this.imageManager.getImages(f.icons,g),this._updateTilesForChangedImages();const x=T=>{T&&T.setDependencies(f.tileID.key,f.type,f.icons)};x(this._otherSourceCaches[f.source]),x(this._symbolSourceCaches[f.source])}getGlyphs(o,f,g){this.glyphManager.getGlyphs(f.stacks,g)}getResource(o,f,g){return a.makeRequest(f,g)}_getSourceCache(o){return this._otherSourceCaches[o]}_getLayerSourceCache(o){return o.type==="symbol"?this._symbolSourceCaches[o.source]:this._otherSourceCaches[o.source]}_getSourceCaches(o){const f=[];return this._otherSourceCaches[o]&&f.push(this._otherSourceCaches[o]),this._symbolSourceCaches[o]&&f.push(this._symbolSourceCaches[o]),f}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}yi.getSourceType=function(_){return Ea[_]},yi.setSourceType=function(_,o){Ea[_]=o},yi.registerForPluginStateChange=a.registerForPluginStateChange;var Qc=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}
#endif`,Ia="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let Ma={},ka={};Ma=Xt("",`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {return currentElevation(apos);}
#endif
float unpack_depth(vec4 rgba_depth)
{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,!0),ka=Xt(`#ifdef FOG
uniform float u_fog_temporal_offset;float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,`#ifdef FOG
uniform mat4 u_fog_matrix;vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,!0);const xn=Xt(`
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef TERRAIN
highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#endif`,`
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#if defined(PROJECTION_GLOBE_VIEW) && !defined(PROJECTED_POS_ON_VIEWPORT)
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {
#if defined(PROJECTION_GLOBE_VIEW) && !defined(PROJECTED_POS_ON_VIEWPORT)
return mix(globe,mercator,t);
#else
return globe;
#endif
}
#ifdef PROJECTION_GLOBE_VIEW
mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Jc=Qc;var qh={background:Xt(`uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Xt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Xt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
vec2 scaled_extrude=extrude*a_scale;vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=scaled_extrude.x*surface_vectors[0]+scaled_extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);vec4 world_center=vec4(pos,1);
#else 
mat3 surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
#if defined(SCALE_WITH_MAP) && defined(PROJECTION_GLOBE_VIEW)
view_scale*=a_scale;
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;
#else
vec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Xt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Xt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
extrude*=a_scale;vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
vec3 pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Xt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Xt("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Xt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Xt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Xt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Xt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Xt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Xt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Xt(`varying vec4 v_color;void main() {vec4 color=v_color;
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);
#else
vec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(pos.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Xt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);
#else
vec3 p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Xt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Xt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Xt(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;varying highp vec2 v_uv;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
#ifdef RENDER_LINE_GRADIENT
vec4 out_color=texture2D(u_gradient_image,v_uv);
#else
vec4 out_color=color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#ifdef RENDER_LINE_GRADIENT
attribute vec3 a_packed;
#else
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;varying highp vec2 v_uv;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_GRADIENT
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];float a_linesofar=a_packed[2];highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);
#endif
#ifdef RENDER_LINE_DASH
float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Xt(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Xt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Xt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Xt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_tile_id;uniform float u_zoom_transition;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Xt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Xt(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef FOG
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
const float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=u_skirt_height*u_skirt_height*wireframeOffset;
#endif
vec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
}`),terrainDepth:Xt(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Xt(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ia),skyboxGradient:Xt(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ia),skyboxCapture:Xt(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Xt(`uniform sampler2D u_image0;varying vec2 v_pos0;void main() {gl_FragColor=texture2D(u_image0,v_pos0);
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;attribute vec3 a_globe_pos;attribute vec2 a_merc_pos;attribute vec2 a_uv;varying vec2 v_pos0;const float wireframeOffset=1e3;void main() {v_pos0=a_uv;vec2 uv=a_uv*EXTENT;vec4 up_vector=vec4(elevationVector(uv),1.0);float height=elevation(uv);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
vec4 globe=u_globe_matrix*vec4(a_globe_pos+up_vector.xyz*height,1.0);vec4 mercator=vec4(0.0);if (u_zoom_transition > 0.0) {mercator=vec4(a_merc_pos,height,1.0);mercator.xy-=u_merc_center;mercator.x=wrap(mercator.x,-0.5,0.5);mercator=u_merc_matrix*mercator;}vec3 position=mix(globe.xyz,mercator.xyz,u_zoom_transition);gl_Position=u_proj_matrix*vec4(position,1.0);}`),globeAtmosphere:Xt(`uniform vec2 u_center;uniform float u_radius;uniform vec2 u_screen_size;uniform float u_opacity;uniform highp float u_fadeout_range;uniform vec3 u_start_color;uniform vec3 u_end_color;uniform float u_pixel_ratio;void main() {highp vec2 fragCoord=gl_FragCoord.xy/u_pixel_ratio;fragCoord.y=u_screen_size.y-fragCoord.y;float distFromCenter=length(fragCoord-u_center);float normDistFromCenter=length(fragCoord-u_center)/u_radius;if (normDistFromCenter < 1.0)
discard;float t=clamp(1.0-sqrt(normDistFromCenter-1.0)/u_fadeout_range,0.0,1.0);vec3 color=mix(u_start_color,u_end_color,1.0-t);gl_FragColor=vec4(color*t*u_opacity,u_opacity);}`,"attribute vec3 a_pos;void main() {gl_Position=vec4(a_pos,1.0);}")};function Xt(_,o,f){const g=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,x=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,T=o.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),A=_.match(x),k=o.match(x),O=Qc.match(x);let L=k?k.concat(A):A;f||(Ma.staticUniforms&&(L=Ma.staticUniforms.concat(L)),ka.staticUniforms&&(L=ka.staticUniforms.concat(L))),L&&(L=L.concat(O));const F={};return{fragmentSource:_=_.replace(g,($,W,Q,X,J)=>(F[J]=!0,W==="define"?`
#ifndef HAS_UNIFORM_u_${J}
varying ${Q} ${X} ${J};
#else
uniform ${Q} ${X} u_${J};
#endif
`:`
#ifdef HAS_UNIFORM_u_${J}
    ${Q} ${X} ${J} = u_${J};
#endif
`)),vertexSource:o=o.replace(g,($,W,Q,X,J)=>{const de=X==="float"?"vec2":"vec4",Y=J.match(/color/)?"color":de;return F[J]?W==="define"?`
#ifndef HAS_UNIFORM_u_${J}
uniform lowp float u_${J}_t;
attribute ${Q} ${de} a_${J};
varying ${Q} ${X} ${J};
#else
uniform ${Q} ${X} u_${J};
#endif
`:Y==="vec4"?`
#ifndef HAS_UNIFORM_u_${J}
    ${J} = a_${J};
#else
    ${Q} ${X} ${J} = u_${J};
#endif
`:`
#ifndef HAS_UNIFORM_u_${J}
    ${J} = unpack_mix_${Y}(a_${J}, u_${J}_t);
#else
    ${Q} ${X} ${J} = u_${J};
#endif
`:W==="define"?`
#ifndef HAS_UNIFORM_u_${J}
uniform lowp float u_${J}_t;
attribute ${Q} ${de} a_${J};
#else
uniform ${Q} ${X} u_${J};
#endif
`:Y==="vec4"?`
#ifndef HAS_UNIFORM_u_${J}
    ${Q} ${X} ${J} = a_${J};
#else
    ${Q} ${X} ${J} = u_${J};
#endif
`:`
#ifndef HAS_UNIFORM_u_${J}
    ${Q} ${X} ${J} = unpack_mix_${Y}(a_${J}, u_${J}_t);
#else
    ${Q} ${X} ${J} = u_${J};
#endif
`}),staticAttributes:T,staticUniforms:L}}class Ni{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(o,f,g,x,T,A,k,O){this.context=o;let L=this.boundPaintVertexBuffers.length!==x.length;for(let F=0;!L&&F<x.length;F++)this.boundPaintVertexBuffers[F]!==x[F]&&(L=!0);o.extVertexArrayObject&&this.vao&&this.boundProgram===f&&this.boundLayoutVertexBuffer===g&&!L&&this.boundIndexBuffer===T&&this.boundVertexOffset===A&&this.boundDynamicVertexBuffer===k&&this.boundDynamicVertexBuffer2===O?(o.bindVertexArrayOES.set(this.vao),k&&k.bind(),T&&T.dynamicDraw&&T.bind(),O&&O.bind()):this.freshBind(f,g,x,T,A,k,O)}freshBind(o,f,g,x,T,A,k){let O;const L=o.numAttributes,F=this.context,$=F.gl;if(F.extVertexArrayObject)this.vao&&this.destroy(),this.vao=F.extVertexArrayObject.createVertexArrayOES(),F.bindVertexArrayOES.set(this.vao),O=0,this.boundProgram=o,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=x,this.boundVertexOffset=T,this.boundDynamicVertexBuffer=A,this.boundDynamicVertexBuffer2=k;else{O=F.currentNumAttributes||0;for(let W=L;W<O;W++)$.disableVertexAttribArray(W)}f.enableAttributes($,o);for(const W of g)W.enableAttributes($,o);A&&A.enableAttributes($,o),k&&k.enableAttributes($,o),f.bind(),f.setVertexAttribPointers($,o,T);for(const W of g)W.bind(),W.setVertexAttribPointers($,o,T);A&&(A.bind(),A.setVertexAttribPointers($,o,T)),x&&x.bind(),k&&(k.bind(),k.setVertexAttribPointers($,o,T)),F.currentNumAttributes=L}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function np(_,o){const f=Math.pow(2,o.canonical.z),g=o.canonical.y;return[new a.MercatorCoordinate(0,g/f).toLngLat().lat,new a.MercatorCoordinate(0,(g+1)/f).toLngLat().lat]}function eu(_,o,f,g,x,T,A){const k=_.context,O=k.gl,L=f.fbo;if(!L)return;_.prepareDrawTile(o);const F=_.useProgram("hillshade");k.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,L.colorAttachment.get());const $=((J,de,Y,ce)=>{const ue=Y.paint.get("hillshade-shadow-color"),ae=Y.paint.get("hillshade-highlight-color"),le=Y.paint.get("hillshade-accent-color");let me=Y.paint.get("hillshade-illumination-direction")*(Math.PI/180);Y.paint.get("hillshade-illumination-anchor")==="viewport"&&(me-=J.transform.angle);const ke=!J.options.moving;return{u_matrix:ce||J.transform.calculateProjMatrix(de.tileID.toUnwrapped(),ke),u_image:0,u_latrange:np(0,de.tileID),u_light:[Y.paint.get("hillshade-exaggeration"),me],u_shadow:ue,u_highlight:ae,u_accent:le}})(_,f,g,_.terrain?o.projMatrix:null);_.prepareDrawProgram(k,F,o.toUnwrapped());const{tileBoundsBuffer:W,tileBoundsIndexBuffer:Q,tileBoundsSegments:X}=_.getTileBoundsBuffers(f);F.draw(k,O.TRIANGLES,x,T,A,a.CullFaceMode.disabled,$,g.id,W,Q,X)}function gr(_,o,f){if(!o.needsDEMTextureUpload)return;const g=_.context,x=g.gl;g.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||_.getTileTexture(f.stride);const T=f.getPixels();o.demTexture?o.demTexture.update(T,{premultiply:!1}):o.demTexture=new a.Texture(g,T,x.RGBA,{premultiply:!1}),o.needsDEMTextureUpload=!1}function Ll(_,o,f,g,x,T){const A=_.context,k=A.gl;if(!o.dem)return;const O=o.dem;if(A.activeTexture.set(k.TEXTURE1),gr(_,o,O),!o.demTexture)return;o.demTexture.bind(k.NEAREST,k.CLAMP_TO_EDGE);const L=O.dim;A.activeTexture.set(k.TEXTURE0);let F=o.fbo;if(!F){const X=new a.Texture(A,{width:L,height:L,data:null},k.RGBA);X.bind(k.LINEAR,k.CLAMP_TO_EDGE),F=o.fbo=A.createFramebuffer(L,L,!0),F.colorAttachment.set(X.texture)}A.bindFramebuffer.set(F.framebuffer),A.viewport.set([0,0,L,L]);const{tileBoundsBuffer:$,tileBoundsIndexBuffer:W,tileBoundsSegments:Q}=_.getMercatorTileBoundsBuffers();_.useProgram("hillshadePrepare").draw(A,k.TRIANGLES,g,x,T,a.CullFaceMode.disabled,((X,J)=>{const de=J.stride,Y=a.create();return a.ortho(Y,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(Y,Y,[0,-a.EXTENT,0]),{u_matrix:Y,u_image:1,u_dimension:[de,de],u_zoom:X.overscaledZ,u_unpack:J.unpackVector}})(o.tileID,O),f.id,$,W,Q),o.needsHillshadePrepare=!1}const Es=(_,o)=>({u_matrix:new a.UniformMatrix4f(_,o.u_matrix),u_image0:new a.Uniform1i(_,o.u_image0),u_skirt_height:new a.Uniform1f(_,o.u_skirt_height)}),zr=(_,o)=>({u_matrix:_,u_image0:0,u_skirt_height:o}),tu=(_,o,f,g,x)=>({u_proj_matrix:Float32Array.from(_),u_globe_matrix:o,u_merc_matrix:f,u_zoom_transition:g,u_merc_center:x,u_image0:0});function ji(_,o){return _!=null&&o!=null&&!(!_.hasData()||!o.hasData())&&_.demTexture!=null&&o.demTexture!=null&&_.tileID.key!==o.tileID.key}const Po=new class{constructor(){this.operations={}}newMorphing(_,o,f,g,x){if(_ in this.operations){const T=this.operations[_];T.to.tileID.key!==f.tileID.key&&(T.queued=f)}else this.operations[_]={startTime:g,phase:0,duration:x,from:o,to:f,queued:null}}getMorphValuesForProxy(_){if(!(_ in this.operations))return null;const o=this.operations[_];return{from:o.from,to:o.to,phase:o.phase}}update(_){for(const o in this.operations){const f=this.operations[o];for(f.phase=(_-f.startTime)/f.duration;f.phase>=1||!this._validOp(f);)if(!this._nextOp(f,_)){delete this.operations[o];break}}}_nextOp(_,o){return!!_.queued&&(_.from=_.to,_.to=_.queued,_.queued=null,_.phase=0,_.startTime=o,!0)}_validOp(_){return _.from.hasData()&&_.to.hasData()}},Ys={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function hg(_,o){const f=1<<_.z;return!o&&(_.x===0||_.x===f-1)||_.y===0||_.y===f-1}const Do=_=>({u_matrix:_});function rp(_,o,f,g,x){if(x>0){const T=a.exported.now(),A=(T-_.timeAdded)/x,k=o?(T-o.timeAdded)/x:-1,O=f.getSource(),L=g.coveringZoomLevel({tileSize:O.tileSize,roundZoom:O.roundZoom}),F=!o||Math.abs(o.tileID.overscaledZ-L)>Math.abs(_.tileID.overscaledZ-L),$=F&&_.refreshedUponExpiration?1:a.clamp(F?A:1-k,0,1);return _.refreshedUponExpiration&&A>=1&&(_.refreshedUponExpiration=!1),o?{opacity:1,mix:1-$}:{opacity:$,mix:0}}return{opacity:1,mix:0}}class ip extends a.SourceCache{constructor(o){const f={type:"raster-dem",maxzoom:o.transform.maxZoom},g=new Ke(ve(),null),x=Mi("mock-dem",f,g,o.style);super("mock-dem",x,!1),x.setEventedParent(this),this._sourceLoaded=!0}_loadTile(o,f){o.state="loaded",f(null)}}class ki extends a.SourceCache{constructor(o){const f=Mi("proxy",{type:"geojson",maxzoom:o.transform.maxZoom},new Ke(ve(),null),o.style);super("proxy",f,!1),f.setEventedParent(this),this.map=this.getSource().map=o,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(o,f,g){if(o.freezeTileCoverage)return;this.transform=o;const x=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((T,A)=>{if(T[A.key]="",!this._tiles[A.key]){const k=new a.Tile(A,this._source.tileSize*A.overscaleFactor(),o.tileZoom);k.state="loaded",this._tiles[A.key]=k}return T},{});for(const T in this._tiles)T in x||(this.freeFBO(T),this._tiles[T].unloadVectorData(),delete this._tiles[T])}freeFBO(o){const f=this.proxyCachedFBO[o];if(f!==void 0){const g=Object.values(f);this.renderCachePool.push(...g),delete this.proxyCachedFBO[o]}}deallocRenderCache(){this.renderCache.forEach(o=>o.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Fl extends a.OverscaledTileID{constructor(o,f,g){super(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y),this.proxyTileKey=f,this.projMatrix=g}}class Ss extends a.Elevation{constructor(o,f){super(),this.painter=o,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[g,x,T]=function(O){const L=new a.StructArrayLayout4i8,F=new a.StructArrayLayout3ui6,$=131;L.reserve(17161),F.reserve(33800);const W=a.EXTENT/128,Q=a.EXTENT+W/2,X=Q+W;for(let de=-W;de<X;de+=W)for(let Y=-W;Y<X;Y+=W){const ce=Y<0||Y>Q||de<0||de>Q?24575:0,ue=a.clamp(Math.round(Y),0,a.EXTENT),ae=a.clamp(Math.round(de),0,a.EXTENT);L.emplaceBack(ue+ce,ae,ue,ae)}const J=(de,Y)=>{const ce=Y*$+de;F.emplaceBack(ce+1,ce,ce+$),F.emplaceBack(ce+$,ce+$+1,ce+1)};for(let de=1;de<129;de++)for(let Y=1;Y<129;Y++)J(Y,de);return[0,129].forEach(de=>{for(let Y=0;Y<130;Y++)J(Y,de),J(de,Y)}),[L,F,32768]}(),A=o.context;this.gridBuffer=A.createVertexBuffer(g,a.boundsAttributes.members),this.gridIndexBuffer=A.createIndexBuffer(x),this.gridSegments=a.SegmentVector.simpleSegment(0,0,g.length,x.length),this.gridNoSkirtSegments=a.SegmentVector.simpleSegment(0,0,g.length,T),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new ki(f.map),this.orthoMatrix=a.create(),a.ortho(this.orthoMatrix,0,a.EXTENT,0,a.EXTENT,0,1);const k=A.gl;this._overlapStencilMode=new a.StencilMode({func:k.GEQUAL,mask:255},0,255,k.KEEP,k.KEEP,k.REPLACE),this._previousZoom=o.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=f,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new ip(f.map)}set style(o){o.on("data",this._onStyleDataEvent.bind(this)),o.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=o,this._checkRenderCacheEfficiency()}update(o,f,g){if(o&&o.terrain){this._style!==o&&(this.style=o),this.enabled=!0;const x=o.terrain.properties;this.sourceCache=o.terrain.drapeRenderMode===0?this._mockSourceCache:o._getSourceCache(x.get("source")),this._exaggeration=x.get("exaggeration");const T=()=>{this.sourceCache.used&&a.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const A=this.getScaledDemTileSize();this.sourceCache.update(f,A,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,T(),this._initializing=!0),T(),f.updateElevation(!g),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(f),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(o){this._findCoveringTileCache[o]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const o=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||o.efficiency!==100&&a.warnOnce(`Terrain render cache efficiency is not optimal (${o.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${o.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(o){o.coord&&o.dataType==="source"?this._clearRenderCacheForTile(o.sourceCacheId,o.coord):o.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const o in this._style._sourceCaches)this._style._sourceCaches[o].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(o=>o.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const o=2*this.proxySourceCache.getSource().tileSize;return[o,o]}set useVertexMorphing(o){this._useVertexMorphing=o}updateTileBinding(o){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const f=this.proxySourceCache,g=this.painter.transform;this._initializing&&(this._initializing=g._centerAltitude===0&&this.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(g.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const x=this.proxyCoords=f.getIds().map(O=>{const L=f.getTileByID(O).tileID;return L.projMatrix=g.calculateProjMatrix(L.toUnwrapped()),L});(function(O,L){const F=L.transform.pointCoordinate(L.transform.getCameraPoint()),$=new a.pointGeometry(F.x,F.y);O.sort((W,Q)=>{if(Q.overscaledZ-W.overscaledZ)return Q.overscaledZ-W.overscaledZ;const X=new a.pointGeometry(W.canonical.x+(1<<W.canonical.z)*W.wrap,W.canonical.y),J=new a.pointGeometry(Q.canonical.x+(1<<Q.canonical.z)*Q.wrap,Q.canonical.y),de=$.mult(1<<W.canonical.z);return de.x-=.5,de.y-=.5,de.distSqr(X)-de.distSqr(J)})})(x,this.painter),this._previousZoom=g.zoom;const T=this.proxyToSource||{};this.proxyToSource={},x.forEach(O=>{this.proxyToSource[O.key]={}}),this.terrainTileForTile={};const A=this._style._sourceCaches;for(const O in A){const L=A[O];if(!L.used||(L!==this.sourceCache&&this.resetTileLookupCache(L.id),this._setupProxiedCoordsForOrtho(L,o[O],T),L.usedForTerrain))continue;const F=o[O];L.getSource().reparseOverscaled&&this._assignTerrainTiles(F)}this.proxiedCoords[f.id]=x.map(O=>new Fl(O,O.key,this.orthoMatrix)),this._assignTerrainTiles(x),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(T),this.renderingToTexture=!1,this._updateTimestamp=a.exported.now();const k={};this._visibleDemTiles=[];for(const O of this.proxyCoords){const L=this.terrainTileForTile[O.key];if(!L)continue;const F=L.tileID.key;F in k||(this._visibleDemTiles.push(L),k[F]=F)}}_assignTerrainTiles(o){this._initializing||o.forEach(f=>{if(this.terrainTileForTile[f.key])return;const g=this._findTileCoveringTileID(f,this.sourceCache);g&&(this.terrainTileForTile[f.key]=g)})}_prepareDEMTextures(){const o=this.painter.context,f=o.gl;for(const g in this.terrainTileForTile){const x=this.terrainTileForTile[g],T=x.dem;!T||x.demTexture&&!x.needsDEMTextureUpload||(o.activeTexture.set(f.TEXTURE1),gr(this.painter,x,T))}}_prepareDemTileUniforms(o,f,g,x){if(!f||f.demTexture==null)return!1;const T=o.tileID.canonical,A=Math.pow(2,f.tileID.canonical.z-T.z),k=x||"";return g[`u_dem_tl${k}`]=[T.x*A%1,T.y*A%1],g[`u_dem_scale${k}`]=A,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const o=this.painter.context,f=o.gl;if(!this._emptyDepthBufferTexture){const g={width:1,height:1,data:new Uint8Array([255,255,255,255])};this._emptyDepthBufferTexture=new a.Texture(o,g,f.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let o=0;const f=this._visibleDemTiles.reduce((g,x)=>{if(!x.dem)return g;const T=x.dem.tree.minimums[0];return T>0&&o++,g+T},0);return o?f/o:0}_updateEmptyDEMTexture(){const o=this.painter.context,f=o.gl;o.activeTexture.set(f.TEXTURE2);const g=this._getLoadedAreaMinimum(),x={width:1,height:1,data:new Uint8Array(a.DEMData.pack(g,this.sourceCache.getSource().encoding))};this._emptyDEMTextureDirty=!1;let T=this._emptyDEMTexture;return T?T.update(x,{premultiply:!1}):T=this._emptyDEMTexture=new a.Texture(o,x,f.RGBA,{premultiply:!1}),T}setupElevationDraw(o,f,g){const x=this.painter.context,T=x.gl,A=(k=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:a.DEMData.getUnpackVector(k),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var k;A.u_dem_size=this.sourceCache.getSource().tileSize,A.u_exaggeration=this.exaggeration();const O=this.painter.transform,L=O.projection.createTileTransform(O,O.worldSize),F=o.tileID.canonical;A.u_tile_tl_up=L.upVector(F,0,0),A.u_tile_tr_up=L.upVector(F,a.EXTENT,0),A.u_tile_br_up=L.upVector(F,a.EXTENT,a.EXTENT),A.u_tile_bl_up=L.upVector(F,0,a.EXTENT),A.u_tile_up_scale=L.upVectorScale(F);let $=null,W=null,Q=1;if(g&&g.morphing&&this._useVertexMorphing){const X=g.morphing.srcDemTile,J=g.morphing.dstDemTile;Q=g.morphing.phase,X&&J&&(this._prepareDemTileUniforms(o,X,A,"_prev")&&(W=X),this._prepareDemTileUniforms(o,J,A)&&($=J))}if(W&&$?(x.activeTexture.set(T.TEXTURE2),$.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE,T.NEAREST),x.activeTexture.set(T.TEXTURE4),W.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE,T.NEAREST),A.u_dem_lerp=Q):($=this.terrainTileForTile[o.tileID.key],x.activeTexture.set(T.TEXTURE2),(this._prepareDemTileUniforms(o,$,A)?$.demTexture:this.emptyDEMTexture).bind(T.NEAREST,T.CLAMP_TO_EDGE)),x.activeTexture.set(T.TEXTURE3),g&&g.useDepthForOcclusion?(this._depthTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),A.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height]):(this.emptyDepthBufferTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),A.u_depth_size_inv=[1,1]),g&&g.useMeterToDem&&$){const X=(1<<$.tileID.canonical.z)*a.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;A.u_meter_to_dem=X}g&&g.labelPlaneMatrixInv&&(A.u_label_plane_matrix_inv=g.labelPlaneMatrixInv),f.setTerrainUniformValues(x,A)}renderToBackBuffer(o){const f=this.painter,g=this.painter.context;o.length!==0&&(g.bindFramebuffer.set(null),g.viewport.set([0,0,f.width,f.height]),this.renderingToTexture=!1,function(x,T,A,k,O){if(x.transform.projection.name==="globe")(function(L,F,$,W,Q){const X=L.context,J=X.gl;let de,Y;const ce=L.options.showTerrainWireframe?2:0,ue=(et,je)=>{if(Y===et)return;const Re=[];je&&Re.push(Ys[ce]),Re.push(Ys[et]),Re.push("PROJECTION_GLOBE_VIEW"),de=L.useProgram("globeRaster",null,Re),Y=et},ae=L.colorModeForRenderPass(),le=new a.DepthMode(J.LEQUAL,a.DepthMode.ReadWrite,L.depthRangeFor3D);Po.update(Q);const me=L.transform,ke=a.calculateGlobeMatrix(me,me.worldSize),Le=a.calculateGlobeMercatorMatrix(me),ht=[a.mercatorXfromLng(me.center.lng),a.mercatorYfromLat(me.center.lat)],nt=L.globeSharedBuffers;(ce?[!1,!0]:[!1]).forEach(et=>{Y=-1;const je=et?J.LINES:J.TRIANGLES;for(const Re of W){const Qe=$.getTile(Re),We=Math.pow(2,Re.canonical.z),[zt,jt]=a.globeBuffersForTileMesh(L,Qe,Re,We),Jt=a.StencilMode.disabled,ut=F.prevTerrainTileForTile[Re.key],Ft=F.terrainTileForTile[Re.key];ji(ut,Ft)&&Po.newMorphing(Re.key,ut,Ft,Q,250),X.activeTexture.set(J.TEXTURE0),Qe.texture.bind(J.LINEAR,J.CLAMP_TO_EDGE);const Zt=Po.getMorphValuesForProxy(Re.key),Pn=Zt?1:0,jn={};Zt&&a.extend$1(jn,{morphing:{srcDemTile:Zt.from,dstDemTile:Zt.to,phase:a.easeCubicInOut(Zt.phase)}});const qt=a.globeMatrixForTile(Re.canonical,ke),sn=tu(me.projMatrix,qt,Le,a.globeToMercatorTransition(me.zoom),ht);if(ue(Pn,et),F.setupElevationDraw(Qe,de,jn),L.prepareDrawProgram(X,de,Re.toUnwrapped()),nt){const[Xn,Er]=et?nt.getWirefameBuffer(L.context):[nt.gridIndexBuffer,nt.gridSegments];de.draw(X,je,le,Jt,ae,a.CullFaceMode.backCCW,sn,"globe_raster",zt,Xn,Er)}if(!et){const Xn=[Re.canonical.y===0?a.globePoleMatrixForTile(Re.canonical,!1,me):null,Re.canonical.y===We-1?a.globePoleMatrixForTile(Re.canonical,!0,me):null];for(const Er of Xn){if(!Er)continue;const xi=tu(me.projMatrix,Er,Er,0,ht);nt&&de.draw(X,je,le,Jt,ae,a.CullFaceMode.disabled,xi,"globe_pole_raster",jt,nt.poleIndexBuffer,nt.poleSegments)}}}})})(x,T,A,k,O);else{const L=x.context,F=L.gl;let $,W;const Q=x.options.showTerrainWireframe?2:0,X=(ue,ae)=>{if(W===ue)return;const le=[Ys[ue]];ae&&le.push(Ys[Q]),$=x.useProgram("terrainRaster",null,le),W=ue},J=x.colorModeForRenderPass(),de=new a.DepthMode(F.LEQUAL,a.DepthMode.ReadWrite,x.depthRangeFor3D);Po.update(O);const Y=x.transform,ce=6*Math.pow(1.5,22-Y.zoom)*T.exaggeration();(Q?[!1,!0]:[!1]).forEach(ue=>{W=-1;const ae=ue?F.LINES:F.TRIANGLES,[le,me]=ue?T.getWirefameBuffer():[T.gridIndexBuffer,T.gridSegments];for(const ke of k){const Le=A.getTile(ke),ht=a.StencilMode.disabled,nt=T.prevTerrainTileForTile[ke.key],et=T.terrainTileForTile[ke.key];ji(nt,et)&&Po.newMorphing(ke.key,nt,et,O,250),L.activeTexture.set(F.TEXTURE0),Le.texture.bind(F.LINEAR,F.CLAMP_TO_EDGE,F.LINEAR_MIPMAP_NEAREST);const je=Po.getMorphValuesForProxy(ke.key),Re=je?1:0;let Qe;je&&(Qe={morphing:{srcDemTile:je.from,dstDemTile:je.to,phase:a.easeCubicInOut(je.phase)}});const We=zr(ke.projMatrix,hg(ke.canonical,Y.renderWorldCopies)?ce/10:ce);X(Re,ue),T.setupElevationDraw(Le,$,Qe),x.prepareDrawProgram(L,$,ke.toUnwrapped()),$.draw(L,ae,de,ht,J,a.CullFaceMode.backCCW,We,"terrain_raster",T.gridBuffer,le,me)}})}}(f,this,this.proxySourceCache,o,this._updateTimestamp),this.renderingToTexture=!0,o.splice(0,o.length))}renderBatch(o){if(this._drapedRenderBatches.length===0)return o+1;this.renderingToTexture=!0;const f=this.painter,g=this.painter.context,x=this.proxySourceCache,T=this.proxiedCoords[x.id],A=this._drapedRenderBatches.shift(),k=[],O=f.style.order;let L=0;for(const F of T){const $=x.getTileByID(F.proxyTileKey),W=x.proxyCachedFBO[F.key]?x.proxyCachedFBO[F.key][o]:void 0,Q=W!==void 0?x.renderCache[W]:this.pool[L++],X=W!==void 0;if($.texture=Q.tex,X&&!Q.dirty){k.push($.tileID);continue}let J;g.bindFramebuffer.set(Q.fb.framebuffer),this.renderedToTile=!1,Q.dirty&&(g.clear({color:a.Color.transparent,stencil:0}),Q.dirty=!1);for(let de=A.start;de<=A.end;++de){const Y=f.style._layers[O[de]];if(Y.isHidden(f.transform.zoom))continue;const ce=f.style._getLayerSourceCache(Y),ue=ce?this.proxyToSource[F.key][ce.id]:[F];if(!ue)continue;const ae=ue;g.viewport.set([0,0,Q.fb.width,Q.fb.height]),J!==(ce?ce.id:null)&&(this._setupStencil(Q,ue,Y,ce),J=ce?ce.id:null),f.renderLayer(f,ce,Y,ae)}this.renderedToTile?(Q.dirty=!0,k.push($.tileID)):X||--L,L===5&&(L=0,this.renderToBackBuffer(k))}return this.renderToBackBuffer(k),this.renderingToTexture=!1,g.bindFramebuffer.set(null),g.viewport.set([0,0,f.width,f.height]),A.end+1}postRender(){}renderCacheEfficiency(o){const f=o.order.length;if(f===0)return{efficiency:100};let g,x=0,T=0,A=!1;for(let k=0;k<f;++k){const O=o._layers[o.order[k]];this._style.isLayerDraped(O)?(A&&++x,++T):A||(A=!0,g=O.id)}return T===0?{efficiency:100}:{efficiency:100*(1-x/T),firstUndrapedLayer:g}}getMinElevationBelowMSL(){let o=0;return this._visibleDemTiles.filter(f=>f.dem).forEach(f=>{o=Math.min(o,f.dem.tree.minimums[0])}),o===0?o:(o-30)*this._exaggeration}raycast(o,f,g){if(!this._visibleDemTiles)return null;const x=this._visibleDemTiles.filter(T=>T.dem).map(T=>{const A=T.tileID,k=Math.pow(2,A.overscaledZ),{x:O,y:L}=A.canonical,F=O/k,$=(O+1)/k,W=L/k,Q=(L+1)/k;return{minx:F,miny:W,maxx:$,maxy:Q,t:T.dem.tree.raycastRoot(F,W,$,Q,o,f,g),tile:T}});x.sort((T,A)=>(T.t!==null?T.t:Number.MAX_VALUE)-(A.t!==null?A.t:Number.MAX_VALUE));for(const T of x){if(T.t==null)return null;const A=T.tile.dem.tree.raycast(T.minx,T.miny,T.maxx,T.maxy,o,f,g);if(A!=null)return A}return null}_createFBO(){const o=this.painter.context,f=o.gl,g=this.drapeBufferSize;o.activeTexture.set(f.TEXTURE0);const x=new a.Texture(o,{width:g[0],height:g[1],data:null},f.RGBA);x.bind(f.LINEAR,f.CLAMP_TO_EDGE);const T=o.createFramebuffer(g[0],g[1],!1);return T.colorAttachment.set(x.texture),T.depthAttachment=new Rr(o,T.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=o.createRenderbuffer(o.gl.DEPTH_STENCIL,g[0],g[1]),this._stencilRef=0,T.depthAttachment.set(this._sharedDepthStencil),o.clear({stencil:0})):T.depthAttachment.set(this._sharedDepthStencil),o.extTextureFilterAnisotropic&&!o.extTextureFilterAnisotropicForceOff&&f.texParameterf(f.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax),{fb:T,tex:x,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const o in this._style._sourceCaches)if(this._style._sourceCaches[o].hasTransition())return!0;return this._style.order.some(o=>{const f=this._style._layers[o],g=f.isHidden(this.painter.transform.zoom),x=f.getCrossfadeParameters(),T=!!x&&x.t!==1,A=f.hasTransition();return f.type!=="custom"&&!g&&(T||A)})}_clearRasterFadeFromRenderCache(){let o=!1;for(const f in this._style._sourceCaches)if(this._style._sourceCaches[f]._source instanceof Yo){o=!0;break}if(o)for(let f=0;f<this._style.order.length;++f){const g=this._style._layers[this._style.order[f]],x=g.isHidden(this.painter.transform.zoom),T=this._style._getLayerSourceCache(g);if(g.type!=="raster"||x||!T)continue;const A=g.paint.get("raster-fade-duration");for(const k of this.proxyCoords){const O=this.proxyToSource[k.key][T.id];if(O)for(const L of O){const F=rp(T.getTile(L),T.findLoadedParent(L,0),T,this.painter.transform,A);(F.opacity!==1||F.mix!==0)&&this._clearRenderCacheForTile(T.id,L)}}}}_setupDrapedRenderBatches(){const o=this._style.order,f=o.length;if(f===0)return;const g=[];let x,T=0,A=this._style._layers[o[T]];for(;!this._style.isLayerDraped(A)&&A.isHidden(this.painter.transform.zoom)&&++T<f;)A=this._style._layers[o[T]];for(;T<f;++T){const k=this._style._layers[o[T]];k.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(k)?x===void 0&&(x=T):x!==void 0&&(g.push({start:x,end:T-1}),x=void 0))}x!==void 0&&g.push({start:x,end:T-1}),this._drapedRenderBatches=g}_setupRenderCache(o){const f=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,f.renderCache.length>f.renderCachePool.length){const A=Object.values(f.proxyCachedFBO);f.proxyCachedFBO={};for(let k=0;k<A.length;++k){const O=Object.values(A[k]);f.renderCachePool.push(...O)}}return}this._clearRasterFadeFromRenderCache();const g=this.proxyCoords,x=this._tilesDirty;for(let A=g.length-1;A>=0;A--){const k=g[A];if(f.getTileByID(k.key),f.proxyCachedFBO[k.key]!==void 0){const O=o[k.key],L=this.proxyToSource[k.key];let F=0;for(const $ in L){const W=L[$],Q=O[$];if(!Q||Q.length!==W.length||W.some((X,J)=>X!==Q[J]||x[$]&&x[$].hasOwnProperty(X.key))){F=-1;break}++F}for(const $ in f.proxyCachedFBO[k.key])f.renderCache[f.proxyCachedFBO[k.key][$]].dirty=F<0||F!==Object.values(O).length}}const T=[...this._drapedRenderBatches];T.sort((A,k)=>k.end-k.start-(A.end-A.start));for(const A of T)for(const k of g){if(f.proxyCachedFBO[k.key])continue;let O=f.renderCachePool.pop();O===void 0&&f.renderCache.length<50&&(O=f.renderCache.length,f.renderCache.push(this._createFBO())),O!==void 0&&(f.proxyCachedFBO[k.key]={},f.proxyCachedFBO[k.key][A.start]=O,f.renderCache[O].dirty=!0)}this._tilesDirty={}}_setupStencil(o,f,g,x){if(!x||!this._sourceTilesOverlap[x.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const T=this.painter.context,A=T.gl;if(f.length<=1)return void(this._overlapStencilType=!1);let k;if(g.isTileClipped())k=f.length,this._overlapStencilMode.test={func:A.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(f[0].overscaledZ>f[f.length-1].overscaledZ))return void(this._overlapStencilType=!1);k=1,this._overlapStencilMode.test={func:A.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+k>255&&(T.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=k,this._overlapStencilMode.ref=this._stencilRef,g.isTileClipped()&&this._renderTileClippingMasks(f,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(o){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[o.key]),this._overlapStencilMode):a.StencilMode.disabled}_renderTileClippingMasks(o,f){const g=this.painter,x=this.painter.context,T=x.gl;g._tileClippingMaskIDs={},x.setColorMode(a.ColorMode.disabled),x.setDepthMode(a.DepthMode.disabled);const A=g.useProgram("clippingMask");for(const k of o){const O=g._tileClippingMaskIDs[k.key]=--f;A.draw(x,T.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:T.ALWAYS,mask:0},O,255,T.KEEP,T.KEEP,T.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,Do(k.projMatrix),"$clipping",g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}}pointCoordinate(o){const f=this.painter.transform;if(o.x<0||o.x>f.width||o.y<0||o.y>f.height)return null;const g=[o.x,o.y,1,1];a.transformMat4$1(g,g,f.pixelMatrixInverse),a.scale$1(g,g,1/g[3]),g[0]/=f.worldSize,g[1]/=f.worldSize;const x=f._camera.position,T=a.mercatorZfromAltitude(1,f.center.lat),A=[x[0],x[1],x[2]/T,0],k=a.subtract([],g.slice(0,3),A);a.normalize(k,k);const O=this.raycast(A,k,this._exaggeration);return O!==null&&O?(a.scaleAndAdd(A,A,k,O),A[3]=A[2],A[2]*=T,A):null}drawDepth(){const o=this.painter,f=o.context,g=this.proxySourceCache,x=Math.ceil(o.width),T=Math.ceil(o.height);if(!this._depthFBO||this._depthFBO.width===x&&this._depthFBO.height===T||(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture),!this._depthFBO){const A=f.gl,k=f.createFramebuffer(x,T,!0);f.activeTexture.set(A.TEXTURE0);const O=new a.Texture(f,{width:x,height:T,data:null},A.RGBA);O.bind(A.NEAREST,A.CLAMP_TO_EDGE),k.colorAttachment.set(O.texture);const L=f.createRenderbuffer(f.gl.DEPTH_COMPONENT16,x,T);k.depthAttachment.set(L),this._depthFBO=k,this._depthTexture=O}f.bindFramebuffer.set(this._depthFBO.framebuffer),f.viewport.set([0,0,x,T]),function(A,k,O,L){if(A.transform.projection.name==="globe")return;const F=A.context,$=F.gl;F.clear({depth:1});const W=A.useProgram("terrainDepth"),Q=new a.DepthMode($.LESS,a.DepthMode.ReadWrite,A.depthRangeFor3D);for(const X of L){const J=O.getTile(X),de=zr(X.projMatrix,0);k.setupElevationDraw(J,W),W.draw(F,$.TRIANGLES,Q,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.backCCW,de,"terrain_depth",k.gridBuffer,k.gridIndexBuffer,k.gridNoSkirtSegments)}}(o,this,g,this.proxyCoords)}_setupProxiedCoordsForOrtho(o,f,g){if(o.getSource()instanceof Ao)return this._setupProxiedCoordsForImageSource(o,f,g);this._findCoveringTileCache[o.id]=this._findCoveringTileCache[o.id]||{};const x=this.proxiedCoords[o.id]=[],T=this.proxyCoords;for(let k=0;k<T.length;k++){const O=T[k],L=this._findTileCoveringTileID(O,o);if(L){const F=this._createProxiedId(O,L,g[O.key]&&g[O.key][o.id]);x.push(F),this.proxyToSource[O.key][o.id]=[F]}}let A=!1;for(let k=0;k<f.length;k++){const O=o.getTile(f[k]);if(!O||!O.hasData())continue;const L=this._findTileCoveringTileID(O.tileID,this.proxySourceCache);if(L&&L.tileID.canonical.z!==O.tileID.canonical.z){const F=this.proxyToSource[L.tileID.key][o.id],$=this._createProxiedId(L.tileID,O,g[L.tileID.key]&&g[L.tileID.key][o.id]);F?F.splice(F.length-1,0,$):this.proxyToSource[L.tileID.key][o.id]=[$],x.push($),A=!0}}this._sourceTilesOverlap[o.id]=A}_setupProxiedCoordsForImageSource(o,f,g){if(!o.getSource().loaded())return;const x=this.proxiedCoords[o.id]=[],T=this.proxyCoords,A=o.getSource(),k=new a.pointGeometry(A.tileID.x,A.tileID.y)._div(1<<A.tileID.z),O=A.coordinates.map(a.MercatorCoordinate.fromLngLat).reduce((F,$)=>(F.min.x=Math.min(F.min.x,$.x-k.x),F.min.y=Math.min(F.min.y,$.y-k.y),F.max.x=Math.max(F.max.x,$.x-k.x),F.max.y=Math.max(F.max.y,$.y-k.y),F),{min:new a.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),L=(F,$)=>{const W=F.wrap+F.canonical.x/(1<<F.canonical.z),Q=F.canonical.y/(1<<F.canonical.z),X=a.EXTENT/(1<<F.canonical.z),J=$.wrap+$.canonical.x/(1<<$.canonical.z),de=$.canonical.y/(1<<$.canonical.z);return W+X<J+O.min.x||W>J+O.max.x||Q+X<de+O.min.y||Q>de+O.max.y};for(let F=0;F<T.length;F++){const $=T[F];for(let W=0;W<f.length;W++){const Q=o.getTile(f[W]);if(!Q||!Q.hasData()||L($,Q.tileID))continue;const X=this._createProxiedId($,Q,g[$.key]&&g[$.key][o.id]),J=this.proxyToSource[$.key][o.id];J?J.push(X):this.proxyToSource[$.key][o.id]=[X],x.push(X)}}}_createProxiedId(o,f,g){let x=this.orthoMatrix;if(g){const T=g.find(A=>A.key===f.tileID.key);if(T)return T}if(f.tileID.key!==o.key){const T=o.canonical.z-f.tileID.canonical.z;let A,k,O;x=a.create();const L=f.tileID.wrap-o.wrap<<o.overscaledZ;T>0?(A=a.EXTENT>>T,k=A*((f.tileID.canonical.x<<T)-o.canonical.x+L),O=A*((f.tileID.canonical.y<<T)-o.canonical.y)):(A=a.EXTENT<<-T,k=a.EXTENT*(f.tileID.canonical.x-(o.canonical.x+L<<-T)),O=a.EXTENT*(f.tileID.canonical.y-(o.canonical.y<<-T))),a.ortho(x,0,A,0,A,0,1),a.translate(x,x,[k,O,0])}return new Fl(f.tileID,o.key,x)}_findTileCoveringTileID(o,f){let g=f.getTile(o);if(g&&g.hasData())return g;const x=this._findCoveringTileCache[f.id],T=x[o.key];if(g=T?f.getTileByID(T):null,g&&g.hasData()||T===null)return g;let A=g?g.tileID:o,k=A.overscaledZ;const O=f.getSource().minzoom,L=[];if(!T){const $=f.getSource().maxzoom;if(o.canonical.z>=$){const W=o.canonical.z-$;f.getSource().reparseOverscaled?(k=Math.max(o.canonical.z+2,f.transform.tileZoom),A=new a.OverscaledTileID(k,o.wrap,$,o.canonical.x>>W,o.canonical.y>>W)):W!==0&&(k=$,A=new a.OverscaledTileID(k,o.wrap,$,o.canonical.x>>W,o.canonical.y>>W))}A.key!==o.key&&(L.push(A.key),g=f.getTile(A))}const F=$=>{L.forEach(W=>{x[W]=$}),L.length=0};for(k-=1;k>=O&&(!g||!g.hasData());k--){g&&F(g.tileID.key);const $=A.calculateScaledKey(k);if(g=f.getTileByID($),g&&g.hasData())break;const W=x[$];if(W===null)break;W===void 0?L.push($):g=f.getTileByID(W)}return F(g?g.tileID.key:null),g&&g.hasData()?g:null}findDEMTileFor(o){return this.enabled?this._findTileCoveringTileID(o,this.sourceCache):null}prepareDrawTile(o){this.renderedToTile=!0}_clearRenderCacheForTile(o,f){let g=this._tilesDirty[o];g||(g=this._tilesDirty[o]={}),g[f.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const o=function(f){let g,x,T;const A=new a.StructArrayLayout2ui4,k=131;for(x=1;x<129;x++){for(g=1;g<129;g++)T=x*k+g,A.emplaceBack(T,T+1),A.emplaceBack(T,T+k),A.emplaceBack(T+1,T+k),x===128&&A.emplaceBack(T+k,T+k+1);A.emplaceBack(T+1,T+1+k)}return A}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(o),this.wireframeSegments=a.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,o.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}function nu(_){const o=[];for(let f=0;f<_.length;f++){if(_[f]===null)continue;const g=_[f].split(" ");o.push(g.pop())}return o}class Bl{static cacheKey(o,f,g){let x=`${o}${g?g.cacheKey:""}`;for(const T of f)x+=`/${T}`;return x}constructor(o,f,g,x,T,A){const k=o.gl;this.program=k.createProgram();const O=nu(g.staticAttributes),L=x?x.getBinderAttributes():[],F=O.concat(L),$=g.staticUniforms?nu(g.staticUniforms):[],W=x?x.getBinderUniforms():[],Q=$.concat(W),X=[];for(const le of Q)X.indexOf(le)<0&&X.push(le);let J=x?x.defines():[];J=J.concat(A.map(le=>`#define ${le}`));const de=J.concat(`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Jc,xn.fragmentSource,ka.fragmentSource,g.fragmentSource).join(`
`),Y=J.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Jc,xn.vertexSource,ka.vertexSource,Ma.vertexSource,g.vertexSource).join(`
`),ce=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);k.shaderSource(ce,de),k.compileShader(ce),k.attachShader(this.program,ce);const ue=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);k.shaderSource(ue,Y),k.compileShader(ue),k.attachShader(this.program,ue),this.attributes={};const ae={};this.numAttributes=F.length;for(let le=0;le<this.numAttributes;le++)F[le]&&(k.bindAttribLocation(this.program,le,F[le]),this.attributes[F[le]]=le);k.linkProgram(this.program),k.deleteShader(ue),k.deleteShader(ce);for(let le=0;le<X.length;le++){const me=X[le];if(me&&!ae[me]){const ke=k.getUniformLocation(this.program,me);ke&&(ae[me]=ke)}}this.fixedUniforms=T(o,ae),this.binderUniforms=x?x.getUniforms(o,ae):[],A.indexOf("TERRAIN")!==-1&&(this.terrainUniforms=((le,me)=>({u_dem:new a.Uniform1i(le,me.u_dem),u_dem_prev:new a.Uniform1i(le,me.u_dem_prev),u_dem_unpack:new a.Uniform4f(le,me.u_dem_unpack),u_dem_tl:new a.Uniform2f(le,me.u_dem_tl),u_dem_scale:new a.Uniform1f(le,me.u_dem_scale),u_dem_tl_prev:new a.Uniform2f(le,me.u_dem_tl_prev),u_dem_scale_prev:new a.Uniform1f(le,me.u_dem_scale_prev),u_dem_size:new a.Uniform1f(le,me.u_dem_size),u_dem_lerp:new a.Uniform1f(le,me.u_dem_lerp),u_exaggeration:new a.Uniform1f(le,me.u_exaggeration),u_depth:new a.Uniform1i(le,me.u_depth),u_depth_size_inv:new a.Uniform2f(le,me.u_depth_size_inv),u_meter_to_dem:new a.Uniform1f(le,me.u_meter_to_dem),u_label_plane_matrix_inv:new a.UniformMatrix4f(le,me.u_label_plane_matrix_inv),u_tile_tl_up:new a.Uniform3f(le,me.u_tile_tl_up),u_tile_tr_up:new a.Uniform3f(le,me.u_tile_tr_up),u_tile_br_up:new a.Uniform3f(le,me.u_tile_br_up),u_tile_bl_up:new a.Uniform3f(le,me.u_tile_bl_up),u_tile_up_scale:new a.Uniform1f(le,me.u_tile_up_scale)}))(o,ae)),A.indexOf("FOG")!==-1&&(this.fogUniforms=((le,me)=>({u_fog_matrix:new a.UniformMatrix4f(le,me.u_fog_matrix),u_fog_range:new a.Uniform2f(le,me.u_fog_range),u_fog_color:new a.Uniform4f(le,me.u_fog_color),u_fog_horizon_blend:new a.Uniform1f(le,me.u_fog_horizon_blend),u_fog_temporal_offset:new a.Uniform1f(le,me.u_fog_temporal_offset)}))(o,ae))}setTerrainUniformValues(o,f){if(!this.terrainUniforms)return;const g=this.terrainUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const x in f)g[x].set(f[x])}}setFogUniformValues(o,f){if(!this.fogUniforms)return;const g=this.fogUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const x in f)g[x].location&&g[x].set(f[x])}}draw(o,f,g,x,T,A,k,O,L,F,$,W,Q,X,J,de){const Y=o.gl;if(this.failedToCreate)return;o.program.set(this.program),o.setDepthMode(g),o.setStencilMode(x),o.setColorMode(T),o.setCullFace(A);for(const ue of Object.keys(this.fixedUniforms))this.fixedUniforms[ue].set(k[ue]);X&&X.setUniforms(o,this.binderUniforms,W,{zoom:Q});const ce={[Y.LINES]:2,[Y.TRIANGLES]:3,[Y.LINE_STRIP]:1}[f];for(const ue of $.get()){const ae=ue.vaos||(ue.vaos={});(ae[O]||(ae[O]=new Ni)).bind(o,this,L,X?X.getPaintVertexBuffers():[],F,ue.vertexOffset,J,de),Y.drawElements(f,ue.primitiveLength*ce,Y.UNSIGNED_SHORT,ue.primitiveOffset*ce*2)}}}function op(_,o,f){const g=1/_t(f,1,o.transform.tileZoom),x=Math.pow(2,f.tileID.overscaledZ),T=f.tileSize*Math.pow(2,o.transform.tileZoom)/x,A=T*(f.tileID.canonical.x+f.tileID.wrap*x),k=T*f.tileID.canonical.y;return{u_image:0,u_texsize:f.imageAtlasTexture.size,u_scale:[g,_.fromScale,_.toScale],u_fade:_.t,u_pixel_coord_upper:[A>>16,k>>16],u_pixel_coord_lower:[65535&A,65535&k]}}const sp=(_,o,f,g)=>{const x=o.style.light,T=x.properties.get("position"),A=[T.x,T.y,T.z],k=a.create$1();x.properties.get("anchor")==="viewport"&&(a.fromRotation(k,-o.transform.angle),a.transformMat3(A,A,k));const O=x.properties.get("color");return{u_matrix:_,u_lightpos:A,u_lightintensity:x.properties.get("intensity"),u_lightcolor:[O.r,O.g,O.b],u_vertical_gradient:+f,u_opacity:g}},Zh=(_,o,f,g,x,T,A)=>a.extend(sp(_,o,f,g),op(T,o,A),{u_height_factor:-Math.pow(2,x.overscaledZ)/A.tileSize/8}),ap=_=>({u_matrix:_}),Wh=(_,o,f,g)=>a.extend(ap(_),op(f,o,g)),fg=(_,o)=>({u_matrix:_,u_world:o}),lp=(_,o,f,g,x)=>a.extend(Wh(_,o,f,g),{u_world:x}),dg=(_,o,f,g)=>{const x=_.transform;let T;return T=g.paint.get("circle-pitch-alignment")==="map"?x.calculatePixelsToTileUnitsMatrix(f):new Float32Array([x.pixelsToGLUnits[0],0,0,x.pixelsToGLUnits[1]]),{u_camera_to_center_distance:x.cameraToCenterDistance,u_matrix:_.translatePosMatrix(o.projMatrix,f,g.paint.get("circle-translate"),g.paint.get("circle-translate-anchor")),u_device_pixel_ratio:a.exported.devicePixelRatio,u_extrude_scale:T}},Hh=_=>{const o=[];return _.paint.get("circle-pitch-alignment")==="map"&&o.push("PITCH_WITH_MAP"),_.paint.get("circle-pitch-scale")==="map"&&o.push("SCALE_WITH_MAP"),o},cp=(_,o,f)=>{const g=a.EXTENT/f.tileSize;return{u_matrix:_,u_camera_to_center_distance:o.cameraToCenterDistance,u_extrude_scale:[o.pixelsToGLUnits[0]/g,o.pixelsToGLUnits[1]/g]}},Xh=(_,o,f=1)=>({u_matrix:_,u_color:o,u_overlay:0,u_overlay_scale:f}),up=(_,o,f,g)=>({u_matrix:_,u_extrude_scale:_t(o,1,f),u_intensity:g}),hp=(_,o,f,g,x,T)=>{const A=_.transform,k=A.calculatePixelsToTileUnitsMatrix(o),O={u_matrix:Ul(_,o,f,x),u_pixels_to_tile_units:k,u_device_pixel_ratio:a.exported.devicePixelRatio,u_units_to_pixels:[1/A.pixelsToGLUnits[0],1/A.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:T,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0,u_alpha_discard_threshold:0};if(Nl(f)){const L=Pa(o,_.transform);O.u_texsize=o.lineAtlasTexture.size,O.u_scale=[L,g.fromScale,g.toScale],O.u_mix=g.t}return O},Qs=(_,o,f,g,x)=>{const T=_.transform,A=Pa(o,T);return{u_matrix:Ul(_,o,f,x),u_texsize:o.imageAtlasTexture.size,u_pixels_to_tile_units:T.calculatePixelsToTileUnitsMatrix(o),u_device_pixel_ratio:a.exported.devicePixelRatio,u_image:0,u_scale:[A,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Pa(_,o){return 1/_t(_,1,o.tileZoom)}function Ul(_,o,f,g){return _.translatePosMatrix(g||o.tileID.projMatrix,o,f.paint.get("line-translate"),f.paint.get("line-translate-anchor"))}function Nl(_){const o=_.paint.get("line-dasharray").value;return o.value||o.kind!=="constant"}const ru=(_,o,f,g,x,T)=>{return{u_matrix:_,u_tl_parent:o,u_scale_parent:f,u_fade_t:g.mix,u_opacity:g.opacity*x.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:x.paint.get("raster-brightness-min"),u_brightness_high:x.paint.get("raster-brightness-max"),u_saturation_factor:(k=x.paint.get("raster-saturation"),k>0?1-1/(1.001-k):-k),u_contrast_factor:(A=x.paint.get("raster-contrast"),A>0?1/(1-A):1+A),u_spin_weights:iu(x.paint.get("raster-hue-rotate")),u_perspective_transform:T};var A,k};function iu(_){_*=Math.PI/180;const o=Math.sin(_),f=Math.cos(_);return[(2*f+1)/3,(-Math.sqrt(3)*o-f+1)/3,(Math.sqrt(3)*o-f+1)/3]}const ou=(_,o,f,g,x,T,A,k,O,L,F,$,W,Q)=>{const X=x.transform;return{u_is_size_zoom_constant:+(_==="constant"||_==="source"),u_is_size_feature_constant:+(_==="constant"||_==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:X.cameraToCenterDistance,u_pitch:X.pitch/360*2*Math.PI,u_rotate_symbol:+f,u_aspect_ratio:X.width/X.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:T,u_label_plane_matrix:A,u_coord_matrix:k,u_is_text:+O,u_pitch_with_map:+g,u_texsize:L,u_tile_id:F,u_zoom_transition:$,u_inv_rot_matrix:W,u_merc_center:Q,u_texture:0}},jl=(_,o,f,g,x,T,A,k,O,L,F,$,W,Q,X)=>{const{cameraToCenterDistance:J,_pitch:de}=x.transform;return a.extend(ou(_,o,f,g,x,T,A,k,O,L,$,W,Q,X),{u_gamma_scale:g?J*Math.cos(x.terrain?0:de):1,u_device_pixel_ratio:a.exported.devicePixelRatio,u_is_halo:+F})},$l=(_,o,f,g,x,T,A,k,O,L,F,$,W,Q)=>a.extend(jl(_,o,f,g,x,T,A,k,!0,O,!0,F,$,W,Q),{u_texsize_icon:L,u_texture_icon:1}),In=(_,o,f)=>({u_matrix:_,u_opacity:o,u_color:f}),su=(_,o,f,g,x,T)=>a.extend(function(A,k,O,L){const F=O.imageManager.getPattern(A.from.toString()),$=O.imageManager.getPattern(A.to.toString()),{width:W,height:Q}=O.imageManager.getPixelSize(),X=Math.pow(2,L.tileID.overscaledZ),J=L.tileSize*Math.pow(2,O.transform.tileZoom)/X,de=J*(L.tileID.canonical.x+L.tileID.wrap*X),Y=J*L.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:F.tl,u_pattern_br_a:F.br,u_pattern_tl_b:$.tl,u_pattern_br_b:$.br,u_texsize:[W,Q],u_mix:k.t,u_pattern_size_a:F.displaySize,u_pattern_size_b:$.displaySize,u_scale_a:k.fromScale,u_scale_b:k.toScale,u_tile_units_to_pixels:1/_t(L,1,O.transform.tileZoom),u_pixel_coord_upper:[de>>16,Y>>16],u_pixel_coord_lower:[65535&de,65535&Y]}}(g,T,f,x),{u_matrix:_,u_opacity:o}),fp={fillExtrusion:(_,o)=>({u_matrix:new a.UniformMatrix4f(_,o.u_matrix),u_lightpos:new a.Uniform3f(_,o.u_lightpos),u_lightintensity:new a.Uniform1f(_,o.u_lightintensity),u_lightcolor:new a.Uniform3f(_,o.u_lightcolor),u_vertical_gradient:new a.Uniform1f(_,o.u_vertical_gradient),u_opacity:new a.Uniform1f(_,o.u_opacity)}),fillExtrusionPattern:(_,o)=>({u_matrix:new a.UniformMatrix4f(_,o.u_matrix),u_lightpos:new a.Uniform3f(_,o.u_lightpos),u_lightintensity:new a.Uniform1f(_,o.u_lightintensity),u_lightcolor:new a.Uniform3f(_,o.u_lightcolor),u_vertical_gradient:new a.Uniform1f(_,o.u_vertical_gradient),u_height_factor:new a.Uniform1f(_,o.u_height_factor),u_image:new a.Uniform1i(_,o.u_image),u_texsize:new a.Uniform2f(_,o.u_texsize),u_pixel_coord_upper:new a.Uniform2f(_,o.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(_,o.u_pixel_coord_lower),u_scale:new a.Uniform3f(_,o.u_scale),u_fade:new a.Uniform1f(_,o.u_fade),u_opacity:new a.Uniform1f(_,o.u_opacity)}),fill:(_,o)=>({u_matrix:new a.UniformMatrix4f(_,o.u_matrix)}),fillPattern:(_,o)=>({u_matrix:new a.UniformMatrix4f(_,o.u_matrix),u_image:new a.Uniform1i(_,o.u_image),u_texsize:new a.Uniform2f(_,o.u_texsize),u_pixel_coord_upper:new a.Uniform2f(_,o.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(_,o.u_pixel_coord_lower),u_scale:new a.Uniform3f(_,o.u_scale),u_fade:new a.Uniform1f(_,o.u_fade)}),fillOutline:(_,o)=>({u_matrix:new a.UniformMatrix4f(_,o.u_matrix),u_world:new a.Uniform2f(_,o.u_world)}),fillOutlinePattern:(_,o)=>({u_matrix:new a.UniformMatrix4f(_,o.u_matrix),u_world:new a.Uniform2f(_,o.u_world),u_image:new a.Uniform1i(_,o.u_image),u_texsize:new a.Uniform2f(_,o.u_texsize),u_pixel_coord_upper:new a.Uniform2f(_,o.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(_,o.u_pixel_coord_lower),u_scale:new a.Uniform3f(_,o.u_scale),u_fade:new a.Uniform1f(_,o.u_fade)}),circle:(_,o)=>({u_camera_to_center_distance:new a.Uniform1f(_,o.u_camera_to_center_distance),u_extrude_scale:new a.UniformMatrix2f(_,o.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(_,o.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(_,o.u_matrix)}),collisionBox:(_,o)=>({u_matrix:new a.UniformMatrix4f(_,o.u_matrix),u_camera_to_center_distance:new a.Uniform1f(_,o.u_camera_to_center_distance),u_extrude_scale:new a.Uniform2f(_,o.u_extrude_scale)}),collisionCircle:(_,o)=>({u_matrix:new a.UniformMatrix4f(_,o.u_matrix),u_inv_matrix:new a.UniformMatrix4f(_,o.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(_,o.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(_,o.u_viewport_size)}),debug:(_,o)=>({u_color:new a.UniformColor(_,o.u_color),u_matrix:new a.UniformMatrix4f(_,o.u_matrix),u_overlay:new a.Uniform1i(_,o.u_overlay),u_overlay_scale:new a.Uniform1f(_,o.u_overlay_scale)}),clippingMask:(_,o)=>({u_matrix:new a.UniformMatrix4f(_,o.u_matrix)}),heatmap:(_,o)=>({u_extrude_scale:new a.Uniform1f(_,o.u_extrude_scale),u_intensity:new a.Uniform1f(_,o.u_intensity),u_matrix:new a.UniformMatrix4f(_,o.u_matrix)}),heatmapTexture:(_,o)=>({u_image:new a.Uniform1i(_,o.u_image),u_color_ramp:new a.Uniform1i(_,o.u_color_ramp),u_opacity:new a.Uniform1f(_,o.u_opacity)}),hillshade:(_,o)=>({u_matrix:new a.UniformMatrix4f(_,o.u_matrix),u_image:new a.Uniform1i(_,o.u_image),u_latrange:new a.Uniform2f(_,o.u_latrange),u_light:new a.Uniform2f(_,o.u_light),u_shadow:new a.UniformColor(_,o.u_shadow),u_highlight:new a.UniformColor(_,o.u_highlight),u_accent:new a.UniformColor(_,o.u_accent)}),hillshadePrepare:(_,o)=>({u_matrix:new a.UniformMatrix4f(_,o.u_matrix),u_image:new a.Uniform1i(_,o.u_image),u_dimension:new a.Uniform2f(_,o.u_dimension),u_zoom:new a.Uniform1f(_,o.u_zoom),u_unpack:new a.Uniform4f(_,o.u_unpack)}),line:(_,o)=>({u_matrix:new a.UniformMatrix4f(_,o.u_matrix),u_pixels_to_tile_units:new a.UniformMatrix2f(_,o.u_pixels_to_tile_units),u_device_pixel_ratio:new a.Uniform1f(_,o.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(_,o.u_units_to_pixels),u_dash_image:new a.Uniform1i(_,o.u_dash_image),u_gradient_image:new a.Uniform1i(_,o.u_gradient_image),u_image_height:new a.Uniform1f(_,o.u_image_height),u_texsize:new a.Uniform2f(_,o.u_texsize),u_scale:new a.Uniform3f(_,o.u_scale),u_mix:new a.Uniform1f(_,o.u_mix),u_alpha_discard_threshold:new a.Uniform1f(_,o.u_alpha_discard_threshold)}),linePattern:(_,o)=>({u_matrix:new a.UniformMatrix4f(_,o.u_matrix),u_texsize:new a.Uniform2f(_,o.u_texsize),u_pixels_to_tile_units:new a.UniformMatrix2f(_,o.u_pixels_to_tile_units),u_device_pixel_ratio:new a.Uniform1f(_,o.u_device_pixel_ratio),u_image:new a.Uniform1i(_,o.u_image),u_units_to_pixels:new a.Uniform2f(_,o.u_units_to_pixels),u_scale:new a.Uniform3f(_,o.u_scale),u_fade:new a.Uniform1f(_,o.u_fade),u_alpha_discard_threshold:new a.Uniform1f(_,o.u_alpha_discard_threshold)}),raster:(_,o)=>({u_matrix:new a.UniformMatrix4f(_,o.u_matrix),u_tl_parent:new a.Uniform2f(_,o.u_tl_parent),u_scale_parent:new a.Uniform1f(_,o.u_scale_parent),u_fade_t:new a.Uniform1f(_,o.u_fade_t),u_opacity:new a.Uniform1f(_,o.u_opacity),u_image0:new a.Uniform1i(_,o.u_image0),u_image1:new a.Uniform1i(_,o.u_image1),u_brightness_low:new a.Uniform1f(_,o.u_brightness_low),u_brightness_high:new a.Uniform1f(_,o.u_brightness_high),u_saturation_factor:new a.Uniform1f(_,o.u_saturation_factor),u_contrast_factor:new a.Uniform1f(_,o.u_contrast_factor),u_spin_weights:new a.Uniform3f(_,o.u_spin_weights),u_perspective_transform:new a.Uniform2f(_,o.u_perspective_transform)}),symbolIcon:(_,o)=>({u_is_size_zoom_constant:new a.Uniform1i(_,o.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(_,o.u_is_size_feature_constant),u_size_t:new a.Uniform1f(_,o.u_size_t),u_size:new a.Uniform1f(_,o.u_size),u_camera_to_center_distance:new a.Uniform1f(_,o.u_camera_to_center_distance),u_pitch:new a.Uniform1f(_,o.u_pitch),u_rotate_symbol:new a.Uniform1i(_,o.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(_,o.u_aspect_ratio),u_fade_change:new a.Uniform1f(_,o.u_fade_change),u_matrix:new a.UniformMatrix4f(_,o.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(_,o.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(_,o.u_coord_matrix),u_is_text:new a.Uniform1i(_,o.u_is_text),u_pitch_with_map:new a.Uniform1i(_,o.u_pitch_with_map),u_texsize:new a.Uniform2f(_,o.u_texsize),u_tile_id:new a.Uniform3f(_,o.u_tile_id),u_zoom_transition:new a.Uniform1f(_,o.u_zoom_transition),u_inv_rot_matrix:new a.UniformMatrix4f(_,o.u_inv_rot_matrix),u_merc_center:new a.Uniform2f(_,o.u_merc_center),u_texture:new a.Uniform1i(_,o.u_texture)}),symbolSDF:(_,o)=>({u_is_size_zoom_constant:new a.Uniform1i(_,o.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(_,o.u_is_size_feature_constant),u_size_t:new a.Uniform1f(_,o.u_size_t),u_size:new a.Uniform1f(_,o.u_size),u_camera_to_center_distance:new a.Uniform1f(_,o.u_camera_to_center_distance),u_pitch:new a.Uniform1f(_,o.u_pitch),u_rotate_symbol:new a.Uniform1i(_,o.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(_,o.u_aspect_ratio),u_fade_change:new a.Uniform1f(_,o.u_fade_change),u_matrix:new a.UniformMatrix4f(_,o.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(_,o.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(_,o.u_coord_matrix),u_is_text:new a.Uniform1i(_,o.u_is_text),u_pitch_with_map:new a.Uniform1i(_,o.u_pitch_with_map),u_texsize:new a.Uniform2f(_,o.u_texsize),u_texture:new a.Uniform1i(_,o.u_texture),u_gamma_scale:new a.Uniform1f(_,o.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(_,o.u_device_pixel_ratio),u_tile_id:new a.Uniform3f(_,o.u_tile_id),u_zoom_transition:new a.Uniform1f(_,o.u_zoom_transition),u_inv_rot_matrix:new a.UniformMatrix4f(_,o.u_inv_rot_matrix),u_merc_center:new a.Uniform2f(_,o.u_merc_center),u_is_halo:new a.Uniform1i(_,o.u_is_halo)}),symbolTextAndIcon:(_,o)=>({u_is_size_zoom_constant:new a.Uniform1i(_,o.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(_,o.u_is_size_feature_constant),u_size_t:new a.Uniform1f(_,o.u_size_t),u_size:new a.Uniform1f(_,o.u_size),u_camera_to_center_distance:new a.Uniform1f(_,o.u_camera_to_center_distance),u_pitch:new a.Uniform1f(_,o.u_pitch),u_rotate_symbol:new a.Uniform1i(_,o.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(_,o.u_aspect_ratio),u_fade_change:new a.Uniform1f(_,o.u_fade_change),u_matrix:new a.UniformMatrix4f(_,o.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(_,o.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(_,o.u_coord_matrix),u_is_text:new a.Uniform1i(_,o.u_is_text),u_pitch_with_map:new a.Uniform1i(_,o.u_pitch_with_map),u_texsize:new a.Uniform2f(_,o.u_texsize),u_texsize_icon:new a.Uniform2f(_,o.u_texsize_icon),u_texture:new a.Uniform1i(_,o.u_texture),u_texture_icon:new a.Uniform1i(_,o.u_texture_icon),u_gamma_scale:new a.Uniform1f(_,o.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(_,o.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(_,o.u_is_halo)}),background:(_,o)=>({u_matrix:new a.UniformMatrix4f(_,o.u_matrix),u_opacity:new a.Uniform1f(_,o.u_opacity),u_color:new a.UniformColor(_,o.u_color)}),backgroundPattern:(_,o)=>({u_matrix:new a.UniformMatrix4f(_,o.u_matrix),u_opacity:new a.Uniform1f(_,o.u_opacity),u_image:new a.Uniform1i(_,o.u_image),u_pattern_tl_a:new a.Uniform2f(_,o.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(_,o.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(_,o.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(_,o.u_pattern_br_b),u_texsize:new a.Uniform2f(_,o.u_texsize),u_mix:new a.Uniform1f(_,o.u_mix),u_pattern_size_a:new a.Uniform2f(_,o.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(_,o.u_pattern_size_b),u_scale_a:new a.Uniform1f(_,o.u_scale_a),u_scale_b:new a.Uniform1f(_,o.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(_,o.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(_,o.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(_,o.u_tile_units_to_pixels)}),terrainRaster:Es,terrainDepth:Es,skybox:(_,o)=>({u_matrix:new a.UniformMatrix4f(_,o.u_matrix),u_sun_direction:new a.Uniform3f(_,o.u_sun_direction),u_cubemap:new a.Uniform1i(_,o.u_cubemap),u_opacity:new a.Uniform1f(_,o.u_opacity),u_temporal_offset:new a.Uniform1f(_,o.u_temporal_offset)}),skyboxGradient:(_,o)=>({u_matrix:new a.UniformMatrix4f(_,o.u_matrix),u_color_ramp:new a.Uniform1i(_,o.u_color_ramp),u_center_direction:new a.Uniform3f(_,o.u_center_direction),u_radius:new a.Uniform1f(_,o.u_radius),u_opacity:new a.Uniform1f(_,o.u_opacity),u_temporal_offset:new a.Uniform1f(_,o.u_temporal_offset)}),skyboxCapture:(_,o)=>({u_matrix_3f:new a.UniformMatrix3f(_,o.u_matrix_3f),u_sun_direction:new a.Uniform3f(_,o.u_sun_direction),u_sun_intensity:new a.Uniform1f(_,o.u_sun_intensity),u_color_tint_r:new a.Uniform4f(_,o.u_color_tint_r),u_color_tint_m:new a.Uniform4f(_,o.u_color_tint_m),u_luminance:new a.Uniform1f(_,o.u_luminance)}),globeRaster:(_,o)=>({u_proj_matrix:new a.UniformMatrix4f(_,o.u_proj_matrix),u_globe_matrix:new a.UniformMatrix4f(_,o.u_globe_matrix),u_merc_matrix:new a.UniformMatrix4f(_,o.u_merc_matrix),u_zoom_transition:new a.Uniform1f(_,o.u_zoom_transition),u_merc_center:new a.Uniform2f(_,o.u_merc_center),u_image0:new a.Uniform1i(_,o.u_image0)}),globeAtmosphere:(_,o)=>({u_center:new a.Uniform2f(_,o.u_center),u_radius:new a.Uniform1f(_,o.u_radius),u_screen_size:new a.Uniform2f(_,o.u_screen_size),u_pixel_ratio:new a.Uniform1f(_,o.u_pixel_ratio),u_opacity:new a.Uniform1f(_,o.u_opacity),u_fadeout_range:new a.Uniform1f(_,o.u_fadeout_range),u_start_color:new a.Uniform3f(_,o.u_start_color),u_end_color:new a.Uniform3f(_,o.u_end_color)})};let Vl;function Kh(_,o,f,g,x,T,A){const k=_.context,O=k.gl,L=_.useProgram("collisionBox"),F=[];let $=0,W=0;for(let ue=0;ue<g.length;ue++){const ae=g[ue],le=o.getTile(ae),me=le.getBucket(f);if(!me)continue;let ke=ae.projMatrix;x[0]===0&&x[1]===0||(ke=_.translatePosMatrix(ae.projMatrix,le,x,T));const Le=A?me.textCollisionBox:me.iconCollisionBox,ht=me.collisionCircleArray;if(ht.length>0){const nt=a.create(),et=ke;a.mul(nt,me.placementInvProjMatrix,_.transform.glCoordMatrix),a.mul(nt,nt,me.placementViewportMatrix),F.push({circleArray:ht,circleOffset:W,transform:et,invTransform:nt}),$+=ht.length/4,W=$}Le&&(_.terrain&&_.terrain.setupElevationDraw(le,L),L.draw(k,O.LINES,a.DepthMode.disabled,a.StencilMode.disabled,_.colorModeForRenderPass(),a.CullFaceMode.disabled,cp(ke,_.transform,le),f.id,Le.layoutVertexBuffer,Le.indexBuffer,Le.segments,null,_.transform.zoom,null,Le.collisionVertexBuffer,Le.collisionVertexBufferExt))}if(!A||!F.length)return;const Q=_.useProgram("collisionCircle"),X=new a.StructArrayLayout2f1f2i16;X.resize(4*$),X._trim();let J=0;for(const ue of F)for(let ae=0;ae<ue.circleArray.length/4;ae++){const le=4*ae,me=ue.circleArray[le+0],ke=ue.circleArray[le+1],Le=ue.circleArray[le+2],ht=ue.circleArray[le+3];X.emplace(J++,me,ke,Le,ht,0),X.emplace(J++,me,ke,Le,ht,1),X.emplace(J++,me,ke,Le,ht,2),X.emplace(J++,me,ke,Le,ht,3)}(!Vl||Vl.length<2*$)&&(Vl=function(ue){const ae=2*ue,le=new a.StructArrayLayout3ui6;le.resize(ae),le._trim();for(let me=0;me<ae;me++){const ke=6*me;le.uint16[ke+0]=4*me+0,le.uint16[ke+1]=4*me+1,le.uint16[ke+2]=4*me+2,le.uint16[ke+3]=4*me+2,le.uint16[ke+4]=4*me+3,le.uint16[ke+5]=4*me+0}return le}($));const de=k.createIndexBuffer(Vl,!0),Y=k.createVertexBuffer(X,a.collisionCircleLayout.members,!0);for(const ue of F){const ae={u_matrix:ue.transform,u_inv_matrix:ue.invTransform,u_camera_to_center_distance:(ce=_.transform).cameraToCenterDistance,u_viewport_size:[ce.width,ce.height]};Q.draw(k,O.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,_.colorModeForRenderPass(),a.CullFaceMode.disabled,ae,f.id,Y,de,a.SegmentVector.simpleSegment(0,2*ue.circleOffset,ue.circleArray.length,ue.circleArray.length/2),null,_.transform.zoom,null,null,null)}var ce;Y.destroy(),de.destroy()}const au=a.identity(new Float32Array(16));function dp(_,o,f,g,x,T){const{horizontalAlign:A,verticalAlign:k}=a.getAnchorAlignment(_),O=-(A-.5)*o,L=-(k-.5)*f,F=a.evaluateVariableOffset(_,g);return new a.pointGeometry((O/x+F[0])*T,(L/x+F[1])*T)}function pg(_,o,f,g,x,T,A,k,O,L,F,$){const W=_.text.placedSymbolArray,Q=_.text.dynamicLayoutVertexArray,X=_.icon.dynamicLayoutVertexArray,J={},de=k.projMatrix,Y=T.elevation,ce=Y?Y.getAtTileOffsetFunc(k,$):ue=>[0,0,0];Q.clear();for(let ue=0;ue<W.length;ue++){const ae=W.get(ue),le=_.allowVerticalPlacement&&!ae.placedOrientation,me=ae.hidden||!ae.crossTileID||le?null:g[ae.crossTileID];if(me){const ke=new a.pointGeometry(ae.tileAnchorX,ae.tileAnchorY),Le=ce(ke),ht=Gr(ke,f?de:A,Le[2]),nt=Co(T.cameraToCenterDistance,ht.signedDistanceFromCamera);let et=x.evaluateSizeForFeature(_.textSizeData,L,ae)*nt/a.ONE_EM;f&&(et*=_.tilePixelRatio/O);const{width:je,height:Re,anchor:Qe,textOffset:We,textScale:zt}=me,jt=dp(Qe,je,Re,We,zt,et),Jt=f?Gr(ke.add(jt),A,Le[2]).point:ht.point.add(o?jt.rotate(-T.angle):jt),ut=_.allowVerticalPlacement&&ae.placedOrientation===a.WritingMode.vertical?Math.PI/2:0;for(let Ft=0;Ft<ae.numGlyphs;Ft++)a.addDynamicAttributes(Q,Jt,ut);F&&ae.associatedIconIndex>=0&&(J[ae.associatedIconIndex]={shiftedAnchor:Jt,angle:ut})}else so(ae.numGlyphs,Q)}if(F){X.clear();const ue=_.icon.placedSymbolArray;for(let ae=0;ae<ue.length;ae++){const le=ue.get(ae);if(le.hidden)so(le.numGlyphs,X);else{const me=J[ae];if(me)for(let ke=0;ke<le.numGlyphs;ke++)a.addDynamicAttributes(X,me.shiftedAnchor,me.angle);else so(le.numGlyphs,X)}}_.icon.dynamicLayoutVertexBuffer.updateData(X)}_.text.dynamicLayoutVertexBuffer.updateData(Q)}function mg(_,o,f){return f.iconsInText&&o?"symbolTextAndIcon":_?"symbolSDF":"symbolIcon"}function lu(_,o,f,g,x,T,A,k,O,L,F,$){const W=_.context,Q=W.gl,X=_.transform,J=X.projection.createTileTransform(X,X.worldSize),de=k==="map",Y=O==="map",ce=de&&f.layout.get("symbol-placement")!=="point",ue=de&&!Y&&!ce,ae=f.layout.get("symbol-sort-key").constantOr(1)!==void 0;let le=!1;const me=_.depthModeForSublayer(0,a.DepthMode.ReadOnly),ke=[a.mercatorXfromLng(X.center.lng),a.mercatorYfromLat(X.center.lat)],Le=f.layout.get("text-variable-anchor"),ht=X.projection.name==="globe",nt=ht?a.globeToMercatorTransition(X.zoom):0,et=[],je=[];_.terrain&&Y&&je.push("PITCH_WITH_MAP_TERRAIN"),ht&&je.push("PROJECTION_GLOBE_VIEW"),ce&&je.push("PROJECTED_POS_ON_VIEWPORT");for(const Re of g){const Qe=o.getTile(Re),We=Qe.getBucket(f);if(!We||We.projection!==X.projection.name)continue;const zt=x?We.text:We.icon;if(!zt||We.fullyClipped||!zt.segments.get().length)continue;const jt=zt.programConfigurations.get(f.id),Jt=x||We.sdfIcons,ut=x?We.textSizeData:We.iconSizeData,Ft=Y||X.pitch!==0,Zt=_.useProgram(mg(Jt,x,We),jt,je),Pn=a.evaluateSizeForZoom(ut,X.zoom),jn=[Re.canonical.x,Re.canonical.y,1<<Re.canonical.z];let qt,sn,Xn,Er,xi=[0,0],Vi=null;if(x){if(sn=Qe.glyphAtlasTexture,Xn=Q.LINEAR,qt=Qe.glyphAtlasTexture.size,We.iconsInText){xi=Qe.imageAtlasTexture.size,Vi=Qe.imageAtlasTexture;const Lr=ut.kind==="composite"||ut.kind==="camera";Er=Ft||_.options.rotating||_.options.zooming||Lr?Q.LINEAR:Q.NEAREST}}else{const Lr=f.layout.get("icon-size").constantOr(0)!==1||We.iconsNeedLinear;sn=Qe.imageAtlasTexture,Xn=Jt||_.options.rotating||_.options.zooming||Lr||Ft?Q.LINEAR:Q.NEAREST,qt=Qe.imageAtlasTexture.size}const uo=_.transform.calculatePixelsToTileUnitsMatrix(Qe),gn=ys(Re.projMatrix,Qe.tileID.canonical,Y,de,_.transform,uo),Wt=_.terrain&&Y&&ce?a.invert(new Float32Array(16),gn):au,fn=Qo(Re.projMatrix,Qe.tileID.canonical,Y,de,_.transform,uo),ur=Le&&We.hasTextData(),Pi=f.layout.get("icon-text-fit")!=="none"&&ur&&We.hasIconData();if(ce){const Lr=X.elevation,ta=Lr?Lr.getAtTileOffsetFunc(Re,J):ks=>[0,0,0];Yd(We,Re.projMatrix,_,x,gn,fn,Y,L,ta,Re)}const qn=_.translatePosMatrix(Re.projMatrix,Qe,T,A),Di=ce||x&&Le||Pi?au:gn,ic=_.translatePosMatrix(fn,Qe,T,A,!0),bi=Jt&&f.paint.get(x?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ea;const Mt=J.createInversionMatrix(Re.toUnwrapped());ea=Jt?We.iconsInText?$l(ut.kind,Pn,ue,Y,_,qn,Di,ic,qt,xi,jn,nt,Mt,ke):jl(ut.kind,Pn,ue,Y,_,qn,Di,ic,x,qt,!0,jn,nt,Mt,ke):ou(ut.kind,Pn,ue,Y,_,qn,Di,ic,x,qt,jn,nt,Mt,ke);const Bt={program:Zt,buffers:zt,uniformValues:ea,atlasTexture:sn,atlasTextureIcon:Vi,atlasInterpolation:Xn,atlasInterpolationIcon:Er,isSDF:Jt,hasHalo:bi,tile:Qe,labelPlaneMatrixInv:Wt};if(ae&&We.canOverlap){le=!0;const Lr=zt.segments.get();for(const ta of Lr)et.push({segments:new a.SegmentVector([ta]),sortKey:ta.sortKey,state:Bt})}else et.push({segments:zt.segments,sortKey:0,state:Bt})}le&&et.sort((Re,Qe)=>Re.sortKey-Qe.sortKey);for(const Re of et){const Qe=Re.state;if(_.terrain&&_.terrain.setupElevationDraw(Qe.tile,Qe.program,{useDepthForOcclusion:!ht,labelPlaneMatrixInv:Qe.labelPlaneMatrixInv}),W.activeTexture.set(Q.TEXTURE0),Qe.atlasTexture.bind(Qe.atlasInterpolation,Q.CLAMP_TO_EDGE),Qe.atlasTextureIcon&&(W.activeTexture.set(Q.TEXTURE1),Qe.atlasTextureIcon&&Qe.atlasTextureIcon.bind(Qe.atlasInterpolationIcon,Q.CLAMP_TO_EDGE)),Qe.isSDF){const We=Qe.uniformValues;Qe.hasHalo&&(We.u_is_halo=1,cu(Qe.buffers,Re.segments,f,_,Qe.program,me,F,$,We)),We.u_is_halo=0}cu(Qe.buffers,Re.segments,f,_,Qe.program,me,F,$,Qe.uniformValues)}}function cu(_,o,f,g,x,T,A,k,O){const L=g.context;x.draw(L,L.gl.TRIANGLES,T,A,k,a.CullFaceMode.disabled,O,f.id,_.layoutVertexBuffer,_.indexBuffer,o,f.paint,g.transform.zoom,_.programConfigurations.get(f.id),_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer)}function uu(_,o,f,g,x,T,A){const k=_.context.gl,O=f.paint.get("fill-pattern"),L=O&&O.constantOr(1),F=f.getCrossfadeParameters();let $,W,Q,X,J;A?(W=L&&!f.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=k.LINES):(W=L?"fillPattern":"fill",$=k.TRIANGLES);for(const de of g){const Y=o.getTile(de);if(L&&!Y.patternsLoaded())continue;const ce=Y.getBucket(f);if(!ce)continue;_.prepareDrawTile(de);const ue=ce.programConfigurations.get(f.id),ae=_.useProgram(W,ue);L&&(_.context.activeTexture.set(k.TEXTURE0),Y.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),ue.updatePaintBuffers(F));const le=O.constantOr(null);if(le&&Y.imageAtlas){const ke=Y.imageAtlas,Le=ke.patternPositions[le.to.toString()],ht=ke.patternPositions[le.from.toString()];Le&&ht&&ue.setConstantPatternPositions(Le,ht)}const me=_.translatePosMatrix(de.projMatrix,Y,f.paint.get("fill-translate"),f.paint.get("fill-translate-anchor"));if(A){X=ce.indexBuffer2,J=ce.segments2;const ke=_.terrain&&_.terrain.renderingToTexture?_.terrain.drapeBufferSize:[k.drawingBufferWidth,k.drawingBufferHeight];Q=W==="fillOutlinePattern"&&L?lp(me,_,F,Y,ke):fg(me,ke)}else X=ce.indexBuffer,J=ce.segments,Q=L?Wh(me,_,F,Y):ap(me);_.prepareDrawProgram(_.context,ae,de.toUnwrapped()),ae.draw(_.context,$,x,_.stencilModeForClipping(de),T,a.CullFaceMode.disabled,Q,f.id,ce.layoutVertexBuffer,X,J,f.paint,_.transform.zoom,ue)}}function Gl(_,o,f,g,x,T,A){const k=_.context,O=k.gl,L=f.paint.get("fill-extrusion-pattern"),F=L.constantOr(1),$=f.getCrossfadeParameters(),W=f.paint.get("fill-extrusion-opacity");for(const Q of g){const X=o.getTile(Q),J=X.getBucket(f);if(!J)continue;const de=J.programConfigurations.get(f.id),Y=_.useProgram(F?"fillExtrusionPattern":"fillExtrusion",de);if(_.terrain){const me=_.terrain;if(!J.enableTerrain)continue;if(me.setupElevationDraw(X,Y,{useMeterToDem:!0}),pp(k,o,Q,J,f,me),!J.centroidVertexBuffer){const ke=Y.attributes.a_centroid_pos;ke!==void 0&&O.vertexAttrib2f(ke,0,0)}}F&&(_.context.activeTexture.set(O.TEXTURE0),X.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),de.updatePaintBuffers($));const ce=L.constantOr(null);if(ce&&X.imageAtlas){const me=X.imageAtlas,ke=me.patternPositions[ce.to.toString()],Le=me.patternPositions[ce.from.toString()];ke&&Le&&de.setConstantPatternPositions(ke,Le)}const ue=_.translatePosMatrix(Q.projMatrix,X,f.paint.get("fill-extrusion-translate"),f.paint.get("fill-extrusion-translate-anchor")),ae=f.paint.get("fill-extrusion-vertical-gradient"),le=F?Zh(ue,_,ae,W,Q,$,X):sp(ue,_,ae,W);_.prepareDrawProgram(k,Y,Q.toUnwrapped()),Y.draw(k,k.gl.TRIANGLES,x,T,A,a.CullFaceMode.backCCW,le,f.id,J.layoutVertexBuffer,J.indexBuffer,J.segments,f.paint,_.transform.zoom,de,_.terrain?J.centroidVertexBuffer:null)}}function pp(_,o,f,g,x,T){const A=[Y=>{let ce=Y.canonical.x-1,ue=Y.wrap;return ce<0&&(ce=(1<<Y.canonical.z)-1,ue--),new a.OverscaledTileID(Y.overscaledZ,ue,Y.canonical.z,ce,Y.canonical.y)},Y=>{let ce=Y.canonical.x+1,ue=Y.wrap;return ce===1<<Y.canonical.z&&(ce=0,ue++),new a.OverscaledTileID(Y.overscaledZ,ue,Y.canonical.z,ce,Y.canonical.y)},Y=>new a.OverscaledTileID(Y.overscaledZ,Y.wrap,Y.canonical.z,Y.canonical.x,(Y.canonical.y===0?1<<Y.canonical.z:Y.canonical.y)-1),Y=>new a.OverscaledTileID(Y.overscaledZ,Y.wrap,Y.canonical.z,Y.canonical.x,Y.canonical.y===(1<<Y.canonical.z)-1?0:Y.canonical.y+1)],k=Y=>{const ce=o.getSource().maxzoom,ue=ke=>{const Le=o.getTileByID(ke);if(Le&&Le.hasData())return Le.getBucket(x)};let ae,le,me;return(Y.overscaledZ===Y.canonical.z||Y.overscaledZ>=ce)&&(ae=ue(Y.key)),Y.overscaledZ>=ce&&(le=ue(Y.calculateScaledKey(Y.overscaledZ+1))),Y.overscaledZ>ce&&(me=ue(Y.calculateScaledKey(Y.overscaledZ-1))),ae||le||me},O=[0,0,0],L=(Y,ce)=>(O[0]=Math.min(Y.min.y,ce.min.y),O[1]=Math.max(Y.max.y,ce.max.y),O[2]=a.EXTENT-ce.min.x>Y.max.x?ce.min.x-a.EXTENT:Y.max.x,O),F=(Y,ce)=>(O[0]=Math.min(Y.min.x,ce.min.x),O[1]=Math.max(Y.max.x,ce.max.x),O[2]=a.EXTENT-ce.min.y>Y.max.y?ce.min.y-a.EXTENT:Y.max.y,O),$=[(Y,ce)=>L(Y,ce),(Y,ce)=>L(ce,Y),(Y,ce)=>F(Y,ce),(Y,ce)=>F(ce,Y)],W=new a.pointGeometry(0,0);let Q,X,J;const de=(Y,ce,ue,ae,le)=>{const me=[[ae?ue:Y,ae?Y:ue,0],[ae?ue:ce,ae?ce:ue,0]],ke=le<0?a.EXTENT+le:le,Le=[ae?ke:(Y+ce)/2,ae?(Y+ce)/2:ke,0];return ue===0&&le<0||ue!==0&&le>0?T.getForTilePoints(J,[Le],!0,X):me.push(Le),T.getForTilePoints(f,me,!0,Q),Math.max(me[0][2],me[1][2],Le[2])/T.exaggeration()};for(let Y=0;Y<4;Y++){const ce=g.borders[Y];if(ce.length===0&&(g.borderDone[Y]=!0),g.borderDone[Y])continue;const ue=J=A[Y](f),ae=k(ue);if(!ae||!ae.enableTerrain||(X=T.findDEMTileFor(ue),!X||!X.dem))continue;if(!Q){const Le=T.findDEMTileFor(f);if(!Le||!Le.dem)return;Q=Le}const le=(Y<2?1:5)-Y,me=ae.borders[le];let ke=0;for(let Le=0;Le<ce.length;Le++){const ht=g.featuresOnBorder[ce[Le]],nt=ht.borders[Y];let et;for(;ke<me.length&&(et=ae.featuresOnBorder[me[ke]],!(et.borders[le][1]>nt[0]+3));)ae.borderDone[le]||ae.encodeCentroid(void 0,et,!1),ke++;if(et&&ke<me.length){const je=ke;let Re=0;for(;!(et.borders[le][0]>nt[1]-3)&&(Re++,++ke!==me.length);)et=ae.featuresOnBorder[me[ke]];if(et=ae.featuresOnBorder[me[je]],ht.intersectsCount()>1||et.intersectsCount()>1||Re!==1){Re!==1&&(ke=je),g.encodeCentroid(void 0,ht,!1),ae.borderDone[le]||ae.encodeCentroid(void 0,et,!1);continue}const Qe=$[Y](ht,et),We=Y%2?a.EXTENT-1:0;W.x=de(Qe[0],Math.min(a.EXTENT-1,Qe[1]),We,Y<2,Qe[2]),W.y=0,g.encodeCentroid(W,ht,!1),ae.borderDone[le]||ae.encodeCentroid(W,et,!1)}else g.encodeCentroid(void 0,ht,!1)}g.borderDone[Y]=g.needsCentroidUpdate=!0,ae.borderDone[le]||(ae.borderDone[le]=ae.needsCentroidUpdate=!0)}(g.needsCentroidUpdate||!g.centroidVertexBuffer&&g.centroidVertexArray.length!==0)&&g.uploadCentroid(_)}const mp=new a.Color(1,0,0,1),_g=new a.Color(0,1,0,1),ql=new a.Color(0,0,1,1),Zl=new a.Color(1,0,1,1),_p=new a.Color(0,1,1,1);function vi(_,o,f,g){Js(_,0,o+f/2,_.transform.width,f,g)}function hu(_,o,f,g){Js(_,o-f/2,0,f,_.transform.height,g)}function Js(_,o,f,g,x,T){const A=_.context,k=A.gl;k.enable(k.SCISSOR_TEST),k.scissor(o*a.exported.devicePixelRatio,f*a.exported.devicePixelRatio,g*a.exported.devicePixelRatio,x*a.exported.devicePixelRatio),A.clear({color:T}),k.disable(k.SCISSOR_TEST)}function fu(_,o,f){const g=_.context,x=g.gl,T=f.projMatrix,A=_.useProgram("debug"),k=o.getTileByID(f.key);_.terrain&&_.terrain.setupElevationDraw(k,A);const O=a.DepthMode.disabled,L=a.StencilMode.disabled,F=_.colorModeForRenderPass(),$="$debug";g.activeTexture.set(x.TEXTURE0),_.emptyTexture.bind(x.LINEAR,x.CLAMP_TO_EDGE),k._makeDebugTileBoundsBuffers(_.context,_.transform.projection);const W=k._tileDebugBuffer||_.debugBuffer,Q=k._tileDebugIndexBuffer||_.debugIndexBuffer,X=k._tileDebugSegments||_.debugSegments;A.draw(g,x.LINE_STRIP,O,L,F,a.CullFaceMode.disabled,Xh(T,a.Color.red),$,W,Q,X);const J=k.latestRawTileData,de=Math.floor((J&&J.byteLength||0)/1024),Y=o.getTile(f).tileSize,ce=512/Math.min(Y,512)*(f.overscaledZ/_.transform.zoom)*.5;let ue=f.canonical.toString();f.overscaledZ!==f.canonical.z&&(ue+=` => ${f.overscaledZ}`),function(ae,le){ae.initDebugOverlayCanvas();const me=ae.debugOverlayCanvas,ke=ae.context.gl,Le=ae.debugOverlayCanvas.getContext("2d");Le.clearRect(0,0,me.width,me.height),Le.shadowColor="white",Le.shadowBlur=2,Le.lineWidth=1.5,Le.strokeStyle="white",Le.textBaseline="top",Le.font="bold 36px Open Sans, sans-serif",Le.fillText(le,5,5),Le.strokeText(le,5,5),ae.debugOverlayTexture.update(me),ae.debugOverlayTexture.bind(ke.LINEAR,ke.CLAMP_TO_EDGE)}(_,`${ue} ${de}kb`),A.draw(g,x.TRIANGLES,O,L,a.ColorMode.alphaBlended,a.CullFaceMode.disabled,Xh(T,a.Color.transparent,ce),$,_.debugBuffer,_.quadTriangleIndexBuffer,_.debugSegments)}const Yh=a.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Qh}=Yh;function ao(_,o,f,g){_.emplaceBack(o,f,g)}class du{constructor(o){this.vertexArray=new a.StructArrayLayout3f12,this.indices=new a.StructArrayLayout3ui6,ao(this.vertexArray,-1,-1,1),ao(this.vertexArray,1,-1,1),ao(this.vertexArray,-1,1,1),ao(this.vertexArray,1,1,1),ao(this.vertexArray,-1,-1,-1),ao(this.vertexArray,1,-1,-1),ao(this.vertexArray,-1,1,-1),ao(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=o.createVertexBuffer(this.vertexArray,Qh),this.indexBuffer=o.createIndexBuffer(this.indices),this.segment=a.SegmentVector.simpleSegment(0,0,36,12)}}function As(_,o,f,g,x,T){const A=_.gl,k=o.paint.get("sky-atmosphere-color"),O=o.paint.get("sky-atmosphere-halo-color"),L=o.paint.get("sky-atmosphere-sun-intensity"),F=(($,W,Q,X,J)=>({u_matrix_3f:$,u_sun_direction:W,u_sun_intensity:Q,u_color_tint_r:[X.r,X.g,X.b,X.a],u_color_tint_m:[J.r,J.g,J.b,J.a],u_luminance:5e-5}))(a.fromMat4([],g),x,L,k,O);A.framebufferTexture2D(A.FRAMEBUFFER,A.COLOR_ATTACHMENT0,A.TEXTURE_CUBE_MAP_POSITIVE_X+T,o.skyboxTexture,0),f.draw(_,A.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.frontCW,F,"skyboxCapture",o.skyboxGeometry.vertexBuffer,o.skyboxGeometry.indexBuffer,o.skyboxGeometry.segment)}const Wl={symbol:function(_,o,f,g,x){if(_.renderPass!=="translucent")return;const T=a.StencilMode.disabled,A=_.colorModeForRenderPass();f.layout.get("text-variable-anchor")&&function(k,O,L,F,$,W,Q){const X=O.transform,J=$==="map",de=W==="map",Y=X.projection.createTileTransform(X,X.worldSize);for(const ce of k){const ue=F.getTile(ce),ae=ue.getBucket(L);if(!ae||ae.projection!==X.projection.name||!ae.text||!ae.text.segments.get().length)continue;const le=a.evaluateSizeForZoom(ae.textSizeData,X.zoom),me=O.transform.calculatePixelsToTileUnitsMatrix(ue),ke=ys(ce.projMatrix,ue.tileID.canonical,de,J,O.transform,me),Le=L.layout.get("icon-text-fit")!=="none"&&ae.hasIconData();if(le){const ht=Math.pow(2,X.zoom-ue.tileID.overscaledZ);pg(ae,J,de,Q,a.symbolSize,X,ke,ce,ht,le,Le,Y)}}}(g,_,f,o,f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),x),f.paint.get("icon-opacity").constantOr(1)!==0&&lu(_,o,f,g,!1,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),f.layout.get("icon-rotation-alignment"),f.layout.get("icon-pitch-alignment"),f.layout.get("icon-keep-upright"),T,A),f.paint.get("text-opacity").constantOr(1)!==0&&lu(_,o,f,g,!0,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),f.layout.get("text-keep-upright"),T,A),o.map.showCollisionBoxes&&(Kh(_,o,f,g,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),!0),Kh(_,o,f,g,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),!1))},circle:function(_,o,f,g){if(_.renderPass!=="translucent")return;const x=f.paint.get("circle-opacity"),T=f.paint.get("circle-stroke-width"),A=f.paint.get("circle-stroke-opacity"),k=f.layout.get("circle-sort-key").constantOr(1)!==void 0;if(x.constantOr(1)===0&&(T.constantOr(1)===0||A.constantOr(1)===0))return;const O=_.context,L=O.gl,F=_.depthModeForSublayer(0,a.DepthMode.ReadOnly),$=a.StencilMode.disabled,W=_.colorModeForRenderPass(),Q=[];for(let J=0;J<g.length;J++){const de=g[J],Y=o.getTile(de),ce=Y.getBucket(f);if(!ce)continue;const ue=ce.programConfigurations.get(f.id),ae=Hh(f),le={programConfiguration:ue,program:_.useProgram("circle",ue,ae),layoutVertexBuffer:ce.layoutVertexBuffer,indexBuffer:ce.indexBuffer,uniformValues:dg(_,de,Y,f),tile:Y};if(k){const me=ce.segments.get();for(const ke of me)Q.push({segments:new a.SegmentVector([ke]),sortKey:ke.sortKey,state:le})}else Q.push({segments:ce.segments,sortKey:0,state:le})}k&&Q.sort((J,de)=>J.sortKey-de.sortKey);const X={useDepthForOcclusion:_.transform.projection.name!=="globe"};for(const J of Q){const{programConfiguration:de,program:Y,layoutVertexBuffer:ce,indexBuffer:ue,uniformValues:ae,tile:le}=J.state,me=J.segments;_.terrain&&_.terrain.setupElevationDraw(le,Y,X),_.prepareDrawProgram(O,Y,le.tileID.toUnwrapped()),Y.draw(O,L.TRIANGLES,F,$,W,a.CullFaceMode.disabled,ae,f.id,ce,ue,me,f.paint,_.transform.zoom,de)}},heatmap:function(_,o,f,g){if(f.paint.get("heatmap-opacity")!==0)if(_.renderPass==="offscreen"){const x=_.context,T=x.gl,A=a.StencilMode.disabled,k=new a.ColorMode([T.ONE,T.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(O,L,F){const $=O.gl;O.activeTexture.set($.TEXTURE1),O.viewport.set([0,0,L.width/4,L.height/4]);let W=F.heatmapFbo;if(W)$.bindTexture($.TEXTURE_2D,W.colorAttachment.get()),O.bindFramebuffer.set(W.framebuffer);else{const Q=$.createTexture();$.bindTexture($.TEXTURE_2D,Q),$.texParameteri($.TEXTURE_2D,$.TEXTURE_WRAP_S,$.CLAMP_TO_EDGE),$.texParameteri($.TEXTURE_2D,$.TEXTURE_WRAP_T,$.CLAMP_TO_EDGE),$.texParameteri($.TEXTURE_2D,$.TEXTURE_MIN_FILTER,$.LINEAR),$.texParameteri($.TEXTURE_2D,$.TEXTURE_MAG_FILTER,$.LINEAR),W=F.heatmapFbo=O.createFramebuffer(L.width/4,L.height/4,!1),function(X,J,de,Y){const ce=X.gl;ce.texImage2D(ce.TEXTURE_2D,0,ce.RGBA,J.width/4,J.height/4,0,ce.RGBA,X.extRenderToTextureHalfFloat?X.extTextureHalfFloat.HALF_FLOAT_OES:ce.UNSIGNED_BYTE,null),Y.colorAttachment.set(de)}(O,L,Q,W)}})(x,_,f),x.clear({color:a.Color.transparent});for(let O=0;O<g.length;O++){const L=g[O];if(o.hasRenderableParent(L))continue;const F=o.getTile(L),$=F.getBucket(f);if(!$)continue;const W=$.programConfigurations.get(f.id),Q=_.useProgram("heatmap",W),{zoom:X}=_.transform;_.terrain&&_.terrain.setupElevationDraw(F,Q),_.prepareDrawProgram(x,Q,L.toUnwrapped()),Q.draw(x,T.TRIANGLES,a.DepthMode.disabled,A,k,a.CullFaceMode.disabled,up(L.projMatrix,F,X,f.paint.get("heatmap-intensity")),f.id,$.layoutVertexBuffer,$.indexBuffer,$.segments,f.paint,_.transform.zoom,W)}x.viewport.set([0,0,_.width,_.height])}else _.renderPass==="translucent"&&(_.context.setColorMode(_.colorModeForRenderPass()),function(x,T){const A=x.context,k=A.gl,O=T.heatmapFbo;if(!O)return;A.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,O.colorAttachment.get()),A.activeTexture.set(k.TEXTURE1);let L=T.colorRampTexture;L||(L=T.colorRampTexture=new a.Texture(A,T.colorRamp,k.RGBA)),L.bind(k.LINEAR,k.CLAMP_TO_EDGE),x.useProgram("heatmapTexture").draw(A,k.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,x.colorModeForRenderPass(),a.CullFaceMode.disabled,((F,$,W,Q)=>({u_image:0,u_color_ramp:1,u_opacity:$.paint.get("heatmap-opacity")}))(0,T),T.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,T.paint,x.transform.zoom)}(_,f))},line:function(_,o,f,g){if(_.renderPass!=="translucent")return;const x=f.paint.get("line-opacity"),T=f.paint.get("line-width");if(x.constantOr(1)===0||T.constantOr(1)===0)return;const A=_.depthModeForSublayer(0,a.DepthMode.ReadOnly),k=_.colorModeForRenderPass(),O=f.paint.get("line-dasharray"),L=O.constantOr(1),F=f.layout.get("line-cap"),$=f.paint.get("line-pattern"),W=$.constantOr(1),Q=f.paint.get("line-gradient"),X=f.getCrossfadeParameters(),J=W?"linePattern":"line",de=_.context,Y=de.gl,ce=(ae=>{const le=[];Nl(ae)&&le.push("RENDER_LINE_DASH"),ae.paint.get("line-gradient")&&le.push("RENDER_LINE_GRADIENT");const me=ae.paint.get("line-pattern").constantOr(1),ke=ae.paint.get("line-opacity").constantOr(1)!==1;return!me&&ke&&le.push("RENDER_LINE_ALPHA_DISCARD"),le})(f);let ue=ce.includes("RENDER_LINE_ALPHA_DISCARD");_.terrain&&_.terrain.clipOrMaskOverlapStencilType()&&(ue=!1);for(const ae of g){const le=o.getTile(ae);if(W&&!le.patternsLoaded())continue;const me=le.getBucket(f);if(!me)continue;_.prepareDrawTile(ae);const ke=me.programConfigurations.get(f.id),Le=_.useProgram(J,ke,ce),ht=$.constantOr(null);if(ht&&le.imageAtlas){const We=le.imageAtlas,zt=We.patternPositions[ht.to.toString()],jt=We.patternPositions[ht.from.toString()];zt&&jt&&ke.setConstantPatternPositions(zt,jt)}const nt=O.constantOr(null),et=F.constantOr(null);if(!W&&nt&&et&&le.lineAtlas){const We=le.lineAtlas,zt=We.getDash(nt.to,et),jt=We.getDash(nt.from,et);zt&&jt&&ke.setConstantPatternPositions(zt,jt)}const je=_.terrain?ae.projMatrix:null,Re=W?Qs(_,le,f,X,je):hp(_,le,f,X,je,me.lineClipsArray.length);if(Q){const We=me.gradients[f.id];let zt=We.texture;if(f.gradientVersion!==We.version){let jt=256;if(f.stepInterpolant){const Jt=o.getSource().maxzoom,ut=ae.canonical.z===Jt?Math.ceil(1<<_.transform.maxZoom-ae.canonical.z):1;jt=a.clamp(a.nextPowerOfTwo(me.maxLineLength/a.EXTENT*1024*ut),256,de.maxTextureSize)}We.gradient=a.renderColorRamp({expression:f.gradientExpression(),evaluationKey:"lineProgress",resolution:jt,image:We.gradient||void 0,clips:me.lineClipsArray}),We.texture?We.texture.update(We.gradient):We.texture=new a.Texture(de,We.gradient,Y.RGBA),We.version=f.gradientVersion,zt=We.texture}de.activeTexture.set(Y.TEXTURE1),zt.bind(f.stepInterpolant?Y.NEAREST:Y.LINEAR,Y.CLAMP_TO_EDGE)}L&&(de.activeTexture.set(Y.TEXTURE0),le.lineAtlasTexture.bind(Y.LINEAR,Y.REPEAT),ke.updatePaintBuffers(X)),W&&(de.activeTexture.set(Y.TEXTURE0),le.imageAtlasTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),ke.updatePaintBuffers(X)),_.prepareDrawProgram(de,Le,ae.toUnwrapped());const Qe=We=>{Le.draw(de,Y.TRIANGLES,A,We,k,a.CullFaceMode.disabled,Re,f.id,me.layoutVertexBuffer,me.indexBuffer,me.segments,f.paint,_.transform.zoom,ke,me.layoutVertexBuffer2)};if(ue){const We=_.stencilModeForClipping(ae).ref;We===0&&_.terrain&&de.clear({stencil:0});const zt={func:Y.EQUAL,mask:255};Re.u_alpha_discard_threshold=.8,Qe(new a.StencilMode(zt,We,255,Y.KEEP,Y.KEEP,Y.INVERT)),Re.u_alpha_discard_threshold=0,Qe(new a.StencilMode(zt,We,255,Y.KEEP,Y.KEEP,Y.KEEP))}else Qe(_.stencilModeForClipping(ae))}ue&&(_.resetStencilClippingMasks(),_.terrain&&de.clear({stencil:0}))},fill:function(_,o,f,g){const x=f.paint.get("fill-color"),T=f.paint.get("fill-opacity");if(T.constantOr(1)===0)return;const A=_.colorModeForRenderPass(),k=f.paint.get("fill-pattern"),O=_.opaquePassEnabledForLayer()&&!k.constantOr(1)&&x.constantOr(a.Color.transparent).a===1&&T.constantOr(0)===1?"opaque":"translucent";if(_.renderPass===O){const L=_.depthModeForSublayer(1,_.renderPass==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly);uu(_,o,f,g,L,A,!1)}if(_.renderPass==="translucent"&&f.paint.get("fill-antialias")){const L=_.depthModeForSublayer(f.getPaintProperty("fill-outline-color")?2:0,a.DepthMode.ReadOnly);uu(_,o,f,g,L,A,!0)}},"fill-extrusion":function(_,o,f,g){const x=f.paint.get("fill-extrusion-opacity");if(x!==0&&_.renderPass==="translucent"){const T=new a.DepthMode(_.context.gl.LEQUAL,a.DepthMode.ReadWrite,_.depthRangeFor3D);if(x!==1||f.paint.get("fill-extrusion-pattern").constantOr(1))Gl(_,o,f,g,T,a.StencilMode.disabled,a.ColorMode.disabled),Gl(_,o,f,g,T,_.stencilModeFor3D(),_.colorModeForRenderPass()),_.resetStencilClippingMasks();else{const A=_.colorModeForRenderPass();Gl(_,o,f,g,T,a.StencilMode.disabled,A)}}},hillshade:function(_,o,f,g){if(_.renderPass!=="offscreen"&&_.renderPass!=="translucent")return;const x=_.context,T=_.depthModeForSublayer(0,a.DepthMode.ReadOnly),A=_.colorModeForRenderPass(),k=_.terrain&&_.terrain.renderingToTexture,[O,L]=_.renderPass!=="translucent"||k?[{},g]:_.stencilConfigForOverlap(g);for(const F of L){const $=o.getTile(F);if($.needsHillshadePrepare&&_.renderPass==="offscreen")Ll(_,$,f,T,a.StencilMode.disabled,A);else if(_.renderPass==="translucent"){const W=k&&_.terrain?_.terrain.stencilModeForRTTOverlap(F):O[F.overscaledZ];eu(_,F,$,f,T,W,A)}}x.viewport.set([0,0,_.width,_.height]),_.resetStencilClippingMasks()},raster:function(_,o,f,g,x,T){if(_.renderPass!=="translucent"||f.paint.get("raster-opacity")===0||!g.length)return;const A=_.context,k=A.gl,O=o.getSource(),L=_.useProgram("raster"),F=_.colorModeForRenderPass(),$=_.terrain&&_.terrain.renderingToTexture,[W,Q]=O instanceof Ao||$?[{},g]:_.stencilConfigForOverlap(g),X=Q[Q.length-1].overscaledZ,J=!_.options.moving;for(const de of Q){const Y=$?a.DepthMode.disabled:_.depthModeForSublayer(de.overscaledZ-X,f.paint.get("raster-opacity")===1?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly,k.LESS),ce=de.toUnwrapped(),ue=o.getTile(de);if($&&(!ue||!ue.hasData()))continue;const ae=$?de.projMatrix:_.transform.calculateProjMatrix(ce,J),le=_.terrain&&$?_.terrain.stencilModeForRTTOverlap(de):W[de.overscaledZ],me=T?0:f.paint.get("raster-fade-duration");ue.registerFadeDuration(me);const ke=o.findLoadedParent(de,0),Le=rp(ue,ke,o,_.transform,me);let ht,nt;_.terrain&&_.terrain.prepareDrawTile(de);const et=f.paint.get("raster-resampling")==="nearest"?k.NEAREST:k.LINEAR;A.activeTexture.set(k.TEXTURE0),ue.texture.bind(et,k.CLAMP_TO_EDGE),A.activeTexture.set(k.TEXTURE1),ke?(ke.texture.bind(et,k.CLAMP_TO_EDGE),ht=Math.pow(2,ke.tileID.overscaledZ-ue.tileID.overscaledZ),nt=[ue.tileID.canonical.x*ht%1,ue.tileID.canonical.y*ht%1]):ue.texture.bind(et,k.CLAMP_TO_EDGE);const je=ru(ae,nt||[0,0],ht||1,Le,f,O instanceof Ao?O.perspectiveTransform:[0,0]);if(_.prepareDrawProgram(A,L,ce),O instanceof Ao)L.draw(A,k.TRIANGLES,Y,a.StencilMode.disabled,F,a.CullFaceMode.disabled,je,f.id,O.boundsBuffer,_.quadTriangleIndexBuffer,O.boundsSegments);else{const{tileBoundsBuffer:Re,tileBoundsIndexBuffer:Qe,tileBoundsSegments:We}=_.getTileBoundsBuffers(ue);L.draw(A,k.TRIANGLES,Y,le,F,a.CullFaceMode.disabled,je,f.id,Re,Qe,We)}}_.resetStencilClippingMasks()},background:function(_,o,f,g){const x=f.paint.get("background-color"),T=f.paint.get("background-opacity");if(T===0)return;const A=_.context,k=A.gl,O=_.transform,L=O.tileSize,F=f.paint.get("background-pattern");if(_.isPatternMissing(F))return;const $=!F&&x.a===1&&T===1&&_.opaquePassEnabledForLayer()?"opaque":"translucent";if(_.renderPass!==$)return;const W=a.StencilMode.disabled,Q=_.depthModeForSublayer(0,$==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly),X=_.colorModeForRenderPass(),J=_.useProgram(F?"backgroundPattern":"background");let de,Y=g;Y||(de=_.getBackgroundTiles(),Y=Object.values(de).map(ue=>ue.tileID)),F&&(A.activeTexture.set(k.TEXTURE0),_.imageManager.bind(_.context));const ce=f.getCrossfadeParameters();for(const ue of Y){const ae=ue.toUnwrapped(),le=g?ue.projMatrix:_.transform.calculateProjMatrix(ae);_.prepareDrawTile(ue);const me=o?o.getTile(ue):de?de[ue.key]:new a.Tile(ue,L,O.zoom,_),ke=F?su(le,T,_,F,{tileID:ue,tileSize:L},ce):In(le,T,x);_.prepareDrawProgram(A,J,ae);const{tileBoundsBuffer:Le,tileBoundsIndexBuffer:ht,tileBoundsSegments:nt}=_.getTileBoundsBuffers(me);J.draw(A,k.TRIANGLES,Q,W,X,a.CullFaceMode.disabled,ke,f.id,Le,ht,nt)}},sky:function(_,o,f){const g=_.transform,x=g.projection.name==="mercator"||g.projection.name==="globe"?1:a.smoothstep(7,8,g.zoom),T=f.paint.get("sky-opacity")*x;if(T===0)return;const A=_.context,k=f.paint.get("sky-type"),O=new a.DepthMode(A.gl.LEQUAL,a.DepthMode.ReadOnly,[0,1]),L=_.frameCounter/1e3%1;k==="atmosphere"?_.renderPass==="offscreen"?f.needsSkyboxCapture(_)&&(function(F,$,W,Q){const X=F.context,J=X.gl;let de=$.skyboxFbo;if(!de){de=$.skyboxFbo=X.createFramebuffer(32,32,!1),$.skyboxGeometry=new du(X),$.skyboxTexture=X.gl.createTexture(),J.bindTexture(J.TEXTURE_CUBE_MAP,$.skyboxTexture),J.texParameteri(J.TEXTURE_CUBE_MAP,J.TEXTURE_WRAP_S,J.CLAMP_TO_EDGE),J.texParameteri(J.TEXTURE_CUBE_MAP,J.TEXTURE_WRAP_T,J.CLAMP_TO_EDGE),J.texParameteri(J.TEXTURE_CUBE_MAP,J.TEXTURE_MIN_FILTER,J.LINEAR),J.texParameteri(J.TEXTURE_CUBE_MAP,J.TEXTURE_MAG_FILTER,J.LINEAR);for(let ae=0;ae<6;++ae)J.texImage2D(J.TEXTURE_CUBE_MAP_POSITIVE_X+ae,0,J.RGBA,32,32,0,J.RGBA,J.UNSIGNED_BYTE,null)}X.bindFramebuffer.set(de.framebuffer),X.viewport.set([0,0,32,32]);const Y=$.getCenter(F,!0),ce=F.useProgram("skyboxCapture"),ue=new Float64Array(16);a.identity(ue),a.rotateY(ue,ue,.5*-Math.PI),As(X,$,ce,ue,Y,0),a.identity(ue),a.rotateY(ue,ue,.5*Math.PI),As(X,$,ce,ue,Y,1),a.identity(ue),a.rotateX(ue,ue,.5*-Math.PI),As(X,$,ce,ue,Y,2),a.identity(ue),a.rotateX(ue,ue,.5*Math.PI),As(X,$,ce,ue,Y,3),a.identity(ue),As(X,$,ce,ue,Y,4),a.identity(ue),a.rotateY(ue,ue,Math.PI),As(X,$,ce,ue,Y,5),X.viewport.set([0,0,F.width,F.height])}(_,f),f.markSkyboxValid(_)):_.renderPass==="sky"&&function(F,$,W,Q,X){const J=F.context,de=J.gl,Y=F.transform,ce=F.useProgram("skybox");J.activeTexture.set(de.TEXTURE0),de.bindTexture(de.TEXTURE_CUBE_MAP,$.skyboxTexture);const ue=((ae,le,me,ke,Le)=>({u_matrix:ae,u_sun_direction:le,u_cubemap:0,u_opacity:ke,u_temporal_offset:Le}))(Y.skyboxMatrix,$.getCenter(F,!1),0,Q,X);F.prepareDrawProgram(J,ce),ce.draw(J,de.TRIANGLES,W,a.StencilMode.disabled,F.colorModeForRenderPass(),a.CullFaceMode.backCW,ue,"skybox",$.skyboxGeometry.vertexBuffer,$.skyboxGeometry.indexBuffer,$.skyboxGeometry.segment)}(_,f,O,T,L):k==="gradient"&&_.renderPass==="sky"&&function(F,$,W,Q,X){const J=F.context,de=J.gl,Y=F.transform,ce=F.useProgram("skyboxGradient");$.skyboxGeometry||($.skyboxGeometry=new du(J)),J.activeTexture.set(de.TEXTURE0);let ue=$.colorRampTexture;ue||(ue=$.colorRampTexture=new a.Texture(J,$.colorRamp,de.RGBA)),ue.bind(de.LINEAR,de.CLAMP_TO_EDGE);const ae=((le,me,ke,Le,ht)=>({u_matrix:le,u_color_ramp:0,u_center_direction:me,u_radius:a.degToRad(ke),u_opacity:Le,u_temporal_offset:ht}))(Y.skyboxMatrix,$.getCenter(F,!1),$.paint.get("sky-gradient-radius"),Q,X);F.prepareDrawProgram(J,ce),ce.draw(J,de.TRIANGLES,W,a.StencilMode.disabled,F.colorModeForRenderPass(),a.CullFaceMode.backCW,ae,"skyboxGradient",$.skyboxGeometry.vertexBuffer,$.skyboxGeometry.indexBuffer,$.skyboxGeometry.segment)}(_,f,O,T,L)},debug:function(_,o,f){for(let g=0;g<f.length;g++)fu(_,o,f[g])},custom:function(_,o,f){const g=_.context,x=f.implementation;if(_.transform.projection.unsupportedLayers&&_.transform.projection.unsupportedLayers.includes("custom"))a.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if(_.renderPass==="offscreen"){const T=x.prerender;T&&(_.setCustomLayerDefaults(),g.setColorMode(_.colorModeForRenderPass()),T.call(x,g.gl,_.transform.customLayerMatrix()),g.setDirty(),_.setBaseState())}else if(_.renderPass==="translucent"){_.setCustomLayerDefaults(),g.setColorMode(_.colorModeForRenderPass()),g.setStencilMode(a.StencilMode.disabled);const T=x.renderingMode==="3d"?new a.DepthMode(_.context.gl.LEQUAL,a.DepthMode.ReadWrite,_.depthRangeFor3D):_.depthModeForSublayer(0,a.DepthMode.ReadOnly);g.setDepthMode(T),x.render(g.gl,_.transform.customLayerMatrix()),g.setDirty(),_.setBaseState(),g.bindFramebuffer.set(null)}}};class gp{constructor(o,f){this.context=new ai(o),this.transform=f,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=a.SourceCache.maxUnderzooming+a.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new zl,this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(o,f){const g=!!o&&!!o.terrain&&this.transform.projection.supportsTerrain;if(!(g||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Ss(this,o));const x=this._terrain;this.transform.elevation=g?x:null,x.update(o,this.transform,f)}_updateFog(o){const f=o.fog;if(!f||f.getOpacity(this.transform.pitch)<1||f.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[g,x]=f.getFovAdjustedRange(this.transform._fov);if(g>x)return void(this.transform.fogCullDistSq=null);const T=g+.78*(x-g);this.transform.fogCullDistSq=T*T}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(o,f){if(this.width=o*a.exported.devicePixelRatio,this.height=f*a.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style.order)this.style._layers[g].resize()}setup(){const o=this.context,f=new a.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(a.EXTENT,0),f.emplaceBack(0,a.EXTENT),f.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=o.createVertexBuffer(f,a.posAttributes.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);const g=new a.StructArrayLayout2i4;g.emplaceBack(0,0),g.emplaceBack(a.EXTENT,0),g.emplaceBack(0,a.EXTENT),g.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=o.createVertexBuffer(g,a.posAttributes.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);const x=new a.StructArrayLayout2i4;x.emplaceBack(-1,-1),x.emplaceBack(1,-1),x.emplaceBack(-1,1),x.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(x,a.posAttributes.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);const T=new a.StructArrayLayout4i8;T.emplaceBack(0,0,0,0),T.emplaceBack(a.EXTENT,0,a.EXTENT,0),T.emplaceBack(0,a.EXTENT,0,a.EXTENT),T.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.mercatorBoundsBuffer=o.createVertexBuffer(T,a.boundsAttributes.members),this.mercatorBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);const A=new a.StructArrayLayout3ui6;A.emplaceBack(0,1,2),A.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(A);const k=new a.StructArrayLayout1ui2;for(const L of[0,1,3,2,0])k.emplaceBack(L);this.debugIndexBuffer=o.createIndexBuffer(k),this.emptyTexture=new a.Texture(o,{width:1,height:1,data:new Uint8Array([0,0,0,0])},o.gl.RGBA),this.identityMat=a.create();const O=this.context.gl;this.stencilClearMode=new a.StencilMode({func:O.ALWAYS,mask:0},0,255,O.ZERO,O.ZERO,O.ZERO),this.loadTimeStamps.push(a.window.performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(o){return o._makeTileBoundsBuffers(this.context,this.transform.projection),o._tileBoundsBuffer?{tileBoundsBuffer:o._tileBoundsBuffer,tileBoundsIndexBuffer:o._tileBoundsIndexBuffer,tileBoundsSegments:o._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const o=this.context,f=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(o,f.TRIANGLES,a.DepthMode.disabled,this.stencilClearMode,a.ColorMode.disabled,a.CullFaceMode.disabled,Do(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(o,f,g){if(!f||this.currentStencilSource===f.id||!o.isTileClipped()||!g||g.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let k=!1;for(const O of g)if(this._tileClippingMaskIDs[O.key]===void 0){k=!0;break}if(!k)return}this.currentStencilSource=f.id;const x=this.context,T=x.gl;this.nextStencilID+g.length>256&&this.clearStencil(),x.setColorMode(a.ColorMode.disabled),x.setDepthMode(a.DepthMode.disabled);const A=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const k of g){const O=f.getTile(k),L=this._tileClippingMaskIDs[k.key]=this.nextStencilID++,{tileBoundsBuffer:F,tileBoundsIndexBuffer:$,tileBoundsSegments:W}=this.getTileBoundsBuffers(O);A.draw(x,T.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:T.ALWAYS,mask:0},L,255,T.KEEP,T.KEEP,T.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,Do(k.projMatrix),"$clipping",F,$,W)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,f=this.context.gl;return new a.StencilMode({func:f.NOTEQUAL,mask:255},o,255,f.KEEP,f.KEEP,f.REPLACE)}stencilModeForClipping(o){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(o);const f=this.context.gl;return new a.StencilMode({func:f.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,f.KEEP,f.KEEP,f.REPLACE)}stencilConfigForOverlap(o){const f=this.context.gl,g=o.sort((A,k)=>k.overscaledZ-A.overscaledZ),x=g[g.length-1].overscaledZ,T=g[0].overscaledZ-x+1;if(T>1){this.currentStencilSource=void 0,this.nextStencilID+T>256&&this.clearStencil();const A={};for(let k=0;k<T;k++)A[k+x]=new a.StencilMode({func:f.GEQUAL,mask:255},k+this.nextStencilID,255,f.KEEP,f.KEEP,f.REPLACE);return this.nextStencilID+=T,[A,g]}return[{[x]:a.StencilMode.disabled},g]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new a.ColorMode([o.CONSTANT_COLOR,o.ONE],new a.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?a.ColorMode.unblended:a.ColorMode.alphaBlended}depthModeForSublayer(o,f,g){if(!this.opaquePassEnabledForLayer())return a.DepthMode.disabled;const x=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new a.DepthMode(g||this.context.gl.LEQUAL,f,[x,x])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,f){this.style=o,this.options=f,this.lineAtlas=o.lineAtlas,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(a.exported.now()),this.imageManager.beginFrame();const g=this.style.order,x=this.style._sourceCaches;for(const L in x){const F=x[L];F.used&&F.prepare(this.context)}const T={},A={},k={};for(const L in x){const F=x[L];T[L]=F.getVisibleCoordinates(),A[L]=T[L].slice().reverse(),k[L]=F.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let L=0;L<g.length;L++)if(this.style._layers[g[L]].is3D()){this.opaquePassCutoff=L;break}if(this.terrain&&(this.terrain.updateTileBinding(k),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new a.GlobeSharedBuffers(this.context)),!a.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const L of g){const F=this.style._layers[L],$=o._getLayerSourceCache(F);if(!F.hasOffscreenPass()||F.isHidden(this.transform.zoom))continue;const W=$?A[$.id]:void 0;(F.type==="custom"||F.isSky()||W&&W.length)&&this.renderLayer(this,$,F,W)}this.depthRangeFor3D=[0,1-(o.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);let O=a.Color.transparent;if(this.style.fog&&this.style.fog.getOpacity(this.transform.pitch)&&(O=this.style.fog.properties.get("color")),this.context.clear({color:f.showOverdrawInspector?a.Color.black:O,depth:1}),this.clearStencil(),this._showOverdrawInspector=f.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){const L=this.style._layers[g[this.currentLayer]],F=o._getLayerSourceCache(L);if(L.isSky())continue;const $=F?A[F.id]:void 0;this._renderTileClippingMasks(L,F,$),this.renderLayer(this,F,L,$)}if(this.renderPass="sky",(a.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){const L=this.style._layers[g[this.currentLayer]],F=o._getLayerSourceCache(L);L.isSky()&&this.renderLayer(this,F,L,F?A[F.id]:void 0)}for(this.transform.projection.name==="globe"&&function(L){const F=L.context,$=F.gl,W=L.transform,Q=new a.DepthMode($.LEQUAL,a.DepthMode.ReadOnly,[0,1]),X=L.useProgram("globeAtmosphere"),J=W._camera.getWorldToCamera(W.worldSize,1),de=W._camera.getCameraToClipPerspective(W._fov,W.width/W.height,W._nearZ,W._farZ),Y=a.mul([],J,a.calculateGlobeMatrix(W,W.worldSize)),ce=a.mul([],W.labelPlaneMatrix,de),ue=a.transformMat4([],[0,0,0],Y),ae=a.add([],ue,[W.worldSize/Math.PI/2,0,0]),le=a.transformMat4([],ue,ce),me=a.transformMat4([],ae,ce),ke=a.length(a.sub([],me,le)),Le=1-a.globeToMercatorTransition(W.zoom),ht={u_center:le,u_radius:ke,u_screen_size:[W.width,W.height],u_pixel_ratio:a.exported.devicePixelRatio,u_opacity:Le,u_fadeout_range:2,u_start_color:[1,1,1],u_end_color:[.0118,.7451,.9882]};L.prepareDrawProgram(F,X);const nt=L.globeSharedBuffers;nt&&X.draw(F,$.TRIANGLES,Q,a.StencilMode.disabled,a.ColorMode.alphaBlended,a.CullFaceMode.backCW,ht,"skybox",nt.atmosphereVertexBuffer,nt.atmosphereIndexBuffer,nt.atmosphereSegments)}(this),this.renderPass="translucent",this.currentLayer=0;this.currentLayer<g.length;){const L=this.style._layers[g[this.currentLayer]],F=o._getLayerSourceCache(L);if(L.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(L)){if(L.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const $=F?(L.type==="symbol"?k:A)[F.id]:void 0;this._renderTileClippingMasks(L,F,F?T[F.id]:void 0),this.renderLayer(this,F,L,$),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let L=null;a.values(this.style._layers).forEach(F=>{const $=o._getLayerSourceCache(F);$&&!F.isHidden(this.transform.zoom)&&(!L||L.getSource().maxzoom<$.getSource().maxzoom)&&(L=$)}),L&&this.options.showTileBoundaries&&Wl.debug(this,L,L.getVisibleCoordinates())}this.options.showPadding&&function(L){const F=L.transform.padding;vi(L,L.transform.height-(F.top||0),3,mp),vi(L,F.bottom||0,3,_g),hu(L,F.left||0,3,ql),hu(L,L.transform.width-(F.right||0),3,Zl);const $=L.transform.centerPoint;(function(W,Q,X,J){Js(W,Q-1,X-10,2,20,J),Js(W,Q-10,X-1,20,2,J)})(L,$.x,L.transform.height-$.y,_p)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(a.window.performance.now()),this.saveCanvasCopy())}renderLayer(o,f,g,x){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="sky"||g.type==="custom"||x&&x.length)&&(this.id=g.id,this.gpuTimingStart(g),o.transform.projection.unsupportedLayers&&o.transform.projection.unsupportedLayers.includes(g.type)||Wl[g.type](o,f,g,x,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const f=this.context.extTimerQuery;let g=this.gpuTimers[o.id];g||(g=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:f.createQueryEXT()}),g.calls++,f.beginQueryEXT(f.TIME_ELAPSED_EXT,g.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}queryGpuTimers(o){const f={};for(const g in o){const x=o[g],T=this.context.extTimerQuery,A=T.getQueryObjectEXT(x.query,T.QUERY_RESULT_EXT)/1e6;T.deleteQueryEXT(x.query),f[g]=A}return f}translatePosMatrix(o,f,g,x,T){if(!g[0]&&!g[1])return o;const A=T?x==="map"?this.transform.angle:0:x==="viewport"?-this.transform.angle:0;if(A){const L=Math.sin(A),F=Math.cos(A);g=[g[0]*F-g[1]*L,g[0]*L+g[1]*F]}const k=[T?g[0]:_t(f,g[0],this.transform.zoom),T?g[1]:_t(f,g[1],this.transform.zoom),0],O=new Float32Array(16);return a.translate(O,o,k),O}saveTileTexture(o){const f=this._tileTextures[o.size[0]];f?f.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const f=this._tileTextures[o];return f&&f.length>0?f.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const f=this.imageManager.getPattern(o.from.toString()),g=this.imageManager.getPattern(o.to.toString());return!f||!g}currentGlobalDefines(){const o=this.terrain&&this.terrain.renderingToTexture,f=this.style&&this.style.fog,g=[];return this.terrain&&!this.terrain.renderingToTexture&&g.push("TERRAIN"),f&&!o&&f.getOpacity(this.transform.pitch)!==0&&g.push("FOG"),o&&g.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&g.push("OVERDRAW_INSPECTOR"),g}useProgram(o,f,g){this.cache=this.cache||{};const x=g||[],T=this.currentGlobalDefines().concat(x),A=Bl.cacheKey(o,T,f);return this.cache[A]||(this.cache[A]=new Bl(this.context,o,qh[o],f,fp[o],T)),this.cache[A]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}prepareDrawTile(o){this.terrain&&this.terrain.prepareDrawTile(o)}prepareDrawProgram(o,f,g){if(this.terrain&&this.terrain.renderingToTexture)return;const x=this.style.fog;if(x){const T=x.getOpacity(this.transform.pitch);T!==0&&f.setFogUniformValues(o,((A,k,O,L)=>{const F=k.properties.get("color"),$=A.frameCounter/1e3%1,W=[F.r/F.a,F.g/F.a,F.b/F.a,L];return{u_fog_matrix:O?A.transform.calculateFogTileMatrix(O):A.identityMat,u_fog_range:k.getFovAdjustedRange(A.transform._fov),u_fog_color:W,u_fog_horizon_blend:k.properties.get("horizon-blend"),u_fog_temporal_offset:$}})(this,x,g,T))}}setTileLoadedFlag(o){this.tileLoaded=o}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const o=this.context.gl,f=o.createTexture();return o.bindTexture(o.TEXTURE_2D,f),o.copyTexImage2D(o.TEXTURE_2D,0,o.RGBA,0,0,o.drawingBufferWidth,o.drawingBufferHeight,0),f}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const o=this.style&&this.style.fog;return!!o&&o.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const o=this._backgroundTiles,f=this._backgroundTiles={},g=this.transform.coveringTiles({tileSize:512});for(const x of g)f[x.key]=o[x.key]||new a.Tile(x,512,this.transform.tileZoom,this);return f}clearBackgroundTiles(){this._backgroundTiles={}}}class pu{constructor(o=0,f=0,g=0,x=0){if(isNaN(o)||o<0||isNaN(f)||f<0||isNaN(g)||g<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=f,this.left=g,this.right=x}interpolate(o,f,g){return f.top!=null&&o.top!=null&&(this.top=a.number(o.top,f.top,g)),f.bottom!=null&&o.bottom!=null&&(this.bottom=a.number(o.bottom,f.bottom,g)),f.left!=null&&o.left!=null&&(this.left=a.number(o.left,f.left,g)),f.right!=null&&o.right!=null&&(this.right=a.number(o.right,f.right,g)),this}getCenter(o,f){const g=a.clamp((this.left+o-this.right)/2,0,o),x=a.clamp((this.top+f-this.bottom)/2,0,f);return new a.pointGeometry(g,x)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new pu(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Cs(_,o){const f=a.getColumn(_,3);a.fromQuat(_,o),a.setColumn(_,3,f)}function yp(_,o){a.setColumn(_,3,[o[0],o[1],o[2],1])}function Jh(_,o){const f=a.identity$1([]);return a.rotateZ$1(f,f,-o),a.rotateX$1(f,f,-_),f}function ef(_,o){const f=[_[0],_[1],0],g=[o[0],o[1],0];if(a.length(f)>=1e-15){const A=a.normalize([],f);a.scale$2(g,A,a.dot(g,A)),o[0]=g[0],o[1]=g[1]}const x=a.cross([],o,_);if(a.len(x)<1e-15)return null;const T=Math.atan2(-x[1],x[0]);return Jh(Math.atan2(Math.sqrt(_[0]*_[0]+_[1]*_[1]),-_[2]),T)}class vp{constructor(o,f){this.position=o,this.orientation=f}get position(){return this._position}set position(o){this._position=this._renderWorldCopies?function(f){if(!f)return;const g=Array.isArray(f)?new a.MercatorCoordinate(f[0],f[1],f[2]):f;return g.x=a.wrap(g.x,0,1),g}(o):o}lookAtPoint(o,f){if(this.orientation=null,!this.position)return;const g=this._elevation?this._elevation.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(o)):0,x=this.position,T=a.MercatorCoordinate.fromLngLat(o,g),A=[T.x-x.x,T.y-x.y,T.z-x.z];f||(f=[0,0,1]),f[2]=Math.abs(f[2]),this.orientation=ef(A,f)}setPitchBearing(o,f){this.orientation=Jh(a.degToRad(o),a.degToRad(-f))}}class tf{constructor(o,f){this._transform=a.identity([]),this._orientation=a.identity$1([]),f&&(this._orientation=f,Cs(this._transform,this._orientation)),o&&yp(this._transform,o)}get mercatorPosition(){const o=this.position;return new a.MercatorCoordinate(o[0],o[1],o[2])}get position(){const o=a.getColumn(this._transform,3);return[o[0],o[1],o[2]]}set position(o){yp(this._transform,o)}get orientation(){return this._orientation}set orientation(o){this._orientation=o,Cs(this._transform,this._orientation)}getPitchBearing(){const o=this.forward(),f=this.right();return{bearing:Math.atan2(-f[1],f[0]),pitch:Math.atan2(Math.sqrt(o[0]*o[0]+o[1]*o[1]),-o[2])}}setPitchBearing(o,f){this._orientation=Jh(o,f),Cs(this._transform,this._orientation)}forward(){const o=a.getColumn(this._transform,2);return[-o[0],-o[1],-o[2]]}up(){const o=a.getColumn(this._transform,1);return[-o[0],-o[1],-o[2]]}right(){const o=a.getColumn(this._transform,0);return[o[0],o[1],o[2]]}getCameraToWorld(o,f){const g=new Float64Array(16);return a.invert(g,this.getWorldToCamera(o,f)),g}getWorldToCameraPosition(o,f,g){const x=this.position;a.scale$2(x,x,-o);const T=new Float64Array(16);return a.fromScaling(T,[g,g,g]),a.translate(T,T,x),T[10]*=f,T}getWorldToCamera(o,f){const g=new Float64Array(16),x=new Float64Array(4),T=this.position;return a.conjugate(x,this._orientation),a.scale$2(T,T,-o),a.fromQuat(g,x),a.translate(g,g,T),g[1]*=-1,g[5]*=-1,g[9]*=-1,g[13]*=-1,g[8]*=f,g[9]*=f,g[10]*=f,g[11]*=f,g}getCameraToClipPerspective(o,f,g,x){const T=new Float64Array(16);return a.perspective(T,o,f,g,x),T}getDistanceToElevation(o){const f=o===0?0:a.mercatorZfromAltitude(o,this.position[1]),g=this.forward();return(f-this.position[2])/g[2]}clone(){return new tf([...this.position],[...this.orientation])}}function xp(_,o){const f=_u(_),g=function(T,A,k,O,L){const F=new a.LngLat(k.lng-180*lo,k.lat),$=new a.LngLat(k.lng+180*lo,k.lat),W=T.project(F.lng,F.lat),Q=T.project($.lng,$.lat),X=-Math.atan2(Q.y-W.y,Q.x-W.x),J=a.MercatorCoordinate.fromLngLat(k);J.y=a.clamp(J.y,-.999975,.999975);const de=J.toLngLat(),Y=T.project(de.lng,de.lat),ce=a.MercatorCoordinate.fromLngLat(de);ce.x+=lo;const ue=ce.toLngLat(),ae=T.project(ue.lng,ue.lat),le=rf(ae.x-Y.x,ae.y-Y.y,X),me=a.MercatorCoordinate.fromLngLat(de);me.y+=lo;const ke=me.toLngLat(),Le=T.project(ke.lng,ke.lat),ht=rf(Le.x-Y.x,Le.y-Y.y,X),nt=Math.abs(le.x)/Math.abs(ht.y),et=a.identity([]);a.rotateZ(et,et,-X*(1-(L?0:O)));const je=a.identity([]);return a.scale(je,je,[1,1-(1-nt)*O,1]),je[4]=-ht.x/ht.y*O,a.rotateZ(je,je,X),a.multiply$1(je,et,je),je}(_.projection,0,_.center,f,o),x=mu(_);return a.scale(g,g,[x,x,1]),g}function mu(_){const o=_.projection,f=_u(_),g=nf(o,_.center),x=nf(o,a.LngLat.convert(o.center));return Math.pow(2,g*f+(1-f)*x)}function _u(_){const o=_.projection.range;if(!o)return 0;const f=Math.max(_.width,_.height),g=Math.log(f/1024)/Math.LN2;return a.smoothstep(o[0]+g,o[1]+g,_.zoom)}const lo=1/4e4;function nf(_,o){const f=a.clamp(o.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),g=new a.LngLat(o.lng-180*lo,f),x=new a.LngLat(o.lng+180*lo,f),T=_.project(g.lng,f),A=_.project(x.lng,f),k=a.MercatorCoordinate.fromLngLat(g),O=a.MercatorCoordinate.fromLngLat(x),L=A.x-T.x,F=A.y-T.y,$=O.x-k.x,W=O.y-k.y,Q=Math.sqrt(($*$+W*W)/(L*L+F*F));return Math.log(Q)/Math.LN2}function rf(_,o,f){const g=Math.cos(f),x=Math.sin(f);return{x:_*g-o*x,y:_*x+o*g}}class Hl{constructor(o,f,g,x,T){this.tileSize=512,this._renderWorldCopies=T===void 0||T,this._minZoom=o||0,this._maxZoom=f||22,this._minPitch=g==null?0:g,this._maxPitch=x==null?60:x,this.setProjection(),this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new pu,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new tf,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._projectionScaler=1,this._horizonShift=.1}clone(){const o=new Hl(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return o.setProjection(this.getProjection()),o._elevation=this._elevation,o._centerAltitude=this._centerAltitude,o.tileSize=this.tileSize,o.setMaxBounds(this.getMaxBounds()),o.width=this.width,o.height=this.height,o.cameraElevationReference=this.cameraElevationReference,o._center=this._center,o._setZoom(this.zoom),o._cameraZoom=this._cameraZoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._nearZ=this._nearZ,o._farZ=this._farZ,o._averageElevation=this._averageElevation,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._camera=this._camera.clone(),o._calcMatrices(),o.freezeTileCoverage=this.freezeTileCoverage,o}get elevation(){return this._elevation}set elevation(o){this._elevation!==o&&(this._elevation=o,o?this._updateCenterElevation()&&this._updateCameraOnTerrain():(this._cameraZoom=null,this._centerAltitude=0),this._calcMatrices())}updateElevation(o){this._terrainEnabled()&&this._cameraZoom==null&&this._updateCenterElevation()&&this._updateCameraOnTerrain(),o&&this._constrainCameraAltitude(),this._calcMatrices()}getProjection(){return a.pick(this.projection,["name","center","parallels"])}setProjection(o){o==null&&(o={name:"mercator"}),this.projectionOptions=o;const f=this.projection?this.getProjection():void 0;return this.projection=a.getProjection(o),!M(f,this.getProjection())&&(this._calcMatrices(),!0)}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.cameraWorldSize)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.pointGeometry(this.width,this.height)}get bearing(){return a.wrap(this.rotation,-180,180)}set bearing(o){this.rotation=o}get rotation(){return-this.angle/Math.PI*180}set rotation(o){const f=-o*Math.PI/180;var g;this.angle!==f&&(this._unmodified=!1,this.angle=f,this._calcMatrices(),this.rotationMatrix=(g=new a.ARRAY_TYPE(4),a.ARRAY_TYPE!=Float32Array&&(g[1]=0,g[2]=0),g[0]=1,g[3]=1,g),function(x,T,A){var k=T[0],O=T[1],L=T[2],F=T[3],$=Math.sin(A),W=Math.cos(A);x[0]=k*W+L*$,x[1]=O*W+F*$,x[2]=k*-$+L*W,x[3]=O*-$+F*W}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const f=a.clamp(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==f&&(this._unmodified=!1,this._pitch=f,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=o/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(o){this._averageElevation=o,this._calcFogMatrices()}get zoom(){return this._zoom}set zoom(o){const f=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==f&&(this._unmodified=!1,this._setZoom(f),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._constrain(),this._calcMatrices())}_setZoom(o){this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom}_updateCenterElevation(){if(!this._elevation)return!1;const o=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center),-1);return o===-1?(this._cameraZoom=null,!1):(this._centerAltitude=o,!0)}_updateCameraOnTerrain(){this._cameraZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize)}sampleAverageElevation(){if(!this._elevation)return 0;const o=this._elevation,f=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],g=this.horizonLineFromTop();let x=0,T=0;for(let A=0;A<f.length;A++){const k=new a.pointGeometry(f[A][0]*this.width,g+f[A][1]*(this.height-g)),O=o.pointCoordinate(k);if(!O)continue;const L=1/Math.hypot(O[0]-this._camera.position[0],O[1]-this._camera.position[1]);x+=O[3]*L,T+=L}return T===0?NaN:x/T}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCenterElevation()?this._updateCameraOnTerrain():this._cameraZoom=null:this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._cameraZoom==null||!this._elevation)return;const o=this._cameraZoom,f=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),g=this.pixelsPerMeter/this.worldSize*f,x=this._mercatorZfromZoom(o),T=this._mercatorZfromZoom(this._maxZoom),A=Math.max(x-g,T);this._setZoom(this._zoomFromMercatorZ(A))}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}computeZoomRelativeTo(o){const f=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,o.toAltitude()));let g;g=o.z<this._camera.position[2]?[f.x,f.y,f.z]:[o.x,o.y,o.z];const x=a.length(a.sub([],this._camera.position,g));return a.clamp(this._zoomFromMercatorZ(x),this._minZoom,this._maxZoom)}setFreeCameraOptions(o){if(!this.height||!o.position&&!o.orientation)return;this._updateCameraState();let f=!1;if(o.orientation&&!a.exactEquals(o.orientation,this._camera.orientation)&&(f=this._setCameraOrientation(o.orientation)),o.position){const g=[o.position.x,o.position.y,o.position.z];a.exactEquals$1(g,this._camera.position)||(this._setCameraPosition(g),f=!0)}f&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const o=this._camera.position,f=new vp;return f.position=new a.MercatorCoordinate(o[0],o[1],o[2]),f.orientation=this._camera.orientation,f._elevation=this.elevation,f._renderWorldCopies=this.renderWorldCopies,f}_setCameraOrientation(o){if(!a.length$1(o))return!1;a.normalize$1(o,o);const f=a.transformQuat([],[0,0,-1],o),g=a.transformQuat([],[0,-1,0],o);if(g[2]<0)return!1;const x=ef(f,g);return!!x&&(this._camera.orientation=x,!0)}_setCameraPosition(o){const f=this.zoomScale(this.minZoom)*this.tileSize,g=this.zoomScale(this.maxZoom)*this.tileSize,x=this.cameraToCenterDistance;o[2]=a.clamp(o[2],x/g,x/f),this._camera.position=o}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,f,g){this._unmodified=!1,this._edgeInsets.interpolate(o,f,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const f=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,f)}getVisibleUnwrappedCoordinates(o){const f=[new a.UnwrappedTileID(0,o)];if(this.renderWorldCopies){const g=this.pointCoordinate(new a.pointGeometry(0,0)),x=this.pointCoordinate(new a.pointGeometry(this.width,0)),T=this.pointCoordinate(new a.pointGeometry(this.width,this.height)),A=this.pointCoordinate(new a.pointGeometry(0,this.height)),k=Math.floor(Math.min(g.x,x.x,T.x,A.x)),O=Math.floor(Math.max(g.x,x.x,T.x,A.x)),L=1;for(let F=k-L;F<=O+L;F++)F!==0&&f.push(new a.UnwrappedTileID(F,o))}return f}coveringTiles(o){let f=this.coveringZoomLevel(o);const g=f,x=this.elevation&&!o.isTerrainDEM,T=this.projection.name==="mercator";if(o.minzoom!==void 0&&f<o.minzoom)return[];o.maxzoom!==void 0&&f>o.maxzoom&&(f=o.maxzoom);const A=this.locationCoordinate(this.center),k=1<<f,O=[k*A.x,k*A.y,0],L=a.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,f,this.projection.name!=="globe"),F=this.pointCoordinate(this.getCameraPoint()),$=k*a.mercatorZfromAltitude(1,this.center.lat),W=this._camera.position[2]/a.mercatorZfromAltitude(1,this.center.lat),Q=[k*F.x,k*F.y,W],X=this.cameraToCenterDistance/o.tileSize*(o.roundZoom?1:.502),J=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?f:0,de=o.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Y=o.isTerrainDEM?-de:this._elevation?this._elevation.getMinElevationBelowMSL():0,ce=this.projection.isReprojectedInTileSpace?mu(this):1,ue=Re=>{const We=new a.MercatorCoordinate(Re.x+25e-6,Re.y,Re.z),zt=new a.MercatorCoordinate(Re.x,Re.y+25e-6,Re.z),jt=Re.toLngLat(),Jt=We.toLngLat(),ut=zt.toLngLat(),Ft=this.locationCoordinate(jt),Zt=this.locationCoordinate(Jt),Pn=this.locationCoordinate(ut),jn=Math.hypot(Zt.x-Ft.x,Zt.y-Ft.y),qt=Math.hypot(Pn.x-Ft.x,Pn.y-Ft.y);return Math.sqrt(jn*qt)*ce/25e-6},ae=Re=>{const Qe=de,We=Y;return{aabb:a.tileAABB(this,k,0,0,0,Re,We,Qe,this.projection),zoom:0,x:0,y:0,minZ:We,maxZ:Qe,wrap:Re,fullyVisible:!1}},le=[];let me=[];const ke=f,Le=o.reparseOverscaled?g:f,ht=Re=>Re*Re,nt=ht((W-this._centerAltitude)*$),et=Re=>{if(!this._elevation||!Re.tileID||!T)return;const Qe=this._elevation.getMinMaxForTile(Re.tileID),We=Re.aabb;Qe?(We.min[2]=Qe.min,We.max[2]=Qe.max,We.center[2]=(We.min[2]+We.max[2])/2):(Re.shouldSplit=je(Re),Re.shouldSplit||(We.min[2]=We.max[2]=We.center[2]=this._centerAltitude))},je=Re=>{if(Re.zoom<J)return!0;if(Re.zoom===ke)return!1;if(Re.shouldSplit!=null)return Re.shouldSplit;const Qe=Re.aabb.distanceX(Q),We=Re.aabb.distanceY(Q);let zt=nt;x&&(zt=ht(Re.aabb.distanceZ(Q)*$));let jt=1;if(this.projection.isReprojectedInTileSpace&&g<=5){const ut=Math.pow(2,Re.zoom),Ft=ue(new a.MercatorCoordinate((Re.x+.5)/ut,(Re.y+.5)/ut));jt=Ft>.85?1:Ft}const Jt=Qe*Qe+We*We+zt;return Jt<ht((1<<ke-Re.zoom)*X*jt*((ut,Ft)=>{if(Ft*ht(.707)<ut)return 1;const Zt=Math.sqrt(Ft/ut);return Zt/(1.4144271570014144+(Math.pow(1.1,Zt-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(zt,nt),Jt))};if(this.renderWorldCopies)for(let Re=1;Re<=3;Re++)le.push(ae(-Re)),le.push(ae(Re));for(le.push(ae(0));le.length>0;){const Re=le.pop(),Qe=Re.x,We=Re.y;let zt=Re.fullyVisible;if(!zt){const jt=Re.aabb.intersects(L);if(jt===0)continue;zt=jt===2}if(Re.zoom!==ke&&je(Re))for(let jt=0;jt<4;jt++){const Jt=(Qe<<1)+jt%2,ut=(We<<1)+(jt>>1),Ft={aabb:T?Re.aabb.quadrant(jt):a.tileAABB(this,k,Re.zoom+1,Jt,ut,Re.wrap,Re.minZ,Re.maxZ,this.projection),zoom:Re.zoom+1,x:Jt,y:ut,wrap:Re.wrap,fullyVisible:zt,tileID:void 0,shouldSplit:void 0,minZ:Re.minZ,maxZ:Re.maxZ};x&&(Ft.tileID=new a.OverscaledTileID(Re.zoom+1===ke?Le:Re.zoom+1,Re.wrap,Re.zoom+1,Jt,ut),et(Ft)),le.push(Ft)}else{const jt=Re.zoom===ke?Le:Re.zoom;if(o.minzoom&&o.minzoom>jt)continue;const Jt=O[0]-(.5+Qe+(Re.wrap<<Re.zoom))*(1<<f-Re.zoom),ut=O[1]-.5-We,Ft=Re.tileID?Re.tileID:new a.OverscaledTileID(jt,Re.wrap,Re.zoom,Qe,We);me.push({tileID:Ft,distanceSq:Jt*Jt+ut*ut})}}if(this.fogCullDistSq){const Re=this.fogCullDistSq,Qe=this.horizonLineFromTop();me=me.filter(We=>{const zt=[0,0,0,1],jt=[a.EXTENT,a.EXTENT,0,1],Jt=this.calculateFogTileMatrix(We.tileID.toUnwrapped());a.transformMat4$1(zt,zt,Jt),a.transformMat4$1(jt,jt,Jt);const ut=a.getAABBPointSquareDist(zt,jt);if(ut===0)return!0;let Ft=!1;const Zt=this._elevation;if(Zt&&ut>Re&&Qe!==0){const Pn=this.calculateProjMatrix(We.tileID.toUnwrapped());let jn;o.isTerrainDEM||(jn=Zt.getMinMaxForTile(We.tileID)),jn||(jn={min:Y,max:de});const qt=a.furthestTileCorner(this.rotation),sn=[qt[0]*a.EXTENT,qt[1]*a.EXTENT,jn.max];a.transformMat4(sn,sn,Pn),Ft=(1-sn[1])*this.height*.5<Qe}return ut<Re||Ft})}return me.sort((Re,Qe)=>Re.distanceSq-Qe.distanceSq).map(Re=>Re.tileID)}resize(o,f){this.width=o,this.height=f,this.pixelsToGLUnits=[2/o,-2/f],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const f=a.clamp(o.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),g=this.projection.project(o.lng,f);return new a.pointGeometry(g.x*this.worldSize,g.y*this.worldSize)}unproject(o){return this.projection.unproject(o.x/this.worldSize,o.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(o,f){const g=this.pointCoordinate(f),x=this.pointCoordinate(this.centerPoint),T=this.locationCoordinate(o);this.setLocation(new a.MercatorCoordinate(T.x-(g.x-x.x),T.y-(g.y-x.y)))}setLocation(o){this.center=this.coordinateLocation(o),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(o){return this.projection.locationPoint(this,o)}locationPoint3D(o){return this._coordinatePoint(this.locationCoordinate(o),!0)}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}pointLocation3D(o){return this.coordinateLocation(this.pointCoordinate3D(o))}locationCoordinate(o,f){const g=f?a.mercatorZfromAltitude(f,o.lat):void 0,x=this.projection.project(o.lng,o.lat);return new a.MercatorCoordinate(x.x,x.y,g)}coordinateLocation(o){return this.projection.unproject(o.x,o.y)}pointRayIntersection(o,f){const g=f!=null?f:this._centerAltitude,x=[o.x,o.y,0,1],T=[o.x,o.y,1,1];a.transformMat4$1(x,x,this.pixelMatrixInverse),a.transformMat4$1(T,T,this.pixelMatrixInverse);const A=T[3];a.scale$1(x,x,1/x[3]),a.scale$1(T,T,1/A);const k=x[2],O=T[2];return{p0:x,p1:T,t:k===O?0:(g-k)/(O-k)}}screenPointToMercatorRay(o){const f=[o.x,o.y,0,1],g=[o.x,o.y,1,1];return a.transformMat4$1(f,f,this.pixelMatrixInverse),a.transformMat4$1(g,g,this.pixelMatrixInverse),a.scale$1(f,f,1/f[3]),a.scale$1(g,g,1/g[3]),f[2]=a.mercatorZfromAltitude(f[2],this._center.lat)*this.worldSize,g[2]=a.mercatorZfromAltitude(g[2],this._center.lat)*this.worldSize,a.scale$1(f,f,1/this.worldSize),a.scale$1(g,g,1/this.worldSize),new a.Ray([f[0],f[1],f[2]],a.normalize([],a.sub([],g,f)))}rayIntersectionCoordinate(o){const{p0:f,p1:g,t:x}=o,T=a.mercatorZfromAltitude(f[2],this._center.lat),A=a.mercatorZfromAltitude(g[2],this._center.lat);return new a.MercatorCoordinate(a.number(f[0],g[0],x)/this.worldSize,a.number(f[1],g[1],x)/this.worldSize,a.number(T,A,x))}pointCoordinate(o,f=this._centerAltitude){return this.projection.createTileTransform(this,this.worldSize).pointCoordinate(o.x,o.y,f)}pointCoordinate3D(o){if(!this.elevation)return this.pointCoordinate(o);const f=this.elevation;let g=this.elevation.pointCoordinate(o);if(g)return new a.MercatorCoordinate(g[0],g[1],g[2]);let x=0,T=this.horizonLineFromTop();if(o.y>T)return this.pointCoordinate(o);const A=.02*T,k=o.clone();for(let O=0;O<10&&T-x>A;O++){k.y=a.number(x,T,.66);const L=f.pointCoordinate(k);L?(T=k.y,g=L):x=k.y}return g?new a.MercatorCoordinate(g[0],g[1],g[2]):this.pointCoordinate(o)}isPointAboveHorizon(o){if(this.elevation)return!this.elevation.pointCoordinate(o);{const f=this.horizonLineFromTop();return o.y<f}}_coordinatePoint(o,f){const g=f&&this.elevation?this.elevation.getAtPointOrZero(o,this._centerAltitude):this._centerAltitude,x=[o.x*this.worldSize,o.y*this.worldSize,g+o.toAltitude(),1];return a.transformMat4$1(x,x,this.pixelMatrix),x[3]>0?new a.pointGeometry(x[0]/x[3],x[1]/x[3]):new a.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(o,f){const g=new a.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),x=new a.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),T=new a.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),A=new a.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let k=this.pointCoordinate(g,o),O=this.pointCoordinate(x,o);const L=this.pointCoordinate(T,f),F=this.pointCoordinate(A,f),$=(W,Q)=>(Q.y-W.y)/(Q.x-W.x);return k.y>1&&O.y>=0?k=new a.MercatorCoordinate((1-F.y)/$(F,k)+F.x,1):k.y<0&&O.y<=1&&(k=new a.MercatorCoordinate(-F.y/$(F,k)+F.x,0)),O.y>1&&k.y>=0?O=new a.MercatorCoordinate((1-L.y)/$(L,O)+L.x,1):O.y<0&&k.y<=1&&(O=new a.MercatorCoordinate(-L.y/$(L,O)+L.x,0)),new a.LngLatBounds().extend(this.coordinateLocation(k)).extend(this.coordinateLocation(O)).extend(this.coordinateLocation(F)).extend(this.coordinateLocation(L))}_getBounds3D(){const o=this.elevation;if(!o.visibleDemTiles.length)return this._getBounds(0,0);const f=o.visibleDemTiles.reduce((g,x)=>{if(x.dem){const T=x.dem.tree;g.min=Math.min(g.min,T.minimums[0]),g.max=Math.max(g.max,T.maximums[0])}return g},{min:Number.MAX_VALUE,max:0});return this._getBounds(f.min*o.exaggeration(),f.max*o.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(o=!0){const f=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,g=this.height/2-f*(1-this._horizonShift);return o?Math.max(0,g):g}getMaxBounds(){return this.maxBounds}setMaxBounds(o){this.maxBounds=o,this.minLat=-a.MAX_MERCATOR_LATITUDE,this.maxLat=a.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,o&&(this.minLat=o.getSouth(),this.maxLat=o.getNorth(),this.minLng=o.getWest(),this.maxLng=o.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=a.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=a.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=a.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(o,f){return this.projection.createTileTransform(this,f).createTileMatrix(o)}calculateDistanceTileData(o){const f=o.key,g=this._distanceTileDataCache;if(g[f])return g[f];const x=o.canonical,T=1/this.height,A=this.cameraWorldSize/this.zoomScale(x.z),k=(x.x+Math.pow(2,x.z)*o.wrap)*A,O=x.y*A,L=this.point,F=this.angle,$=Math.sin(-F),W=-Math.cos(-F);return g[f]={bearing:[$,W],center:[(L.x-k)*T,(L.y-O)*T],scale:A/a.EXTENT*T},g[f]}calculateFogTileMatrix(o){const f=o.key,g=this._fogTileMatrixCache;if(g[f])return g[f];const x=this.calculatePosMatrix(o,this.cameraWorldSize);return a.multiply$1(x,this.worldToFogMatrix,x),g[f]=new Float32Array(x),g[f]}calculateProjMatrix(o,f=!1){const g=o.key,x=f?this._alignedProjMatrixCache:this._projMatrixCache;if(x[g])return x[g];const T=this.calculatePosMatrix(o,this.worldSize);return a.multiply$1(T,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:f?this.alignedProjMatrix:this.projMatrix,T),x[g]=new Float32Array(T),x[g]}calculatePixelsToTileUnitsMatrix(o){const f=o.tileID.key,g=this._pixelsToTileUnitsCache;if(g[f])return g[f];const x=function(T,A){const{scale:k}=T.tileTransform,O=k*a.EXTENT/(T.tileSize*Math.pow(2,A.zoom-T.tileID.overscaledZ+T.tileID.canonical.z));return L=new Float32Array(4),W=(F=A.inverseAdjustmentMatrix)[1],Q=F[2],X=F[3],de=($=[O,O])[1],L[0]=F[0]*(J=$[0]),L[1]=W*J,L[2]=Q*de,L[3]=X*de,L;var L,F,$,W,Q,X,J,de}(o,this);return g[f]=x,g[f]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation)return;const o=this._elevation;this._updateCameraState();const f=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,g=this._computeCameraPosition(f),x=this._camera.forward(),T=a.mercatorZfromAltitude(1,this._center.lat);g[2]/=T,x[2]/=T,a.normalize(x,x);const A=o.raycast(g,x,o.exaggeration());if(A){const k=a.scaleAndAdd([],g,x,A),O=new a.MercatorCoordinate(k[0],k[1],a.mercatorZfromAltitude(k[2],a.latFromMercatorY(k[1]))),L=(O.z+a.length([O.x-g[0],O.y-g[1],O.z-g[2]*T]))*this._projectionScaler;this._cameraZoom=this._zoomFromMercatorZ(L),this._centerAltitude=O.toAltitude(),this._center=this.coordinateLocation(O),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const o=this._elevation;this._updateCameraState();const f=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,g=this._computeCameraPosition(f),x=o.getAtPointOrZero(new a.MercatorCoordinate(...g)),T=this._minimumHeightOverTerrain()*Math.cos(a.degToRad(this._maxPitch)),A=this._camera.position[2]-this.pixelsPerMeter/this.worldSize*x;if(A<T){const k=this.locationCoordinate(this._center,this._centerAltitude),O=[k.x-g[0],k.y-g[1],k.z-g[2]],L=a.length(O);O[2]-=(T-A)/this._projectionScaler;const F=a.length(O);if(F===0)return;a.scale$2(O,O,L/F*this._projectionScaler),this._camera.position=[k.x-O[0],k.y-O[1],k.z*this._projectionScaler-O[2]],this._camera.orientation=ef(O,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;if(this._constraining=!0,this.projection.isReprojectedInTileSpace){const $=this.center;return $.lat=a.clamp($.lat,this.minLat,this.maxLat),!this.maxBounds&&this.renderWorldCopies||($.lng=a.clamp($.lng,this.minLng,this.maxLng)),this.center=$,void(this._constraining=!1)}const o=this._unmodified,{x:f,y:g}=this.point;let x=0,T=f,A=g;const k=this.width/2,O=this.height/2,L=this.worldMinY*this.scale,F=this.worldMaxY*this.scale;if(g-O<L&&(A=L+O),g+O>F&&(A=F-O),F-L<this.height&&(x=Math.max(x,this.height/(F-L)),A=(F+L)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const $=this.worldMinX*this.scale,W=this.worldMaxX*this.scale,Q=this.worldSize/2-($+W)/2;T=(f+Q+this.worldSize)%this.worldSize-Q,T-k<$&&(T=$+k),T+k>W&&(T=W-k),W-$<this.width&&(x=Math.max(x,this.width/(W-$)),T=(W+$)/2)}T===f&&A===g||(this.center=this.unproject(new a.pointGeometry(T,A))),x&&(this.zoom+=this.scaleZoom(x)),this._constrainCameraAltitude(),this._unmodified=o,this._constraining=!1}_minZoomForBounds(){let o=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(o=Math.max(o,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),o}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const o=this._fov/2,f=this.centerOffset,g=this.pixelsPerMeter;this._projectionScaler=g/(a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize),this.cameraToCenterDistance=.5/Math.tan(o)*this.height*this._projectionScaler,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const x=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?g:1),T=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);T[8]=2*-f.x/this.width,T[9]=2*f.y/this.height;let A=a.mul([],T,x);if(this.projection.isReprojectedInTileSpace){const ae=this.locationCoordinate(this.center),le=a.identity([]);a.translate(le,le,[ae.x*this.worldSize,ae.y*this.worldSize,0]),a.multiply$1(le,le,xp(this)),a.translate(le,le,[-ae.x*this.worldSize,-ae.y*this.worldSize,0]),a.multiply$1(A,A,le),this.inverseAdjustmentMatrix=function(me){const ke=xp(me,!0);return I([],[ke[0],ke[1],ke[4],ke[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=a.scale([],A,[this.worldSize,this.worldSize,this.worldSize/g,1]),this.projMatrix=A,this.invProjMatrix=a.invert(new Float64Array(16),this.projMatrix);const k=new Float32Array(16);a.identity(k),a.scale(k,k,[1,-1,1]),a.rotateX(k,k,this._pitch),a.rotateZ(k,k,this.angle);const O=a.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),L=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;O[8]=2*-f.x/this.width,O[9]=2*(f.y+L)/this.height,this.skyboxMatrix=a.multiply$1(k,O,k);const F=this.point,$=F.x,W=F.y,Q=this.width%2/2,X=this.height%2/2,J=Math.cos(this.angle),de=Math.sin(this.angle),Y=$-Math.round($)+J*Q+de*X,ce=W-Math.round(W)+J*X+de*Q,ue=new Float64Array(A);if(a.translate(ue,ue,[Y>.5?Y-1:Y,ce>.5?ce-1:ce,0]),this.alignedProjMatrix=ue,A=a.create(),a.scale(A,A,[this.width/2,-this.height/2,1]),a.translate(A,A,[1,-1,0]),this.labelPlaneMatrix=A,A=a.create(),a.scale(A,A,[1,-1,1]),a.translate(A,A,[-1,-1,0]),a.scale(A,A,[2/this.width,2/this.height,1]),this.glCoordMatrix=A,this.pixelMatrix=a.multiply$1(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},A=a.invert(new Float64Array(16),this.pixelMatrix),!A)throw new Error("failed to invert matrix");this.pixelMatrixInverse=A,this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const o=this.cameraWorldSize,f=this.cameraPixelsPerMeter,g=this._camera.position,x=1/this.height,T=[o,o,f];a.scale$2(T,T,x),a.scale$2(g,g,-1),a.multiply$2(g,g,T);const A=a.create();a.translate(A,A,g),a.scale(A,A,T),this.mercatorFogMatrix=A,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(o,f,x)}_computeCameraPosition(o){const f=(o=o||this.pixelsPerMeter)/this.pixelsPerMeter,g=this._camera.forward(),x=this.point,T=this._mercatorZfromZoom(this._cameraZoom?this._cameraZoom:this._zoom)*f-o/this.worldSize*this._centerAltitude;return[x.x/this.worldSize-g[0]*T,x.y/this.worldSize-g[1]*T,o/this.worldSize*this._centerAltitude-g[2]*T]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(o){const f=this._maxCameraBoundsDistance()*Math.cos(this._pitch),g=o[2];let x=1;g>0&&(x=Math.min((f-this._camera.position[2])/g,1)),this._camera.position=a.scaleAndAdd([],this._camera.position,o,x),this._updateStateFromCamera()}_updateStateFromCamera(){const o=this._camera.position,f=this._camera.forward(),{pitch:g,bearing:x}=this._camera.getPitchBearing(),T=a.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._projectionScaler,A=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.degToRad(this._maxPitch)),k=Math.max((o[2]-T)/Math.cos(g),A),O=this._zoomFromMercatorZ(k);a.scaleAndAdd(o,o,f,k),this._pitch=a.clamp(g,a.degToRad(this.minPitch),a.degToRad(this.maxPitch)),this.angle=a.wrap(x,-Math.PI,Math.PI),this._setZoom(a.clamp(O,this._minZoom,this._maxZoom)),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._center=this.coordinateLocation(new a.MercatorCoordinate(o[0],o[1],o[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(o){return Math.pow(2,o)*this.tileSize}_mercatorZfromZoom(o){return this.cameraToCenterDistance/this._worldSizeFromZoom(o)}_minimumHeightOverTerrain(){const o=Math.min((this._cameraZoom!=null?this._cameraZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(o)}_zoomFromMercatorZ(o){return this.scaleZoom(this.cameraToCenterDistance/(o*this.tileSize))}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.warnOnce("Terrain is not yet supported with alternate projections. Use mercator to enable terrain."),1))}anyCornerOffEdge(o,f){const g=Math.min(o.x,f.x),x=Math.max(o.x,f.x),T=Math.min(o.y,f.y),A=Math.max(o.y,f.y);if(T<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const k=[new a.pointGeometry(g,T),new a.pointGeometry(x,A),new a.pointGeometry(g,A),new a.pointGeometry(x,T)],O=this.renderWorldCopies?-3:0,L=this.renderWorldCopies?4:1;for(const F of k){const $=this.pointRayIntersection(F);if($.t<0)return!0;const W=this.rayIntersectionCoordinate($);if(W.x<O||W.y<0||W.x>L||W.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.pointGeometry(0,0),new a.pointGeometry(this.width,this.height))}zoomDeltaToMovement(o,f){const g=a.length(a.sub([],this._camera.position,o)),x=this._zoomFromMercatorZ(g)+f;return g-this._mercatorZfromZoom(x)}getCameraPoint(){const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.pointGeometry(0,o))}}function Is(_,o){let f=!1,g=null;const x=()=>{g=null,f&&(_(),g=setTimeout(x,o),f=!1)};return()=>(f=!0,g||x(),g)}class bp{constructor(o){this._hashName=o&&encodeURIComponent(o),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Is(this._updateHashUnthrottled.bind(this),300)}addTo(o){return this._map=o,a.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return a.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(o){const f=this._map.getCenter(),g=Math.round(100*this._map.getZoom())/100,x=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),T=Math.pow(10,x),A=Math.round(f.lng*T)/T,k=Math.round(f.lat*T)/T,O=this._map.getBearing(),L=this._map.getPitch();let F="";if(F+=o?`/${A}/${k}/${g}`:`${g}/${k}/${A}`,(O||L)&&(F+="/"+Math.round(10*O)/10),L&&(F+=`/${Math.round(L)}`),this._hashName){const $=this._hashName;let W=!1;const Q=a.window.location.hash.slice(1).split("&").map(X=>{const J=X.split("=")[0];return J===$?(W=!0,`${J}=${F}`):X}).filter(X=>X);return W||Q.push(`${$}=${F}`),`#${Q.join("&")}`}return`#${F}`}_getCurrentHash(){const o=a.window.location.hash.replace("#","");if(this._hashName){let f;return o.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(f=g)}),(f&&f[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._getCurrentHash();if(o.length>=3&&!o.some(f=>isNaN(f))){const f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(o[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+o[2],+o[1]],zoom:+o[0],bearing:f,pitch:+(o[4]||0)}),!0}return!1}_updateHashUnthrottled(){const o=a.window.location.href.replace(/(#.+)?$/,this.getHashString());a.window.history.replaceState(a.window.history.state,null,o)}}const es={linearity:.3,easing:a.bezier(0,0,.3,1)},Da=a.extend({deceleration:2500,maxSpeed:1400},es),wp=a.extend({deceleration:20,maxSpeed:1400},es),of=a.extend({deceleration:1e3,maxSpeed:360},es),En=a.extend({deceleration:1e3,maxSpeed:90},es);class gu{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.exported.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,f=a.exported.now();for(;o.length>0&&f-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const f={zoom:0,bearing:0,pitch:0,pan:new a.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:T}of this._inertiaBuffer)f.zoom+=T.zoomDelta||0,f.bearing+=T.bearingDelta||0,f.pitch+=T.pitchDelta||0,T.panDelta&&f.pan._add(T.panDelta),T.around&&(f.around=T.around),T.pinchAround&&(f.pinchAround=T.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(f.pan.mag()){const T=Xl(f.pan.mag(),g,a.extend({},Da,o||{}));x.offset=f.pan.mult(T.amount/f.pan.mag()),x.center=this._map.transform.center,yu(x,T)}if(f.zoom){const T=Xl(f.zoom,g,wp);x.zoom=this._map.transform.zoom+T.amount,yu(x,T)}if(f.bearing){const T=Xl(f.bearing,g,of);x.bearing=this._map.transform.bearing+a.clamp(T.amount,-179,179),yu(x,T)}if(f.pitch){const T=Xl(f.pitch,g,En);x.pitch=this._map.transform.pitch+T.amount,yu(x,T)}if(x.zoom||x.bearing){const T=f.pinchAround===void 0?f.around:f.pinchAround;x.around=T?this._map.unproject(T):this._map.getCenter()}return this.clear(),a.extend(x,{noMoveStart:!0})}}function yu(_,o){(!_.duration||_.duration<o.duration)&&(_.duration=o.duration,_.easing=o.easing)}function Xl(_,o,f){const{maxSpeed:g,linearity:x,deceleration:T}=f,A=a.clamp(_*x/(o/1e3),-g,g),k=Math.abs(A)/(T*x);return{easing:f.easing,duration:1e3*k,amount:A*(k/2)}}class qr extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,f,g,x={}){const T=P.mousePos(f.getCanvasContainer(),g),A=f.unproject(T);super(o,a.extend({point:T,lngLat:A,originalEvent:g},x)),this._defaultPrevented=!1,this.target=f}}class vu extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,f,g){const x=o==="touchend"?g.changedTouches:g.touches,T=P.touchPos(f.getCanvasContainer(),x),A=T.map(O=>f.unproject(O)),k=T.reduce((O,L,F,$)=>O.add(L.div($.length)),new a.pointGeometry(0,0));super(o,{points:T,point:k,lngLats:A,lngLat:f.unproject(k),originalEvent:g}),this._defaultPrevented=!1}}class gg extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,f,g){super(o,{originalEvent:g}),this._defaultPrevented=!1}}class Tp{constructor(o,f){this._map=o,this._clickTolerance=f.clickTolerance}reset(){delete this._mousedownPos}wheel(o){return this._firePreventable(new gg(o.type,this._map,o))}mousedown(o,f){return this._mousedownPos=f,this._firePreventable(new qr(o.type,this._map,o))}mouseup(o){this._map.fire(new qr(o.type,this._map,o))}preclick(o){const f=a.extend({},o);f.type="preclick",this._map.fire(new qr(f.type,this._map,f))}click(o,f){this._mousedownPos&&this._mousedownPos.dist(f)>=this._clickTolerance||(this.preclick(o),this._map.fire(new qr(o.type,this._map,o)))}dblclick(o){return this._firePreventable(new qr(o.type,this._map,o))}mouseover(o){this._map.fire(new qr(o.type,this._map,o))}mouseout(o){this._map.fire(new qr(o.type,this._map,o))}touchstart(o){return this._firePreventable(new vu(o.type,this._map,o))}touchmove(o){this._map.fire(new vu(o.type,this._map,o))}touchend(o){this._map.fire(new vu(o.type,this._map,o))}touchcancel(o){this._map.fire(new vu(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class yg{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,delete this._contextMenuEvent}mousemove(o){this._map.fire(new qr(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new qr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new qr(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class sf{constructor(o,f){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=f.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,f){this.isEnabled()&&o.shiftKey&&o.button===0&&(P.disableDrag(),this._startPos=this._lastPos=f,this._active=!0)}mousemoveWindow(o,f){if(!this._active)return;const g=f;if(this._lastPos.equals(g)||!this._box&&g.dist(this._startPos)<this._clickTolerance)return;const x=this._startPos;this._lastPos=g,this._box||(this._box=P.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const T=Math.min(x.x,g.x),A=Math.max(x.x,g.x),k=Math.min(x.y,g.y),O=Math.max(x.y,g.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${T}px,${k}px)`,this._box.style.width=A-T+"px",this._box.style.height=O-k+"px")})}mouseupWindow(o,f){if(!this._active||o.button!==0)return;const g=this._startPos,x=f;if(this.reset(),P.suppressClick(),g.x!==x.x||g.y!==x.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:o})),{cameraAnimation:T=>T.fitScreenCoordinates(g,x,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",o)}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),P.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(o,f){return this._map.fire(new a.Event(o,{originalEvent:f}))}}function Ra(_,o){const f={};for(let g=0;g<_.length;g++)f[_[g].identifier]=o[g];return f}class Kl{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(o,f,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=o.timeStamp),g.length===this.numTouches&&(this.centroid=function(x){const T=new a.pointGeometry(0,0);for(const A of x)T._add(A);return T.div(x.length)}(f),this.touches=Ra(g,f)))}touchmove(o,f,g){if(this.aborted||!this.centroid)return;const x=Ra(g,f);for(const T in this.touches){const A=this.touches[T],k=x[T];(!k||k.dist(A)>30)&&(this.aborted=!0)}}touchend(o,f,g){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class Yl{constructor(o){this.singleTap=new Kl(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(o,f,g){this.singleTap.touchstart(o,f,g)}touchmove(o,f,g){this.singleTap.touchmove(o,f,g)}touchend(o,f,g){const x=this.singleTap.touchend(o,f,g);if(x){const T=o.timeStamp-this.lastTime<500,A=!this.lastTap||this.lastTap.dist(x)<30;if(T&&A||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class af{constructor(){this._zoomIn=new Yl({numTouches:1,numTaps:2}),this._zoomOut=new Yl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,f,g){this._zoomIn.touchstart(o,f,g),this._zoomOut.touchstart(o,f,g)}touchmove(o,f,g){this._zoomIn.touchmove(o,f,g),this._zoomOut.touchmove(o,f,g)}touchend(o,f,g){const x=this._zoomIn.touchend(o,f,g),T=this._zoomOut.touchend(o,f,g);return x?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:A.getZoom()+1,around:A.unproject(x)},{originalEvent:o})}):T?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:A.getZoom()-1,around:A.unproject(T)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Ep={0:1,2:2};class za{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(o,f){return!1}_move(o,f){return{}}mousedown(o,f){if(this._lastPoint)return;const g=P.mouseButton(o);this._correctButton(o,g)&&(this._lastPoint=f,this._eventButton=g)}mousemoveWindow(o,f){const g=this._lastPoint;if(g){if(o.preventDefault(),function(x,T){const A=Ep[T];return x.buttons===void 0||(x.buttons&A)!==A}(o,this._eventButton))this.reset();else if(this._moved||!(f.dist(g)<this._clickTolerance))return this._moved=!0,this._lastPoint=f,this._move(g,f)}}mouseupWindow(o){this._lastPoint&&P.mouseButton(o)===this._eventButton&&(this._moved&&P.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class xu extends za{mousedown(o,f){super.mousedown(o,f),this._lastPoint&&(this._active=!0)}_correctButton(o,f){return f===0&&!o.ctrlKey}_move(o,f){return{around:f,panDelta:f.sub(o)}}}class $i extends za{_correctButton(o,f){return f===0&&o.ctrlKey||f===2}_move(o,f){const g=.8*(f.x-o.x);if(g)return this._active=!0,{bearingDelta:g}}contextmenu(o){o.preventDefault()}}class lf extends za{_correctButton(o,f){return f===0&&o.ctrlKey||f===2}_move(o,f){const g=-.5*(f.y-o.y);if(g)return this._active=!0,{pitchDelta:g}}contextmenu(o){o.preventDefault()}}class Sp{constructor(o,f){this._map=o,this._el=o.getCanvasContainer(),this._minTouches=1,this._clickTolerance=f.clickTolerance||1,this.reset(),a.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.pointGeometry(0,0)}touchstart(o,f,g){return this._calculateTransform(o,f,g)}touchmove(o,f,g){if(this._active&&!(g.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(g.length===1)return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return o.preventDefault(),this._calculateTransform(o,f,g)}}touchend(o,f,g){this._calculateTransform(o,f,g),this._active&&g.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,f,g){g.length>0&&(this._active=!0);const x=Ra(g,f),T=new a.pointGeometry(0,0),A=new a.pointGeometry(0,0);let k=0;for(const L in x){const F=x[L],$=this._touches[L];$&&(T._add(F),A._add(F.sub($)),k++,x[L]=F)}if(this._touches=x,k<this._minTouches||!A.mag())return;const O=A.div(k);return this._sum._add(O),this._sum.mag()<this._clickTolerance?void 0:{around:T.div(k),panDelta:O}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=P.create("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show")},500)}}class bu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(o){}_move(o,f,g){return{}}touchstart(o,f,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([f[0],f[1]]))}touchmove(o,f,g){if(!this._firstTwoTouches)return;o.preventDefault();const[x,T]=this._firstTwoTouches,A=ts(g,f,x),k=ts(g,f,T);if(!A||!k)return;const O=this._aroundCenter?null:A.add(k).div(2);return this._move([A,k],O,o)}touchend(o,f,g){if(!this._firstTwoTouches)return;const[x,T]=this._firstTwoTouches,A=ts(g,f,x),k=ts(g,f,T);A&&k||(this._active&&P.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ts(_,o,f){for(let g=0;g<_.length;g++)if(_[g].identifier===f)return o[g]}function cf(_,o){return Math.log(_/o)/Math.LN2}class wu extends bu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,f){const g=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(cf(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:cf(this._distance,g),pinchAround:f}}}function Tu(_,o){return 180*_.angleWith(o)/Math.PI}class Eu extends bu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,f){const g=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Tu(this._vector,g),pinchAround:f}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const f=25/(Math.PI*this._minDiameter)*360,g=Tu(o,this._startVector);return Math.abs(g)<f}}function Su(_){return Math.abs(_.y)>Math.abs(_.x)}class Ap extends bu{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}_start(o){this._lastPoints=o,Su(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,f,g){const x=o[0].sub(this._lastPoints[0]),T=o[1].sub(this._lastPoints[1]);if(!(this._map._cooperativeGestures&&g.touches.length<3)&&(this._valid=this.gestureBeginsVertically(x,T,g.timeStamp),this._valid))return this._lastPoints=o,this._active=!0,{pitchDelta:(x.y+T.y)/2*-.5}}gestureBeginsVertically(o,f,g){if(this._valid!==void 0)return this._valid;const x=o.mag()>=2,T=f.mag()>=2;if(!x&&!T)return;if(!x||!T)return this._firstMove===void 0&&(this._firstMove=g),g-this._firstMove<100&&void 0;const A=o.y>0==f.y>0;return Su(o)&&Su(f)&&A}}const Oa={panStep:100,bearingStep:15,pitchStep:10};class vg{constructor(){const o=Oa;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let f=0,g=0,x=0,T=0,A=0;switch(o.keyCode){case 61:case 107:case 171:case 187:f=1;break;case 189:case 109:case 173:f=-1;break;case 37:o.shiftKey?g=-1:(o.preventDefault(),T=-1);break;case 39:o.shiftKey?g=1:(o.preventDefault(),T=1);break;case 38:o.shiftKey?x=1:(o.preventDefault(),A=-1);break;case 40:o.shiftKey?x=-1:(o.preventDefault(),A=1);break;default:return}return this._rotationDisabled&&(g=0,x=0),{cameraAnimation:k=>{const O=k.getZoom();k.easeTo({duration:300,easeId:"keyboardHandler",easing:xg,zoom:f?Math.round(O)+f*(o.shiftKey?2:1):O,bearing:k.getBearing()+g*this._bearingStep,pitch:k.getPitch()+x*this._pitchStep,offset:[-T*this._panStep,-A*this._panStep],center:k.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function xg(_){return _*(2-_)}const uf=4.000244140625;class Au{constructor(o,f){this._map=o,this._el=o.getCanvasContainer(),this._handler=f,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert","_isFullscreen"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(o.ctrlKey||o.metaKey||this.isZooming()||this._isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let f=o.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const g=a.exported.now(),x=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,f!==0&&f%uf==0?this._type="wheel":f!==0&&Math.abs(f)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=f,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(x*f)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,f+=this._lastValue)),o.shiftKey&&f&&(f/=4),this._type&&(this._lastWheelEvent=o,this._delta-=f,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const f=P.mousePos(this._el,o);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:f,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform,f=()=>o._terrainEnabled()&&this._aroundCoord?o.computeZoomRelativeTo(this._aroundCoord):o.zoom;if(this._delta!==0){const O=this._type==="wheel"&&Math.abs(this._delta)>uf?this._wheelZoomRate:this._defaultZoomRate;let L=2/(1+Math.exp(-Math.abs(this._delta*O)));this._delta<0&&L!==0&&(L=1/L);const F=f(),$=Math.pow(2,F),W=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):$;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(W*L))),this._type==="wheel"&&(this._startZoom=f(),this._easing=this._smoothOutEasing(200)),this._delta=0}const g=typeof this._targetZoom=="number"?this._targetZoom:f(),x=this._startZoom,T=this._easing;let A,k=!1;if(this._type==="wheel"&&x&&T){const O=Math.min((a.exported.now()-this._lastWheelEventTime)/200,1),L=T(O);A=a.number(x,g,L),O<1?this._frameId||(this._frameId=!0):k=!0}else A=g,k=!0;return this._active=!0,k&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!k,zoomDelta:A-f(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let f=a.ease;if(this._prevEase){const g=this._prevEase,x=(a.exported.now()-g.start)/g.duration,T=g.easing(x+.01)-g.easing(x),A=.27/Math.sqrt(T*T+1e-4)*.01,k=Math.sqrt(.0729-A*A);f=a.bezier(A,k,.25,1)}return this._prevEase={start:a.exported.now(),duration:o,easing:f},f}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=P.create("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(a.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_isFullscreen(){return!!a.window.document.fullscreenElement}_showBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show")},200)}}class hf{constructor(o,f){this._clickZoom=o,this._tapZoom=f}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Cp{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(o,f){return o.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:g.getZoom()+(o.shiftKey?-1:1),around:g.unproject(f)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ip{constructor(){this._tap=new Yl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(o,f,g){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?g.length>0&&(this._swipePoint=f[0],this._swipeTouch=g[0].identifier):this._tap.touchstart(o,f,g))}touchmove(o,f,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const x=f[0],T=x.y-this._swipePoint.y;return this._swipePoint=x,o.preventDefault(),this._active=!0,{zoomDelta:T/128}}}else this._tap.touchmove(o,f,g)}touchend(o,f,g){this._tapTime?this._swipePoint&&g.length===0&&this.reset():this._tap.touchend(o,f,g)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Cu{constructor(o,f,g){this._el=o,this._mousePan=f,this._touchPan=g}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ff{constructor(o,f,g){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=f,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Mp{constructor(o,f,g,x){this._el=o,this._touchZoom=f,this._touchRotate=g,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Ql=_=>_.zoom||_.drag||_.pitch||_.rotate;class kp extends a.Event{}class Pp{constructor(){this.constants=[1,1,.01],this.radius=0}setup(o,f){const g=a.sub([],f,o);this.radius=a.length(g[2]<0?a.div([],g,this.constants):[g[0],g[1],0])}projectRay(o){a.div(o,o,this.constants),a.normalize(o,o),a.mul$1(o,o,this.constants);const f=a.scale$2([],o,this.radius);if(f[2]>0){const g=a.scale$2([],[0,0,1],a.dot(f,[0,0,1])),x=a.scale$2([],a.normalize([],[f[0],f[1],0]),this.radius),T=a.add([],f,a.scale$2([],a.sub([],a.add([],x,g),f),2));f[0]=T[0],f[1]=T[1]}return f}}function Jl(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta}class La{constructor(o,f){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new gu(o),this._bearingSnap=f.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Pp,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(f),a.bindAll(["handleEvent","handleWindowEvent"],this);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[a.window,"blur",void 0]];for(const[x,T,A]of this._listeners)x.addEventListener(T,x===a.window.document?this.handleWindowEvent:this.handleEvent,A)}destroy(){for(const[o,f,g]of this._listeners)o.removeEventListener(f,o===a.window.document?this.handleWindowEvent:this.handleEvent,g)}_addDefaultHandlers(o){const f=this._map,g=f.getCanvasContainer();this._add("mapEvent",new Tp(f,o));const x=f.boxZoom=new sf(f,o);this._add("boxZoom",x);const T=new af,A=new Cp;f.doubleClickZoom=new hf(A,T),this._add("tapZoom",T),this._add("clickZoom",A);const k=new Ip;this._add("tapDragZoom",k);const O=f.touchPitch=new Ap(f);this._add("touchPitch",O);const L=new $i(o),F=new lf(o);f.dragRotate=new ff(o,L,F),this._add("mouseRotate",L,["mousePitch"]),this._add("mousePitch",F,["mouseRotate"]);const $=new xu(o),W=new Sp(f,o);f.dragPan=new Cu(g,$,W),this._add("mousePan",$),this._add("touchPan",W,["touchZoom","touchRotate"]);const Q=new Eu,X=new wu;f.touchZoomRotate=new Mp(g,X,Q,k),this._add("touchRotate",Q,["touchPan","touchZoom"]),this._add("touchZoom",X,["touchPan","touchRotate"]),this._add("blockableMapEvent",new yg(f));const J=f.scrollZoom=new Au(f,this);this._add("scrollZoom",J,["mousePan"]);const de=f.keyboard=new vg;this._add("keyboard",de);for(const Y of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[Y]&&f[Y].enable(o[Y])}_add(o,f,g){this._handlers.push({handlerName:o,handler:f,allowed:g}),this._handlersById[o]=f}stop(o){if(!this._updatingCamera){for(const{handler:f}of this._handlers)f.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(Ql(this._eventsInProgress))||this.isZooming()}_blockedByActive(o,f,g){for(const x in o)if(x!==g&&(!f||f.indexOf(x)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const f=[];for(const g of o)this._el.contains(g.target)&&f.push(g);return f}handleEvent(o,f){this._updatingCamera=!0;const g=o.type==="renderFrame",x=g?void 0:o,T={needsRenderFrame:!1},A={},k={},O=o.touches?this._getMapTouches(o.touches):void 0,L=O?P.touchPos(this._el,O):g?void 0:P.mousePos(this._el,o);for(const{handlerName:W,handler:Q,allowed:X}of this._handlers){if(!Q.isEnabled())continue;let J;this._blockedByActive(k,X,W)?Q.reset():Q[f||o.type]&&(J=Q[f||o.type](o,L,O),this.mergeHandlerResult(T,A,J,W,x),J&&J.needsRenderFrame&&this._triggerRenderFrame()),(J||Q.isActive())&&(k[W]=Q)}const F={};for(const W in this._previousActiveHandlers)k[W]||(F[W]=x);this._previousActiveHandlers=k,(Object.keys(F).length||Jl(T))&&(this._changes.push([T,A,F]),this._triggerRenderFrame()),(Object.keys(k).length||Jl(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:$}=T;$&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],$(this._map))}mergeHandlerResult(o,f,g,x,T){if(!g)return;a.extend(o,g);const A={handlerName:x,originalEvent:g.originalEvent||T};g.zoomDelta!==void 0&&(f.zoom=A),g.panDelta!==void 0&&(f.drag=A),g.pitchDelta!==void 0&&(f.pitch=A),g.bearingDelta!==void 0&&(f.rotate=A)}_applyChanges(){const o={},f={},g={};for(const[x,T,A]of this._changes)x.panDelta&&(o.panDelta=(o.panDelta||new a.pointGeometry(0,0))._add(x.panDelta)),x.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+x.pitchDelta),x.around!==void 0&&(o.around=x.around),x.aroundCoord!==void 0&&(o.aroundCoord=x.aroundCoord),x.pinchAround!==void 0&&(o.pinchAround=x.pinchAround),x.noInertia&&(o.noInertia=x.noInertia),a.extend(f,T),a.extend(g,A);this._updateMapTransform(o,f,g),this._changes=[]}_updateMapTransform(o,f,g){const x=this._map,T=x.transform,A=ce=>[ce.x,ce.y,ce.z];if((ce=>{const ue=this._eventsInProgress.drag;return ue&&!this._handlersById[ue.handlerName].isActive()})()&&!Jl(o)){const ce=T.zoom;T.cameraElevationReference="sea",T.recenterOnTerrain(),T.cameraElevationReference="ground",ce!==T.zoom&&this._map._update(!0)}if(!Jl(o))return this._fireEvents(f,g,!0);let{panDelta:k,zoomDelta:O,bearingDelta:L,pitchDelta:F,around:$,aroundCoord:W,pinchAround:Q}=o;Q!==void 0&&($=Q),(ce=>f.drag&&!this._eventsInProgress.drag)()&&$&&(this._dragOrigin=A(T.pointCoordinate3D($)),this._trackingEllipsoid.setup(T._camera.position,this._dragOrigin)),T.cameraElevationReference="sea",x._stop(!0),$=$||x.transform.centerPoint,L&&(T.bearing+=L),F&&(T.pitch+=F),T._updateCameraState();const X=[0,0,0];if(k){const ce=T.pointCoordinate($),ue=T.pointCoordinate($.sub(k));ce&&ue&&(X[0]=ue.x-ce.x,X[1]=ue.y-ce.y)}const J=T.zoom,de=[0,0,0];if(O){const ce=A(W||T.pointCoordinate3D($)),ue={dir:a.normalize([],a.sub([],ce,T._camera.position))};if(ue.dir[2]<0){const ae=T.zoomDeltaToMovement(ce,O);a.scale$2(de,ue.dir,ae)}}const Y=a.add(X,X,de);T._translateCameraConstrained(Y),O&&Math.abs(T.zoom-J)>1e-4&&T.recenterOnTerrain(),T.cameraElevationReference="ground",this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(f,g,!0)}_fireEvents(o,f,g){const x=Ql(this._eventsInProgress),T=Ql(o),A={};for(const F in o){const{originalEvent:$}=o[F];this._eventsInProgress[F]||(A[`${F}start`]=$),this._eventsInProgress[F]=o[F]}!x&&T&&this._fireEvent("movestart",T.originalEvent);for(const F in A)this._fireEvent(F,A[F]);T&&this._fireEvent("move",T.originalEvent);for(const F in o){const{originalEvent:$}=o[F];this._fireEvent(F,$)}const k={};let O;for(const F in this._eventsInProgress){const{handlerName:$,originalEvent:W}=this._eventsInProgress[F];this._handlersById[$].isActive()||(delete this._eventsInProgress[F],O=f[$]||W,k[`${F}end`]=O)}for(const F in k)this._fireEvent(F,k[F]);const L=Ql(this._eventsInProgress);if(g&&(x||T)&&!L){this._updatingCamera=!0;const F=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),$=W=>W!==0&&-this._bearingSnap<W&&W<this._bearingSnap;F?($(F.bearing||this._map.getBearing())&&(F.bearing=0),this._map.easeTo(F,{originalEvent:O})):(this._map.fire(new a.Event("moveend",{originalEvent:O})),$(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,f){this._map.fire(new a.Event(o,f?{originalEvent:f}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{delete this._frameId,this.handleEvent(new kp("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const df="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Dp extends a.Evented{constructor(o,f){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=f.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}getCenter(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(o,f){return this.jumpTo({center:o},f)}panBy(o,f,g){return o=a.pointGeometry.convert(o).mult(-1),this.panTo(this.transform.center,a.extend({offset:o},f),g)}panTo(o,f,g){return this.easeTo(a.extend({center:o},f),g)}getZoom(){return this.transform.zoom}setZoom(o,f){return this.jumpTo({zoom:o},f),this}zoomTo(o,f,g){return this.easeTo(a.extend({zoom:o},f),g)}zoomIn(o,f){return this.zoomTo(this.getZoom()+1,o,f),this}zoomOut(o,f){return this.zoomTo(this.getZoom()-1,o,f),this}getBearing(){return this.transform.bearing}setBearing(o,f){return this.jumpTo({bearing:o},f),this}getPadding(){return this.transform.padding}setPadding(o,f){return this.jumpTo({padding:o},f),this}rotateTo(o,f,g){return this.easeTo(a.extend({bearing:o},f),g)}resetNorth(o,f){return this.rotateTo(0,a.extend({duration:1e3},o),f),this}resetNorthPitch(o,f){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},o),f),this}snapToNorth(o,f){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,f):this}getPitch(){return this.transform.pitch}setPitch(o,f){return this.jumpTo({pitch:o},f),this}cameraForBounds(o,f){o=a.LngLatBounds.convert(o);const g=f&&f.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),g,f)}_extendCameraOptions(o){const f={top:0,bottom:0,right:0,left:0};if(typeof(o=a.extend({padding:f,offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding=="number"){const g=o.padding;o.padding={top:g,bottom:g,right:g,left:g}}return o.padding=a.extend(f,o.padding),o}_cameraForBoxAndBearing(o,f,g,x){const T=this._extendCameraOptions(x),A=this.transform,k=A.padding,O=A.project(a.LngLat.convert(o)),L=A.project(a.LngLat.convert(f)),F=O.rotate(-a.degToRad(g)),$=L.rotate(-a.degToRad(g)),W=new a.pointGeometry(Math.max(F.x,$.x),Math.max(F.y,$.y)),Q=new a.pointGeometry(Math.min(F.x,$.x),Math.min(F.y,$.y)),X=W.sub(Q),J=(A.width-(k.left+k.right+T.padding.left+T.padding.right))/X.x,de=(A.height-(k.top+k.bottom+T.padding.top+T.padding.bottom))/X.y;if(de<0||J<0)return void a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Y=Math.min(A.scaleZoom(A.scale*Math.min(J,de)),T.maxZoom),ce=typeof T.offset.x=="number"?new a.pointGeometry(T.offset.x,T.offset.y):a.pointGeometry.convert(T.offset),ue=new a.pointGeometry((T.padding.left-T.padding.right)/2,(T.padding.top-T.padding.bottom)/2).rotate(g*Math.PI/180),ae=ce.add(ue).mult(A.scale/A.zoomScale(Y));return{center:A.unproject(O.add(L).div(2).sub(ae)),zoom:Y,bearing:g}}_cameraForBox(o,f,g,x,T){const A=this._extendCameraOptions(T);g=g||0,x=x||0,o=a.LngLat.convert(o),f=a.LngLat.convert(f);const k=this.transform.clone();k.padding=A.padding;const O=this.getFreeCameraOptions(),L=new a.LngLat(.5*(o.lng+f.lng),.5*(o.lat+f.lat)),F=.5*(g+x);if(k._camera.position[2]<a.mercatorZfromAltitude(F,L.lat))return void a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");O.lookAtPoint(L),k.setFreeCameraOptions(O);const $=a.MercatorCoordinate.fromLngLat(o),W=a.MercatorCoordinate.fromLngLat(f),Q=k.pointRayIntersection(k.centerPoint,F),X=[(J=k.rayIntersectionCoordinate(Q)).x,J.y,J.z];var J;const de=k.screenPointToMercatorRay(k.centerPoint),Y=k.projection.name!=="globe";let ce,ue=0;do{const ae=Math.floor(k.zoom),le=1<<ae,me=Math.min(le*$.x,le*W.x),ke=Math.min(le*$.y,le*W.y),Le=Math.max(le*$.x,le*W.x),ht=Math.max(le*$.y,le*W.y),nt=new a.Aabb([me,ke,g],[Le,ht,x]),et=a.Frustum.fromInvProjectionMatrix(k.invProjMatrix,k.worldSize,ae,Y);if(nt.intersects(et)!==2){ce&&(k._camera.position=a.scaleAndAdd([],k._camera.position,de.dir,-ce),k._updateStateFromCamera());break}const je=a.sub([],k._camera.position,X);ce=.5*a.length(je),k._camera.position=a.scaleAndAdd([],k._camera.position,de.dir,ce);try{k._updateStateFromCamera()}catch{return void a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++ue<10);return{center:k.center,zoom:k.zoom,bearing:k.bearing,pitch:k.pitch}}fitBounds(o,f,g){return this._fitInternal(this.cameraForBounds(o,f),f,g)}_raycastElevationBox(o,f){const g=this.transform.elevation;if(!g)return;const x=new a.pointGeometry(o.x,f.y),T=new a.pointGeometry(f.x,o.y),A=g.pointCoordinate(o);if(!A)return;const k=g.pointCoordinate(f);if(!k)return;const O=g.pointCoordinate(x);if(!O)return;const L=g.pointCoordinate(T);if(!L)return;const F=new a.MercatorCoordinate(A[0],A[1]).toLngLat(),$=new a.MercatorCoordinate(k[0],k[1]).toLngLat(),W=new a.MercatorCoordinate(O[0],O[1]).toLngLat(),Q=new a.MercatorCoordinate(L[0],L[1]).toLngLat(),X=Math.min(F.lng,Math.min($.lng,Math.min(W.lng,Q.lng))),J=Math.min(F.lat,Math.min($.lat,Math.min(W.lat,Q.lat))),de=Math.max(F.lng,Math.max($.lng,Math.max(W.lng,Q.lng))),Y=Math.max(F.lat,Math.max($.lat,Math.max(W.lat,Q.lat))),ce=Math.min(A[3],Math.min(k[3],Math.min(O[3],L[3]))),ue=Math.max(A[3],Math.max(k[3],Math.max(O[3],L[3])));return{minLngLat:new a.LngLat(X,J),maxLngLat:new a.LngLat(de,Y),minAltitude:ce,maxAltitude:ue}}fitScreenCoordinates(o,f,g,x,T){let A,k,O,L;const F=a.pointGeometry.convert(o),$=a.pointGeometry.convert(f),W=this._raycastElevationBox(F,$);if(W)A=W.minLngLat,k=W.maxLngLat,O=W.minAltitude,L=W.maxAltitude;else{if(this.transform.anyCornerOffEdge(F,$))return this;A=this.transform.pointLocation(F),k=this.transform.pointLocation($)}return this._fitInternal(this.transform.pitch===0?this._cameraForBoxAndBearing(this.transform.pointLocation(a.pointGeometry.convert(o)),this.transform.pointLocation(a.pointGeometry.convert(f)),g,x):this._cameraForBox(A,k,O,L,x),x,T)}_fitInternal(o,f,g){return o?(delete(f=a.extend(o,f)).padding,f.linear?this.easeTo(f,g):this.flyTo(f,g)):this}jumpTo(o,f){this.stop();const g=o.preloadOnly?this.transform.clone():this.transform;let x=!1,T=!1,A=!1;return"zoom"in o&&g.zoom!==+o.zoom&&(x=!0,g.zoom=+o.zoom),o.center!==void 0&&(g.center=a.LngLat.convert(o.center)),"bearing"in o&&g.bearing!==+o.bearing&&(T=!0,g.bearing=+o.bearing),"pitch"in o&&g.pitch!==+o.pitch&&(A=!0,g.pitch=+o.pitch),o.padding==null||g.isPaddingEqual(o.padding)||(g.padding=o.padding),o.preloadOnly?(this._preloadTiles(g),this):(this.fire(new a.Event("movestart",f)).fire(new a.Event("move",f)),x&&this.fire(new a.Event("zoomstart",f)).fire(new a.Event("zoom",f)).fire(new a.Event("zoomend",f)),T&&this.fire(new a.Event("rotatestart",f)).fire(new a.Event("rotate",f)).fire(new a.Event("rotateend",f)),A&&this.fire(new a.Event("pitchstart",f)).fire(new a.Event("pitch",f)).fire(new a.Event("pitchend",f)),this.fire(new a.Event("moveend",f)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.warnOnce(df),this.transform.getFreeCameraOptions()}setFreeCameraOptions(o,f){const g=this.transform;if(!g.projection.supportsFreeCamera)return void a.warnOnce(df);this.stop();const x=g.zoom,T=g.pitch,A=g.bearing;g.setFreeCameraOptions(o);const k=x!==g.zoom,O=T!==g.pitch,L=A!==g.bearing;return this.fire(new a.Event("movestart",f)).fire(new a.Event("move",f)),k&&this.fire(new a.Event("zoomstart",f)).fire(new a.Event("zoom",f)).fire(new a.Event("zoomend",f)),L&&this.fire(new a.Event("rotatestart",f)).fire(new a.Event("rotate",f)).fire(new a.Event("rotateend",f)),O&&this.fire(new a.Event("pitchstart",f)).fire(new a.Event("pitch",f)).fire(new a.Event("pitchend",f)),this.fire(new a.Event("moveend",f)),this}easeTo(o,f){this._stop(!1,o.easeId),((o=a.extend({offset:[0,0],duration:500,easing:a.ease},o)).animate===!1||!o.essential&&a.exported.prefersReducedMotion)&&(o.duration=0);const g=this.transform,x=this.getZoom(),T=this.getBearing(),A=this.getPitch(),k=this.getPadding(),O="zoom"in o?+o.zoom:x,L="bearing"in o?this._normalizeBearing(o.bearing,T):T,F="pitch"in o?+o.pitch:A,$="padding"in o?o.padding:g.padding,W=a.pointGeometry.convert(o.offset);let Q=g.centerPoint.add(W);const X=g.projection.name==="globe"?g.pointCoordinate(Q).toLngLat():g.pointLocation(Q),J=a.LngLat.convert(o.center||X);this._normalizeCenter(J);const de=g.project(X),Y=g.project(J).sub(de),ce=g.zoomScale(O-x);let ue,ae;o.around&&(ue=a.LngLat.convert(o.around),ae=g.locationPoint(ue));const le=this._zooming||O!==x,me=this._rotating||T!==L,ke=this._pitching||F!==A,Le=!g.isPaddingEqual($),ht=et=>je=>{if(le&&(et.zoom=a.number(x,O,je)),me&&(et.bearing=a.number(T,L,je)),ke&&(et.pitch=a.number(A,F,je)),Le&&(et.interpolatePadding(k,$,je),Q=et.centerPoint.add(W)),ue)et.setLocationAtPoint(ue,ae);else{const Re=et.zoomScale(et.zoom-x),Qe=O>x?Math.min(2,ce):Math.max(.5,ce),We=Math.pow(Qe,1-je),zt=et.unproject(de.add(Y.mult(je*We)).mult(Re));et.setLocationAtPoint(et.renderWorldCopies?zt.wrap():zt,Q)}return o.preloadOnly||this._fireMoveEvents(f),et};if(o.preloadOnly){const et=this._emulate(ht,o.duration,g);return this._preloadTiles(et),this}const nt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=le,this._rotating=me,this._pitching=ke,this._padding=Le,this._easeId=o.easeId,this._prepareEase(f,o.noMoveStart,nt),this._ease(ht(g),et=>{g.recenterOnTerrain(),this._afterEase(f,et)},o),this}_prepareEase(o,f,g={}){this._moving=!0,this.transform.cameraElevationReference="sea",f||g.moving||this.fire(new a.Event("movestart",o)),this._zooming&&!g.zooming&&this.fire(new a.Event("zoomstart",o)),this._rotating&&!g.rotating&&this.fire(new a.Event("rotatestart",o)),this._pitching&&!g.pitching&&this.fire(new a.Event("pitchstart",o))}_fireMoveEvents(o){this.fire(new a.Event("move",o)),this._zooming&&this.fire(new a.Event("zoom",o)),this._rotating&&this.fire(new a.Event("rotate",o)),this._pitching&&this.fire(new a.Event("pitch",o))}_afterEase(o,f){if(this._easeId&&f&&this._easeId===f)return;delete this._easeId,this.transform.cameraElevationReference="ground";const g=this._zooming,x=this._rotating,T=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new a.Event("zoomend",o)),x&&this.fire(new a.Event("rotateend",o)),T&&this.fire(new a.Event("pitchend",o)),this.fire(new a.Event("moveend",o))}flyTo(o,f){if(!o.essential&&a.exported.prefersReducedMotion){const ut=a.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ut,f)}this.stop(),o=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},o);const g=this.transform,x=this.getZoom(),T=this.getBearing(),A=this.getPitch(),k=this.getPadding(),O="zoom"in o?a.clamp(+o.zoom,g.minZoom,g.maxZoom):x,L="bearing"in o?this._normalizeBearing(o.bearing,T):T,F="pitch"in o?+o.pitch:A,$="padding"in o?o.padding:g.padding,W=g.zoomScale(O-x),Q=a.pointGeometry.convert(o.offset);let X=g.centerPoint.add(Q);const J=g.pointLocation(X),de=a.LngLat.convert(o.center||J);this._normalizeCenter(de);const Y=g.project(J),ce=g.project(de).sub(Y);let ue=o.curve;const ae=Math.max(g.width,g.height),le=ae/W,me=ce.mag();if("minZoom"in o){const ut=a.clamp(Math.min(o.minZoom,x,O),g.minZoom,g.maxZoom),Ft=ae/g.zoomScale(ut-x);ue=Math.sqrt(Ft/me*2)}const ke=ue*ue;function Le(ut){const Ft=(le*le-ae*ae+(ut?-1:1)*ke*ke*me*me)/(2*(ut?le:ae)*ke*me);return Math.log(Math.sqrt(Ft*Ft+1)-Ft)}function ht(ut){return(Math.exp(ut)-Math.exp(-ut))/2}function nt(ut){return(Math.exp(ut)+Math.exp(-ut))/2}const et=Le(0);let je=function(ut){return nt(et)/nt(et+ue*ut)},Re=function(ut){return ae*((nt(et)*(ht(Ft=et+ue*ut)/nt(Ft))-ht(et))/ke)/me;var Ft},Qe=(Le(1)-et)/ue;if(Math.abs(me)<1e-6||!isFinite(Qe)){if(Math.abs(ae-le)<1e-6)return this.easeTo(o,f);const ut=le<ae?-1:1;Qe=Math.abs(Math.log(le/ae))/ue,Re=function(){return 0},je=function(Ft){return Math.exp(ut*ue*Ft)}}o.duration="duration"in o?+o.duration:1e3*Qe/("screenSpeed"in o?+o.screenSpeed/ue:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0);const We=T!==L,zt=F!==A,jt=!g.isPaddingEqual($),Jt=ut=>Ft=>{const Zt=Ft*Qe,Pn=1/je(Zt);ut.zoom=Ft===1?O:x+ut.scaleZoom(Pn),We&&(ut.bearing=a.number(T,L,Ft)),zt&&(ut.pitch=a.number(A,F,Ft)),jt&&(ut.interpolatePadding(k,$,Ft),X=ut.centerPoint.add(Q));const jn=Ft===1?de:ut.unproject(Y.add(ce.mult(Re(Zt))).mult(Pn));return ut.setLocationAtPoint(ut.renderWorldCopies?jn.wrap():jn,X),ut._updateCenterElevation(),o.preloadOnly||this._fireMoveEvents(f),ut};if(o.preloadOnly){const ut=this._emulate(Jt,o.duration,g);return this._preloadTiles(ut),this}return this._zooming=!0,this._rotating=We,this._pitching=zt,this._padding=jt,this._prepareEase(f,!1),this._ease(Jt(g),()=>this._afterEase(f),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,f){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const g=this._onEaseEnd;delete this._onEaseEnd,g.call(this,f)}if(!o){const g=this.handlers;g&&g.stop(!1)}return this}_ease(o,f,g){g.animate===!1||g.duration===0?(o(1),f()):(this._easeStart=a.exported.now(),this._easeOptions=g,this._onEaseFrame=o,this._onEaseEnd=f,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((a.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,f){o=a.wrap(o,-180,180);const g=Math.abs(o-f);return Math.abs(o-360-f)<g&&(o-=360),Math.abs(o+360-f)<g&&(o+=360),o}_normalizeCenter(o){const f=this.transform;if(!f.renderWorldCopies||f.maxBounds)return;const g=o.lng-f.center.lng;o.lng+=g>180?-360:g<-180?360:0}_emulate(o,f,g){const x=Math.ceil(15*f/1e3),T=[],A=o(g.clone());for(let k=0;k<=x;k++){const O=A(k/x);T.push(O.clone())}return T}}class pf{constructor(o={}){this.options=o,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){const f=this.options&&this.options.compact;return this._map=o,this._container=P.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=P.create("button","mapboxgl-ctrl-attrib-button",this._container),P.create("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden",!0),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=P.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),f&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),f===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(o,f){const g=this._map._getUIString(`AttributionControl.${f}`);o.setAttribute("aria-label",g),o.removeAttribute("title"),o.firstElementChild&&o.firstElementChild.setAttribute("title",g)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let o=this._editLink;o||(o=this._editLink=this._container.querySelector(".mapbox-improve-map"));const f=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(o){const g=f.reduce((x,T,A)=>(T.value&&(x+=`${T.key}=${T.value}${A<f.length-1?"&":""}`),x),"?");o.href=`${a.config.FEEDBACK_URL}/${g}${this._map._hash?this._map._hash.getHashString(!0):""}`,o.rel="noopener nofollow",this._setElementTitle(o,"MapFeedback")}}_updateData(o){!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let o=[];if(this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const f=this._map.style._sourceCaches;for(const x in f){const T=f[x];if(T.used){const A=T.getSource();A.attribution&&o.indexOf(A.attribution)<0&&o.push(A.attribution)}}o.sort((x,T)=>x.length-T.length),o=o.filter((x,T)=>{for(let A=T+1;A<o.length;A++)if(o[A].indexOf(x)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=[...this.options.customAttribution,...o]:o.unshift(this.options.customAttribution));const g=o.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,o.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class mf{constructor(){a.bindAll(["_updateLogo"],this),a.bindAll(["_updateCompact"],this)}onAdd(o){this._map=o,this._container=P.create("div","mapboxgl-ctrl");const f=P.create("a","mapboxgl-ctrl-logo");return f.target="_blank",f.rel="noopener nofollow",f.href="https://www.mapbox.com/",f.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),f.setAttribute("rel","noopener nofollow"),this._container.appendChild(f),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(o){o&&o.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const o=this._map.style._sourceCaches;if(Object.entries(o).length===0)return!0;for(const f in o){const g=o[f].getSource();if(g.hasOwnProperty("mapbox_logo")&&!g.mapbox_logo)return!1}return!0}_updateCompact(){const o=this._container.children;if(o.length){const f=o[0];this._map.getCanvasContainer().offsetWidth<250?f.classList.add("mapboxgl-compact"):f.classList.remove("mapboxgl-compact")}}}class _f{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const f=++this._id;return this._queue.push({callback:o,id:f,cancelled:!1}),f}remove(o){const f=this._currentlyRunning,g=f?this._queue.concat(f):this._queue;for(const x of g)if(x.id===o)return void(x.cancelled=!0)}run(o=0){const f=this._currentlyRunning=this._queue;this._queue=[];for(const g of f)if(!g.cancelled&&(g.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function gf(_,o,f){if(_=new a.LngLat(_.lng,_.lat),o){const g=new a.LngLat(_.lng-360,_.lat),x=new a.LngLat(_.lng+360,_.lat),T=360*Math.ceil(Math.abs(_.lng-f.center.lng)/360),A=f.locationPoint(_).distSqr(o),k=o.x<0||o.y<0||o.x>f.width||o.y>f.height;f.locationPoint(g).distSqr(o)<A&&(k||Math.abs(g.lng-f.center.lng)<T)?_=g:f.locationPoint(x).distSqr(o)<A&&(k||Math.abs(x.lng-f.center.lng)<T)&&(_=x)}for(;Math.abs(_.lng-f.center.lng)>180;){const g=f.locationPoint(_);if(g.x>=0&&g.y>=0&&g.x<=f.width&&g.y<=f.height)break;_.lng>f.center.lng?_.lng-=360:_.lng+=360}return _}const Or={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class yf extends a.Evented{constructor(o,f){if(super(),(o instanceof a.window.HTMLElement||f)&&(o=a.extend({element:o},f)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,this._updateMoving=()=>this._update(!0),o&&o.element)this._element=o.element,this._offset=a.pointGeometry.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=P.create("div");const x=41,T=27,A=P.createSVG("svg",{display:"block",height:x*this._scale+"px",width:T*this._scale+"px",viewBox:`0 0 ${T} ${x}`},this._element),k=P.createSVG("radialGradient",{id:"shadowGradient"},P.createSVG("defs",{},A));P.createSVG("stop",{offset:"10%","stop-opacity":.4},k),P.createSVG("stop",{offset:"100%","stop-opacity":.05},k),P.createSVG("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},A),P.createSVG("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},A),P.createSVG("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},A),P.createSVG("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},A),this._offset=a.pointGeometry.convert(o&&o.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",x=>{x.preventDefault()}),this._element.addEventListener("mousedown",x=>{x.preventDefault()});const g=this._element.classList;for(const x in Or)g.remove(`mapboxgl-marker-anchor-${x}`);g.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(o){return o===this._map||(this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._updateMoving),o.on("moveend",this._update),o.on("remove",this._clearFadeTimer),o._addMarker(this),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick)),this}remove(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._updateMoving),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._map.off("remove",this._clearFadeTimer),this._map._removeMarker(this),delete this._map),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const x=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(38.1-13.5+x)],"bottom-right":[-x,-1*(38.1-13.5+x)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(o){const f=o.code,g=o.charCode||o.keyCode;f!=="Space"&&f!=="Enter"&&g!==32&&g!==13||this.togglePopup()}_onMapClick(o){const f=o.originalEvent.target,g=this._element;this._popup&&(f===g||g.contains(f))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?(o.remove(),this._element.setAttribute("aria-expanded","false")):(o.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_evaluateOpacity(){const o=this._pos?this._pos.sub(this._transformedOffset()):null;if(!this._withinScreenBounds(o))return void this._clearFadeTimer();const f=this._map.unproject(o);let g=!1;if(this._map.transform._terrainEnabled()&&this._map.getTerrain()){const T=this._map.getFreeCameraOptions();if(T.position){const A=T.position.toLngLat();g=A.distanceTo(f)<.9*A.distanceTo(this._lngLat)}}const x=(1-this._map._queryFogOpacity(f))*(g?.2:1);this._element.style.opacity=`${x}`,this._popup&&this._popup._setOpacity(`${x}`),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_withinScreenBounds(o){const f=this._map.transform;return!!o&&o.x>=0&&o.x<f.width&&o.y>=0&&o.y<f.height}_updateDOM(){const o=this._pos||new a.pointGeometry(0,0),f=this._calculatePitch(),g=this._calculateRotation();this._element.style.transform=`${Or[this._anchor]} translate(${o.x}px, ${o.y}px) rotateX(${f}deg) rotateZ(${g}deg)`}_calculatePitch(){return this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?0:this._pitchAlignment==="map"?this._map.getPitch():0}_calculateRotation(){return this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?this._rotation:this._rotationAlignment==="map"?this._rotation-this._map.getBearing():0}_update(o){a.window.cancelAnimationFrame(this._updateFrameId),this._map&&(this._map.transform.renderWorldCopies&&(this._lngLat=gf(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._transformedOffset()),o===!0?this._updateFrameId=a.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),this._map._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),!this._map.getTerrain()&&!this._map.getFog()||this._fadeTimer||(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}_transformedOffset(){if(!this._defaultMarker)return this._offset;const o=this._map.transform,f=this._offset.mult(this._scale);return this._rotationAlignment==="map"&&f._rotate(o.angle),this._pitchAlignment==="map"&&(f.y*=Math.cos(o._pitch)),f}getOffset(){return this._offset}setOffset(o){return this._offset=a.pointGeometry.convert(o),this._update(),this}_onMove(o){if(!this._isDragging){const f=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=f}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"}_addDragHandler(o){this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._transformedOffset()),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}class ns{constructor(o){this.jumpTo(o)}getValue(o){if(o<=this._startTime)return this._start;if(o>=this._endTime)return this._end;const f=a.easeCubicInOut((o-this._startTime)/(this._endTime-this._startTime));return this._start*(1-f)+this._end*f}isEasing(o){return o>=this._startTime&&o<=this._endTime}jumpTo(o){this._startTime=-1/0,this._endTime=-1/0,this._start=o,this._end=o}easeTo(o,f,g){this._start=this.getValue(f),this._end=o,this._startTime=f,this._endTime=f+g}}const Rp={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},{HTMLImageElement:co,HTMLElement:Fa,ImageBitmap:Ba}=a.window,bg={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function vf(_){_.parentNode&&_.parentNode.removeChild(_)}const wg={showCompass:!0,showZoom:!0,visualizePitch:!1};class zp{constructor(o,f,g=!1){this._clickTolerance=10,this.element=f,this.mouseRotate=new $i({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,g&&(this.mousePitch=new lf({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),f.addEventListener("mousedown",this.mousedown),f.addEventListener("touchstart",this.touchstart,{passive:!1}),f.addEventListener("touchmove",this.touchmove),f.addEventListener("touchend",this.touchend),f.addEventListener("touchcancel",this.reset)}down(o,f){this.mouseRotate.mousedown(o,f),this.mousePitch&&this.mousePitch.mousedown(o,f),P.disableDrag()}move(o,f){const g=this.map,x=this.mouseRotate.mousemoveWindow(o,f);if(x&&x.bearingDelta&&g.setBearing(g.getBearing()+x.bearingDelta),this.mousePitch){const T=this.mousePitch.mousemoveWindow(o,f);T&&T.pitchDelta&&g.setPitch(g.getPitch()+T.pitchDelta)}}off(){const o=this.element;o.removeEventListener("mousedown",this.mousedown),o.removeEventListener("touchstart",this.touchstart,{passive:!1}),o.removeEventListener("touchmove",this.touchmove),o.removeEventListener("touchend",this.touchend),o.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){P.enableDrag(),a.window.removeEventListener("mousemove",this.mousemove),a.window.removeEventListener("mouseup",this.mouseup)}mousedown(o){this.down(a.extend({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),P.mousePos(this.element,o)),a.window.addEventListener("mousemove",this.mousemove),a.window.addEventListener("mouseup",this.mouseup)}mousemove(o){this.move(o,P.mousePos(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=P.touchPos(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){o.targetTouches.length!==1?this.reset():(this._lastPos=P.touchPos(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const ec={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1};let li,tc=0,Ua=!1;const nc={maxWidth:100,unit:"metric"};function Ct(_,o,f){const g=f&&f.maxWidth||100,x=_._containerHeight/2,T=_.unproject([0,x]),A=_.unproject([g,x]),k=T.distanceTo(A);if(f&&f.unit==="imperial"){const O=3.2808*k;O>5280?Na(o,g,O/5280,_._getUIString("ScaleControl.Miles"),_):Na(o,g,O,_._getUIString("ScaleControl.Feet"),_)}else f&&f.unit==="nautical"?Na(o,g,k/1852,_._getUIString("ScaleControl.NauticalMiles"),_):k>=1e3?Na(o,g,k/1e3,_._getUIString("ScaleControl.Kilometers"),_):Na(o,g,k,_._getUIString("ScaleControl.Meters"),_)}function Na(_,o,f,g,x){const T=function(k){const O=Math.pow(10,`${Math.floor(k)}`.length-1);let L=k/O;return L=L>=10?10:L>=5?5:L>=3?3:L>=2?2:L>=1?1:function(F){const $=Math.pow(10,Math.ceil(-Math.log(F)/Math.LN10));return Math.round(F*$)/$}(L),O*L}(f),A=T/f;x._requestDomTask(()=>{_.style.width=o*A+"px",_.innerHTML=`${T}&nbsp;${g}`})}const Op={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},rc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Ms={version:a.version,supported:v,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:class extends Dp{constructor(_){if((_=a.extend({},bg,_)).minZoom!=null&&_.maxZoom!=null&&_.minZoom>_.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(_.minPitch!=null&&_.maxPitch!=null&&_.minPitch>_.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(_.minPitch!=null&&_.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(_.maxPitch!=null&&_.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Hl(_.minZoom,_.maxZoom,_.minPitch,_.maxPitch,_.renderWorldCopies),_),this._interactive=_.interactive,this._minTileCacheSize=_.minTileCacheSize,this._maxTileCacheSize=_.maxTileCacheSize,this._failIfMajorPerformanceCaveat=_.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=_.preserveDrawingBuffer,this._antialias=_.antialias,this._trackResize=_.trackResize,this._bearingSnap=_.bearingSnap,this._refreshExpiredTiles=_.refreshExpiredTiles,this._fadeDuration=_.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=_.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=_.collectResourceTiming,this._optimizeForTerrain=_.optimizeForTerrain,this._renderTaskQueue=new _f,this._domRenderTaskQueue=new _f,this._controls=[],this._markers=[],this._mapId=a.uniqueId(),this._locale=a.extend({},Rp,_.locale),this._clickTolerance=_.clickTolerance,this._cooperativeGestures=_.cooperativeGestures,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevation=new ns(0),this._requestManager=new a.RequestManager(_.transformRequest,_.accessToken,_.testMode),this._silenceAuthErrors=!!_.testMode,typeof _.container=="string"){if(this._container=a.window.document.getElementById(_.container),!this._container)throw new Error(`Container '${_.container}' not found.`)}else{if(!(_.container instanceof Fa))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=_.container}if(this._container.childNodes.length>0&&a.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),_.maxBounds&&this.setMaxBounds(_.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1),a.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new La(this,_),this._localFontFamily=_.localFontFamily,this._localIdeographFontFamily=_.localIdeographFontFamily,_.style&&this.setStyle(_.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),_.projection&&this.setProjection(_.projection),this._hash=_.hash&&new bp(typeof _.hash=="string"&&_.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch}),_.bounds&&(this.resize(),this.fitBounds(_.bounds,a.extend({},_.fitBoundsOptions,{duration:0})))),this.resize(),_.attributionControl&&this.addControl(new pf({customAttribution:_.customAttribution})),this._logoControl=new mf,this.addControl(this._logoControl,_.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",o=>{this._update(o.dataType==="style"),this.fire(new a.Event(`${o.dataType}data`,o))}),this.on("dataloading",o=>{this.fire(new a.Event(`${o.dataType}dataloading`,o))})}_getMapId(){return this._mapId}addControl(_,o){if(o===void 0&&(o=_.getDefaultPosition?_.getDefaultPosition():"top-right"),!_||!_.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const f=_.onAdd(this);this._controls.push(_);const g=this._controlPositions[o];return o.indexOf("bottom")!==-1?g.insertBefore(f,g.firstChild):g.appendChild(f),this}removeControl(_){if(!_||!_.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(_);return o>-1&&this._controls.splice(o,1),_.onRemove(this),this}hasControl(_){return this._controls.indexOf(_)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(_){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const o=!this._moving;return o&&this.fire(new a.Event("movestart",_)).fire(new a.Event("move",_)),this.fire(new a.Event("resize",_)),o&&this.fire(new a.Event("moveend",_)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(_){return this.transform.setMaxBounds(a.LngLatBounds.convert(_)),this._update()}setMinZoom(_){if((_=_==null?-2:_)>=-2&&_<=this.transform.maxZoom)return this.transform.minZoom=_,this._update(),this.getZoom()<_?this.setZoom(_):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(_){if((_=_==null?22:_)>=this.transform.minZoom)return this.transform.maxZoom=_,this._update(),this.getZoom()>_?this.setZoom(_):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(_){if((_=_==null?0:_)<0)throw new Error("minPitch must be greater than or equal to 0");if(_>=0&&_<=this.transform.maxPitch)return this.transform.minPitch=_,this._update(),this.getPitch()<_?this.setPitch(_):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(_){if((_=_==null?85:_)>85)throw new Error("maxPitch must be less than or equal to 85");if(_>=this.transform.minPitch)return this.transform.maxPitch=_,this._update(),this.getPitch()>_?this.setPitch(_):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(_){return this.transform.renderWorldCopies=_,this._update()}getProjection(){return this.transform.getProjection()}setProjection(_){return this._lazyInitEmptyStyle(),typeof _=="string"&&(_={name:_}),this._runtimeProjection=_,this.style.updateProjection(),this._transitionFromGlobe=!1,this}project(_){return this.transform.locationPoint3D(a.LngLat.convert(_))}unproject(_){return this.transform.pointLocation3D(a.pointGeometry.convert(_))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()}_createDelegatedListener(_,o,f){if(_==="mouseenter"||_==="mouseover"){let g=!1;const x=A=>{const k=o.filter(L=>this.getLayer(L)),O=k.length?this.queryRenderedFeatures(A.point,{layers:k}):[];O.length?g||(g=!0,f.call(this,new qr(_,this,A.originalEvent,{features:O}))):g=!1},T=()=>{g=!1};return{layers:new Set(o),listener:f,delegates:{mousemove:x,mouseout:T}}}if(_==="mouseleave"||_==="mouseout"){let g=!1;const x=A=>{const k=o.filter(O=>this.getLayer(O));(k.length?this.queryRenderedFeatures(A.point,{layers:k}):[]).length?g=!0:g&&(g=!1,f.call(this,new qr(_,this,A.originalEvent)))},T=A=>{g&&(g=!1,f.call(this,new qr(_,this,A.originalEvent)))};return{layers:new Set(o),listener:f,delegates:{mousemove:x,mouseout:T}}}{const g=x=>{const T=o.filter(k=>this.getLayer(k)),A=T.length?this.queryRenderedFeatures(x.point,{layers:T}):[];A.length&&(x.features=A,f.call(this,x),delete x.features)};return{layers:new Set(o),listener:f,delegates:{[_]:g}}}}on(_,o,f){if(f===void 0)return super.on(_,o);Array.isArray(o)||(o=[o]);const g=this._createDelegatedListener(_,o,f);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[_]=this._delegatedListeners[_]||[],this._delegatedListeners[_].push(g);for(const x in g.delegates)this.on(x,g.delegates[x]);return this}once(_,o,f){if(f===void 0)return super.once(_,o);Array.isArray(o)||(o=[o]);const g=this._createDelegatedListener(_,o,f);for(const x in g.delegates)this.once(x,g.delegates[x]);return this}off(_,o,f){if(f===void 0)return super.off(_,o);o=new Set(Array.isArray(o)?o:[o]);const g=(T,A)=>{if(T.size!==A.size)return!1;for(const k of T)if(!A.has(k))return!1;return!0},x=this._delegatedListeners?this._delegatedListeners[_]:void 0;return x&&(T=>{for(let A=0;A<T.length;A++){const k=T[A];if(k.listener===f&&g(k.layers,o)){for(const O in k.delegates)this.off(O,k.delegates[O]);return T.splice(A,1),this}}})(x),this}queryRenderedFeatures(_,o){return this.style?(o!==void 0||_===void 0||_ instanceof a.pointGeometry||Array.isArray(_)||(o=_,_=void 0),this.style.queryRenderedFeatures(_=_||[[0,0],[this.transform.width,this.transform.height]],o=o||{},this.transform)):[]}querySourceFeatures(_,o){return this.style.querySourceFeatures(_,o)}queryTerrainElevation(_,o){const f=this.transform.elevation;return f?(o=a.extend({},{exaggerated:!0},o),f.getAtPoint(a.MercatorCoordinate.fromLngLat(_),null,o.exaggerated)):null}setStyle(_,o){return(o=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&o.localFontFamily===this._localFontFamily&&this.style&&_?(this._diffStyle(_,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._localFontFamily=o.localFontFamily,this._updateStyle(_,o))}_getUIString(_){const o=this._locale[_];if(o==null)throw new Error(`Missing UI string '${_}'`);return o}_updateStyle(_,o){return this.style&&(this.style.setEventedParent(null),this.style._remove(),delete this.style),_&&(this.style=new yi(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof _=="string"?this.style.loadURL(_):this.style.loadJSON(_)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new yi(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(_,o){if(typeof _=="string"){const f=this._requestManager.normalizeStyleURL(_),g=this._requestManager.transformRequest(f,a.ResourceType.Style);a.getJSON(g,(x,T)=>{x?this.fire(new a.ErrorEvent(x)):T&&this._updateDiff(T,o)})}else typeof _=="object"&&this._updateDiff(_,o)}_updateDiff(_,o){try{this.style.setState(_)&&this._update(!0)}catch(f){a.warnOnce(`Unable to perform style diff: ${f.message||f.error||f}.  Rebuilding the style from scratch.`),this._updateStyle(_,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")}addSource(_,o){return this._lazyInitEmptyStyle(),this.style.addSource(_,o),this._update(!0)}isSourceLoaded(_){const o=this.style&&this.style._getSourceCaches(_);if(o.length!==0)return o.every(f=>f.loaded());this.fire(new a.ErrorEvent(new Error(`There is no source with ID '${_}'`)))}areTilesLoaded(){const _=this.style&&this.style._sourceCaches;for(const o in _){const f=_[o]._tiles;for(const g in f){const x=f[g];if(x.state!=="loaded"&&x.state!=="errored")return!1}}return!0}addSourceType(_,o,f){return this._lazyInitEmptyStyle(),this.style.addSourceType(_,o,f)}removeSource(_){return this.style.removeSource(_),this._updateTerrain(),this._update(!0)}getSource(_){return this.style.getSource(_)}addImage(_,o,{pixelRatio:f=1,sdf:g=!1,stretchX:x,stretchY:T,content:A}={}){if(this._lazyInitEmptyStyle(),o instanceof co||Ba&&o instanceof Ba){const{width:k,height:O,data:L}=a.exported.getImageData(o);this.style.addImage(_,{data:new a.RGBAImage({width:k,height:O},L),pixelRatio:f,stretchX:x,stretchY:T,content:A,sdf:g,version:0})}else{if(o.width===void 0||o.height===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:k,height:O,data:L}=o,F=o;this.style.addImage(_,{data:new a.RGBAImage({width:k,height:O},new Uint8Array(L)),pixelRatio:f,stretchX:x,stretchY:T,content:A,sdf:g,version:0,userImage:F}),F.onAdd&&F.onAdd(this,_)}}}updateImage(_,o){const f=this.style.getImage(_);if(!f)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const g=o instanceof co||Ba&&o instanceof Ba?a.exported.getImageData(o):o,{width:x,height:T,data:A}=g;return x===void 0||T===void 0?this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):x!==f.data.width||T!==f.data.height?this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(f.data.replace(A,!(o instanceof co||Ba&&o instanceof Ba)),void this.style.updateImage(_,f))}hasImage(_){return _?!!this.style.getImage(_):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(_){this.style.removeImage(_)}loadImage(_,o){a.getImage(this._requestManager.transformRequest(_,a.ResourceType.Image),(f,g)=>{o(f,g instanceof co?a.exported.getImageData(g):g)})}listImages(){return this.style.listImages()}addLayer(_,o){return this._lazyInitEmptyStyle(),this.style.addLayer(_,o),this._update(!0)}moveLayer(_,o){return this.style.moveLayer(_,o),this._update(!0)}removeLayer(_){return this.style.removeLayer(_),this._update(!0)}getLayer(_){return this.style.getLayer(_)}setLayerZoomRange(_,o,f){return this.style.setLayerZoomRange(_,o,f),this._update(!0)}setFilter(_,o,f={}){return this.style.setFilter(_,o,f),this._update(!0)}getFilter(_){return this.style.getFilter(_)}setPaintProperty(_,o,f,g={}){return this.style.setPaintProperty(_,o,f,g),this._update(!0)}getPaintProperty(_,o){return this.style.getPaintProperty(_,o)}setLayoutProperty(_,o,f,g={}){return this.style.setLayoutProperty(_,o,f,g),this._update(!0)}getLayoutProperty(_,o){return this.style.getLayoutProperty(_,o)}setLight(_,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(_,o),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(_){return this._lazyInitEmptyStyle(),!_&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(_),this._averageElevationLastSampledAt=-1/0,this._update(!0)}_updateProjection(){this.transform.projection.name==="globe"&&this.transform.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX&&!this._transitionFromGlobe&&(this.setProjection({name:"mercator"}),this._transitionFromGlobe=!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(_){return this._lazyInitEmptyStyle(),this.style.setFog(_),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(_){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.LngLat.convert(_),this.transform):0}setFeatureState(_,o){return this.style.setFeatureState(_,o),this._update()}removeFeatureState(_,o){return this.style.removeFeatureState(_,o),this._update()}getFeatureState(_){return this.style.getFeatureState(_)}_updateContainerDimensions(){if(!this._container)return;const _=this._container.getBoundingClientRect().width||400,o=this._container.getBoundingClientRect().height||300;let f,g=this._container;for(;g&&!f;){const x=a.window.getComputedStyle(g).transform;x&&x!=="none"&&(f=x.match(/matrix.*\((.+)\)/)[1].split(", ")),g=g.parentElement}f?(this._containerWidth=f[0]&&f[0]!=="0"?Math.abs(_/f[0]):_,this._containerHeight=f[3]&&f[3]!=="0"?Math.abs(o/f[3]):o):(this._containerWidth=_,this._containerHeight=o)}_detectMissingCSS(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const _=this._container;_.classList.add("mapboxgl-map"),(this._missingCSSCanary=P.create("div","mapboxgl-canary",_)).style.visibility="hidden",this._detectMissingCSS();const o=this._canvasContainer=P.create("div","mapboxgl-canvas-container",_);this._interactive&&o.classList.add("mapboxgl-interactive"),this._canvas=P.create("canvas","mapboxgl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const f=this._controlContainer=P.create("div","mapboxgl-control-container",_),g=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{g[x]=P.create("div",`mapboxgl-ctrl-${x}`,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(_,o){const f=a.exported.devicePixelRatio||1;this._canvas.width=f*Math.ceil(_),this._canvas.height=f*Math.ceil(o),this._canvas.style.width=`${_}px`,this._canvas.style.height=`${o}px`}_addMarker(_){this._markers.push(_)}_removeMarker(_){const o=this._markers.indexOf(_);o!==-1&&this._markers.splice(o,1)}_setupPainter(){const _=a.extend({},v.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._canvas.getContext("webgl",_)||this._canvas.getContext("experimental-webgl",_);o?(a.storeAuthState(o,!0),this.painter=new gp(o,this.transform),this.on("data",f=>{f.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),a.exported$1.testSupport(o)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(_){_.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:_}))}_contextRestored(_){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:_}))}_onMapScroll(_){if(_.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(_){return this.style?(this._styleDirty=this._styleDirty||_,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(_){return this._update(),this._renderTaskQueue.add(_)}_cancelRenderFrame(_){this._renderTaskQueue.remove(_)}_requestDomTask(_){!this.loaded()||this.loaded()&&!this.isMoving()?_():this._domRenderTaskQueue.add(_)}_render(_){let o;const f=this.painter.context.extTimerQuery,g=a.exported.now();this.listens("gpu-timing-frame")&&(o=f.createQueryEXT(),f.beginQueryEXT(f.TIME_ELAPSED_EXT,o));let x=this._updateAverageElevation(g);if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(_),this._domRenderTaskQueue.run(_),this._removed)return;this._updateProjection();let T=!1;const A=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const O=this.transform.zoom,L=this.transform.pitch,F=a.exported.now();this.style.zoomHistory.update(O,F);const $=new a.EvaluationParameters(O,{now:F,fadeDuration:A,pitch:L,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),W=$.crossFadingFactor();W===1&&W===this._crossFadingFactor||(T=!0,this._crossFadingFactor=W),this.style.update($)}if(this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0),this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),this.style._updateSources(this.transform),this._forceMarkerUpdate()),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,A,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:A,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||T)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const O=a.exported.now()-g;f.endQueryEXT(f.TIME_ELAPSED_EXT,o),setTimeout(()=>{const L=f.getQueryObjectEXT(o,f.QUERY_RESULT_EXT)/1e6;f.deleteQueryEXT(o),this.fire(new a.Event("gpu-timing-frame",{cpuTime:O,gpuTime:L}))},50)}if(this.listens("gpu-timing-layer")){const O=this.painter.collectGpuTimers();setTimeout(()=>{const L=this.painter.queryGpuTimers(O);this.fire(new a.Event("gpu-timing-layer",{layerTimes:L}))},50)}const k=this._sourcesDirty||this._styleDirty||this._placementDirty||x;if(k||this._repaint)this.triggerRepaint();else{const O=!this.isMoving()&&this.loaded();if(O&&(x=this._updateAverageElevation(g,!0)),x)this.triggerRepaint();else if(this._triggerFrame(!1),O&&(this.fire(new a.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const L=this._calculateSpeedIndex();this.fire(new a.Event("speedindexcompleted",{speedIndex:L})),this.speedIndexTiming=!1}}return!this._loaded||this._fullyLoaded||k||(this._fullyLoaded=!0,this._authenticate()),this}_forceMarkerUpdate(){for(const _ of this._markers)_._update()}_updateAverageElevation(_,o=!1){const f=g=>(this.transform.averageElevation=g,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&f(0);if((o||_-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(_)){const g=this.transform.averageElevation;let x=this.transform.sampleAverageElevation();isNaN(x)?x=0:this._averageElevationLastSampledAt=_;const T=Math.abs(g-x);if(T>1){if(this._isInitialLoad)return this._averageElevation.jumpTo(x),f(x);this._averageElevation.easeTo(x,_,300)}else if(T>1e-4)return this._averageElevation.jumpTo(x),f(x)}return!!this._averageElevation.isEasing(_)&&f(this._averageElevation.getValue(_))}_authenticate(){a.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,_=>{if(_&&(_.message===a.AUTH_ERR_MSG||_.status===401)){const o=this.painter.context.gl;a.storeAuthState(o,!1),this._logoControl instanceof mf&&this._logoControl._updateLogo(),o&&o.clear(o.DEPTH_BUFFER_BIT|o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),a.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const _=this.painter.canvasCopy(),o=this.painter.getCanvasCopiesAndTimestamps();o.timeStamps.push(performance.now());const f=this.painter.context.gl,g=f.createFramebuffer();function x(T){f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,T,0);const A=new Uint8Array(f.drawingBufferWidth*f.drawingBufferHeight*4);return f.readPixels(0,0,f.drawingBufferWidth,f.drawingBufferHeight,f.RGBA,f.UNSIGNED_BYTE,A),A}return f.bindFramebuffer(f.FRAMEBUFFER,g),this._canvasPixelComparison(x(_),o.canvasCopies.map(x),o.timeStamps)}_canvasPixelComparison(_,o,f){let g=f[1]-f[0];const x=_.length/4;for(let T=0;T<o.length;T++){const A=o[T];let k=0;for(let O=0;O<A.length;O+=4)A[O]===_[O]&&A[O+1]===_[O+1]&&A[O+2]===_[O+2]&&A[O+3]===_[O+3]&&(k+=1);g+=(f[T+2]-f[T+1])*(1-k/x)}return g}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1));const _=this.painter.context.gl.getExtension("WEBGL_lose_context");_&&_.loseContext(),vf(this._canvasContainer),vf(this._controlContainer),vf(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),a.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new a.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(_){this._renderNextFrame=this._renderNextFrame||_,this.style&&!this._frame&&(this._frame=a.exported.frame(o=>{const f=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,f&&this._render(o)}))}_preloadTiles(_){const o=this.style&&Object.values(this.style._sourceCaches)||[];return a.asyncAll(o,(f,g)=>f._preloadTiles(_,g),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(_){this._trackResize&&this.resize({originalEvent:_})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(_){this._showTileBoundaries!==_&&(this._showTileBoundaries=_,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(_){this._showTerrainWireframe!==_&&(this._showTerrainWireframe=_,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(_){this._speedIndexTiming!==_&&(this._speedIndexTiming=_,this._update())}get showPadding(){return!!this._showPadding}set showPadding(_){this._showPadding!==_&&(this._showPadding=_,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(_){this._showCollisionBoxes!==_&&(this._showCollisionBoxes=_,_?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(_){this._showOverdrawInspector!==_&&(this._showOverdrawInspector=_,this._update())}get repaint(){return!!this._repaint}set repaint(_){this._repaint!==_&&(this._repaint=_,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(_){this._vertices=_,this._update()}_setCacheLimits(_,o){a.setCacheLimits(_,o)}get version(){return a.version}},NavigationControl:class{constructor(_){this.options=a.extend({},wg,_),this._container=P.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",o=>this._map.zoomIn({},{originalEvent:o})),P.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",o=>this._map.zoomOut({},{originalEvent:o})),P.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",o=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:o}):this._map.resetNorth({},{originalEvent:o})}),this._compassIcon=P.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))}_updateZoomButtons(){const _=this._map.getZoom(),o=_===this._map.getMaxZoom(),f=_===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())}_rotateCompassArrow(){const _=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._map._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=_)})}onAdd(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new zp(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){this._container.remove(),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(_,o){const f=P.create("button",_,this._container);return f.type="button",f.addEventListener("click",o),f}_setButtonTitle(_,o){const f=this._map._getUIString(`NavigationControl.${o}`);_.setAttribute("aria-label",f),_.firstElementChild&&_.firstElementChild.setAttribute("title",f)}},GeolocateControl:class extends a.Evented{constructor(_){super(),this.options=a.extend({},ec,_),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation"],this),this._onDeviceOrientationListener=this._onDeviceOrientation.bind(this),this._updateMarkerRotationThrottled=Is(this._updateMarkerRotation,20)}onAdd(_){var o;return this._map=_,this._container=P.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),o=this._setupUI,li!==void 0?o(li):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then(f=>{li=f.state!=="denied",o(li)}):(li=!!a.window.navigator.geolocation,o(li)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,tc=0,Ua=!1}_isOutOfMapMaxBounds(_){const o=this._map.getMaxBounds(),f=_.coords;return o&&(f.longitude<o.getWest()||f.longitude>o.getEast()||f.latitude<o.getSouth()||f.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(_){if(this._map){if(this._isOutOfMapMaxBounds(_))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",_)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=_,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(_),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(_),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",_)),this._finish()}}_updateCamera(_){const o=new a.LngLat(_.coords.longitude,_.coords.latitude),f=_.coords.accuracy,g=this._map.getBearing(),x=a.extend({bearing:g},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(f),x,{geolocateSource:!0})}_updateMarker(_){if(_){const o=new a.LngLat(_.coords.longitude,_.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=_.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const _=this._map._containerHeight/2,o=this._map.unproject([0,_]),f=this._map.unproject([100,_]),g=o.distanceTo(f)/100,x=Math.ceil(2*this._accuracy/g);this._circleElement.style.width=`${x}px`,this._circleElement.style.height=`${x}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(_){if(this._map){if(this.options.trackUserLocation)if(_.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(_.code===3&&Ua)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",_)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(_){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=P.create("button","mapboxgl-ctrl-geolocate",this._container),P.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",_===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=P.create("div","mapboxgl-user-location"),this._dotElement.appendChild(P.create("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(P.create("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new yf({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=P.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new yf({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.Event("trackuserlocationend")))})}_onDeviceOrientation(_){this._userLocationDotMarker&&(_.webkitCompassHeading?this._heading=_.webkitCompassHeading:_.absolute===!0&&(this._heading=-1*_.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":tc--,Ua=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let _;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),tc++,tc>1?(_={maximumAge:6e5,timeout:0},Ua=!0):(_=this.options.positionOptions,Ua=!1),this._geolocationWatchID=a.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,_),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else a.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const _=()=>{a.window.addEventListener("ondeviceorientationabsolute"in a.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientationListener)};a.window.DeviceMotionEvent!==void 0&&typeof a.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(o=>{o==="granted"&&_()}).catch(console.error):_()}_clearWatch(){a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),a.window.removeEventListener("deviceorientation",this._onDeviceOrientationListener),a.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientationListener),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:pf,ScaleControl:class{constructor(_){this.options=a.extend({},nc,_),a.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Ct(this._map,this._container,this.options)}onAdd(_){return this._map=_,this._container=P.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",_.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._onMove),this._map=void 0}setUnit(_){this.options.unit=_,Ct(this._map,this._container,this.options)}},FullscreenControl:class{constructor(_){this._fullscreen=!1,_&&_.container&&(_.container instanceof a.window.HTMLElement?this._container=_.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in a.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=P.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!a.window.document.fullscreenEnabled&&!a.window.document.webkitFullscreenEnabled)}_setupUI(){const _=this._fullscreenButton=P.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);P.create("span","mapboxgl-ctrl-icon",_).setAttribute("aria-hidden",!0),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",_)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(a.window.document.fullscreenElement||a.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.Evented{constructor(_){super(),this.options=a.extend(Object.create(Op),_),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this),this._classList=new Set(_&&_.className?_.className.trim().split(/\s+/):[])}addTo(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&this._map.on("preclick",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&this._content.remove(),this._container&&(this._container.remove(),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(_){return this._lngLat=a.LngLat.convert(_),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(_){return this.setDOMContent(a.window.document.createTextNode(_))}setHTML(_){const o=a.window.document.createDocumentFragment(),f=a.window.document.createElement("body");let g;for(f.innerHTML=_;g=f.firstChild,g;)o.appendChild(g);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(_){return this.options.maxWidth=_,this._update(),this}setDOMContent(_){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=P.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(_),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(_){return this._classList.add(_),this._container&&this._updateClassList(),this}removeClassName(_){return this._classList.delete(_),this._container&&this._updateClassList(),this}setOffset(_){return this.options.offset=_,this._update(),this}toggleClassName(_){let o;return this._classList.delete(_)?o=!1:(this._classList.add(_),o=!0),this._container&&this._updateClassList(),o}_createCloseButton(){this.options.closeButton&&(this._closeButton=P.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.setAttribute("aria-hidden","true"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(_){this._update(_.point)}_onMouseMove(_){this._update(_.point)}_onDrag(_){this._update(_.point)}_getAnchor(_){if(this.options.anchor)return this.options.anchor;const o=this._pos,f=this._container.offsetWidth,g=this._container.offsetHeight;let x;return x=o.y+_.bottom.y<g?["top"]:o.y>this._map.transform.height-g?["bottom"]:[],o.x<f/2?x.push("left"):o.x>this._map.transform.width-f/2&&x.push("right"),x.length===0?"bottom":x.join("-")}_updateClassList(){const _=[...this._classList];_.push("mapboxgl-popup"),this._anchor&&_.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&_.push("mapboxgl-popup-track-pointer"),this._container.className=_.join(" ")}_update(_){if(this._map&&(this._lngLat||this._trackPointer)&&this._content){if(this._container||(this._container=P.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=P.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content)),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=gf(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||_){const o=this._pos=this._trackPointer&&_?_:this._map.project(this._lngLat),f=function(T){if(T||(T=new a.pointGeometry(0,0)),typeof T=="number"){const A=Math.round(Math.sqrt(.5*Math.pow(T,2)));return{center:new a.pointGeometry(0,0),top:new a.pointGeometry(0,T),"top-left":new a.pointGeometry(A,A),"top-right":new a.pointGeometry(-A,A),bottom:new a.pointGeometry(0,-T),"bottom-left":new a.pointGeometry(A,-A),"bottom-right":new a.pointGeometry(-A,-A),left:new a.pointGeometry(T,0),right:new a.pointGeometry(-T,0)}}if(T instanceof a.pointGeometry||Array.isArray(T)){const A=a.pointGeometry.convert(T);return{center:A,top:A,"top-left":A,"top-right":A,bottom:A,"bottom-left":A,"bottom-right":A,left:A,right:A}}return{center:a.pointGeometry.convert(T.center||[0,0]),top:a.pointGeometry.convert(T.top||[0,0]),"top-left":a.pointGeometry.convert(T["top-left"]||[0,0]),"top-right":a.pointGeometry.convert(T["top-right"]||[0,0]),bottom:a.pointGeometry.convert(T.bottom||[0,0]),"bottom-left":a.pointGeometry.convert(T["bottom-left"]||[0,0]),"bottom-right":a.pointGeometry.convert(T["bottom-right"]||[0,0]),left:a.pointGeometry.convert(T.left||[0,0]),right:a.pointGeometry.convert(T.right||[0,0])}}(this.options.offset),g=this._anchor=this._getAnchor(f),x=o.add(f[g]).round();this._map._requestDomTask(()=>{this._container&&g&&(this._container.style.transform=`${Or[g]} translate(${x.x}px,${x.y}px)`)})}this._updateClassList()}}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const _=this._container.querySelector(rc);_&&_.focus()}_onClose(){this.remove()}_setOpacity(_){this._content&&(this._content.style.opacity=_),this._tip&&(this._tip.style.opacity=_)}},Marker:yf,Style:yi,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.pointGeometry,MercatorCoordinate:a.MercatorCoordinate,FreeCameraOptions:vp,Evented:a.Evented,config:a.config,prewarm:function(){ve().acquire(ge)},clearPrewarmedResources:function(){const _=Ie;_&&(_.isPreloaded()&&_.numActive()===1?(_.release(ge),Ie=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(_){a.config.ACCESS_TOKEN=_},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(_){a.config.API_URL=_},get workerCount(){return Ce.workerCount},set workerCount(_){Ce.workerCount=_},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(_){a.config.MAX_PARALLEL_IMAGE_REQUESTS=_},clearStorage(_){a.clearTileCache(_)},workerUrl:"",workerClass:null,setNow:a.exported.setNow,restoreNow:a.exported.restoreNow};return Ms});var m=c;return m})})(YC);var lj=YC.exports;const bU="1.30.0",JC={"X-Client-Info":`supabase-js/${bU}`},wU="supabase.auth.token";function TU(e){return e.replace(/\/$/,"")}const EU=()=>typeof window!="undefined";var Cv={exports:{}};(function(e,n){var r=typeof self!="undefined"?self:KC,s=function(){function h(){this.fetch=!1,this.DOMException=r.DOMException}return h.prototype=r,new h}();(function(h){(function(m){var a={searchParams:"URLSearchParams"in h,iterable:"Symbol"in h&&"iterator"in Symbol,blob:"FileReader"in h&&"Blob"in h&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in h,arrayBuffer:"ArrayBuffer"in h};function v(be){return be&&DataView.prototype.isPrototypeOf(be)}if(a.arrayBuffer)var w=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],E=ArrayBuffer.isView||function(be){return be&&w.indexOf(Object.prototype.toString.call(be))>-1};function I(be){if(typeof be!="string"&&(be=String(be)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(be))throw new TypeError("Invalid character in header field name");return be.toLowerCase()}function M(be){return typeof be!="string"&&(be=String(be)),be}function P(be){var qe={next:function(){var Ke=be.shift();return{done:Ke===void 0,value:Ke}}};return a.iterable&&(qe[Symbol.iterator]=function(){return qe}),qe}function j(be){this.map={},be instanceof j?be.forEach(function(qe,Ke){this.append(Ke,qe)},this):Array.isArray(be)?be.forEach(function(qe){this.append(qe[0],qe[1])},this):be&&Object.getOwnPropertyNames(be).forEach(function(qe){this.append(qe,be[qe])},this)}j.prototype.append=function(be,qe){be=I(be),qe=M(qe);var Ke=this.map[be];this.map[be]=Ke?Ke+", "+qe:qe},j.prototype.delete=function(be){delete this.map[I(be)]},j.prototype.get=function(be){return be=I(be),this.has(be)?this.map[be]:null},j.prototype.has=function(be){return this.map.hasOwnProperty(I(be))},j.prototype.set=function(be,qe){this.map[I(be)]=M(qe)},j.prototype.forEach=function(be,qe){for(var Ke in this.map)this.map.hasOwnProperty(Ke)&&be.call(qe,this.map[Ke],Ke,this)},j.prototype.keys=function(){var be=[];return this.forEach(function(qe,Ke){be.push(Ke)}),P(be)},j.prototype.values=function(){var be=[];return this.forEach(function(qe){be.push(qe)}),P(be)},j.prototype.entries=function(){var be=[];return this.forEach(function(qe,Ke){be.push([Ke,qe])}),P(be)},a.iterable&&(j.prototype[Symbol.iterator]=j.prototype.entries);function N(be){if(be.bodyUsed)return Promise.reject(new TypeError("Already read"));be.bodyUsed=!0}function q(be){return new Promise(function(qe,Ke){be.onload=function(){qe(be.result)},be.onerror=function(){Ke(be.error)}})}function V(be){var qe=new FileReader,Ke=q(qe);return qe.readAsArrayBuffer(be),Ke}function ee(be){var qe=new FileReader,Ke=q(qe);return qe.readAsText(be),Ke}function oe(be){for(var qe=new Uint8Array(be),Ke=new Array(qe.length),_t=0;_t<qe.length;_t++)Ke[_t]=String.fromCharCode(qe[_t]);return Ke.join("")}function pe(be){if(be.slice)return be.slice(0);var qe=new Uint8Array(be.byteLength);return qe.set(new Uint8Array(be)),qe.buffer}function se(){return this.bodyUsed=!1,this._initBody=function(be){this._bodyInit=be,be?typeof be=="string"?this._bodyText=be:a.blob&&Blob.prototype.isPrototypeOf(be)?this._bodyBlob=be:a.formData&&FormData.prototype.isPrototypeOf(be)?this._bodyFormData=be:a.searchParams&&URLSearchParams.prototype.isPrototypeOf(be)?this._bodyText=be.toString():a.arrayBuffer&&a.blob&&v(be)?(this._bodyArrayBuffer=pe(be.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(be)||E(be))?this._bodyArrayBuffer=pe(be):this._bodyText=be=Object.prototype.toString.call(be):this._bodyText="",this.headers.get("content-type")||(typeof be=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):a.searchParams&&URLSearchParams.prototype.isPrototypeOf(be)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a.blob&&(this.blob=function(){var be=N(this);if(be)return be;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?N(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(V)}),this.text=function(){var be=N(this);if(be)return be;if(this._bodyBlob)return ee(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(oe(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a.formData&&(this.formData=function(){return this.text().then(Me)}),this.json=function(){return this.text().then(JSON.parse)},this}var xe=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Te(be){var qe=be.toUpperCase();return xe.indexOf(qe)>-1?qe:be}function De(be,qe){qe=qe||{};var Ke=qe.body;if(be instanceof De){if(be.bodyUsed)throw new TypeError("Already read");this.url=be.url,this.credentials=be.credentials,qe.headers||(this.headers=new j(be.headers)),this.method=be.method,this.mode=be.mode,this.signal=be.signal,!Ke&&be._bodyInit!=null&&(Ke=be._bodyInit,be.bodyUsed=!0)}else this.url=String(be);if(this.credentials=qe.credentials||this.credentials||"same-origin",(qe.headers||!this.headers)&&(this.headers=new j(qe.headers)),this.method=Te(qe.method||this.method||"GET"),this.mode=qe.mode||this.mode||null,this.signal=qe.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&Ke)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(Ke)}De.prototype.clone=function(){return new De(this,{body:this._bodyInit})};function Me(be){var qe=new FormData;return be.trim().split("&").forEach(function(Ke){if(Ke){var _t=Ke.split("="),It=_t.shift().replace(/\+/g," "),Tt=_t.join("=").replace(/\+/g," ");qe.append(decodeURIComponent(It),decodeURIComponent(Tt))}}),qe}function Be(be){var qe=new j,Ke=be.replace(/\r?\n[\t ]+/g," ");return Ke.split(/\r?\n/).forEach(function(_t){var It=_t.split(":"),Tt=It.shift().trim();if(Tt){var Dn=It.join(":").trim();qe.append(Tt,Dn)}}),qe}se.call(De.prototype);function ze(be,qe){qe||(qe={}),this.type="default",this.status=qe.status===void 0?200:qe.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in qe?qe.statusText:"OK",this.headers=new j(qe.headers),this.url=qe.url||"",this._initBody(be)}se.call(ze.prototype),ze.prototype.clone=function(){return new ze(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new j(this.headers),url:this.url})},ze.error=function(){var be=new ze(null,{status:0,statusText:""});return be.type="error",be};var Fe=[301,302,303,307,308];ze.redirect=function(be,qe){if(Fe.indexOf(qe)===-1)throw new RangeError("Invalid status code");return new ze(null,{status:qe,headers:{location:be}})},m.DOMException=h.DOMException;try{new m.DOMException}catch{m.DOMException=function(qe,Ke){this.message=qe,this.name=Ke;var _t=Error(qe);this.stack=_t.stack},m.DOMException.prototype=Object.create(Error.prototype),m.DOMException.prototype.constructor=m.DOMException}function Je(be,qe){return new Promise(function(Ke,_t){var It=new De(be,qe);if(It.signal&&It.signal.aborted)return _t(new m.DOMException("Aborted","AbortError"));var Tt=new XMLHttpRequest;function Dn(){Tt.abort()}Tt.onload=function(){var Ot={status:Tt.status,statusText:Tt.statusText,headers:Be(Tt.getAllResponseHeaders()||"")};Ot.url="responseURL"in Tt?Tt.responseURL:Ot.headers.get("X-Request-URL");var Zn="response"in Tt?Tt.response:Tt.responseText;Ke(new ze(Zn,Ot))},Tt.onerror=function(){_t(new TypeError("Network request failed"))},Tt.ontimeout=function(){_t(new TypeError("Network request failed"))},Tt.onabort=function(){_t(new m.DOMException("Aborted","AbortError"))},Tt.open(It.method,It.url,!0),It.credentials==="include"?Tt.withCredentials=!0:It.credentials==="omit"&&(Tt.withCredentials=!1),"responseType"in Tt&&a.blob&&(Tt.responseType="blob"),It.headers.forEach(function(Ot,Zn){Tt.setRequestHeader(Zn,Ot)}),It.signal&&(It.signal.addEventListener("abort",Dn),Tt.onreadystatechange=function(){Tt.readyState===4&&It.signal.removeEventListener("abort",Dn)}),Tt.send(typeof It._bodyInit=="undefined"?null:It._bodyInit)})}return Je.polyfill=!0,h.fetch||(h.fetch=Je,h.Headers=j,h.Request=De,h.Response=ze),m.Headers=j,m.Request=De,m.Response=ze,m.fetch=Je,Object.defineProperty(m,"__esModule",{value:!0}),m})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var c=s;n=c.fetch,n.default=c.fetch,n.fetch=c.fetch,n.Headers=c.Headers,n.Request=c.Request,n.Response=c.Response,e.exports=n})(Cv,Cv.exports);var ng=xU(Cv.exports),Wd=globalThis&&globalThis.__awaiter||function(e,n,r,s){function c(h){return h instanceof r?h:new r(function(m){m(h)})}return new(r||(r=Promise))(function(h,m){function a(E){try{w(s.next(E))}catch(I){m(I)}}function v(E){try{w(s.throw(E))}catch(I){m(I)}}function w(E){E.done?h(E.value):c(E.value).then(a,v)}w((s=s.apply(e,n||[])).next())})};const SU=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),AU=(e,n)=>{if(typeof e.json!="function")return n(e);e.json().then(r=>n({message:SU(r),status:(e==null?void 0:e.status)||500}))},CU=(e,n,r)=>{const s={method:e,headers:(n==null?void 0:n.headers)||{}};return e==="GET"||(s.headers=Object.assign({"Content-Type":"text/plain;charset=UTF-8"},n==null?void 0:n.headers),s.body=JSON.stringify(r)),s};function rg(e=ng,n,r,s,c){return Wd(this,void 0,void 0,function*(){return new Promise((h,m)=>{e(r,CU(n,s,c)).then(a=>{if(!a.ok)throw a;return(s==null?void 0:s.noResolveJson)?h:a.json()}).then(a=>h(a)).catch(a=>AU(a,m))})})}function uy(e,n,r){return Wd(this,void 0,void 0,function*(){return rg(e,"GET",n,r)})}function Hi(e,n,r,s){return Wd(this,void 0,void 0,function*(){return rg(e,"POST",n,s,r)})}function V2(e,n,r,s){return Wd(this,void 0,void 0,function*(){return rg(e,"PUT",n,s,r)})}function IU(e,n,r,s){return Wd(this,void 0,void 0,function*(){return rg(e,"DELETE",n,s,r)})}const MU="1.22.1",kU="http://localhost:9999",PU={"X-Client-Info":`gotrue-js/${MU}`},Xf="supabase.auth.token",DU={name:"sb",lifetime:60*60*8,domain:"",path:"/",sameSite:"lax"};function RU(e,n,r){const s=r||{},c=encodeURIComponent,h=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;if(typeof c!="function")throw new TypeError("option encode is invalid");if(!h.test(e))throw new TypeError("argument name is invalid");const m=c(n);if(m&&!h.test(m))throw new TypeError("argument val is invalid");let a=e+"="+m;if(s.maxAge!=null){const v=s.maxAge-0;if(isNaN(v)||!isFinite(v))throw new TypeError("option maxAge is invalid");a+="; Max-Age="+Math.floor(v)}if(s.domain){if(!h.test(s.domain))throw new TypeError("option domain is invalid");a+="; Domain="+s.domain}if(s.path){if(!h.test(s.path))throw new TypeError("option path is invalid");a+="; Path="+s.path}if(s.expires){if(typeof s.expires.toUTCString!="function")throw new TypeError("option expires is invalid");a+="; Expires="+s.expires.toUTCString()}if(s.httpOnly&&(a+="; HttpOnly"),s.secure&&(a+="; Secure"),s.sameSite)switch(typeof s.sameSite=="string"?s.sameSite.toLowerCase():s.sameSite){case"lax":a+="; SameSite=Lax";break;case"strict":a+="; SameSite=Strict";break;case"none":a+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return a}function zU(e){if(!e||!e.headers||!e.headers.host)throw new Error('The "host" request header is not available');const n=e.headers.host.indexOf(":")>-1&&e.headers.host.split(":")[0]||e.headers.host;return!(["localhost","127.0.0.1"].indexOf(n)>-1||n.endsWith(".local"))}function OU(e,n){var r,s,c;return RU(e.name,e.value,{maxAge:e.maxAge,expires:new Date(Date.now()+e.maxAge*1e3),httpOnly:!0,secure:n,path:(r=e.path)!==null&&r!==void 0?r:"/",domain:(s=e.domain)!==null&&s!==void 0?s:"",sameSite:(c=e.sameSite)!==null&&c!==void 0?c:"lax"})}function Iv(e,n,r){const s=r.map(h=>OU(h,zU(e))),c=n.getHeader("Set-Cookie");return c&&(c instanceof Array?Array.prototype.push.apply(s,c):typeof c=="string"&&s.push(c)),s}function Rm(e,n,r){n.setHeader("Set-Cookie",Iv(e,n,r))}function Yu(e){return Math.round(Date.now()/1e3)+e}function LU(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const n=Math.random()*16|0;return(e=="x"?n:n&3|8).toString(16)})}const nl=()=>typeof window!="undefined";function rl(e,n){var r;n||(n=((r=window==null?void 0:window.location)===null||r===void 0?void 0:r.href)||""),e=e.replace(/[\[\]]/g,"\\$&");const s=new RegExp("[?&#]"+e+"(=([^&#]*)|&|#|$)"),c=s.exec(n);return c?c[2]?decodeURIComponent(c[2].replace(/\+/g," ")):"":null}var Mr=globalThis&&globalThis.__awaiter||function(e,n,r,s){function c(h){return h instanceof r?h:new r(function(m){m(h)})}return new(r||(r=Promise))(function(h,m){function a(E){try{w(s.next(E))}catch(I){m(I)}}function v(E){try{w(s.throw(E))}catch(I){m(I)}}function w(E){E.done?h(E.value):c(E.value).then(a,v)}w((s=s.apply(e,n||[])).next())})};class FU{constructor({url:n="",headers:r={},cookieOptions:s,fetch:c}){this.url=n,this.headers=r,this.cookieOptions=Object.assign(Object.assign({},DU),s),this.fetch=c}_createRequestHeaders(n){const r=Object.assign({},this.headers);return r.Authorization=`Bearer ${n}`,r}cookieName(){var n;return(n=this.cookieOptions.name)!==null&&n!==void 0?n:""}getUrlForProvider(n,r){const s=[`provider=${encodeURIComponent(n)}`];return(r==null?void 0:r.redirectTo)&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),(r==null?void 0:r.scopes)&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),`${this.url}/authorize?${s.join("&")}`}signUpWithEmail(n,r,s={}){return Mr(this,void 0,void 0,function*(){try{const c=Object.assign({},this.headers);let h="";s.redirectTo&&(h="?redirect_to="+encodeURIComponent(s.redirectTo));const m=yield Hi(this.fetch,`${this.url}/signup${h}`,{email:n,password:r,data:s.data,gotrue_meta_security:{hcaptcha_token:s.captchaToken}},{headers:c}),a=Object.assign({},m);return a.expires_in&&(a.expires_at=Yu(m.expires_in)),{data:a,error:null}}catch(c){return{data:null,error:c}}})}signInWithEmail(n,r,s={}){return Mr(this,void 0,void 0,function*(){try{const c=Object.assign({},this.headers);let h="?grant_type=password";s.redirectTo&&(h+="&redirect_to="+encodeURIComponent(s.redirectTo));const m=yield Hi(this.fetch,`${this.url}/token${h}`,{email:n,password:r},{headers:c}),a=Object.assign({},m);return a.expires_in&&(a.expires_at=Yu(m.expires_in)),{data:a,error:null}}catch(c){return{data:null,error:c}}})}signUpWithPhone(n,r,s={}){return Mr(this,void 0,void 0,function*(){try{const c=Object.assign({},this.headers),h=yield Hi(this.fetch,`${this.url}/signup`,{phone:n,password:r,data:s.data,gotrue_meta_security:{hcaptcha_token:s.captchaToken}},{headers:c}),m=Object.assign({},h);return m.expires_in&&(m.expires_at=Yu(h.expires_in)),{data:m,error:null}}catch(c){return{data:null,error:c}}})}signInWithPhone(n,r){return Mr(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers),c="?grant_type=password",h=yield Hi(this.fetch,`${this.url}/token${c}`,{phone:n,password:r},{headers:s}),m=Object.assign({},h);return m.expires_in&&(m.expires_at=Yu(h.expires_in)),{data:m,error:null}}catch(s){return{data:null,error:s}}})}signInWithOpenIDConnect({id_token:n,nonce:r,client_id:s,issuer:c,provider:h}){return Mr(this,void 0,void 0,function*(){try{const m=Object.assign({},this.headers),a="?grant_type=id_token",v=yield Hi(this.fetch,`${this.url}/token${a}`,{id_token:n,nonce:r,client_id:s,issuer:c,provider:h},{headers:m}),w=Object.assign({},v);return w.expires_in&&(w.expires_at=Yu(v.expires_in)),{data:w,error:null}}catch(m){return{data:null,error:m}}})}sendMagicLinkEmail(n,r={}){return Mr(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let c="";return r.redirectTo&&(c+="?redirect_to="+encodeURIComponent(r.redirectTo)),{data:yield Hi(this.fetch,`${this.url}/magiclink${c}`,{email:n,gotrue_meta_security:{hcaptcha_token:r.captchaToken}},{headers:s}),error:null}}catch(s){return{data:null,error:s}}})}sendMobileOTP(n,r={}){return Mr(this,void 0,void 0,function*(){try{let s=Object.assign({},this.headers);return{data:yield Hi(this.fetch,`${this.url}/otp`,{phone:n,gotrue_meta_security:{hcaptcha_token:r.captchaToken}},{headers:s}),error:null}}catch(s){return{data:null,error:s}}})}signOut(n){return Mr(this,void 0,void 0,function*(){try{return yield Hi(this.fetch,`${this.url}/logout`,{},{headers:this._createRequestHeaders(n),noResolveJson:!0}),{error:null}}catch(r){return{error:r}}})}verifyMobileOTP(n,r,s={}){return Mr(this,void 0,void 0,function*(){try{const c=Object.assign({},this.headers);return{data:yield Hi(this.fetch,`${this.url}/verify`,{phone:n,token:r,type:"sms",redirect_to:s.redirectTo},{headers:c}),error:null}}catch(c){return{data:null,error:c}}})}inviteUserByEmail(n,r={}){return Mr(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let c="";return r.redirectTo&&(c+="?redirect_to="+encodeURIComponent(r.redirectTo)),{data:yield Hi(this.fetch,`${this.url}/invite${c}`,{email:n,data:r.data},{headers:s}),error:null}}catch(s){return{data:null,error:s}}})}resetPasswordForEmail(n,r={}){return Mr(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let c="";return r.redirectTo&&(c+="?redirect_to="+encodeURIComponent(r.redirectTo)),{data:yield Hi(this.fetch,`${this.url}/recover${c}`,{email:n,gotrue_meta_security:{hcaptcha_token:r.captchaToken}},{headers:s}),error:null}}catch(s){return{data:null,error:s}}})}refreshAccessToken(n){return Mr(this,void 0,void 0,function*(){try{const r=yield Hi(this.fetch,`${this.url}/token?grant_type=refresh_token`,{refresh_token:n},{headers:this.headers}),s=Object.assign({},r);return s.expires_in&&(s.expires_at=Yu(r.expires_in)),{data:s,error:null}}catch(r){return{data:null,error:r}}})}setAuthCookie(n,r){n.method!=="POST"&&(r.setHeader("Allow","POST"),r.status(405).end("Method Not Allowed"));const{event:s,session:c}=n.body;if(!s)throw new Error("Auth event missing!");if(s==="SIGNED_IN"){if(!c)throw new Error("Auth session missing!");Rm(n,r,[{key:"access-token",value:c.access_token},{key:"refresh-token",value:c.refresh_token}].map(h=>{var m;return{name:`${this.cookieName()}-${h.key}`,value:h.value,domain:this.cookieOptions.domain,maxAge:(m=this.cookieOptions.lifetime)!==null&&m!==void 0?m:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}}))}s==="SIGNED_OUT"&&Rm(n,r,["access-token","refresh-token"].map(h=>({name:`${this.cookieName()}-${h}`,value:"",maxAge:-1}))),r.status(200).json({})}deleteAuthCookie(n,r,{redirectTo:s="/"}){return Rm(n,r,["access-token","refresh-token"].map(c=>({name:`${this.cookieName()}-${c}`,value:"",maxAge:-1}))),r.redirect(307,s)}getAuthCookieString(n,r){n.method!=="POST"&&(r.setHeader("Allow","POST"),r.status(405).end("Method Not Allowed"));const{event:s,session:c}=n.body;if(!s)throw new Error("Auth event missing!");if(s==="SIGNED_IN"){if(!c)throw new Error("Auth session missing!");return Iv(n,r,[{key:"access-token",value:c.access_token},{key:"refresh-token",value:c.refresh_token}].map(h=>{var m;return{name:`${this.cookieName()}-${h.key}`,value:h.value,domain:this.cookieOptions.domain,maxAge:(m=this.cookieOptions.lifetime)!==null&&m!==void 0?m:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}}))}return s==="SIGNED_OUT"?Iv(n,r,["access-token","refresh-token"].map(h=>({name:`${this.cookieName()}-${h}`,value:"",maxAge:-1}))):r.getHeader("Set-Cookie")}generateLink(n,r,s={}){return Mr(this,void 0,void 0,function*(){try{return{data:yield Hi(this.fetch,`${this.url}/admin/generate_link`,{type:n,email:r,password:s.password,data:s.data,redirect_to:s.redirectTo},{headers:this.headers}),error:null}}catch(c){return{data:null,error:c}}})}createUser(n){return Mr(this,void 0,void 0,function*(){try{const r=yield Hi(this.fetch,`${this.url}/admin/users`,n,{headers:this.headers});return{user:r,data:r,error:null}}catch(r){return{user:null,data:null,error:r}}})}listUsers(){return Mr(this,void 0,void 0,function*(){try{return{data:(yield uy(this.fetch,`${this.url}/admin/users`,{headers:this.headers})).users,error:null}}catch(n){return{data:null,error:n}}})}getUserById(n){return Mr(this,void 0,void 0,function*(){try{return{data:yield uy(this.fetch,`${this.url}/admin/users/${n}`,{headers:this.headers}),error:null}}catch(r){return{data:null,error:r}}})}getUserByCookie(n,r){return Mr(this,void 0,void 0,function*(){try{if(!n.cookies)throw new Error("Not able to parse cookies! When using Express make sure the cookie-parser middleware is in use!");const s=n.cookies[`${this.cookieName()}-access-token`],c=n.cookies[`${this.cookieName()}-refresh-token`];if(!s)throw new Error("No cookie found!");const{user:h,error:m}=yield this.getUser(s);if(m){if(!c)throw new Error("No refresh_token cookie found!");if(!r)throw new Error("You need to pass the res object to automatically refresh the session!");const{data:a,error:v}=yield this.refreshAccessToken(c);if(v)throw v;if(a)return Rm(n,r,[{key:"access-token",value:a.access_token},{key:"refresh-token",value:a.refresh_token}].map(w=>{var E;return{name:`${this.cookieName()}-${w.key}`,value:w.value,domain:this.cookieOptions.domain,maxAge:(E=this.cookieOptions.lifetime)!==null&&E!==void 0?E:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}})),{token:a.access_token,user:a.user,data:a.user,error:null}}return{token:s,user:h,data:h,error:null}}catch(s){return{token:null,user:null,data:null,error:s}}})}updateUserById(n,r){return Mr(this,void 0,void 0,function*(){try{const s=yield V2(this.fetch,`${this.url}/admin/users/${n}`,r,{headers:this.headers});return{user:s,data:s,error:null}}catch(s){return{user:null,data:null,error:s}}})}deleteUser(n){return Mr(this,void 0,void 0,function*(){try{const r=yield IU(this.fetch,`${this.url}/admin/users/${n}`,{},{headers:this.headers});return{user:r,data:r,error:null}}catch(r){return{user:null,data:null,error:r}}})}getUser(n){return Mr(this,void 0,void 0,function*(){try{const r=yield uy(this.fetch,`${this.url}/user`,{headers:this._createRequestHeaders(n)});return{user:r,data:r,error:null}}catch(r){return{user:null,data:null,error:r}}})}updateUser(n,r){return Mr(this,void 0,void 0,function*(){try{const s=yield V2(this.fetch,`${this.url}/user`,r,{headers:this._createRequestHeaders(n)});return{user:s,data:s,error:null}}catch(s){return{user:null,data:null,error:s}}})}}function BU(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self!="undefined"&&(self.globalThis=self)}}var Xi=globalThis&&globalThis.__awaiter||function(e,n,r,s){function c(h){return h instanceof r?h:new r(function(m){m(h)})}return new(r||(r=Promise))(function(h,m){function a(E){try{w(s.next(E))}catch(I){m(I)}}function v(E){try{w(s.throw(E))}catch(I){m(I)}}function w(E){E.done?h(E.value):c(E.value).then(a,v)}w((s=s.apply(e,n||[])).next())})};BU();const UU={url:kU,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,multiTab:!0,headers:PU};class NU{constructor(n){this.stateChangeEmitters=new Map;const r=Object.assign(Object.assign({},UU),n);this.currentUser=null,this.currentSession=null,this.autoRefreshToken=r.autoRefreshToken,this.persistSession=r.persistSession,this.multiTab=r.multiTab,this.localStorage=r.localStorage||globalThis.localStorage,this.api=new FU({url:r.url,headers:r.headers,cookieOptions:r.cookieOptions,fetch:r.fetch}),this._recoverSession(),this._recoverAndRefresh(),this._listenForMultiTabEvents(),r.detectSessionInUrl&&nl()&&!!rl("access_token")&&this.getSessionFromUrl({storeSession:!0}).then(({error:s})=>{s&&console.error("Error getting session from URL.",s)})}signUp({email:n,password:r,phone:s},c={}){return Xi(this,void 0,void 0,function*(){try{this._removeSession();const{data:h,error:m}=s&&r?yield this.api.signUpWithPhone(s,r,{data:c.data,captchaToken:c.captchaToken}):yield this.api.signUpWithEmail(n,r,{redirectTo:c.redirectTo,data:c.data,captchaToken:c.captchaToken});if(m)throw m;if(!h)throw"An error occurred on sign up.";let a=null,v=null;return h.access_token&&(a=h,v=a.user,this._saveSession(a),this._notifyAllSubscribers("SIGNED_IN")),h.id&&(v=h),{user:v,session:a,error:null}}catch(h){return{user:null,session:null,error:h}}})}signIn({email:n,phone:r,password:s,refreshToken:c,provider:h,oidc:m},a={}){return Xi(this,void 0,void 0,function*(){try{if(this._removeSession(),n&&!s){const{error:v}=yield this.api.sendMagicLinkEmail(n,{redirectTo:a.redirectTo,captchaToken:a.captchaToken});return{user:null,session:null,error:v}}if(n&&s)return this._handleEmailSignIn(n,s,{redirectTo:a.redirectTo});if(r&&!s){const{error:v}=yield this.api.sendMobileOTP(r,{captchaToken:a.captchaToken});return{user:null,session:null,error:v}}if(r&&s)return this._handlePhoneSignIn(r,s);if(c){const{error:v}=yield this._callRefreshToken(c);if(v)throw v;return{user:this.currentUser,session:this.currentSession,error:null}}if(h)return this._handleProviderSignIn(h,{redirectTo:a.redirectTo,scopes:a.scopes});if(m)return this._handleOpenIDConnectSignIn(m);throw new Error("You must provide either an email, phone number, a third-party provider or OpenID Connect.")}catch(v){return{user:null,session:null,error:v}}})}verifyOTP({phone:n,token:r},s={}){return Xi(this,void 0,void 0,function*(){try{this._removeSession();const{data:c,error:h}=yield this.api.verifyMobileOTP(n,r,s);if(h)throw h;if(!c)throw"An error occurred on token verification.";let m=null,a=null;return c.access_token&&(m=c,a=m.user,this._saveSession(m),this._notifyAllSubscribers("SIGNED_IN")),c.id&&(a=c),{user:a,session:m,error:null}}catch(c){return{user:null,session:null,error:c}}})}user(){return this.currentUser}session(){return this.currentSession}refreshSession(){var n;return Xi(this,void 0,void 0,function*(){try{if(!((n=this.currentSession)===null||n===void 0?void 0:n.access_token))throw new Error("Not logged in.");const{error:r}=yield this._callRefreshToken();if(r)throw r;return{data:this.currentSession,user:this.currentUser,error:null}}catch(r){return{data:null,user:null,error:r}}})}update(n){var r;return Xi(this,void 0,void 0,function*(){try{if(!((r=this.currentSession)===null||r===void 0?void 0:r.access_token))throw new Error("Not logged in.");const{user:s,error:c}=yield this.api.updateUser(this.currentSession.access_token,n);if(c)throw c;if(!s)throw Error("Invalid user data.");const h=Object.assign(Object.assign({},this.currentSession),{user:s});return this._saveSession(h),this._notifyAllSubscribers("USER_UPDATED"),{data:s,user:s,error:null}}catch(s){return{data:null,user:null,error:s}}})}setSession(n){return Xi(this,void 0,void 0,function*(){try{if(!n)throw new Error("No current session.");const{data:r,error:s}=yield this.api.refreshAccessToken(n);return s?{session:null,error:s}:(this._saveSession(r),this._notifyAllSubscribers("SIGNED_IN"),{session:r,error:null})}catch(r){return{error:r,session:null}}})}setAuth(n){return this.currentSession=Object.assign(Object.assign({},this.currentSession),{access_token:n,token_type:"bearer",user:null}),this.currentSession}getSessionFromUrl(n){return Xi(this,void 0,void 0,function*(){try{if(!nl())throw new Error("No browser detected.");const r=rl("error_description");if(r)throw new Error(r);const s=rl("provider_token"),c=rl("access_token");if(!c)throw new Error("No access_token detected.");const h=rl("expires_in");if(!h)throw new Error("No expires_in detected.");const m=rl("refresh_token");if(!m)throw new Error("No refresh_token detected.");const a=rl("token_type");if(!a)throw new Error("No token_type detected.");const w=Math.round(Date.now()/1e3)+parseInt(h),{user:E,error:I}=yield this.api.getUser(c);if(I)throw I;const M={provider_token:s,access_token:c,expires_in:parseInt(h),expires_at:w,refresh_token:m,token_type:a,user:E};if(n==null?void 0:n.storeSession){this._saveSession(M);const P=rl("type");this._notifyAllSubscribers("SIGNED_IN"),P==="recovery"&&this._notifyAllSubscribers("PASSWORD_RECOVERY")}return window.location.hash="",{data:M,error:null}}catch(r){return{data:null,error:r}}})}signOut(){var n;return Xi(this,void 0,void 0,function*(){const r=(n=this.currentSession)===null||n===void 0?void 0:n.access_token;if(this._removeSession(),this._notifyAllSubscribers("SIGNED_OUT"),r){const{error:s}=yield this.api.signOut(r);if(s)return{error:s}}return{error:null}})}onAuthStateChange(n){try{const r=LU(),s={id:r,callback:n,unsubscribe:()=>{this.stateChangeEmitters.delete(r)}};return this.stateChangeEmitters.set(r,s),{data:s,error:null}}catch(r){return{data:null,error:r}}}_handleEmailSignIn(n,r,s={}){var c,h;return Xi(this,void 0,void 0,function*(){try{const{data:m,error:a}=yield this.api.signInWithEmail(n,r,{redirectTo:s.redirectTo});return a||!m?{data:null,user:null,session:null,error:a}:((((c=m==null?void 0:m.user)===null||c===void 0?void 0:c.confirmed_at)||((h=m==null?void 0:m.user)===null||h===void 0?void 0:h.email_confirmed_at))&&(this._saveSession(m),this._notifyAllSubscribers("SIGNED_IN")),{data:m,user:m.user,session:m,error:null})}catch(m){return{data:null,user:null,session:null,error:m}}})}_handlePhoneSignIn(n,r){var s;return Xi(this,void 0,void 0,function*(){try{const{data:c,error:h}=yield this.api.signInWithPhone(n,r);return h||!c?{data:null,user:null,session:null,error:h}:(((s=c==null?void 0:c.user)===null||s===void 0?void 0:s.phone_confirmed_at)&&(this._saveSession(c),this._notifyAllSubscribers("SIGNED_IN")),{data:c,user:c.user,session:c,error:null})}catch(c){return{data:null,user:null,session:null,error:c}}})}_handleProviderSignIn(n,r={}){const s=this.api.getUrlForProvider(n,{redirectTo:r.redirectTo,scopes:r.scopes});try{return nl()&&(window.location.href=s),{provider:n,url:s,data:null,session:null,user:null,error:null}}catch(c){return s?{provider:n,url:s,data:null,session:null,user:null,error:null}:{data:null,user:null,session:null,error:c}}}_handleOpenIDConnectSignIn({id_token:n,nonce:r,client_id:s,issuer:c,provider:h}){return Xi(this,void 0,void 0,function*(){if(n&&r&&(s&&c||h))try{const{data:m,error:a}=yield this.api.signInWithOpenIDConnect({id_token:n,nonce:r,client_id:s,issuer:c,provider:h});return a||!m?{user:null,session:null,error:a}:(this._saveSession(m),this._notifyAllSubscribers("SIGNED_IN"),{user:m.user,session:m,error:null})}catch(m){return{user:null,session:null,error:m}}throw new Error("You must provide a OpenID Connect provider with your id token and nonce.")})}_recoverSession(){var n;try{const r=nl()&&((n=this.localStorage)===null||n===void 0?void 0:n.getItem(Xf));if(!r||typeof r!="string")return null;const s=JSON.parse(r),{currentSession:c,expiresAt:h}=s,m=Math.round(Date.now()/1e3);h>=m&&(c==null?void 0:c.user)&&(this._saveSession(c),this._notifyAllSubscribers("SIGNED_IN"))}catch(r){console.log("error",r)}}_recoverAndRefresh(){return Xi(this,void 0,void 0,function*(){try{const n=nl()&&(yield this.localStorage.getItem(Xf));if(!n)return null;const r=JSON.parse(n),{currentSession:s,expiresAt:c}=r,h=Math.round(Date.now()/1e3);if(c<h)if(this.autoRefreshToken&&s.refresh_token){const{error:m}=yield this._callRefreshToken(s.refresh_token);m&&(console.log(m.message),yield this._removeSession())}else this._removeSession();else!s||!s.user?(console.log("Current session is missing data."),this._removeSession()):(this._saveSession(s),this._notifyAllSubscribers("SIGNED_IN"))}catch(n){return console.error(n),null}})}_callRefreshToken(n){var r;return n===void 0&&(n=(r=this.currentSession)===null||r===void 0?void 0:r.refresh_token),Xi(this,void 0,void 0,function*(){try{if(!n)throw new Error("No current session.");const{data:s,error:c}=yield this.api.refreshAccessToken(n);if(c)throw c;if(!s)throw Error("Invalid session data.");return this._saveSession(s),this._notifyAllSubscribers("TOKEN_REFRESHED"),this._notifyAllSubscribers("SIGNED_IN"),{data:s,error:null}}catch(s){return{data:null,error:s}}})}_notifyAllSubscribers(n){this.stateChangeEmitters.forEach(r=>r.callback(n,this.currentSession))}_saveSession(n){this.currentSession=n,this.currentUser=n.user;const r=n.expires_at;if(r){const s=Math.round(Date.now()/1e3),c=r-s,h=c>60?60:.5;this._startAutoRefreshToken((c-h)*1e3)}this.persistSession&&n.expires_at&&this._persistSession(this.currentSession)}_persistSession(n){const r={currentSession:n,expiresAt:n.expires_at};nl()&&this.localStorage.setItem(Xf,JSON.stringify(r))}_removeSession(){return Xi(this,void 0,void 0,function*(){this.currentSession=null,this.currentUser=null,this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),nl()&&(yield this.localStorage.removeItem(Xf))})}_startAutoRefreshToken(n){this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),!(n<=0||!this.autoRefreshToken)&&(this.refreshTokenTimer=setTimeout(()=>this._callRefreshToken(),n),typeof this.refreshTokenTimer.unref=="function"&&this.refreshTokenTimer.unref())}_listenForMultiTabEvents(){if(!this.multiTab||!nl()||!(window==null?void 0:window.addEventListener))return!1;try{window==null||window.addEventListener("storage",n=>{var r;if(n.key===Xf){const s=JSON.parse(String(n.newValue));((r=s==null?void 0:s.currentSession)===null||r===void 0?void 0:r.access_token)?(this._recoverAndRefresh(),this._notifyAllSubscribers("SIGNED_IN")):(this._removeSession(),this._notifyAllSubscribers("SIGNED_OUT"))}})}catch(n){console.error("_listenForMultiTabEvents",n)}}}class jU extends NU{constructor(n){super(n)}}var $U=globalThis&&globalThis.__awaiter||function(e,n,r,s){function c(h){return h instanceof r?h:new r(function(m){m(h)})}return new(r||(r=Promise))(function(h,m){function a(E){try{w(s.next(E))}catch(I){m(I)}}function v(E){try{w(s.throw(E))}catch(I){m(I)}}function w(E){E.done?h(E.value):c(E.value).then(a,v)}w((s=s.apply(e,n||[])).next())})};class Nx{constructor(n){this.shouldThrowOnError=!1,Object.assign(this,n),this.fetch=n.fetch||ng}throwOnError(){return this.shouldThrowOnError=!0,this}then(n,r){typeof this.schema=="undefined"||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");let s=this.fetch(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(c=>$U(this,void 0,void 0,function*(){var h,m,a;let v=null,w=null,E=null;if(c.ok){const M=(h=this.headers.Prefer)===null||h===void 0?void 0:h.split(",").includes("return=minimal");if(this.method!=="HEAD"&&!M){const N=yield c.text();N&&(this.headers.Accept==="text/csv"?w=N:w=JSON.parse(N))}const P=(m=this.headers.Prefer)===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),j=(a=c.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");P&&j&&j.length>1&&(E=parseInt(j[1]))}else{const M=yield c.text();try{v=JSON.parse(M)}catch{v={message:M}}if(v&&this.shouldThrowOnError)throw v}return{error:v,data:w,count:E,status:c.status,statusText:c.statusText,body:w}}));return this.shouldThrowOnError||(s=s.catch(c=>({error:{message:`FetchError: ${c.message}`,details:"",hint:"",code:c.code||""},data:null,body:null,count:null,status:400,statusText:"Bad Request"}))),s.then(n,r)}}class jx extends Nx{select(n="*"){let r=!1;const s=n.split("").map(c=>/\s/.test(c)&&!r?"":(c==='"'&&(r=!r),c)).join("");return this.url.searchParams.set("select",s),this}order(n,{ascending:r=!0,nullsFirst:s=!1,foreignTable:c}={}){const h=typeof c=="undefined"?"order":`${c}.order`,m=this.url.searchParams.get(h);return this.url.searchParams.set(h,`${m?`${m},`:""}${n}.${r?"asc":"desc"}.${s?"nullsfirst":"nullslast"}`),this}limit(n,{foreignTable:r}={}){const s=typeof r=="undefined"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${n}`),this}range(n,r,{foreignTable:s}={}){const c=typeof s=="undefined"?"offset":`${s}.offset`,h=typeof s=="undefined"?"limit":`${s}.limit`;return this.url.searchParams.set(c,`${n}`),this.url.searchParams.set(h,`${r-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){this.headers.Accept="application/vnd.pgrst.object+json";const n=new jx(this);return n.then=(r,s)=>this.then(c=>{var h,m;return((m=(h=c.error)===null||h===void 0?void 0:h.details)===null||m===void 0?void 0:m.includes("Results contain 0 rows"))?r({error:null,data:null,count:c.count,status:200,statusText:"OK",body:null}):r(c)},s),n}csv(){return this.headers.Accept="text/csv",this}}class rh extends jx{constructor(){super(...arguments);this.cs=this.contains,this.cd=this.containedBy,this.sl=this.rangeLt,this.sr=this.rangeGt,this.nxl=this.rangeGte,this.nxr=this.rangeLte,this.adj=this.rangeAdjacent,this.ov=this.overlaps}not(n,r,s){return this.url.searchParams.append(`${n}`,`not.${r}.${s}`),this}or(n,{foreignTable:r}={}){const s=typeof r=="undefined"?"or":`${r}.or`;return this.url.searchParams.append(s,`(${n})`),this}eq(n,r){return this.url.searchParams.append(`${n}`,`eq.${r}`),this}neq(n,r){return this.url.searchParams.append(`${n}`,`neq.${r}`),this}gt(n,r){return this.url.searchParams.append(`${n}`,`gt.${r}`),this}gte(n,r){return this.url.searchParams.append(`${n}`,`gte.${r}`),this}lt(n,r){return this.url.searchParams.append(`${n}`,`lt.${r}`),this}lte(n,r){return this.url.searchParams.append(`${n}`,`lte.${r}`),this}like(n,r){return this.url.searchParams.append(`${n}`,`like.${r}`),this}ilike(n,r){return this.url.searchParams.append(`${n}`,`ilike.${r}`),this}is(n,r){return this.url.searchParams.append(`${n}`,`is.${r}`),this}in(n,r){const s=r.map(c=>typeof c=="string"&&new RegExp("[,()]").test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(`${n}`,`in.(${s})`),this}contains(n,r){return typeof r=="string"?this.url.searchParams.append(`${n}`,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(`${n}`,`cs.{${r.join(",")}}`):this.url.searchParams.append(`${n}`,`cs.${JSON.stringify(r)}`),this}containedBy(n,r){return typeof r=="string"?this.url.searchParams.append(`${n}`,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(`${n}`,`cd.{${r.join(",")}}`):this.url.searchParams.append(`${n}`,`cd.${JSON.stringify(r)}`),this}rangeLt(n,r){return this.url.searchParams.append(`${n}`,`sl.${r}`),this}rangeGt(n,r){return this.url.searchParams.append(`${n}`,`sr.${r}`),this}rangeGte(n,r){return this.url.searchParams.append(`${n}`,`nxl.${r}`),this}rangeLte(n,r){return this.url.searchParams.append(`${n}`,`nxr.${r}`),this}rangeAdjacent(n,r){return this.url.searchParams.append(`${n}`,`adj.${r}`),this}overlaps(n,r){return typeof r=="string"?this.url.searchParams.append(`${n}`,`ov.${r}`):this.url.searchParams.append(`${n}`,`ov.{${r.join(",")}}`),this}textSearch(n,r,{config:s,type:c=null}={}){let h="";c==="plain"?h="pl":c==="phrase"?h="ph":c==="websearch"&&(h="w");const m=s===void 0?"":`(${s})`;return this.url.searchParams.append(`${n}`,`${h}fts${m}.${r}`),this}fts(n,r,{config:s}={}){const c=typeof s=="undefined"?"":`(${s})`;return this.url.searchParams.append(`${n}`,`fts${c}.${r}`),this}plfts(n,r,{config:s}={}){const c=typeof s=="undefined"?"":`(${s})`;return this.url.searchParams.append(`${n}`,`plfts${c}.${r}`),this}phfts(n,r,{config:s}={}){const c=typeof s=="undefined"?"":`(${s})`;return this.url.searchParams.append(`${n}`,`phfts${c}.${r}`),this}wfts(n,r,{config:s}={}){const c=typeof s=="undefined"?"":`(${s})`;return this.url.searchParams.append(`${n}`,`wfts${c}.${r}`),this}filter(n,r,s){return this.url.searchParams.append(`${n}`,`${r}.${s}`),this}match(n){return Object.keys(n).forEach(r=>{this.url.searchParams.append(`${r}`,`eq.${n[r]}`)}),this}}class eI extends Nx{constructor(n,{headers:r={},schema:s,fetch:c}={}){super({fetch:c});this.url=new URL(n),this.headers=Object.assign({},r),this.schema=s}select(n="*",{head:r=!1,count:s=null}={}){this.method="GET";let c=!1;const h=n.split("").map(m=>/\s/.test(m)&&!c?"":(m==='"'&&(c=!c),m)).join("");return this.url.searchParams.set("select",h),s&&(this.headers.Prefer=`count=${s}`),r&&(this.method="HEAD"),new rh(this)}insert(n,{upsert:r=!1,onConflict:s,returning:c="representation",count:h=null}={}){this.method="POST";const m=[`return=${c}`];if(r&&m.push("resolution=merge-duplicates"),r&&s!==void 0&&this.url.searchParams.set("on_conflict",s),this.body=n,h&&m.push(`count=${h}`),this.headers.Prefer&&m.unshift(this.headers.Prefer),this.headers.Prefer=m.join(","),Array.isArray(n)){const a=n.reduce((v,w)=>v.concat(Object.keys(w)),[]);if(a.length>0){const v=[...new Set(a)].map(w=>`"${w}"`);this.url.searchParams.set("columns",v.join(","))}}return new rh(this)}upsert(n,{onConflict:r,returning:s="representation",count:c=null,ignoreDuplicates:h=!1}={}){this.method="POST";const m=[`resolution=${h?"ignore":"merge"}-duplicates`,`return=${s}`];return r!==void 0&&this.url.searchParams.set("on_conflict",r),this.body=n,c&&m.push(`count=${c}`),this.headers.Prefer&&m.unshift(this.headers.Prefer),this.headers.Prefer=m.join(","),new rh(this)}update(n,{returning:r="representation",count:s=null}={}){this.method="PATCH";const c=[`return=${r}`];return this.body=n,s&&c.push(`count=${s}`),this.headers.Prefer&&c.unshift(this.headers.Prefer),this.headers.Prefer=c.join(","),new rh(this)}delete({returning:n="representation",count:r=null}={}){this.method="DELETE";const s=[`return=${n}`];return r&&s.push(`count=${r}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new rh(this)}}class VU extends Nx{constructor(n,{headers:r={},schema:s,fetch:c}={}){super({fetch:c});this.url=new URL(n),this.headers=Object.assign({},r),this.schema=s}rpc(n,{head:r=!1,count:s=null}={}){return r?(this.method="HEAD",n&&Object.entries(n).forEach(([c,h])=>{this.url.searchParams.append(c,h)})):(this.method="POST",this.body=n),s&&(this.headers.Prefer!==void 0?this.headers.Prefer+=`,count=${s}`:this.headers.Prefer=`count=${s}`),new rh(this)}}const GU="0.36.0",qU={"X-Client-Info":`postgrest-js/${GU}`};class ZU{constructor(n,{headers:r={},schema:s,fetch:c}={}){this.url=n,this.headers=Object.assign(Object.assign({},qU),r),this.schema=s,this.fetch=c}auth(n){return this.headers.Authorization=`Bearer ${n}`,this}from(n){const r=`${this.url}/${n}`;return new eI(r,{headers:this.headers,schema:this.schema,fetch:this.fetch})}rpc(n,r,{head:s=!1,count:c=null}={}){const h=`${this.url}/rpc/${n}`;return new VU(h,{headers:this.headers,schema:this.schema,fetch:this.fetch}).rpc(r,{head:s,count:c})}}var lr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(lr||(lr={}));const G2=(e,n,r={})=>{var s;const c=(s=r.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(n).reduce((h,m)=>(h[m]=WU(m,e,n,c),h),{})},WU=(e,n,r,s)=>{const c=n.find(a=>a.name===e),h=c==null?void 0:c.type,m=r[e];return h&&!s.includes(h)?tI(h,m):Mv(m)},tI=(e,n)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return YU(n,r)}switch(e){case lr.bool:return HU(n);case lr.float4:case lr.float8:case lr.int2:case lr.int4:case lr.int8:case lr.numeric:case lr.oid:return XU(n);case lr.json:case lr.jsonb:return KU(n);case lr.timestamp:return QU(n);case lr.abstime:case lr.date:case lr.daterange:case lr.int4range:case lr.int8range:case lr.money:case lr.reltime:case lr.text:case lr.time:case lr.timestamptz:case lr.timetz:case lr.tsrange:case lr.tstzrange:return Mv(n);default:return Mv(n)}},Mv=e=>e,HU=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},XU=e=>{if(typeof e=="string"){const n=parseFloat(e);if(!Number.isNaN(n))return n}return e},KU=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(n){return console.log(`JSON parse error: ${n}`),e}return e},YU=(e,n)=>{if(typeof e!="string")return e;const r=e.length-1,s=e[r];if(e[0]==="{"&&s==="}"){let h;const m=e.slice(1,r);try{h=JSON.parse("["+m+"]")}catch{h=m?m.split(","):[]}return h.map(a=>tI(n,a))}return e},QU=e=>typeof e=="string"?e.replace(" ","T"):e,JU="1.3.5",eN={"X-Client-Info":`realtime-js/${JU}`},tN="1.0.0",nI=1e4,nN=1e3;var xd;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(xd||(xd={}));var Ki;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Ki||(Ki={}));var us;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(us||(us={}));var kv;(function(e){e.websocket="websocket"})(kv||(kv={}));class rI{constructor(n,r){this.callback=n,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=n,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class hy{constructor(n,r,s={},c=nI){this.channel=n,this.event=r,this.payload=s,this.timeout=c,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(n){this.timeout=n,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref}))}updatePayload(n){this.payload=Object.assign(Object.assign({},this.payload),n)}receive(n,r){var s;return this._hasReceived(n)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:n,callback:r}),this}startTimeout(){this.timeoutTimer||(this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref),this.channel.on(this.refEvent,n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout))}trigger(n,r){this.refEvent&&this.channel.trigger(this.refEvent,{status:n,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){!this.refEvent||this.channel.off(this.refEvent)}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:n,response:r}){this.recHooks.filter(s=>s.status===n).forEach(s=>s.callback(r))}_hasReceived(n){return this.receivedResp&&this.receivedResp.status===n}}class rN{constructor(n,r={},s){this.topic=n,this.params=r,this.socket=s,this.bindings=[],this.state=Ki.closed,this.joinedOnce=!1,this.pushBuffer=[],this.timeout=this.socket.timeout,this.joinPush=new hy(this,us.join,this.params,this.timeout),this.rejoinTimer=new rI(()=>this.rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ki.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=Ki.closed,this.socket.remove(this)}),this.onError(c=>{this.isLeaving()||this.isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=Ki.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{!this.isJoining()||(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ki.errored,this.rejoinTimer.scheduleTimeout())}),this.on(us.reply,(c,h)=>{this.trigger(this.replyEventName(h),c)})}rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this.rejoin()}subscribe(n=this.timeout){if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";return this.joinedOnce=!0,this.rejoin(n),this.joinPush}onClose(n){this.on(us.close,n)}onError(n){this.on(us.error,r=>n(r))}on(n,r){this.bindings.push({event:n,callback:r})}off(n){this.bindings=this.bindings.filter(r=>r.event!==n)}canPush(){return this.socket.isConnected()&&this.isJoined()}push(n,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${n}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let c=new hy(this,n,r,s);return this.canPush()?c.send():(c.startTimeout(),this.pushBuffer.push(c)),c}updateJoinPayload(n){this.joinPush.updatePayload(n)}unsubscribe(n=this.timeout){this.state=Ki.leaving;let r=()=>{this.socket.log("channel",`leave ${this.topic}`),this.trigger(us.close,"leave",this.joinRef())};this.joinPush.destroy();let s=new hy(this,us.leave,{},n);return s.receive("ok",()=>r()).receive("timeout",()=>r()),s.send(),this.canPush()||s.trigger("ok",{}),s}onMessage(n,r,s){return r}isMember(n){return this.topic===n}joinRef(){return this.joinPush.ref}rejoin(n=this.timeout){this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=Ki.joining,this.joinPush.resend(n))}trigger(n,r,s){let{close:c,error:h,leave:m,join:a}=us;if(s&&[c,h,m,a].indexOf(n)>=0&&s!==this.joinRef())return;let w=this.onMessage(n,r,s);if(r&&!w)throw"channel onMessage callbacks must return the payload, modified or unmodified";this.bindings.filter(E=>E.event==="*"?n===(r==null?void 0:r.type):E.event===n).map(E=>E.callback(w,s))}replyEventName(n){return`chan_reply_${n}`}isClosed(){return this.state===Ki.closed}isErrored(){return this.state===Ki.errored}isJoined(){return this.state===Ki.joined}isJoining(){return this.state===Ki.joining}isLeaving(){return this.state===Ki.leaving}}const iN="websocket",oN="Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",sN=["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],aN="Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)",lN=["I\xF1aki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],cN="1.0.34",uN={type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},hN="https://github.com/theturtle32/WebSocket-Node",fN={node:">=4.0.0"},dN={bufferutil:"^4.0.1",debug:"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2",yaeti:"^0.0.6"},pN={"buffer-equal":"^1.0.0",gulp:"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1",jshint:"^2.0.0",tape:"^4.9.1"},mN={verbose:!1},_N={test:"tape test/unit/*.js",gulp:"gulp"},gN="index",yN={lib:"./lib"},vN="lib/browser.js",xN="Apache-2.0";var bN={name:iN,description:oN,keywords:sN,author:aN,contributors:lN,version:cN,repository:uN,homepage:hN,engines:fN,dependencies:dN,devDependencies:pN,config:mN,scripts:_N,main:gN,directories:yN,browser:vN,license:xN},wN=bN.version,Ac;if(typeof globalThis=="object")Ac=globalThis;else try{Ac=require("es5-ext/global")}catch{}finally{if(!Ac&&typeof window!="undefined"&&(Ac=window),!Ac)throw new Error("Could not determine global this")}var jd=Ac.WebSocket||Ac.MozWebSocket,TN=wN;function iI(e,n){var r;return n?r=new jd(e,n):r=new jd(e),r}jd&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(e){Object.defineProperty(iI,e,{get:function(){return jd[e]}})});var EN={w3cwebsocket:jd?iI:null,version:TN};class SN{constructor(){this.HEADER_LENGTH=1}decode(n,r){return n.constructor===ArrayBuffer?r(this._binaryDecode(n)):r(typeof n=="string"?JSON.parse(n):{})}_binaryDecode(n){const r=new DataView(n),s=new TextDecoder;return this._decodeBroadcast(n,r,s)}_decodeBroadcast(n,r,s){const c=r.getUint8(1),h=r.getUint8(2);let m=this.HEADER_LENGTH+2;const a=s.decode(n.slice(m,m+c));m=m+c;const v=s.decode(n.slice(m,m+h));m=m+h;const w=JSON.parse(s.decode(n.slice(m,n.byteLength)));return{ref:null,topic:a,event:v,payload:w}}}var AN=globalThis&&globalThis.__awaiter||function(e,n,r,s){function c(h){return h instanceof r?h:new r(function(m){m(h)})}return new(r||(r=Promise))(function(h,m){function a(E){try{w(s.next(E))}catch(I){m(I)}}function v(E){try{w(s.throw(E))}catch(I){m(I)}}function w(E){E.done?h(E.value):c(E.value).then(a,v)}w((s=s.apply(e,n||[])).next())})};const CN=()=>{};class IN{constructor(n,r){this.accessToken=null,this.channels=[],this.endPoint="",this.headers=eN,this.params={},this.timeout=nI,this.transport=EN.w3cwebsocket,this.heartbeatIntervalMs=3e4,this.longpollerTimeout=2e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=CN,this.conn=null,this.sendBuffer=[],this.serializer=new SN,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.endPoint=`${n}/${kv.websocket}`,(r==null?void 0:r.params)&&(this.params=r.params),(r==null?void 0:r.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),(r==null?void 0:r.timeout)&&(this.timeout=r.timeout),(r==null?void 0:r.logger)&&(this.logger=r.logger),(r==null?void 0:r.transport)&&(this.transport=r.transport),(r==null?void 0:r.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs),(r==null?void 0:r.longpollerTimeout)&&(this.longpollerTimeout=r.longpollerTimeout),this.reconnectAfterMs=(r==null?void 0:r.reconnectAfterMs)?r.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=(r==null?void 0:r.encode)?r.encode:(s,c)=>c(JSON.stringify(s)),this.decode=(r==null?void 0:r.decode)?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new rI(()=>AN(this,void 0,void 0,function*(){yield this.disconnect(),this.connect()}),this.reconnectAfterMs)}connect(){this.conn||(this.conn=new this.transport(this.endPointURL(),[],null,this.headers),this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=n=>this._onConnError(n),this.conn.onmessage=n=>this.onConnMessage(n),this.conn.onclose=n=>this._onConnClose(n)))}disconnect(n,r){return new Promise((s,c)=>{try{this.conn&&(this.conn.onclose=function(){},n?this.conn.close(n,r||""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset()),s({error:null,data:!0})}catch(h){s({error:h,data:!1})}})}log(n,r,s){this.logger(n,r,s)}onOpen(n){this.stateChangeCallbacks.open.push(n)}onClose(n){this.stateChangeCallbacks.close.push(n)}onError(n){this.stateChangeCallbacks.error.push(n)}onMessage(n){this.stateChangeCallbacks.message.push(n)}connectionState(){switch(this.conn&&this.conn.readyState){case xd.connecting:return"connecting";case xd.open:return"open";case xd.closing:return"closing";default:return"closed"}}isConnected(){return this.connectionState()==="open"}remove(n){this.channels=this.channels.filter(r=>r.joinRef()!==n.joinRef())}channel(n,r={}){let s=new rN(n,r,this);return this.channels.push(s),s}push(n){let{topic:r,event:s,payload:c,ref:h}=n,m=()=>{this.encode(n,a=>{var v;(v=this.conn)===null||v===void 0||v.send(a)})};this.log("push",`${r} ${s} (${h})`,c),this.isConnected()?m():this.sendBuffer.push(m)}onConnMessage(n){this.decode(n.data,r=>{let{topic:s,event:c,payload:h,ref:m}=r;m&&m===this.pendingHeartbeatRef?this.pendingHeartbeatRef=null:c===(h==null?void 0:h.type)&&this._resetHeartbeat(),this.log("receive",`${h.status||""} ${s} ${c} ${m&&"("+m+")"||""}`,h),this.channels.filter(a=>a.isMember(s)).forEach(a=>a.trigger(c,h,m)),this.stateChangeCallbacks.message.forEach(a=>a(r))})}endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:tN}))}makeRef(){let n=this.ref+1;return n===this.ref?this.ref=0:this.ref=n,this.ref.toString()}setAuth(n){this.accessToken=n;try{this.channels.forEach(r=>{n&&r.updateJoinPayload({user_token:n}),r.joinedOnce&&r.isJoined()&&r.push(us.access_token,{access_token:n})})}catch(r){console.log("setAuth error",r)}}leaveOpenTopic(n){let r=this.channels.find(s=>s.topic===n&&(s.isJoined()||s.isJoining()));r&&(this.log("transport",`leaving duplicate topic "${n}"`),r.unsubscribe())}_onConnOpen(){this.log("transport",`connected to ${this.endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this._resetHeartbeat(),this.stateChangeCallbacks.open.forEach(n=>n())}_onConnClose(n){this.log("transport","close",n),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(n))}_onConnError(n){this.log("transport",n.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(n))}_triggerChanError(){this.channels.forEach(n=>n.trigger(us.error))}_appendParams(n,r){if(Object.keys(r).length===0)return n;const s=n.match(/\?/)?"&":"?",c=new URLSearchParams(r);return`${n}${s}${c}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(n=>n()),this.sendBuffer=[])}_resetHeartbeat(){this.pendingHeartbeatRef=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs)}_sendHeartbeat(){var n;if(!!this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(n=this.conn)===null||n===void 0||n.close(nN,"hearbeat timeout");return}this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class MN{constructor(n,r,s,c){const h={},m=c==="*"?`realtime:${s}`:`realtime:${s}:${c}`,a=r.Authorization.split(" ")[1];a&&(h.user_token=a),this.subscription=n.channel(m,h)}getPayloadRecords(n){const r={new:{},old:{}};return(n.type==="INSERT"||n.type==="UPDATE")&&(r.new=G2(n.columns,n.record)),(n.type==="UPDATE"||n.type==="DELETE")&&(r.old=G2(n.columns,n.old_record)),r}on(n,r){return this.subscription.on(n,s=>{let c={schema:s.schema,table:s.table,commit_timestamp:s.commit_timestamp,eventType:s.type,new:{},old:{},errors:s.errors};c=Object.assign(Object.assign({},c),this.getPayloadRecords(s)),r(c)}),this}subscribe(n=()=>{}){return this.subscription.onError(r=>n("SUBSCRIPTION_ERROR",r)),this.subscription.onClose(()=>n("CLOSED")),this.subscription.subscribe().receive("ok",()=>n("SUBSCRIBED")).receive("error",r=>n("SUBSCRIPTION_ERROR",r)).receive("timeout",()=>n("RETRYING_AFTER_TIMEOUT")),this.subscription}}class kN extends eI{constructor(n,{headers:r={},schema:s,realtime:c,table:h,fetch:m}){super(n,{headers:r,schema:s,fetch:m});this._subscription=null,this._realtime=c,this._headers=r,this._schema=s,this._table=h}on(n,r){return this._realtime.isConnected()||this._realtime.connect(),this._subscription||(this._subscription=new MN(this._realtime,this._headers,this._schema,this._table)),this._subscription.on(n,r)}}var Hd=globalThis&&globalThis.__awaiter||function(e,n,r,s){function c(h){return h instanceof r?h:new r(function(m){m(h)})}return new(r||(r=Promise))(function(h,m){function a(E){try{w(s.next(E))}catch(I){m(I)}}function v(E){try{w(s.throw(E))}catch(I){m(I)}}function w(E){E.done?h(E.value):c(E.value).then(a,v)}w((s=s.apply(e,n||[])).next())})};const PN=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),DN=(e,n)=>{if(typeof e.json!="function")return n(e);e.json().then(r=>n({message:PN(r),status:(e==null?void 0:e.status)||500}))},RN=(e,n,r,s)=>{const c={method:e,headers:(n==null?void 0:n.headers)||{}};return e==="GET"?c:(c.headers=Object.assign({"Content-Type":"application/json"},n==null?void 0:n.headers),c.body=JSON.stringify(s),Object.assign(Object.assign({},c),r))};function ig(e=ng,n,r,s,c,h){return Hd(this,void 0,void 0,function*(){return new Promise((m,a)=>{e(r,RN(n,s,c,h)).then(v=>{if(!v.ok)throw v;return(s==null?void 0:s.noResolveJson)?m(v):v.json()}).then(v=>m(v)).catch(v=>DN(v,a))})})}function Pv(e,n,r,s){return Hd(this,void 0,void 0,function*(){return ig(e,"GET",n,r,s)})}function bd(e,n,r,s,c){return Hd(this,void 0,void 0,function*(){return ig(e,"POST",n,s,c,r)})}function zN(e,n,r,s,c){return Hd(this,void 0,void 0,function*(){return ig(e,"PUT",n,s,c,r)})}function oI(e,n,r,s,c){return Hd(this,void 0,void 0,function*(){return ig(e,"DELETE",n,s,c,r)})}const ON="0.0.0",LN={"X-Client-Info":`storage-js/${ON}`};var Qu=globalThis&&globalThis.__awaiter||function(e,n,r,s){function c(h){return h instanceof r?h:new r(function(m){m(h)})}return new(r||(r=Promise))(function(h,m){function a(E){try{w(s.next(E))}catch(I){m(I)}}function v(E){try{w(s.throw(E))}catch(I){m(I)}}function w(E){E.done?h(E.value):c(E.value).then(a,v)}w((s=s.apply(e,n||[])).next())})};class FN{constructor(n,r={},s){this.url=n,this.headers=Object.assign(Object.assign({},LN),r),this.fetch=s}listBuckets(){return Qu(this,void 0,void 0,function*(){try{return{data:yield Pv(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(n){return{data:null,error:n}}})}getBucket(n){return Qu(this,void 0,void 0,function*(){try{return{data:yield Pv(this.fetch,`${this.url}/bucket/${n}`,{headers:this.headers}),error:null}}catch(r){return{data:null,error:r}}})}createBucket(n,r={public:!1}){return Qu(this,void 0,void 0,function*(){try{return{data:(yield bd(this.fetch,`${this.url}/bucket`,{id:n,name:n,public:r.public},{headers:this.headers})).name,error:null}}catch(s){return{data:null,error:s}}})}updateBucket(n,r){return Qu(this,void 0,void 0,function*(){try{return{data:yield zN(this.fetch,`${this.url}/bucket/${n}`,{id:n,name:n,public:r.public},{headers:this.headers}),error:null}}catch(s){return{data:null,error:s}}})}emptyBucket(n){return Qu(this,void 0,void 0,function*(){try{return{data:yield bd(this.fetch,`${this.url}/bucket/${n}/empty`,{},{headers:this.headers}),error:null}}catch(r){return{data:null,error:r}}})}deleteBucket(n){return Qu(this,void 0,void 0,function*(){try{return{data:yield oI(this.fetch,`${this.url}/bucket/${n}`,{},{headers:this.headers}),error:null}}catch(r){return{data:null,error:r}}})}}var il=globalThis&&globalThis.__awaiter||function(e,n,r,s){function c(h){return h instanceof r?h:new r(function(m){m(h)})}return new(r||(r=Promise))(function(h,m){function a(E){try{w(s.next(E))}catch(I){m(I)}}function v(E){try{w(s.throw(E))}catch(I){m(I)}}function w(E){E.done?h(E.value):c(E.value).then(a,v)}w((s=s.apply(e,n||[])).next())})};const BN={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},UN={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class NN{constructor(n,r={},s,c){this.url=n,this.headers=r,this.bucketId=s,this.fetch=c}uploadOrUpdate(n,r,s,c){return il(this,void 0,void 0,function*(){try{let h;const m=Object.assign(Object.assign({},UN),c),a=Object.assign(Object.assign({},this.headers),n==="POST"&&{"x-upsert":String(m.upsert)});typeof Blob!="undefined"&&s instanceof Blob?(h=new FormData,h.append("cacheControl",m.cacheControl),h.append("",s)):typeof FormData!="undefined"&&s instanceof FormData?(h=s,h.append("cacheControl",m.cacheControl)):(h=s,a["cache-control"]=`max-age=${m.cacheControl}`,a["content-type"]=m.contentType);const v=this._removeEmptyFolders(r),w=this._getFinalPath(v),E=yield ng(`${this.url}/object/${w}`,{method:n,body:h,headers:a});if(E.ok)return{data:{Key:w},error:null};{const I=yield E.json();return{data:null,error:I}}}catch(h){return{data:null,error:h}}})}upload(n,r,s){return il(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",n,r,s)})}update(n,r,s){return il(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",n,r,s)})}move(n,r){return il(this,void 0,void 0,function*(){try{return{data:yield bd(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:n,destinationKey:r},{headers:this.headers}),error:null}}catch(s){return{data:null,error:s}}})}createSignedUrl(n,r){return il(this,void 0,void 0,function*(){try{const s=this._getFinalPath(n);let c=yield bd(this.fetch,`${this.url}/object/sign/${s}`,{expiresIn:r},{headers:this.headers});const h=`${this.url}${c.signedURL}`;return c={signedURL:h},{data:c,error:null,signedURL:h}}catch(s){return{data:null,error:s,signedURL:null}}})}download(n){return il(this,void 0,void 0,function*(){try{const r=this._getFinalPath(n);return{data:yield(yield Pv(this.fetch,`${this.url}/object/${r}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(r){return{data:null,error:r}}})}getPublicUrl(n){try{const r=this._getFinalPath(n),s=`${this.url}/object/public/${r}`;return{data:{publicURL:s},error:null,publicURL:s}}catch(r){return{data:null,error:r,publicURL:null}}}remove(n){return il(this,void 0,void 0,function*(){try{return{data:yield oI(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:n},{headers:this.headers}),error:null}}catch(r){return{data:null,error:r}}})}list(n,r,s){return il(this,void 0,void 0,function*(){try{const c=Object.assign(Object.assign(Object.assign({},BN),r),{prefix:n||""});return{data:yield bd(this.fetch,`${this.url}/object/list/${this.bucketId}`,c,{headers:this.headers},s),error:null}}catch(c){return{data:null,error:c}}})}_getFinalPath(n){return`${this.bucketId}/${n}`}_removeEmptyFolders(n){return n.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}}class jN extends FN{constructor(n,r={},s){super(n,r,s)}from(n){return new NN(this.url,this.headers,n,this.fetch)}}var fy=globalThis&&globalThis.__awaiter||function(e,n,r,s){function c(h){return h instanceof r?h:new r(function(m){m(h)})}return new(r||(r=Promise))(function(h,m){function a(E){try{w(s.next(E))}catch(I){m(I)}}function v(E){try{w(s.throw(E))}catch(I){m(I)}}function w(E){E.done?h(E.value):c(E.value).then(a,v)}w((s=s.apply(e,n||[])).next())})};const $N={schema:"public",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,multiTab:!0,headers:JC};class VN{constructor(n,r,s){if(this.supabaseUrl=n,this.supabaseKey=r,!n)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const c=TU(n),h=Object.assign(Object.assign({},$N),s);this.restUrl=`${c}/rest/v1`,this.realtimeUrl=`${c}/realtime/v1`.replace("http","ws"),this.authUrl=`${c}/auth/v1`,this.storageUrl=`${c}/storage/v1`,this.schema=h.schema,this.multiTab=h.multiTab,this.fetch=h.fetch,this.headers=Object.assign(Object.assign({},JC),s==null?void 0:s.headers),this.auth=this._initSupabaseAuthClient(h),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},h.realtime)),this._listenForAuthEvents(),this._listenForMultiTabEvents()}get storage(){return new jN(this.storageUrl,this._getAuthHeaders(),this.fetch)}from(n){const r=`${this.restUrl}/${n}`;return new kN(r,{headers:this._getAuthHeaders(),schema:this.schema,realtime:this.realtime,table:n,fetch:this.fetch})}rpc(n,r,{head:s=!1,count:c=null}={}){return this._initPostgRESTClient().rpc(n,r,{head:s,count:c})}removeAllSubscriptions(){return fy(this,void 0,void 0,function*(){const n=this.getSubscriptions().slice(),r=n.map(c=>this.removeSubscription(c));return(yield Promise.all(r)).map(({error:c},h)=>({data:{subscription:n[h]},error:c}))})}removeSubscription(n){return fy(this,void 0,void 0,function*(){const{error:r}=yield this._closeSubscription(n),s=this.getSubscriptions(),c=s.filter(h=>h.isJoined()).length;return s.length===0&&(yield this.realtime.disconnect()),{data:{openSubscriptions:c},error:r}})}_closeSubscription(n){return fy(this,void 0,void 0,function*(){let r=null;if(!n.isClosed()){const{error:s}=yield this._unsubscribeSubscription(n);r=s}return this.realtime.remove(n),{error:r}})}_unsubscribeSubscription(n){return new Promise(r=>{n.unsubscribe().receive("ok",()=>r({error:null})).receive("error",s=>r({error:s})).receive("timeout",()=>r({error:new Error("timed out")}))})}getSubscriptions(){return this.realtime.channels}_initSupabaseAuthClient({autoRefreshToken:n,persistSession:r,detectSessionInUrl:s,localStorage:c,headers:h,fetch:m}){const a={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new jU({url:this.authUrl,headers:Object.assign(Object.assign({},h),a),autoRefreshToken:n,persistSession:r,detectSessionInUrl:s,localStorage:c,fetch:m})}_initRealtimeClient(n){return new IN(this.realtimeUrl,Object.assign(Object.assign({},n),{params:Object.assign(Object.assign({},n==null?void 0:n.params),{apikey:this.supabaseKey})}))}_initPostgRESTClient(){return new ZU(this.restUrl,{headers:this._getAuthHeaders(),schema:this.schema,fetch:this.fetch})}_getAuthHeaders(){var n,r;const s=this.headers,c=(r=(n=this.auth.session())===null||n===void 0?void 0:n.access_token)!==null&&r!==void 0?r:this.supabaseKey;return s.apikey=this.supabaseKey,s.Authorization=`Bearer ${c}`,s}_listenForMultiTabEvents(){if(!this.multiTab||!EU()||!(window==null?void 0:window.addEventListener))return null;try{return window==null?void 0:window.addEventListener("storage",n=>{var r,s,c;if(n.key===wU){const h=JSON.parse(String(n.newValue)),m=(s=(r=h==null?void 0:h.currentSession)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0,a=(c=this.auth.session())===null||c===void 0?void 0:c.access_token;m?!a&&m?this._handleTokenChanged("SIGNED_IN",m,"STORAGE"):a!==m&&this._handleTokenChanged("TOKEN_REFRESHED",m,"STORAGE"):this._handleTokenChanged("SIGNED_OUT",m,"STORAGE")}})}catch(n){return console.error("_listenForMultiTabEvents",n),null}}_listenForAuthEvents(){let{data:n}=this.auth.onAuthStateChange((r,s)=>{this._handleTokenChanged(r,s==null?void 0:s.access_token,"CLIENT")});return n}_handleTokenChanged(n,r,s){(n==="TOKEN_REFRESHED"||n==="SIGNED_IN")&&this.changedAccessToken!==r?(this.realtime.setAuth(r),s=="STORAGE"&&this.auth.setAuth(r),this.changedAccessToken=r):(n==="SIGNED_OUT"||n==="USER_DELETED")&&(this.realtime.setAuth(this.supabaseKey),s=="STORAGE"&&this.auth.signOut())}}const cj=(e,n,r)=>new VN(e,n,r);function Pr(e,n,...r){if(e in n){let c=n[e];return typeof c=="function"?c(...r):c}let s=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(n).map(c=>`"${c}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,Pr),s}function an(s){var c=s,{visible:e=!0,features:n=0}=c,r=cs(c,["visible","features"]);var h;if(e||n&2&&r.props.static)return dy(r);if(n&1){let m=((h=r.props.unmount)!=null?h:!0)?0:1;return Pr(m,{[0](){return null},[1](){return dy(Ei(Pt({},r),{props:Ei(Pt({},r.props),{hidden:!0,style:{display:"none"}})}))}})}return dy(r)}function dy({props:e,attrs:n,slots:r,slot:s,name:c}){var h;let w=Ml(e,["unmount","static"]),{as:m}=w,a=cs(w,["as"]),v=(h=r.default)==null?void 0:h.call(r,s);if(m==="template"){if(Object.keys(a).length>0||Object.keys(n).length>0){let[E,...I]=v!=null?v:[];if(!GN(E)||I.length>0)throw new Error(['Passing props on "template"!',"",`The current component <${c} /> is rendering a "template".`,"However we need to passthrough the following props:",Object.keys(a).concat(Object.keys(n)).map(M=>`  - ${M}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "template".',"Render a single element as the child so that we can forward the props onto that element."].map(M=>`  - ${M}`).join(`
`)].join(`
`));return Bc(E,a)}return Array.isArray(v)&&v.length===1?v[0]:v}return yo(m,a,v)}function Ml(e,n=[]){let r=Object.assign({},e);for(let s of n)s in r&&delete r[s];return r}function GN(e){return e==null?!1:typeof e.type=="string"||typeof e.type=="object"||typeof e.type=="function"}var qN=0;function ZN(){return++qN}function Qn(){return ZN()}function WN(e){throw new Error("Unexpected object: "+e)}function $x(e,n){let r=n.resolveItems();if(r.length<=0)return null;let s=n.resolveActiveIndex(),c=s!=null?s:-1,h=(()=>{switch(e.focus){case 0:return r.findIndex(m=>!n.resolveDisabled(m));case 1:{let m=r.slice().reverse().findIndex((a,v,w)=>c!==-1&&w.length-v-1>=c?!1:!n.resolveDisabled(a));return m===-1?m:r.length-1-m}case 2:return r.findIndex((m,a)=>a<=c?!1:!n.resolveDisabled(m));case 3:{let m=r.slice().reverse().findIndex(a=>!n.resolveDisabled(a));return m===-1?m:r.length-1-m}case 4:return r.findIndex(m=>n.resolveId(m)===e.id);case 5:return null;default:WN(e)}})();return h===-1?s:h}function pt(e){return e==null||e.value==null?null:"$el"in e.value?e.value.$el:e.value}function Ko(e,n,r){typeof window!="undefined"&&dr(s=>{window.addEventListener(e,n,r),s(()=>{window.removeEventListener(e,n,r)})})}var sI=Symbol("Context");function HN(){return ba()!==null}function ba(){return kn(sI,null)}function Nh(e){fr(sI,e)}function q2(e,n){if(e)return e;let r=n!=null?n:"button";if(typeof r=="string"&&r.toLowerCase()==="button")return"button"}function qc(e,n){let r=ft(q2(e.value.type,e.value.as));return cr(()=>{r.value=q2(e.value.type,e.value.as)}),dr(()=>{var s;r.value||!pt(n)||pt(n)instanceof HTMLButtonElement&&!((s=pt(n))==null?void 0:s.hasAttribute("type"))&&(r.value="button")}),r}function Vx({container:e,accept:n,walk:r,enabled:s}){dr(()=>{let c=e.value;if(!c||s!==void 0&&!s.value)return;let h=Object.assign(a=>n(a),{acceptNode:n}),m=document.createTreeWalker(c,NodeFilter.SHOW_ELEMENT,h,!1);for(;m.nextNode();)r(m.currentNode)})}var aI=Symbol("ComboboxContext");function jh(e){let n=kn(aI,null);if(n===null){let r=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,jh),r}return n}Yt({name:"Combobox",emits:{"update:modelValue":e=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},modelValue:{type:[Object,String,Number,Boolean]}},setup(e,{slots:n,attrs:r,emit:s}){let c=ft(1),h=ft(null),m=ft(null),a=ft(null),v=ft(null),w=ft({static:!1,hold:!1}),E=ft([]),I=ft(null),M=Et(()=>e.modelValue),P={comboboxState:c,value:M,inputRef:m,labelRef:h,buttonRef:a,optionsRef:v,disabled:Et(()=>e.disabled),options:E,activeOptionIndex:I,inputPropsRef:ft({displayValue:void 0}),optionsPropsRef:w,closeCombobox(){e.disabled||c.value!==1&&(c.value=1,I.value=null)},openCombobox(){e.disabled||c.value!==0&&(c.value=0)},goToOption(N,q){if(e.disabled||v.value&&!w.value.static&&c.value===1)return;let V=$x(N===4?{focus:4,id:q}:{focus:N},{resolveItems:()=>E.value,resolveActiveIndex:()=>I.value,resolveId:ee=>ee.id,resolveDisabled:ee=>ee.dataRef.disabled});I.value!==V&&(I.value=V)},syncInputValue(){let N=P.value.value;if(!pt(P.inputRef)||N===void 0)return;let q=P.inputPropsRef.value.displayValue;typeof q=="function"?P.inputRef.value.value=q(N):typeof N=="string"&&(P.inputRef.value.value=N)},selectOption(N){let q=E.value.find(ee=>ee.id===N);if(!q)return;let{dataRef:V}=q;s("update:modelValue",V.value),P.syncInputValue()},selectActiveOption(){if(I.value===null)return;let{dataRef:N}=E.value[I.value];s("update:modelValue",N.value),P.syncInputValue()},registerOption(N,q){var V,ee;let oe=I.value!==null?E.value[I.value]:null,pe=Array.from((ee=(V=v.value)==null?void 0:V.querySelectorAll('[id^="headlessui-combobox-option-"]'))!=null?ee:[]).reduce((se,xe,Te)=>Object.assign(se,{[xe.id]:Te}),{});E.value=[...E.value,{id:N,dataRef:q}].sort((se,xe)=>pe[se.id]-pe[xe.id]),I.value=(()=>oe===null?null:E.value.indexOf(oe))()},unregisterOption(N){let q=E.value.slice(),V=I.value!==null?q[I.value]:null,ee=q.findIndex(oe=>oe.id===N);ee!==-1&&q.splice(ee,1),E.value=q,I.value=(()=>ee===I.value||V===null?null:q.indexOf(V))()}};Ko("mousedown",N=>{var q,V,ee;let oe=N.target;c.value===0&&(((q=pt(m))==null?void 0:q.contains(oe))||((V=pt(a))==null?void 0:V.contains(oe))||((ee=pt(v))==null?void 0:ee.contains(oe))||P.closeCombobox())}),gi([P.value,P.inputRef],()=>P.syncInputValue(),{immediate:!0}),fr(aI,P),Nh(Et(()=>Pr(c.value,{[0]:0,[1]:1})));let j=Et(()=>I.value===null?null:E.value[I.value].dataRef.value);return()=>{let N={open:c.value===0,disabled:e.disabled,activeIndex:I.value,activeOption:j.value};return an({props:Ml(e,["modelValue","onUpdate:modelValue","disabled"]),slot:N,slots:n,attrs:r,name:"Combobox"})}}});Yt({name:"ComboboxLabel",props:{as:{type:[Object,String],default:"label"}},setup(e,{attrs:n,slots:r}){let s=jh("ComboboxLabel"),c=`headlessui-combobox-label-${Qn()}`;function h(){var m;(m=pt(s.inputRef))==null||m.focus({preventScroll:!0})}return()=>{let m={open:s.comboboxState.value===0,disabled:s.disabled.value},a={id:c,ref:s.labelRef,onClick:h};return an({props:Pt(Pt({},e),a),slot:m,attrs:n,slots:r,name:"ComboboxLabel"})}}});Yt({name:"ComboboxButton",props:{as:{type:[Object,String],default:"button"}},setup(e,{attrs:n,slots:r}){let s=jh("ComboboxButton"),c=`headlessui-combobox-button-${Qn()}`;function h(v){s.disabled.value||(s.comboboxState.value===0?s.closeCombobox():(v.preventDefault(),s.openCombobox()),Yn(()=>{var w;return(w=pt(s.inputRef))==null?void 0:w.focus({preventScroll:!0})}))}function m(v){switch(v.key){case"ArrowDown":v.preventDefault(),v.stopPropagation(),s.comboboxState.value===1&&(s.openCombobox(),Yn(()=>{s.value.value||s.goToOption(0)})),Yn(()=>{var w;return(w=s.inputRef.value)==null?void 0:w.focus({preventScroll:!0})});return;case"ArrowUp":v.preventDefault(),v.stopPropagation(),s.comboboxState.value===1&&(s.openCombobox(),Yn(()=>{s.value.value||s.goToOption(3)})),Yn(()=>{var w;return(w=s.inputRef.value)==null?void 0:w.focus({preventScroll:!0})});return;case"Escape":v.preventDefault(),s.optionsRef.value&&!s.optionsPropsRef.value.static&&v.stopPropagation(),s.closeCombobox(),Yn(()=>{var w;return(w=s.inputRef.value)==null?void 0:w.focus({preventScroll:!0})});return}}let a=qc(Et(()=>({as:e.as,type:n.type})),s.buttonRef);return()=>{var v,w;let E={open:s.comboboxState.value===0,disabled:s.disabled.value},I={ref:s.buttonRef,id:c,type:a.value,tabindex:"-1","aria-haspopup":!0,"aria-controls":(v=pt(s.optionsRef))==null?void 0:v.id,"aria-expanded":s.disabled.value?void 0:s.comboboxState.value===0,"aria-labelledby":s.labelRef.value?[(w=pt(s.labelRef))==null?void 0:w.id,c].join(" "):void 0,disabled:s.disabled.value===!0?!0:void 0,onKeydown:m,onClick:h};return an({props:Pt(Pt({},e),I),slot:E,attrs:n,slots:r,name:"ComboboxButton"})}}});Yt({name:"ComboboxInput",props:{as:{type:[Object,String],default:"input"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},displayValue:{type:Function}},emits:{change:e=>!0},setup(e,{emit:n,attrs:r,slots:s}){let c=jh("ComboboxInput"),h=`headlessui-combobox-input-${Qn()}`;c.inputPropsRef=Et(()=>e);function m(v){switch(v.key){case"Enter":v.preventDefault(),v.stopPropagation(),c.selectActiveOption(),c.closeCombobox();break;case"ArrowDown":return v.preventDefault(),v.stopPropagation(),Pr(c.comboboxState.value,{[0]:()=>c.goToOption(2),[1]:()=>{c.openCombobox(),Yn(()=>{c.value.value||c.goToOption(0)})}});case"ArrowUp":return v.preventDefault(),v.stopPropagation(),Pr(c.comboboxState.value,{[0]:()=>c.goToOption(1),[1]:()=>{c.openCombobox(),Yn(()=>{c.value.value||c.goToOption(3)})}});case"Home":case"PageUp":return v.preventDefault(),v.stopPropagation(),c.goToOption(0);case"End":case"PageDown":return v.preventDefault(),v.stopPropagation(),c.goToOption(3);case"Escape":v.preventDefault(),c.optionsRef.value&&!c.optionsPropsRef.value.static&&v.stopPropagation(),c.closeCombobox();break;case"Tab":c.selectActiveOption(),c.closeCombobox();break}}function a(v){c.openCombobox(),n("change",v)}return()=>{var v,w,E,I,M;let P={open:c.comboboxState.value===0},j={"aria-controls":(v=c.optionsRef.value)==null?void 0:v.id,"aria-expanded":c.disabled?void 0:c.comboboxState.value===0,"aria-activedescendant":c.activeOptionIndex.value===null||(w=c.options.value[c.activeOptionIndex.value])==null?void 0:w.id,"aria-labelledby":(M=(E=pt(c.labelRef))==null?void 0:E.id)!=null?M:(I=pt(c.buttonRef))==null?void 0:I.id,id:h,onKeydown:m,onChange:a,onInput:a,role:"combobox",type:"text",tabIndex:0,ref:c.inputRef},N=Ml(e,["displayValue"]);return an({props:Pt(Pt({},N),j),slot:P,attrs:r,slots:s,features:3,name:"ComboboxInput"})}}});Yt({name:"ComboboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},hold:{type:[Boolean],default:!1}},setup(e,{attrs:n,slots:r}){let s=jh("ComboboxOptions"),c=`headlessui-combobox-options-${Qn()}`;dr(()=>{s.optionsPropsRef.value.static=e.static}),dr(()=>{s.optionsPropsRef.value.hold=e.hold});let h=ba(),m=Et(()=>h!==null?h.value===0:s.comboboxState.value===0);return Vx({container:Et(()=>pt(s.optionsRef)),enabled:Et(()=>s.comboboxState.value===0),accept(a){return a.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:a.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(a){a.setAttribute("role","none")}}),()=>{var a,v,w,E;let I={open:s.comboboxState.value===0},M={"aria-activedescendant":s.activeOptionIndex.value===null||(a=s.options.value[s.activeOptionIndex.value])==null?void 0:a.id,"aria-labelledby":(E=(v=pt(s.labelRef))==null?void 0:v.id)!=null?E:(w=pt(s.buttonRef))==null?void 0:w.id,id:c,ref:s.optionsRef,role:"listbox"},P=Ml(e,["hold"]);return an({props:Pt(Pt({},P),M),slot:I,attrs:n,slots:r,features:3,visible:m.value,name:"ComboboxOptions"})}}});Yt({name:"ComboboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1}},setup(e,{slots:n,attrs:r}){let s=jh("ComboboxOption"),c=`headlessui-combobox-option-${Qn()}`,h=Et(()=>s.activeOptionIndex.value!==null?s.options.value[s.activeOptionIndex.value].id===c:!1),m=Et(()=>un(s.value.value)===un(e.value)),a=Et(()=>({disabled:e.disabled,value:e.value}));cr(()=>s.registerOption(c,a)),Cr(()=>s.unregisterOption(c)),cr(()=>{gi([s.comboboxState,m],()=>{s.comboboxState.value===0&&(!m.value||s.goToOption(4,c))},{immediate:!0})}),dr(()=>{s.comboboxState.value===0&&(!h.value||Yn(()=>{var M,P;return(P=(M=document.getElementById(c))==null?void 0:M.scrollIntoView)==null?void 0:P.call(M,{block:"nearest"})}))});function v(M){if(e.disabled)return M.preventDefault();s.selectOption(c),s.closeCombobox(),Yn(()=>{var P;return(P=pt(s.inputRef))==null?void 0:P.focus({preventScroll:!0})})}function w(){if(e.disabled)return s.goToOption(5);s.goToOption(4,c)}function E(){e.disabled||h.value||s.goToOption(4,c)}function I(){e.disabled||!h.value||s.optionsPropsRef.value.hold||s.goToOption(5)}return()=>{let{disabled:M}=e,P={active:h.value,selected:m.value,disabled:M},j={id:c,role:"option",tabIndex:M===!0?void 0:-1,"aria-disabled":M===!0?!0:void 0,"aria-selected":m.value===!0?m.value:void 0,disabled:void 0,onClick:v,onFocus:w,onPointermove:E,onMousemove:E,onPointerleave:I,onMouseleave:I};return an({props:Pt(Pt({},e),j),slot:P,attrs:r,slots:n,name:"ComboboxOption"})}}});var Dv=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(",");function R_(e=document.body){return e==null?[]:Array.from(e.querySelectorAll(Dv))}function XN(e,n=0){return e===document.body?!1:Pr(n,{[0](){return e.matches(Dv)},[1](){let r=e;for(;r!==null;){if(r.matches(Dv))return!0;r=r.parentElement}return!1}})}function Kf(e){e==null||e.focus({preventScroll:!0})}function pi(e,n){let r=Array.isArray(e)?e.slice().sort((E,I)=>{let M=E.compareDocumentPosition(I);return M&Node.DOCUMENT_POSITION_FOLLOWING?-1:M&Node.DOCUMENT_POSITION_PRECEDING?1:0}):R_(e),s=document.activeElement,c=(()=>{if(n&5)return 1;if(n&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),h=(()=>{if(n&1)return 0;if(n&2)return Math.max(0,r.indexOf(s))-1;if(n&4)return Math.max(0,r.indexOf(s))+1;if(n&8)return r.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),m=n&32?{preventScroll:!0}:{},a=0,v=r.length,w;do{if(a>=v||a+v<=0)return 0;let E=h+a;if(n&16)E=(E+v)%v;else{if(E<0)return 3;if(E>=v)return 1}w=r[E],w==null||w.focus(m),a+=c}while(w!==document.activeElement);return w.hasAttribute("tabindex")||w.setAttribute("tabindex","0"),2}function Rv(e,n){for(let r of e)if(r.contains(n))return!0;return!1}function lI(e,n=ft(!0),r=ft({})){let s=ft(typeof window!="undefined"?document.activeElement:null),c=ft(null);function h(){if(!n.value||e.value.size!==1)return;let{initialFocus:a}=r.value,v=document.activeElement;if(a){if(a===v)return}else if(Rv(e.value,v))return;if(s.value=v,a)Kf(a);else{let w=!1;for(let E of e.value)if(pi(E,1)===2){w=!0;break}w||console.warn("There are no focusable elements inside the <FocusTrap />")}c.value=document.activeElement}function m(){Kf(s.value),s.value=null,c.value=null}dr(h),Z_(()=>{n.value?h():m()}),Cr(m),Ko("keydown",a=>{if(!!n.value&&a.key==="Tab"&&!!document.activeElement&&e.value.size===1){a.preventDefault();for(let v of e.value)if(pi(v,(a.shiftKey?2:4)|16)===2){c.value=document.activeElement;break}}}),Ko("focus",a=>{if(!n.value||e.value.size!==1)return;let v=c.value;if(!v)return;let w=a.target;w&&w instanceof HTMLElement?Rv(e.value,w)?(c.value=w,Kf(w)):(a.preventDefault(),a.stopPropagation(),Kf(v)):Kf(c.value)},!0)}var Z2="body > *",Ju=new Set,sl=new Map;function W2(e){e.setAttribute("aria-hidden","true"),e.inert=!0}function H2(e){let n=sl.get(e);!n||(n["aria-hidden"]===null?e.removeAttribute("aria-hidden"):e.setAttribute("aria-hidden",n["aria-hidden"]),e.inert=n.inert)}function KN(e,n=ft(!0)){dr(r=>{if(!n.value||!e.value)return;let s=e.value;Ju.add(s);for(let c of sl.keys())c.contains(s)&&(H2(c),sl.delete(c));document.querySelectorAll(Z2).forEach(c=>{if(c instanceof HTMLElement){for(let h of Ju)if(c.contains(h))return;Ju.size===1&&(sl.set(c,{"aria-hidden":c.getAttribute("aria-hidden"),inert:c.inert}),W2(c))}}),r(()=>{if(Ju.delete(s),Ju.size>0)document.querySelectorAll(Z2).forEach(c=>{if(c instanceof HTMLElement&&!sl.has(c)){for(let h of Ju)if(c.contains(h))return;sl.set(c,{"aria-hidden":c.getAttribute("aria-hidden"),inert:c.inert}),W2(c)}});else for(let c of sl.keys())H2(c),sl.delete(c)})})}var cI=Symbol("StackContext");function uI(){return kn(cI,()=>{})}function YN(e){let n=uI();dr(r=>{let s=e==null?void 0:e.value;!s||(n(0,s),r(()=>n(1,s)))})}function hI(e){let n=uI();function r(...s){e==null||e(...s),n(...s)}fr(cI,r)}var fI=Symbol("ForcePortalRootContext");function QN(){return kn(fI,!1)}var X2=Yt({name:"ForcePortalRoot",props:{as:{type:[Object,String],default:"template"},force:{type:Boolean,default:!1}},setup(e,{slots:n,attrs:r}){return fr(fI,e.force),()=>{let h=e,{force:s}=h,c=cs(h,["force"]);return an({props:c,slot:{},slots:n,attrs:r,name:"ForcePortalRoot"})}}});function JN(){let e=document.getElementById("headlessui-portal-root");if(e)return e;let n=document.createElement("div");return n.setAttribute("id","headlessui-portal-root"),document.body.appendChild(n)}var e8=Yt({name:"Portal",props:{as:{type:[Object,String],default:"div"}},setup(e,{slots:n,attrs:r}){let s=QN(),c=kn(dI,null),h=ft(s===!0||c===null?JN():c.resolveTarget());dr(()=>{s||c!==null&&(h.value=c.resolveTarget())});let m=ft(null);return YN(m),Cr(()=>{var a;let v=document.getElementById("headlessui-portal-root");!v||h.value===v&&h.value.children.length<=0&&((a=h.value.parentElement)==null||a.removeChild(h.value))}),hI(),()=>{if(h.value===null)return null;let a={ref:m};return yo(T3,{to:h.value},an({props:Pt(Pt({},e),a),slot:{},attrs:r,slots:n,name:"Portal"}))}}}),dI=Symbol("PortalGroupContext"),t8=Yt({name:"PortalGroup",props:{as:{type:[Object,String],default:"template"},target:{type:Object,default:null}},setup(e,{attrs:n,slots:r}){let s=Al({resolveTarget(){return e.target}});return fr(dI,s),()=>{let m=e,{target:c}=m,h=cs(m,["target"]);return an({props:h,slot:{},attrs:n,slots:r,name:"PortalGroup"})}}}),pI=Symbol("DescriptionContext");function n8(){let e=kn(pI,null);if(e===null)throw new Error("Missing parent");return e}function og({slot:e=ft({}),name:n="Description",props:r={}}={}){let s=ft([]);function c(h){return s.value.push(h),()=>{let m=s.value.indexOf(h);m!==-1&&s.value.splice(m,1)}}return fr(pI,{register:c,slot:e,name:n,props:r}),Et(()=>s.value.length>0?s.value.join(" "):void 0)}Yt({name:"Description",props:{as:{type:[Object,String],default:"p"}},setup(e,{attrs:n,slots:r}){let s=n8(),c=`headlessui-description-${Qn()}`;return cr(()=>Cr(s.register(c))),()=>{let{name:h="Description",slot:m=ft({}),props:a={}}=s,v=e,w=Ei(Pt({},Object.entries(a).reduce((E,[I,M])=>Object.assign(E,{[I]:qo(M)}),{})),{id:c});return an({props:Pt(Pt({},v),w),slot:m.value,attrs:n,slots:r,name:h})}}});var mI=Symbol("DialogContext");function Gx(e){let n=kn(mI,null);if(n===null){let r=new Error(`<${e} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Gx),r}return n}var zm="DC8F892D-2EBD-447C-A4C8-A03058436FF4",uj=Yt({name:"Dialog",inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},open:{type:[Boolean,String],default:zm},initialFocus:{type:Object,default:null}},emits:{close:e=>!0},setup(e,{emit:n,attrs:r,slots:s}){let c=ft(new Set),h=ba(),m=Et(()=>e.open===zm&&h!==null?Pr(h.value,{[0]:!0,[1]:!1}):e.open);if(!(e.open!==zm||h!==null))throw new Error("You forgot to provide an `open` prop to the `Dialog`.");if(typeof m.value!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${m.value===zm?void 0:e.open}`);let a=Et(()=>e.open?0:1),v=Et(()=>h!==null?h.value===0:a.value===0),w=ft(null),E=ft(a.value===0);Z_(()=>{E.value=a.value===0});let I=`headlessui-dialog-${Qn()}`,M=Et(()=>({initialFocus:e.initialFocus}));lI(c,E,M),KN(w,E),hI((V,ee)=>Pr(V,{[0](){c.value.add(ee)},[1](){c.value.delete(ee)}}));let P=og({name:"DialogDescription",slot:Et(()=>({open:m.value}))}),j=ft(null),N={titleId:j,dialogState:a,setTitleId(V){j.value!==V&&(j.value=V)},close(){n("close",!1)}};fr(mI,N),Ko("mousedown",V=>{let ee=V.target;a.value===0&&c.value.size===1&&(Rv(c.value,ee)||(N.close(),Yn(()=>ee==null?void 0:ee.focus())))}),Ko("keydown",V=>{V.key==="Escape"&&a.value===0&&(c.value.size>1||(V.preventDefault(),V.stopPropagation(),N.close()))}),dr(V=>{if(a.value!==0)return;let ee=document.documentElement.style.overflow,oe=document.documentElement.style.paddingRight,pe=window.innerWidth-document.documentElement.clientWidth;document.documentElement.style.overflow="hidden",document.documentElement.style.paddingRight=`${pe}px`,V(()=>{document.documentElement.style.overflow=ee,document.documentElement.style.paddingRight=oe})}),dr(V=>{if(a.value!==0)return;let ee=pt(w);if(!ee)return;let oe=new IntersectionObserver(pe=>{for(let se of pe)se.boundingClientRect.x===0&&se.boundingClientRect.y===0&&se.boundingClientRect.width===0&&se.boundingClientRect.height===0&&N.close()});oe.observe(ee),V(()=>oe.disconnect())});function q(V){V.stopPropagation()}return()=>{let V=Ei(Pt({},r),{ref:w,id:I,role:"dialog","aria-modal":a.value===0?!0:void 0,"aria-labelledby":j.value,"aria-describedby":P.value,onClick:q}),xe=e,{open:ee,initialFocus:oe}=xe,pe=cs(xe,["open","initialFocus"]),se={open:a.value===0};return yo(X2,{force:!0},()=>yo(e8,()=>yo(t8,{target:w.value},()=>yo(X2,{force:!1},()=>an({props:Pt(Pt({},pe),V),slot:se,attrs:r,slots:s,visible:v.value,features:3,name:"Dialog"})))))}}}),hj=Yt({name:"DialogOverlay",props:{as:{type:[Object,String],default:"div"}},setup(e,{attrs:n,slots:r}){let s=Gx("DialogOverlay"),c=`headlessui-dialog-overlay-${Qn()}`;function h(m){m.target===m.currentTarget&&(m.preventDefault(),m.stopPropagation(),s.close())}return()=>an({props:Ei(Pt({},e),{id:c,"aria-hidden":!0,onClick:h}),slot:{open:s.dialogState.value===0},attrs:n,slots:r,name:"DialogOverlay"})}}),fj=Yt({name:"DialogTitle",props:{as:{type:[Object,String],default:"h2"}},setup(e,{attrs:n,slots:r}){let s=Gx("DialogTitle"),c=`headlessui-dialog-title-${Qn()}`;return cr(()=>{s.setTitleId(c),Cr(()=>s.setTitleId(null))}),()=>an({props:Ei(Pt({},e),{id:c}),slot:{open:s.dialogState.value===0},attrs:n,slots:r,name:"DialogTitle"})}}),_I=Symbol("DisclosureContext");function qx(e){let n=kn(_I,null);if(n===null){let r=new Error(`<${e} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,qx),r}return n}var gI=Symbol("DisclosurePanelContext");function r8(){return kn(gI,null)}Yt({name:"Disclosure",props:{as:{type:[Object,String],default:"template"},defaultOpen:{type:[Boolean],default:!1}},setup(e,{slots:n,attrs:r}){let s=`headlessui-disclosure-button-${Qn()}`,c=`headlessui-disclosure-panel-${Qn()}`,h=ft(e.defaultOpen?0:1),m=ft(null),a=ft(null),v={buttonId:s,panelId:c,disclosureState:h,panel:m,button:a,toggleDisclosure(){h.value=Pr(h.value,{[0]:1,[1]:0})},closeDisclosure(){h.value!==1&&(h.value=1)},close(w){v.closeDisclosure();let E=(()=>w?w instanceof HTMLElement?w:w.value instanceof HTMLElement?pt(w):pt(v.button):pt(v.button))();E==null||E.focus()}};return fr(_I,v),Nh(Et(()=>Pr(h.value,{[0]:0,[1]:1}))),()=>{let M=e,{defaultOpen:w}=M,E=cs(M,["defaultOpen"]),I={open:h.value===0,close:v.close};return an({props:E,slot:I,slots:n,attrs:r,name:"Disclosure"})}}});Yt({name:"DisclosureButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1}},setup(e,{attrs:n,slots:r}){let s=qx("DisclosureButton"),c=r8(),h=c===null?!1:c===s.panelId,m=ft(null);h||dr(()=>{s.button.value=m.value});let a=qc(Et(()=>({as:e.as,type:n.type})),m);function v(){var I;e.disabled||(h?(s.toggleDisclosure(),(I=pt(s.button))==null||I.focus()):s.toggleDisclosure())}function w(I){var M;if(!e.disabled)if(h)switch(I.key){case" ":case"Enter":I.preventDefault(),I.stopPropagation(),s.toggleDisclosure(),(M=pt(s.button))==null||M.focus();break}else switch(I.key){case" ":case"Enter":I.preventDefault(),I.stopPropagation(),s.toggleDisclosure();break}}function E(I){switch(I.key){case" ":I.preventDefault();break}}return()=>{let I={open:s.disclosureState.value===0},M=h?{ref:m,type:a.value,onClick:v,onKeydown:w}:{id:s.buttonId,ref:m,type:a.value,"aria-expanded":e.disabled?void 0:s.disclosureState.value===0,"aria-controls":pt(s.panel)?s.panelId:void 0,disabled:e.disabled?!0:void 0,onClick:v,onKeydown:w,onKeyup:E};return an({props:Pt(Pt({},e),M),slot:I,attrs:n,slots:r,name:"DisclosureButton"})}}});Yt({name:"DisclosurePanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0}},setup(e,{attrs:n,slots:r}){let s=qx("DisclosurePanel");fr(gI,s.panelId);let c=ba(),h=Et(()=>c!==null?c.value===0:s.disclosureState.value===0);return()=>{let m={open:s.disclosureState.value===0,close:s.close},a={id:s.panelId,ref:s.panel};return an({props:Pt(Pt({},e),a),slot:m,attrs:n,slots:r,features:3,visible:h.value,name:"DisclosurePanel"})}}});Yt({name:"FocusTrap",props:{as:{type:[Object,String],default:"div"},initialFocus:{type:Object,default:null}},setup(e,{attrs:n,slots:r}){let s=ft(new Set),c=ft(null),h=ft(!0),m=Et(()=>({initialFocus:e.initialFocus}));return cr(()=>{!c.value||(s.value.add(c.value),lI(s,h,m))}),Cr(()=>{h.value=!1}),()=>{let a={},v={ref:c},I=e,{initialFocus:w}=I,E=cs(I,["initialFocus"]);return an({props:Pt(Pt({},E),v),slot:a,attrs:n,slots:r,name:"FocusTrap"})}}});function i8(e){requestAnimationFrame(()=>requestAnimationFrame(e))}var yI=Symbol("ListboxContext");function Xd(e){let n=kn(yI,null);if(n===null){let r=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Xd),r}return n}var dj=Yt({name:"Listbox",emits:{"update:modelValue":e=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},horizontal:{type:[Boolean],default:!1},modelValue:{type:[Object,String,Number,Boolean]}},setup(e,{slots:n,attrs:r,emit:s}){let c=ft(1),h=ft(null),m=ft(null),a=ft(null),v=ft([]),w=ft(""),E=ft(null),I=Et(()=>e.modelValue),M={listboxState:c,value:I,orientation:Et(()=>e.horizontal?"horizontal":"vertical"),labelRef:h,buttonRef:m,optionsRef:a,disabled:Et(()=>e.disabled),options:v,searchQuery:w,activeOptionIndex:E,closeListbox(){e.disabled||c.value!==1&&(c.value=1,E.value=null)},openListbox(){e.disabled||c.value!==0&&(c.value=0)},goToOption(P,j){if(e.disabled||c.value===1)return;let N=$x(P===4?{focus:4,id:j}:{focus:P},{resolveItems:()=>v.value,resolveActiveIndex:()=>E.value,resolveId:q=>q.id,resolveDisabled:q=>q.dataRef.disabled});w.value===""&&E.value===N||(w.value="",E.value=N)},search(P){if(e.disabled||c.value===1)return;let j=w.value!==""?0:1;w.value+=P.toLowerCase();let N=(E.value!==null?v.value.slice(E.value+j).concat(v.value.slice(0,E.value+j)):v.value).find(V=>V.dataRef.textValue.startsWith(w.value)&&!V.dataRef.disabled),q=N?v.value.indexOf(N):-1;q===-1||q===E.value||(E.value=q)},clearSearch(){e.disabled||c.value!==1&&w.value!==""&&(w.value="")},registerOption(P,j){var N,q;let V=Array.from((q=(N=a.value)==null?void 0:N.querySelectorAll('[id^="headlessui-listbox-option-"]'))!=null?q:[]).reduce((ee,oe,pe)=>Object.assign(ee,{[oe.id]:pe}),{});v.value=[...v.value,{id:P,dataRef:j}].sort((ee,oe)=>V[ee.id]-V[oe.id])},unregisterOption(P){let j=v.value.slice(),N=E.value!==null?j[E.value]:null,q=j.findIndex(V=>V.id===P);q!==-1&&j.splice(q,1),v.value=j,E.value=(()=>q===E.value||N===null?null:j.indexOf(N))()},select(P){e.disabled||s("update:modelValue",P)}};return Ko("mousedown",P=>{var j,N,q;let V=P.target,ee=document.activeElement;c.value===0&&(((j=pt(m))==null?void 0:j.contains(V))||(((N=pt(a))==null?void 0:N.contains(V))||M.closeListbox(),!(ee!==document.body&&(ee==null?void 0:ee.contains(V)))&&(P.defaultPrevented||(q=pt(m))==null||q.focus({preventScroll:!0}))))}),fr(yI,M),Nh(Et(()=>Pr(c.value,{[0]:0,[1]:1}))),()=>{let P={open:c.value===0,disabled:e.disabled};return an({props:Ml(e,["modelValue","onUpdate:modelValue","disabled","horizontal"]),slot:P,slots:n,attrs:r,name:"Listbox"})}}}),pj=Yt({name:"ListboxLabel",props:{as:{type:[Object,String],default:"label"}},setup(e,{attrs:n,slots:r}){let s=Xd("ListboxLabel"),c=`headlessui-listbox-label-${Qn()}`;function h(){var m;(m=pt(s.buttonRef))==null||m.focus({preventScroll:!0})}return()=>{let m={open:s.listboxState.value===0,disabled:s.disabled.value},a={id:c,ref:s.labelRef,onClick:h};return an({props:Pt(Pt({},e),a),slot:m,attrs:n,slots:r,name:"ListboxLabel"})}}}),mj=Yt({name:"ListboxButton",props:{as:{type:[Object,String],default:"button"}},setup(e,{attrs:n,slots:r}){let s=Xd("ListboxButton"),c=`headlessui-listbox-button-${Qn()}`;function h(w){switch(w.key){case" ":case"Enter":case"ArrowDown":w.preventDefault(),s.openListbox(),Yn(()=>{var E;(E=pt(s.optionsRef))==null||E.focus({preventScroll:!0}),s.value.value||s.goToOption(0)});break;case"ArrowUp":w.preventDefault(),s.openListbox(),Yn(()=>{var E;(E=pt(s.optionsRef))==null||E.focus({preventScroll:!0}),s.value.value||s.goToOption(3)});break}}function m(w){switch(w.key){case" ":w.preventDefault();break}}function a(w){s.disabled.value||(s.listboxState.value===0?(s.closeListbox(),Yn(()=>{var E;return(E=pt(s.buttonRef))==null?void 0:E.focus({preventScroll:!0})})):(w.preventDefault(),s.openListbox(),i8(()=>{var E;return(E=pt(s.optionsRef))==null?void 0:E.focus({preventScroll:!0})})))}let v=qc(Et(()=>({as:e.as,type:n.type})),s.buttonRef);return()=>{var w,E;let I={open:s.listboxState.value===0,disabled:s.disabled.value},M={ref:s.buttonRef,id:c,type:v.value,"aria-haspopup":!0,"aria-controls":(w=pt(s.optionsRef))==null?void 0:w.id,"aria-expanded":s.disabled.value?void 0:s.listboxState.value===0,"aria-labelledby":s.labelRef.value?[(E=pt(s.labelRef))==null?void 0:E.id,c].join(" "):void 0,disabled:s.disabled.value===!0?!0:void 0,onKeydown:h,onKeyup:m,onClick:a};return an({props:Pt(Pt({},e),M),slot:I,attrs:n,slots:r,name:"ListboxButton"})}}}),_j=Yt({name:"ListboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0}},setup(e,{attrs:n,slots:r}){let s=Xd("ListboxOptions"),c=`headlessui-listbox-options-${Qn()}`,h=ft(null);function m(w){switch(h.value&&clearTimeout(h.value),w.key){case" ":if(s.searchQuery.value!=="")return w.preventDefault(),w.stopPropagation(),s.search(w.key);case"Enter":if(w.preventDefault(),w.stopPropagation(),s.activeOptionIndex.value!==null){let{dataRef:E}=s.options.value[s.activeOptionIndex.value];s.select(E.value)}s.closeListbox(),Yn(()=>{var E;return(E=pt(s.buttonRef))==null?void 0:E.focus({preventScroll:!0})});break;case Pr(s.orientation.value,{vertical:"ArrowDown",horizontal:"ArrowRight"}):return w.preventDefault(),w.stopPropagation(),s.goToOption(2);case Pr(s.orientation.value,{vertical:"ArrowUp",horizontal:"ArrowLeft"}):return w.preventDefault(),w.stopPropagation(),s.goToOption(1);case"Home":case"PageUp":return w.preventDefault(),w.stopPropagation(),s.goToOption(0);case"End":case"PageDown":return w.preventDefault(),w.stopPropagation(),s.goToOption(3);case"Escape":w.preventDefault(),w.stopPropagation(),s.closeListbox(),Yn(()=>{var E;return(E=pt(s.buttonRef))==null?void 0:E.focus({preventScroll:!0})});break;case"Tab":w.preventDefault(),w.stopPropagation();break;default:w.key.length===1&&(s.search(w.key),h.value=setTimeout(()=>s.clearSearch(),350));break}}let a=ba(),v=Et(()=>a!==null?a.value===0:s.listboxState.value===0);return()=>{var w,E,I,M;let P={open:s.listboxState.value===0},j={"aria-activedescendant":s.activeOptionIndex.value===null||(w=s.options.value[s.activeOptionIndex.value])==null?void 0:w.id,"aria-labelledby":(M=(E=pt(s.labelRef))==null?void 0:E.id)!=null?M:(I=pt(s.buttonRef))==null?void 0:I.id,"aria-orientation":s.orientation.value,id:c,onKeydown:m,role:"listbox",tabIndex:0,ref:s.optionsRef};return an({props:Pt(Pt({},e),j),slot:P,attrs:n,slots:r,features:3,visible:v.value,name:"ListboxOptions"})}}}),gj=Yt({name:"ListboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1}},setup(e,{slots:n,attrs:r}){let s=Xd("ListboxOption"),c=`headlessui-listbox-option-${Qn()}`,h=Et(()=>s.activeOptionIndex.value!==null?s.options.value[s.activeOptionIndex.value].id===c:!1),m=Et(()=>un(s.value.value)===un(e.value)),a=ft({disabled:e.disabled,value:e.value,textValue:""});cr(()=>{var M,P;let j=(P=(M=document.getElementById(c))==null?void 0:M.textContent)==null?void 0:P.toLowerCase().trim();j!==void 0&&(a.value.textValue=j)}),cr(()=>s.registerOption(c,a)),Cr(()=>s.unregisterOption(c)),cr(()=>{gi([s.listboxState,m],()=>{var M,P;s.listboxState.value===0&&(!m.value||(s.goToOption(4,c),(P=(M=document.getElementById(c))==null?void 0:M.focus)==null||P.call(M)))},{immediate:!0})}),dr(()=>{s.listboxState.value===0&&(!h.value||Yn(()=>{var M,P;return(P=(M=document.getElementById(c))==null?void 0:M.scrollIntoView)==null?void 0:P.call(M,{block:"nearest"})}))});function v(M){if(e.disabled)return M.preventDefault();s.select(e.value),s.closeListbox(),Yn(()=>{var P;return(P=pt(s.buttonRef))==null?void 0:P.focus({preventScroll:!0})})}function w(){if(e.disabled)return s.goToOption(5);s.goToOption(4,c)}function E(){e.disabled||h.value||s.goToOption(4,c)}function I(){e.disabled||!h.value||s.goToOption(5)}return()=>{let{disabled:M}=e,P={active:h.value,selected:m.value,disabled:M},j={id:c,role:"option",tabIndex:M===!0?void 0:-1,"aria-disabled":M===!0?!0:void 0,"aria-selected":m.value===!0?m.value:void 0,disabled:void 0,onClick:v,onFocus:w,onPointermove:E,onMousemove:E,onPointerleave:I,onMouseleave:I};return an({props:Pt(Pt({},e),j),slot:P,attrs:r,slots:n,name:"ListboxOption"})}}});function o8(e){requestAnimationFrame(()=>requestAnimationFrame(e))}var vI=Symbol("MenuContext");function sg(e){let n=kn(vI,null);if(n===null){let r=new Error(`<${e} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,sg),r}return n}Yt({name:"Menu",props:{as:{type:[Object,String],default:"template"}},setup(e,{slots:n,attrs:r}){let s=ft(1),c=ft(null),h=ft(null),m=ft([]),a=ft(""),v=ft(null),w={menuState:s,buttonRef:c,itemsRef:h,items:m,searchQuery:a,activeItemIndex:v,closeMenu:()=>{s.value=1,v.value=null},openMenu:()=>s.value=0,goToItem(E,I){let M=$x(E===4?{focus:4,id:I}:{focus:E},{resolveItems:()=>m.value,resolveActiveIndex:()=>v.value,resolveId:P=>P.id,resolveDisabled:P=>P.dataRef.disabled});a.value===""&&v.value===M||(a.value="",v.value=M)},search(E){let I=a.value!==""?0:1;a.value+=E.toLowerCase();let M=(v.value!==null?m.value.slice(v.value+I).concat(m.value.slice(0,v.value+I)):m.value).find(j=>j.dataRef.textValue.startsWith(a.value)&&!j.dataRef.disabled),P=M?m.value.indexOf(M):-1;P===-1||P===v.value||(v.value=P)},clearSearch(){a.value=""},registerItem(E,I){var M,P;let j=Array.from((P=(M=h.value)==null?void 0:M.querySelectorAll('[id^="headlessui-menu-item-"]'))!=null?P:[]).reduce((N,q,V)=>Object.assign(N,{[q.id]:V}),{});m.value=[...m.value,{id:E,dataRef:I}].sort((N,q)=>j[N.id]-j[q.id])},unregisterItem(E){let I=m.value.slice(),M=v.value!==null?I[v.value]:null,P=I.findIndex(j=>j.id===E);P!==-1&&I.splice(P,1),m.value=I,v.value=(()=>P===v.value||M===null?null:I.indexOf(M))()}};return Ko("mousedown",E=>{var I,M,P;let j=E.target,N=document.activeElement;s.value===0&&(((I=pt(c))==null?void 0:I.contains(j))||(((M=pt(h))==null?void 0:M.contains(j))||w.closeMenu(),!(N!==document.body&&(N==null?void 0:N.contains(j)))&&(E.defaultPrevented||(P=pt(c))==null||P.focus({preventScroll:!0}))))}),fr(vI,w),Nh(Et(()=>Pr(s.value,{[0]:0,[1]:1}))),()=>{let E={open:s.value===0};return an({props:e,slot:E,slots:n,attrs:r,name:"Menu"})}}});Yt({name:"MenuButton",props:{disabled:{type:Boolean,default:!1},as:{type:[Object,String],default:"button"}},setup(e,{attrs:n,slots:r}){let s=sg("MenuButton"),c=`headlessui-menu-button-${Qn()}`;function h(w){switch(w.key){case" ":case"Enter":case"ArrowDown":w.preventDefault(),w.stopPropagation(),s.openMenu(),Yn(()=>{var E;(E=pt(s.itemsRef))==null||E.focus({preventScroll:!0}),s.goToItem(0)});break;case"ArrowUp":w.preventDefault(),w.stopPropagation(),s.openMenu(),Yn(()=>{var E;(E=pt(s.itemsRef))==null||E.focus({preventScroll:!0}),s.goToItem(3)});break}}function m(w){switch(w.key){case" ":w.preventDefault();break}}function a(w){e.disabled||(s.menuState.value===0?(s.closeMenu(),Yn(()=>{var E;return(E=pt(s.buttonRef))==null?void 0:E.focus({preventScroll:!0})})):(w.preventDefault(),w.stopPropagation(),s.openMenu(),o8(()=>{var E;return(E=pt(s.itemsRef))==null?void 0:E.focus({preventScroll:!0})})))}let v=qc(Et(()=>({as:e.as,type:n.type})),s.buttonRef);return()=>{var w;let E={open:s.menuState.value===0},I={ref:s.buttonRef,id:c,type:v.value,"aria-haspopup":!0,"aria-controls":(w=pt(s.itemsRef))==null?void 0:w.id,"aria-expanded":e.disabled?void 0:s.menuState.value===0,onKeydown:h,onKeyup:m,onClick:a};return an({props:Pt(Pt({},e),I),slot:E,attrs:n,slots:r,name:"MenuButton"})}}});Yt({name:"MenuItems",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0}},setup(e,{attrs:n,slots:r}){let s=sg("MenuItems"),c=`headlessui-menu-items-${Qn()}`,h=ft(null);Vx({container:Et(()=>pt(s.itemsRef)),enabled:Et(()=>s.menuState.value===0),accept(E){return E.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:E.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(E){E.setAttribute("role","none")}});function m(E){var I;switch(h.value&&clearTimeout(h.value),E.key){case" ":if(s.searchQuery.value!=="")return E.preventDefault(),E.stopPropagation(),s.search(E.key);case"Enter":if(E.preventDefault(),E.stopPropagation(),s.activeItemIndex.value!==null){let{id:M}=s.items.value[s.activeItemIndex.value];(I=document.getElementById(M))==null||I.click()}s.closeMenu(),Yn(()=>{var M;return(M=pt(s.buttonRef))==null?void 0:M.focus({preventScroll:!0})});break;case"ArrowDown":return E.preventDefault(),E.stopPropagation(),s.goToItem(2);case"ArrowUp":return E.preventDefault(),E.stopPropagation(),s.goToItem(1);case"Home":case"PageUp":return E.preventDefault(),E.stopPropagation(),s.goToItem(0);case"End":case"PageDown":return E.preventDefault(),E.stopPropagation(),s.goToItem(3);case"Escape":E.preventDefault(),E.stopPropagation(),s.closeMenu(),Yn(()=>{var M;return(M=pt(s.buttonRef))==null?void 0:M.focus({preventScroll:!0})});break;case"Tab":E.preventDefault(),E.stopPropagation();break;default:E.key.length===1&&(s.search(E.key),h.value=setTimeout(()=>s.clearSearch(),350));break}}function a(E){switch(E.key){case" ":E.preventDefault();break}}let v=ba(),w=Et(()=>v!==null?v.value===0:s.menuState.value===0);return()=>{var E,I;let M={open:s.menuState.value===0},P={"aria-activedescendant":s.activeItemIndex.value===null||(E=s.items.value[s.activeItemIndex.value])==null?void 0:E.id,"aria-labelledby":(I=pt(s.buttonRef))==null?void 0:I.id,id:c,onKeydown:m,onKeyup:a,role:"menu",tabIndex:0,ref:s.itemsRef};return an({props:Pt(Pt({},e),P),slot:M,attrs:n,slots:r,features:3,visible:w.value,name:"MenuItems"})}}});Yt({name:"MenuItem",props:{as:{type:[Object,String],default:"template"},disabled:{type:Boolean,default:!1}},setup(e,{slots:n,attrs:r}){let s=sg("MenuItem"),c=`headlessui-menu-item-${Qn()}`,h=Et(()=>s.activeItemIndex.value!==null?s.items.value[s.activeItemIndex.value].id===c:!1),m=ft({disabled:e.disabled,textValue:""});cr(()=>{var I,M;let P=(M=(I=document.getElementById(c))==null?void 0:I.textContent)==null?void 0:M.toLowerCase().trim();P!==void 0&&(m.value.textValue=P)}),cr(()=>s.registerItem(c,m)),Cr(()=>s.unregisterItem(c)),dr(()=>{s.menuState.value===0&&(!h.value||Yn(()=>{var I,M;return(M=(I=document.getElementById(c))==null?void 0:I.scrollIntoView)==null?void 0:M.call(I,{block:"nearest"})}))});function a(I){if(e.disabled)return I.preventDefault();s.closeMenu(),Yn(()=>{var M;return(M=pt(s.buttonRef))==null?void 0:M.focus({preventScroll:!0})})}function v(){if(e.disabled)return s.goToItem(5);s.goToItem(4,c)}function w(){e.disabled||h.value||s.goToItem(4,c)}function E(){e.disabled||!h.value||s.goToItem(5)}return()=>{let{disabled:I}=e,M={active:h.value,disabled:I};return an({props:Ei(Pt({},e),{id:c,role:"menuitem",tabIndex:I===!0?void 0:-1,"aria-disabled":I===!0?!0:void 0,onClick:a,onFocus:v,onPointermove:w,onMousemove:w,onPointerleave:E,onMouseleave:E}),slot:M,attrs:r,slots:n,name:"MenuItem"})}}});var xI=Symbol("PopoverContext");function ag(e){let n=kn(xI,null);if(n===null){let r=new Error(`<${e} /> is missing a parent <${a8.name} /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,ag),r}return n}var bI=Symbol("PopoverGroupContext");function wI(){return kn(bI,null)}var TI=Symbol("PopoverPanelContext");function s8(){return kn(TI,null)}var a8=Yt({name:"Popover",props:{as:{type:[Object,String],default:"div"}},setup(e,{slots:n,attrs:r}){let s=`headlessui-popover-button-${Qn()}`,c=`headlessui-popover-panel-${Qn()}`,h=ft(1),m=ft(null),a=ft(null),v={popoverState:h,buttonId:s,panelId:c,panel:a,button:m,togglePopover(){h.value=Pr(h.value,{[0]:1,[1]:0})},closePopover(){h.value!==1&&(h.value=1)},close(P){v.closePopover();let j=(()=>P?P instanceof HTMLElement?P:P.value instanceof HTMLElement?pt(P):pt(v.button):pt(v.button))();j==null||j.focus()}};fr(xI,v),Nh(Et(()=>Pr(h.value,{[0]:0,[1]:1})));let w={buttonId:s,panelId:c,close(){v.closePopover()}},E=wI(),I=E==null?void 0:E.registerPopover;function M(){var P,j,N;return(N=E==null?void 0:E.isFocusWithinPopoverGroup())!=null?N:((P=pt(m))==null?void 0:P.contains(document.activeElement))||((j=pt(a))==null?void 0:j.contains(document.activeElement))}return dr(()=>I==null?void 0:I(w)),Ko("focus",()=>{h.value===0&&(M()||!m||!a||v.closePopover())},!0),Ko("mousedown",P=>{var j,N,q;let V=P.target;h.value===0&&(((j=pt(m))==null?void 0:j.contains(V))||((N=pt(a))==null?void 0:N.contains(V))||(v.closePopover(),XN(V,1)||(P.preventDefault(),(q=pt(m))==null||q.focus())))}),()=>{let P={open:h.value===0,close:v.close};return an({props:e,slot:P,slots:n,attrs:r,name:"Popover"})}}});Yt({name:"PopoverButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1}},setup(e,{attrs:n,slots:r}){let s=ag("PopoverButton"),c=wI(),h=c==null?void 0:c.closeOthers,m=s8(),a=m===null?!1:m===s.panelId,v=ft(null),w=ft(typeof window=="undefined"?null:document.activeElement);Ko("focus",()=>{w.value=v.value,v.value=document.activeElement},!0);let E=ft(null);a||dr(()=>{s.button.value=E.value});let I=qc(Et(()=>({as:e.as,type:n.type})),E);function M(N){var q,V,ee,oe;if(a){if(s.popoverState.value===1)return;switch(N.key){case" ":case"Enter":N.preventDefault(),N.stopPropagation(),s.closePopover(),(q=pt(s.button))==null||q.focus();break}}else switch(N.key){case" ":case"Enter":N.preventDefault(),N.stopPropagation(),s.popoverState.value===1&&(h==null||h(s.buttonId)),s.togglePopover();break;case"Escape":if(s.popoverState.value!==0)return h==null?void 0:h(s.buttonId);if(!pt(s.button)||!((V=pt(s.button))==null?void 0:V.contains(document.activeElement)))return;N.preventDefault(),N.stopPropagation(),s.closePopover();break;case"Tab":if(s.popoverState.value!==0||!s.panel||!s.button)return;if(N.shiftKey){if(!w.value||((ee=pt(s.button))==null?void 0:ee.contains(w.value))||((oe=pt(s.panel))==null?void 0:oe.contains(w.value)))return;let pe=R_(),se=pe.indexOf(w.value);if(pe.indexOf(pt(s.button))>se)return;N.preventDefault(),N.stopPropagation(),pi(pt(s.panel),8)}else N.preventDefault(),N.stopPropagation(),pi(pt(s.panel),1);break}}function P(N){var q,V;if(!a&&(N.key===" "&&N.preventDefault(),s.popoverState.value===0&&!!s.panel&&!!s.button))switch(N.key){case"Tab":if(!w.value||((q=pt(s.button))==null?void 0:q.contains(w.value))||((V=pt(s.panel))==null?void 0:V.contains(w.value)))return;let ee=R_(),oe=ee.indexOf(w.value);if(ee.indexOf(pt(s.button))>oe)return;N.preventDefault(),N.stopPropagation(),pi(pt(s.panel),8);break}}function j(){var N,q;e.disabled||(a?(s.closePopover(),(N=pt(s.button))==null||N.focus()):(s.popoverState.value===1&&(h==null||h(s.buttonId)),(q=pt(s.button))==null||q.focus(),s.togglePopover()))}return()=>{let N={open:s.popoverState.value===0},q=a?{ref:E,type:I.value,onKeydown:M,onClick:j}:{ref:E,id:s.buttonId,type:I.value,"aria-expanded":e.disabled?void 0:s.popoverState.value===0,"aria-controls":pt(s.panel)?s.panelId:void 0,disabled:e.disabled?!0:void 0,onKeydown:M,onKeyup:P,onClick:j};return an({props:Pt(Pt({},e),q),slot:N,attrs:n,slots:r,name:"PopoverButton"})}}});Yt({name:"PopoverOverlay",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0}},setup(e,{attrs:n,slots:r}){let s=ag("PopoverOverlay"),c=`headlessui-popover-overlay-${Qn()}`,h=ba(),m=Et(()=>h!==null?h.value===0:s.popoverState.value===0);function a(){s.closePopover()}return()=>{let v={open:s.popoverState.value===0};return an({props:Ei(Pt({},e),{id:c,"aria-hidden":!0,onClick:a}),slot:v,attrs:n,slots:r,features:3,visible:m.value,name:"PopoverOverlay"})}}});Yt({name:"PopoverPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},focus:{type:Boolean,default:!1}},setup(e,{attrs:n,slots:r}){let{focus:s}=e,c=ag("PopoverPanel");fr(TI,c.panelId),Cr(()=>{c.panel.value=null}),dr(()=>{var v;if(!s||c.popoverState.value!==0||!c.panel)return;let w=document.activeElement;((v=pt(c.panel))==null?void 0:v.contains(w))||pi(pt(c.panel),1)}),Ko("keydown",v=>{var w,E;if(c.popoverState.value!==0||!pt(c.panel)||v.key!=="Tab"||!document.activeElement||!((w=pt(c.panel))==null?void 0:w.contains(document.activeElement)))return;v.preventDefault();let I=pi(pt(c.panel),v.shiftKey?2:4);if(I===3)return(E=pt(c.button))==null?void 0:E.focus();if(I===1){if(!pt(c.button))return;let M=R_(),P=M.indexOf(pt(c.button)),j=M.splice(P+1).filter(N=>{var q;return!((q=pt(c.panel))==null?void 0:q.contains(N))});pi(j,1)===0&&pi(document.body,1)}}),Ko("focus",()=>{var v;!s||c.popoverState.value===0&&(!pt(c.panel)||((v=pt(c.panel))==null?void 0:v.contains(document.activeElement))||c.closePopover())},!0);let h=ba(),m=Et(()=>h!==null?h.value===0:c.popoverState.value===0);function a(v){var w,E;switch(v.key){case"Escape":if(c.popoverState.value!==0||!pt(c.panel)||!((w=pt(c.panel))==null?void 0:w.contains(document.activeElement)))return;v.preventDefault(),v.stopPropagation(),c.closePopover(),(E=pt(c.button))==null||E.focus();break}}return()=>{let v={open:c.popoverState.value===0,close:c.close},w={ref:c.panel,id:c.panelId,onKeydown:a};return an({props:Pt(Pt({},e),w),slot:v,attrs:n,slots:r,features:3,visible:m.value,name:"PopoverPanel"})}}});Yt({name:"PopoverGroup",props:{as:{type:[Object,String],default:"div"}},setup(e,{attrs:n,slots:r}){let s=ft(null),c=ft([]);function h(w){let E=c.value.indexOf(w);E!==-1&&c.value.splice(E,1)}function m(w){return c.value.push(w),()=>{h(w)}}function a(){var w;let E=document.activeElement;return((w=pt(s))==null?void 0:w.contains(E))?!0:c.value.some(I=>{var M,P;return((M=document.getElementById(I.buttonId))==null?void 0:M.contains(E))||((P=document.getElementById(I.panelId))==null?void 0:P.contains(E))})}function v(w){for(let E of c.value)E.buttonId!==w&&E.close()}return fr(bI,{registerPopover:m,unregisterPopover:h,isFocusWithinPopoverGroup:a,closeOthers:v}),()=>an({props:Ei(Pt({},e),{ref:s}),slot:{},attrs:n,slots:r,name:"PopoverGroup"})}});var EI=Symbol("LabelContext");function SI(){let e=kn(EI,null);if(e===null){let n=new Error("You used a <Label /> component, but it is not inside a parent.");throw Error.captureStackTrace&&Error.captureStackTrace(n,SI),n}return e}function Zx({slot:e={},name:n="Label",props:r={}}={}){let s=ft([]);function c(h){return s.value.push(h),()=>{let m=s.value.indexOf(h);m!==-1&&s.value.splice(m,1)}}return fr(EI,{register:c,slot:e,name:n,props:r}),Et(()=>s.value.length>0?s.value.join(" "):void 0)}Yt({name:"Label",props:{as:{type:[Object,String],default:"label"},passive:{type:[Boolean],default:!1}},setup(e,{slots:n,attrs:r}){let s=SI(),c=`headlessui-label-${Qn()}`;return cr(()=>Cr(s.register(c))),()=>{let{name:h="Label",slot:m={},props:a={}}=s,M=e,{passive:v}=M,w=cs(M,["passive"]),E=Ei(Pt({},Object.entries(a).reduce((P,[j,N])=>Object.assign(P,{[j]:qo(N)}),{})),{id:c}),I=Pt(Pt({},w),E);return v&&delete I.onClick,an({props:I,slot:m,attrs:r,slots:n,name:h})}}});var AI=Symbol("RadioGroupContext");function CI(e){let n=kn(AI,null);if(n===null){let r=new Error(`<${e} /> is missing a parent <RadioGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,CI),r}return n}Yt({name:"RadioGroup",emits:{"update:modelValue":e=>!0},props:{as:{type:[Object,String],default:"div"},disabled:{type:[Boolean],default:!1},modelValue:{type:[Object,String,Number,Boolean]}},setup(e,{emit:n,attrs:r,slots:s}){let c=ft(null),h=ft([]),m=Zx({name:"RadioGroupLabel"}),a=og({name:"RadioGroupDescription"}),v=Et(()=>e.modelValue),w={options:h,value:v,disabled:Et(()=>e.disabled),firstOption:Et(()=>h.value.find(M=>!M.propsRef.disabled)),containsCheckedOption:Et(()=>h.value.some(M=>un(M.propsRef.value)===un(e.modelValue))),change(M){var P;if(e.disabled||v.value===M)return!1;let j=(P=h.value.find(N=>un(N.propsRef.value)===un(M)))==null?void 0:P.propsRef;return(j==null?void 0:j.disabled)?!1:(n("update:modelValue",M),!0)},registerOption(M){var P;let j=Array.from((P=c.value)==null?void 0:P.querySelectorAll('[id^="headlessui-radiogroup-option-"]')).reduce((N,q,V)=>Object.assign(N,{[q.id]:V}),{});h.value.push(M),h.value.sort((N,q)=>j[N.id]-j[q.id])},unregisterOption(M){let P=h.value.findIndex(j=>j.id===M);P!==-1&&h.value.splice(P,1)}};fr(AI,w),Vx({container:Et(()=>pt(c)),accept(M){return M.getAttribute("role")==="radio"?NodeFilter.FILTER_REJECT:M.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(M){M.setAttribute("role","none")}});function E(M){if(!c.value||!c.value.contains(M.target))return;let P=h.value.filter(j=>j.propsRef.disabled===!1).map(j=>j.element);switch(M.key){case"ArrowLeft":case"ArrowUp":if(M.preventDefault(),M.stopPropagation(),pi(P,18)===2){let j=h.value.find(N=>N.element===document.activeElement);j&&w.change(j.propsRef.value)}break;case"ArrowRight":case"ArrowDown":if(M.preventDefault(),M.stopPropagation(),pi(P,20)===2){let j=h.value.find(N=>N.element===document.activeElement);j&&w.change(j.propsRef.value)}break;case" ":{M.preventDefault(),M.stopPropagation();let j=h.value.find(N=>N.element===document.activeElement);j&&w.change(j.propsRef.value)}break}}let I=`headlessui-radiogroup-${Qn()}`;return()=>{let q=e,{modelValue:M,disabled:P}=q,j=cs(q,["modelValue","disabled"]),N={ref:c,id:I,role:"radiogroup","aria-labelledby":m.value,"aria-describedby":a.value,onKeydown:E};return an({props:Pt(Pt({},j),N),slot:{},attrs:r,slots:s,name:"RadioGroup"})}}});Yt({name:"RadioGroupOption",props:{as:{type:[Object,String],default:"div"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1}},setup(e,{attrs:n,slots:r}){let s=CI("RadioGroupOption"),c=`headlessui-radiogroup-option-${Qn()}`,h=Zx({name:"RadioGroupLabel"}),m=og({name:"RadioGroupDescription"}),a=ft(null),v=Et(()=>({value:e.value,disabled:e.disabled})),w=ft(1);cr(()=>s.registerOption({id:c,element:a,propsRef:v})),Cr(()=>s.unregisterOption(c));let E=Et(()=>{var V;return((V=s.firstOption.value)==null?void 0:V.id)===c}),I=Et(()=>s.disabled.value||e.disabled),M=Et(()=>un(s.value.value)===un(e.value)),P=Et(()=>I.value?-1:M.value||!s.containsCheckedOption.value&&E.value?0:-1);function j(){var V;!s.change(e.value)||(w.value|=2,(V=a.value)==null||V.focus())}function N(){w.value|=2}function q(){w.value&=-3}return()=>{let V=Ml(e,["value","disabled"]),ee={checked:M.value,disabled:I.value,active:Boolean(w.value&2)},oe={id:c,ref:a,role:"radio","aria-checked":M.value?"true":"false","aria-labelledby":h.value,"aria-describedby":m.value,"aria-disabled":I.value?!0:void 0,tabIndex:P.value,onClick:I.value?void 0:j,onFocus:I.value?void 0:N,onBlur:I.value?void 0:q};return an({props:Pt(Pt({},V),oe),slot:ee,attrs:n,slots:r,name:"RadioGroupOption"})}}});var II=Symbol("GroupContext");Yt({name:"SwitchGroup",props:{as:{type:[Object,String],default:"template"}},setup(e,{slots:n,attrs:r}){let s=ft(null),c=Zx({name:"SwitchLabel",props:{onClick(){!s.value||(s.value.click(),s.value.focus({preventScroll:!0}))}}}),h=og({name:"SwitchDescription"});return fr(II,{switchRef:s,labelledby:c,describedby:h}),()=>an({props:e,slot:{},slots:n,attrs:r,name:"SwitchGroup"})}});Yt({name:"Switch",emits:{"update:modelValue":e=>!0},props:{as:{type:[Object,String],default:"button"},modelValue:{type:Boolean,default:!1}},setup(e,{emit:n,attrs:r,slots:s}){let c=kn(II,null),h=`headlessui-switch-${Qn()}`;function m(){n("update:modelValue",!e.modelValue)}let a=ft(null),v=c===null?a:c.switchRef,w=qc(Et(()=>({as:e.as,type:r.type})),v);function E(P){P.preventDefault(),m()}function I(P){P.key!=="Tab"&&P.preventDefault(),P.key===" "&&m()}function M(P){P.preventDefault()}return()=>{let P={checked:e.modelValue},j={id:h,ref:v,role:"switch",type:w.value,tabIndex:0,"aria-checked":e.modelValue,"aria-labelledby":c==null?void 0:c.labelledby.value,"aria-describedby":c==null?void 0:c.describedby.value,onClick:E,onKeyup:I,onKeypress:M};return an({props:Pt(Pt({},e),j),slot:P,attrs:r,slots:s,name:"Switch"})}}});var MI=Symbol("TabsContext");function Kd(e){let n=kn(MI,null);if(n===null){let r=new Error(`<${e} /> is missing a parent <TabGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Kd),r}return n}Yt({name:"TabGroup",emits:{change:e=>!0},props:{as:{type:[Object,String],default:"template"},selectedIndex:{type:[Number],default:null},defaultIndex:{type:[Number],default:0},vertical:{type:[Boolean],default:!1},manual:{type:[Boolean],default:!1}},setup(e,{slots:n,attrs:r,emit:s}){let c=ft(null),h=ft([]),m=ft([]),a={selectedIndex:c,orientation:Et(()=>e.vertical?"vertical":"horizontal"),activation:Et(()=>e.manual?"manual":"auto"),tabs:h,panels:m,setSelectedIndex(v){c.value!==v&&(c.value=v,s("change",v))},registerTab(v){h.value.includes(v)||h.value.push(v)},unregisterTab(v){let w=h.value.indexOf(v);w!==-1&&h.value.splice(w,1)},registerPanel(v){m.value.includes(v)||m.value.push(v)},unregisterPanel(v){let w=m.value.indexOf(v);w!==-1&&m.value.splice(w,1)}};return fr(MI,a),dr(()=>{var v;if(a.tabs.value.length<=0||e.selectedIndex===null&&c.value!==null)return;let w=a.tabs.value.map(M=>pt(M)).filter(Boolean),E=w.filter(M=>!M.hasAttribute("disabled")),I=(v=e.selectedIndex)!=null?v:e.defaultIndex;if(I<0)c.value=w.indexOf(E[0]);else if(I>a.tabs.value.length)c.value=w.indexOf(E[E.length-1]);else{let M=w.slice(0,I),P=[...w.slice(I),...M].find(j=>E.includes(j));if(!P)return;c.value=w.indexOf(P)}}),()=>{let v={selectedIndex:c.value};return an({props:Ml(e,["selectedIndex","defaultIndex","manual","vertical","onChange"]),slot:v,slots:n,attrs:r,name:"TabGroup"})}}});Yt({name:"TabList",props:{as:{type:[Object,String],default:"div"}},setup(e,{attrs:n,slots:r}){let s=Kd("TabList");return()=>{let c={selectedIndex:s.selectedIndex.value},h={role:"tablist","aria-orientation":s.orientation.value};return an({props:Pt(Pt({},e),h),slot:c,attrs:n,slots:r,name:"TabList"})}}});Yt({name:"Tab",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1}},setup(e,{attrs:n,slots:r}){let s=Kd("Tab"),c=`headlessui-tabs-tab-${Qn()}`,h=ft();cr(()=>s.registerTab(h)),Cr(()=>s.unregisterTab(h));let m=Et(()=>s.tabs.value.indexOf(h)),a=Et(()=>m.value===s.selectedIndex.value);function v(M){let P=s.tabs.value.map(j=>pt(j)).filter(Boolean);if(M.key===" "||M.key==="Enter"){M.preventDefault(),M.stopPropagation(),s.setSelectedIndex(m.value);return}switch(M.key){case"Home":case"PageUp":return M.preventDefault(),M.stopPropagation(),pi(P,1);case"End":case"PageDown":return M.preventDefault(),M.stopPropagation(),pi(P,8)}return Pr(s.orientation.value,{vertical(){if(M.key==="ArrowUp")return pi(P,18);if(M.key==="ArrowDown")return pi(P,20)},horizontal(){if(M.key==="ArrowLeft")return pi(P,18);if(M.key==="ArrowRight")return pi(P,20)}})}function w(){var M;(M=pt(h))==null||M.focus()}function E(){var M;e.disabled||((M=pt(h))==null||M.focus(),s.setSelectedIndex(m.value))}let I=qc(Et(()=>({as:e.as,type:n.type})),h);return()=>{var M,P;let j={selected:a.value},N={ref:h,onKeydown:v,onFocus:s.activation.value==="manual"?w:E,onClick:E,id:c,role:"tab",type:I.value,"aria-controls":(P=(M=s.panels.value[m.value])==null?void 0:M.value)==null?void 0:P.id,"aria-selected":a.value,tabIndex:a.value?0:-1,disabled:e.disabled?!0:void 0};return an({props:Pt(Pt({},e),N),slot:j,attrs:n,slots:r,name:"Tab"})}}});Yt({name:"TabPanels",props:{as:{type:[Object,String],default:"div"}},setup(e,{slots:n,attrs:r}){let s=Kd("TabPanels");return()=>{let c={selectedIndex:s.selectedIndex.value};return an({props:e,slot:c,attrs:r,slots:n,name:"TabPanels"})}}});Yt({name:"TabPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0}},setup(e,{attrs:n,slots:r}){let s=Kd("TabPanel"),c=`headlessui-tabs-panel-${Qn()}`,h=ft();cr(()=>s.registerPanel(h)),Cr(()=>s.unregisterPanel(h));let m=Et(()=>s.panels.value.indexOf(h)),a=Et(()=>m.value===s.selectedIndex.value);return()=>{var v,w;let E={selected:a.value},I={ref:h,id:c,role:"tabpanel","aria-labelledby":(w=(v=s.tabs.value[m.value])==null?void 0:v.value)==null?void 0:w.id,tabIndex:a.value?0:-1};return an({props:Pt(Pt({},e),I),slot:E,attrs:n,slots:r,features:3,visible:a.value,name:"TabPanel"})}}});function l8(e){let n={called:!1};return(...r)=>{if(!n.called)return n.called=!0,e(...r)}}function kI(){let e=[],n=[],r={enqueue(s){n.push(s)},requestAnimationFrame(...s){let c=requestAnimationFrame(...s);r.add(()=>cancelAnimationFrame(c))},nextFrame(...s){r.requestAnimationFrame(()=>{r.requestAnimationFrame(...s)})},setTimeout(...s){let c=setTimeout(...s);r.add(()=>clearTimeout(c))},add(s){e.push(s)},dispose(){for(let s of e.splice(0))s()},async workQueue(){for(let s of n.splice(0))await s()}};return r}function py(e,...n){e&&n.length>0&&e.classList.add(...n)}function Om(e,...n){e&&n.length>0&&e.classList.remove(...n)}function c8(e,n){let r=kI();if(!e)return r.dispose;let{transitionDuration:s,transitionDelay:c}=getComputedStyle(e),[h,m]=[s,c].map(a=>{let[v=0]=a.split(",").filter(Boolean).map(w=>w.includes("ms")?parseFloat(w):parseFloat(w)*1e3).sort((w,E)=>E-w);return v});return h!==0?r.setTimeout(()=>n("finished"),h+m):n("finished"),r.add(()=>n("cancelled")),r.dispose}function K2(e,n,r,s,c,h){let m=kI(),a=h!==void 0?l8(h):()=>{};return Om(e,...c),py(e,...n,...r),m.nextFrame(()=>{Om(e,...r),py(e,...s),m.add(c8(e,v=>(Om(e,...s,...n),py(e,...c),a(v))))}),m.add(()=>Om(e,...n,...r,...s,...c)),m.add(()=>a("cancelled")),m.dispose}function yc(e=""){return e.split(" ").filter(n=>n.trim().length>1)}var Wx=Symbol("TransitionContext");function u8(){return kn(Wx,null)!==null}function h8(){let e=kn(Wx,null);if(e===null)throw new Error("A <TransitionChild /> is used but it is missing a parent <TransitionRoot />.");return e}function f8(){let e=kn(Hx,null);if(e===null)throw new Error("A <TransitionChild /> is used but it is missing a parent <TransitionRoot />.");return e}var Hx=Symbol("NestingContext");function lg(e){return"children"in e?lg(e.children):e.value.filter(({state:n})=>n==="visible").length>0}function PI(e){let n=ft([]),r=ft(!1);cr(()=>r.value=!0),Cr(()=>r.value=!1);function s(h,m=1){let a=n.value.findIndex(({id:v})=>v===h);a!==-1&&(Pr(m,{[0](){n.value.splice(a,1)},[1](){n.value[a].state="hidden"}}),!lg(n)&&r.value&&(e==null||e()))}function c(h){let m=n.value.find(({id:a})=>a===h);return m?m.state!=="visible"&&(m.state="visible"):n.value.push({id:h,state:"visible"}),()=>s(h,0)}return{children:n,register:c,unregister:s}}var DI=1,d8=Yt({props:{as:{type:[Object,String],default:"div"},show:{type:[Boolean],default:null},unmount:{type:[Boolean],default:!0},appear:{type:[Boolean],default:!1},enter:{type:[String],default:""},enterFrom:{type:[String],default:""},enterTo:{type:[String],default:""},entered:{type:[String],default:""},leave:{type:[String],default:""},leaveFrom:{type:[String],default:""},leaveTo:{type:[String],default:""}},emits:{beforeEnter:()=>!0,afterEnter:()=>!0,beforeLeave:()=>!0,afterLeave:()=>!0},setup(e,{emit:n,attrs:r,slots:s}){if(!u8()&&HN())return()=>yo(m8,Ei(Pt({},e),{onBeforeEnter:()=>n("beforeEnter"),onAfterEnter:()=>n("afterEnter"),onBeforeLeave:()=>n("beforeLeave"),onAfterLeave:()=>n("afterLeave")}),s);let c=ft(null),h=ft("visible"),m=Et(()=>e.unmount?0:1),{show:a,appear:v}=h8(),{register:w,unregister:E}=f8(),I={value:!0},M=Qn(),P={value:!1},j=PI(()=>{P.value||(h.value="hidden",E(M),n("afterLeave"))});cr(()=>{let Te=w(M);Cr(Te)}),dr(()=>{if(m.value===1&&!!M){if(a&&h.value!=="visible"){h.value="visible";return}Pr(h.value,{hidden:()=>E(M),visible:()=>w(M)})}});let N=yc(e.enter),q=yc(e.enterFrom),V=yc(e.enterTo),ee=yc(e.entered),oe=yc(e.leave),pe=yc(e.leaveFrom),se=yc(e.leaveTo);cr(()=>{dr(()=>{if(h.value==="visible"){let Te=pt(c);if(Te instanceof Comment&&Te.data==="")throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")}})});function xe(Te){let De=I.value&&!v.value,Me=pt(c);!Me||!(Me instanceof HTMLElement)||De||(P.value=!0,a.value&&n("beforeEnter"),a.value||n("beforeLeave"),Te(a.value?K2(Me,N,q,V,ee,Be=>{P.value=!1,Be==="finished"&&n("afterEnter")}):K2(Me,oe,pe,se,ee,Be=>{P.value=!1,Be==="finished"&&(lg(j)||(h.value="hidden",E(M),n("afterLeave")))})))}return cr(()=>{gi([a,v],(Te,De,Me)=>{xe(Me),I.value=!1},{immediate:!0})}),fr(Hx,j),Nh(Et(()=>Pr(h.value,{visible:0,hidden:1}))),()=>{let _t=e,{appear:Te,show:De,enter:Me,enterFrom:Be,enterTo:ze,entered:Fe,leave:Je,leaveFrom:be,leaveTo:qe}=_t,Ke=cs(_t,["appear","show","enter","enterFrom","enterTo","entered","leave","leaveFrom","leaveTo"]);return an({props:Ei(Pt({},Ke),{ref:c}),slot:{},slots:s,attrs:r,features:DI,visible:h.value==="visible",name:"TransitionChild"})}}}),p8=d8,m8=Yt({inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"},show:{type:[Boolean],default:null},unmount:{type:[Boolean],default:!0},appear:{type:[Boolean],default:!1},enter:{type:[String],default:""},enterFrom:{type:[String],default:""},enterTo:{type:[String],default:""},entered:{type:[String],default:""},leave:{type:[String],default:""},leaveFrom:{type:[String],default:""},leaveTo:{type:[String],default:""}},emits:{beforeEnter:()=>!0,afterEnter:()=>!0,beforeLeave:()=>!0,afterLeave:()=>!0},setup(e,{emit:n,attrs:r,slots:s}){let c=ba(),h=Et(()=>e.show===null&&c!==null?Pr(c.value,{[0]:!0,[1]:!1}):e.show);dr(()=>{if(![!0,!1].includes(h.value))throw new Error('A <Transition /> is used but it is missing a `:show="true | false"` prop.')});let m=ft(h.value?"visible":"hidden"),a=PI(()=>{m.value="hidden"}),v={value:!0},w={show:h,appear:Et(()=>e.appear||!v.value)};return cr(()=>{dr(()=>{v.value=!1,h.value?m.value="visible":lg(a)||(m.value="hidden")})}),fr(Hx,a),fr(Wx,w),()=>{let E=Ml(e,["show","appear","unmount"]),I={unmount:e.unmount};return an({props:Ei(Pt({},I),{as:"template"}),slot:{},slots:Ei(Pt({},s),{default:()=>[yo(p8,Pt(Pt(Pt({onBeforeEnter:()=>n("beforeEnter"),onAfterEnter:()=>n("afterEnter"),onBeforeLeave:()=>n("beforeLeave"),onAfterLeave:()=>n("afterLeave")},r),I),E),s.default)]}),attrs:{},features:DI,visible:m.value==="visible",name:"Transition"})}}});export{L8 as $,dr as A,$8 as B,q5 as C,V8 as D,G8 as E,di as F,K8 as G,N8 as H,WA as I,tr as J,Z8 as K,tA as L,lj as M,gi as N,cj as O,O8 as P,U8 as Q,uS as R,I8 as S,aS as T,oj as U,z8 as V,C8 as W,y8 as X,v8 as Y,nj as Z,Y8 as _,aj as a,US as a0,fr as a1,uj as a2,d8 as a3,hj as a4,fj as a5,m8 as a6,kn as a7,Q8 as a8,T3 as a9,T8 as aA,yo as aB,F8 as aa,j8 as ab,QD as ac,B8 as ad,Al as ae,sj as af,M8 as ag,P8 as ah,b8 as ai,D8 as aj,mS as ak,pj as al,mj as am,_j as an,dj as ao,gj as ap,k8 as aq,tj as ar,Yn as as,ej as at,Ar as au,J8 as av,x8 as aw,rj as ax,ij as ay,rx as az,q8 as b,R8 as c,Yt as d,$5 as e,H8 as f,W8 as g,oS as h,X8 as i,E8 as j,_U as k,m4 as l,cS as m,Nv as n,cr as o,Et as p,w8 as q,ft as r,Xr as s,g8 as t,ux as u,qo as v,UE as w,jv as x,A8 as y,S8 as z};
