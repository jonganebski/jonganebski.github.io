var oe=Object.defineProperty,re=Object.defineProperties;var ue=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var ie=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var I=(o,t,n)=>t in o?oe(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,ee=(o,t)=>{for(var n in t||(t={}))ie.call(t,n)&&I(o,n,t[n]);if(J)for(var n of J(t))ce.call(t,n)&&I(o,n,t[n]);return o},te=(o,t)=>re(o,ue(t));import{_ as ae,u as B,s as A,d as _e,f as de,g as se,e as ne,r as pe,a as me}from"./app.887b33ea.js";import{d as H,h as _,j as p,m as r,t as h,x as F,y as U,v as e,T as W,P as he,p as L,s as z,F as M,W as D,R as ge,S as K,w as X,r as R,$ as ve,a0 as fe,al as ye,o as $e,ad as be,am as ke,N as xe,H as we,an as ze,q as Ce,n as j}from"./vendor.05982d12.js";import{_ as Se,b as Ne,a as Ee}from"./list-numbered.8bdf8d48.js";const Ue={class:"mt-4 px-2 text-center"},Re={key:0,class:"text-sm text-gray-700 dark:text-gray-300"},Te=W(" Photo by "),Ve=["href"],je={key:1,class:"text-sm text-gray-700 dark:text-gray-300"},Fe=W(" on "),Le=["href"],Me={class:"text-xs text-gray-500"},Be=H({props:{selectedImage:null},setup(o){const t=o,{t:n}=B();return(s,m)=>{var f,g,c,b,v,y,$,k,w,u;return _(),p("div",Ue,[((f=t.selectedImage)==null?void 0:f.creator)?(_(),p("span",Re,[Te,r("a",{class:F([((g=t.selectedImage)==null?void 0:g.creator.url)?"link__active":"link__inactive"]),href:(c=t.selectedImage)==null?void 0:c.creator.url,target:"_blank",rel:"noopener"},h((v=(b=t.selectedImage)==null?void 0:b.creator)==null?void 0:v.name),11,Ve)])):U("",!0),((y=t.selectedImage)==null?void 0:y.provider)?(_(),p("span",je,[Fe,r("a",{class:F([(($=t.selectedImage)==null?void 0:$.provider.url)?"link__active":"link__inactive"]),href:(k=t.selectedImage)==null?void 0:k.provider.url,target:"_blank",rel:"noopener"},h((u=(w=t.selectedImage)==null?void 0:w.provider)==null?void 0:u.name),11,Le)])):U("",!0),r("p",Me,h(e(n)("all_rights_of_the_image_belong_to_the_creator")),1)])}}});var He=ae(Be,[["__scopeId","data-v-176f9680"]]);const Ze={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 32 32"},De=r("circle",{cx:"9.5",cy:"9.5",r:"2.5",fill:"currentColor"},null,-1),Oe=r("circle",{cx:"9.5",cy:"22.5",r:"2.5",fill:"currentColor"},null,-1),Pe=r("circle",{cx:"22.5",cy:"22.5",r:"2.5",fill:"currentColor"},null,-1),Ye=r("path",{d:"M28 2H4a2.002 2.002 0 0 0-2 2v24a2.002 2.002 0 0 0 2 2h24a2.002 2.002 0 0 0 2-2V4a2.002 2.002 0 0 0-2-2zm0 13H17V4h11zM15 4v11H4V4zM4 17h11v11H4zm13 11V17h11v11z",fill:"currentColor"},null,-1),Ae=[De,Oe,Pe,Ye];function Xe(o,t){return _(),p("svg",Ze,Ae)}var Qe={name:"carbon-scatter-matrix",render:Xe};const qe=1e3*60*60;function Ge(){return he("sliding-puzzle-records",async()=>(await A.from("sliding-puzzle-records").select("*, user: user_id (user_name, avatar_url)").order("score",{ascending:!0}).limit(100)).data,{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,staleTime:qe,retry:!1})}const Ke={class:"mt-30 p-4 mx-auto max-w-xl rounded shadow-lg"},We={class:"mx-auto w-full text-sm table-fixed"},Je={class:"pb-5"},Ie={class:"pb-5 w-[80%]"},et={class:"pb-5"},tt={class:"w-full"},st={key:0},at=r("td",{colspan:"3",class:"py-10 text-center"},"Loading...",-1),nt=[at],lt={key:1},ot=r("td",{colspan:"3",class:"py-10 text-center"},"No Data",-1),rt=[ot],ut={class:"py-2"},it={class:"py-2 px-4"},ct={class:"w-full flex items-center justify-start gap-3"},_t={class:"relative"},dt={class:"absolute top-0 right-0 text-xl pointer-events-none"},pt={class:"overflow-ellipsis overflow-hidden whitespace-nowrap"},mt={class:"py-2 text-right"},ht=H({setup(o){const{t}=B(),{isLoading:n,data:s}=Ge(),m=L(f);function f(){var c;const g=[];if(!s.value)return g;for(let b=0;b<((c=s.value)==null?void 0:c.length);b++){const{score:v}=s.value[b];if(g.length===0){g.push(v);continue}if(g[g.length-1]!==v&&(g.push(v),g.length===3))break}return g}return(g,c)=>{const b=Se,v=_e,y=Qe,$=de;return _(),p("div",Ke,[r("table",We,[r("thead",null,[r("tr",null,[r("th",Je,[z(b)]),r("th",Ie,[z(v,{class:"mx-auto"})]),r("th",et,[z(y,{class:"ml-auto"})])])]),r("tbody",tt,[e(n)?(_(),p("tr",st,nt)):!e(s)||e(s).length===0?(_(),p("tr",lt,rt)):(_(!0),p(M,{key:2},D(e(s),(k,w)=>(_(),p("tr",{key:k.id,class:"w-full"},[r("td",ut,h(w+1),1),r("td",it,[r("div",ct,[r("div",_t,[z($,{src:k.user.avatar_url,width:40,height:40,alt:e(t)("the_avatar_of",{user_name:k.user.user_name})},null,8,["src","alt"]),r("span",dt,h(k.score===e(m)[0]?"\u{1F947}":k.score===e(m)[1]?"\u{1F948}":k.score===e(m)[2]?"\u{1F949}":""),1)]),r("span",pt,h(k.user.user_name),1)])]),r("td",mt,h(k.score),1)]))),128))])])])}}}),gt={class:"text-sm"},vt={key:0,class:""},ft={key:0},yt={key:1},$t={key:2},bt={key:1},kt=H({props:{clicksCount:null,shuffleCount:null,score:null,time:null},setup(o){const t=o,{t:n}=B(),s=L(()=>{if(!t.time)return null;const m=Math.floor(t.time/(1e3*60)),f=Math.floor((t.time-m*1e3*60)/1e3),g=t.time-m*1e3*60-f*1e3;return{minutes:m,seconds:f,milliseconds:g}});return(m,f)=>(_(),p("div",gt,[r("span",null,[W(h(e(n)("move",2))+": ",1),r("span",{class:F([t.clicksCount<=t.shuffleCount?"text-green-500":t.clicksCount<t.shuffleCount*2?"text-yellow-500":"text-red-500"])},h(t.clicksCount),3)]),e(s)?(_(),p("p",vt,[r("span",null,h(e(n)("time"))+": ",1),e(s).minutes?(_(),p("span",ft,h(e(s).minutes)+" "+h(e(n)("minutes").toLowerCase())+" "+h(" "),1)):U("",!0),e(s).seconds?(_(),p("span",yt,h(e(s).seconds)+" "+h(e(n)("seconds").toLowerCase())+" "+h(" "),1)):U("",!0),e(s).milliseconds?(_(),p("span",$t,h(e(s).milliseconds)+" "+h(e(n)("milliseconds").toLowerCase()),1)):U("",!0)])):U("",!0),o.score?(_(),p("p",bt,h(e(n)("score"))+": "+h(o.score),1)):U("",!0)]))}}),xt={class:"mt-2 text-sm"},wt={class:"pl-2 font-bold"},zt={display:"mt-1 grid"},Ct=H({props:{categoryName:null},setup(o){const t=o;return(n,s)=>(_(),p("div",xt,[r("span",wt,h(t.categoryName),1),r("div",zt,[ge(n.$slots,"default")])]))}}),St=H({props:{modelValue:null,images:null},emits:["update:modelValue"],setup(o,{emit:t}){const n=o,{t:s}=B();return(m,f)=>{const g=Ne,c=Ct,b=Ee;return _(),K(b,{"model-value":n.modelValue,label:e(s)("image"),class:"w-72","onUpdate:modelValue":f[0]||(f[0]=v=>t("update:modelValue",v.toString()))},{default:X(()=>[(_(!0),p(M,null,D(n.images,({categoryName:v,options:y})=>(_(),K(c,{key:v,"category-name":v,class:"text-dark-500"},{default:X(()=>[(_(!0),p(M,null,D(y,$=>(_(),K(g,{key:$.url,value:$.url,label:$.label},null,8,["value","label"]))),128))]),_:2},1032,["category-name"]))),128))]),_:1},8,["model-value","label"])}}}),N="https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images",E="utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText";function Nt(){const{t:o}=B(),t=R(!1),n=R(0),s=L(()=>t.value?[{categoryName:o("fate_series"),options:[{label:o("jean_alter"),url:`${N}/jean-alter.jpg`},{label:o("rider_5th"),url:`${N}/rider-5th.jpg`}]},{categoryName:o("eighty_six"),options:[{label:o("vladilena_milize"),url:`${N}/vladilena-milize.jpg`}]},{categoryName:o("attack_on_titan"),options:[{label:o("eren_yeager"),url:`${N}/eren-yeager.jpg`}]}]:[{categoryName:o("nature"),options:[{label:"Kamran Ch",url:`${N}/mountain.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/t/act-for-nature?${E}`},creator:{name:"Kamran Ch",url:`https://unsplash.com/@kamranch?${E}`}},{label:"David Scanlon",url:`${N}/gorilla.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/t/nature?${E}`},creator:{name:"David Scanlon",url:`https://unsplash.com/@dsartwork?${E}`}}]},{categoryName:o("cat",2),options:[{label:"Pacto Visual",url:`${N}/cat_pacto-visual.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/s/photos/cat?${E}`},creator:{name:"Pacto Visual",url:`https://unsplash.com/@pactovisual?${E}`}},{label:"Georgi Benev",url:`${N}/cat_georgi-benev.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/s/photos/cat-box?${E}`},creator:{name:"georgi benev",url:`https://unsplash.com/@georgibenev97?${E}`}}]}]),m=R(f());function f(){const v=se(0,s.value.length-1),y=se(0,s.value[v].options.length-1);return s.value[v].options[y].url}let g;function c(){n.value+=1,clearTimeout(g),g=setTimeout(()=>n.value=0,200),n.value===10&&(t.value=!t.value,m.value=f())}function b(v){for(let y=0;y<s.value.length;y++)for(let $=0;$<s.value[y].options.length;$++)if(s.value[y].options[$].url===v)return s.value[y].options[$]}return{selectedImageUrl:m,images:s,findImageByUrl:b,worship:c}}function Et(){const o=fe(),{data:t}=ne();return ve(async({score:n})=>{if(!t.value)return null;const{data:s}=await A.from("sliding-puzzle-records").select("*").eq("user_id",t.value.id).order("score",{ascending:!0});if(!s)return null;switch(s.length<=10){case!0:return(await A.from("sliding-puzzle-records").insert({score:n,user_id:t.value.id}).single()).data;case!1:{const m=s[s.length-1];return m.score<n?null:(await A.from("sliding-puzzle-records").update({id:m.id,score:n}).single()).data}}},{onSuccess:n=>{if(!t.value)return;const{user_name:s=t.value.email,avatar_url:m=""}=t.value.user_metadata;if(!n)return;const f=o.getQueryData("sliding-puzzle-records");!f||o.setQueryData("sliding-puzzle-records",()=>[...f,te(ee({},n),{user:{user_name:s,avatar_url:m}})].sort((g,c)=>g.score-c.score))}})}function Ut(){const s=R("shuffle"),m=ye(ke),f=m.greater("sm"),g=m.greater("lg"),c=L(()=>g.value?140:f.value?100:60),b=Et(),v=R(0),y=R(null),$=R(null),k=L(()=>!y.value||!$.value?null:$.value-y.value),w=L(()=>k.value?v.value+Math.floor(k.value/1e3):null),u=R([[0,0,0,0,0,0,0],[0,1,2,3,4,5,0],[0,6,7,8,9,10,0],[0,11,12,13,14,15,0],[0,16,17,18,19,20,0],[0,21,22,23,24,25,0],[0,0,0,0,0,-1,0],[0,0,0,0,0,0,0]]);$e(async()=>O());function C(i,a,l){let d=[];const x=u.value[i-1][a],V=u.value[i+1][a],S=u.value[i][a+1],G=u.value[i][a-1];return 0<x&&x!==l&&d.push(x),0<V&&V!==l&&d.push(V),0<S&&S!==l&&d.push(S),0<G&&G!==l&&d.push(G),l&&(d=d.filter(le=>le!==25)),pe(1,d)[0]}async function O(){y.value=null,$.value=null,u.value=[[0,0,0,0,0,0,0],[0,1,2,3,4,5,0],[0,6,7,8,9,10,0],[0,11,12,13,14,15,0],[0,16,17,18,19,20,0],[0,21,22,23,24,25,0],[0,0,0,0,0,-1,0],[0,0,0,0,0,0,0]],await be(),v.value=0,s.value="shuffle";let i;for(let a=0;a<50;a++){const l=document.getElementById("void");if(!l)return;const d=Number(l.dataset.rowidx),x=Number(l.dataset.colidx),V=C(d,x,i),S=document.getElementById(V.toString());if(!S)return;await Y(S,Number(S.dataset.rowidx),Number(S.dataset.colidx),!1),i=V}s.value="ready"}function P(){let a=0;for(let l=0;l<u.value.length;l++)for(let d=0;d<u.value[l].length;d++){const x=u.value[l][d];if(x!==0){if(a===25&&x===-1)return!0;if(a+1!==x)return!1;a++}}return!0}async function Y(i,a,l,d=!0){const x=T(a,l);return d&&(i.style.transition="transform linear 0.1s"),x==="top"&&(d&&(i.style.transform=`translateY(-${c.value}px)`,await Z(100)),[u.value[a][l],u.value[a-1][l]]=[u.value[a-1][l],u.value[a][l]]),x==="bottom"&&(d&&(i.style.transform=`translateY(${c.value}px)`,await Z(100)),[u.value[a][l],u.value[a+1][l]]=[u.value[a+1][l],u.value[a][l]]),x==="right"&&(d&&(i.style.transform=`translateX(${c.value}px)`,await Z(100)),[u.value[a][l],u.value[a][l+1]]=[u.value[a][l+1],u.value[a][l]]),x==="left"&&(d&&(i.style.transform=`translateX(-${c.value}px)`,await Z(100)),[u.value[a][l],u.value[a][l-1]]=[u.value[a][l-1],u.value[a][l]]),d&&(i.style.transition=""),!!x}async function Z(i){await new Promise(a=>setTimeout(()=>a(!0),i))}function T(i,a){return u.value[i-1][a]===-1?"top":u.value[i+1][a]===-1?"bottom":u.value[i][a+1]===-1?"right":u.value[i][a-1]===-1?"left":null}async function Q(i,a,l){if(s.value==="shuffle"||s.value==="done")return;const d=i.currentTarget;!d||!await Y(d,a,l)||(y.value||(y.value=new Date().getTime()),v.value+=1,s.value==="ready"&&(s.value="playing"),!!P()&&(s.value="done",$.value=new Date().getTime(),!!w.value&&(console.log(w.value),b.mutate({score:w.value}))))}function q(i){const a=(i-1)%5*c.value*-1,l=Math.floor((i-1)/5)*c.value*-1;return`${a}px ${l}px`}return{SHUFFLE_COUNT:50,nodeSize:c,SIZE_X:5,SIZE_Y:5,clicksCount:v,status:s,nodes:u,score:w,time:k,computeBgPosition:q,onClickNode:Q,initialize:O}}const Rt={class:"mt-20 grid gap-12 place-items-center text-dark-500 dark:text-light-500"},Tt={key:0,class:"w-0 h-0"},Vt=["data-rowIdx","data-colIdx"],jt=["id","data-rowIdx","data-colIdx","onClick"],Ft={class:"absolute inset-0 bg-black bg-opacity-50 grid place-items-center"},Lt={key:0,class:"mt-2 text-center text-rose-500 text-sm"},Mt=H({setup(o){const{data:t}=ne(),{t:n}=B(),{SHUFFLE_COUNT:s,SIZE_X:m,SIZE_Y:f,clicksCount:g,nodeSize:c,status:b,nodes:v,score:y,time:$,computeBgPosition:k,onClickNode:w,initialize:u}=Ut(),{selectedImageUrl:C,findImageByUrl:O,worship:P,images:Y}=Nt();return xe(()=>C.value,()=>u()),(Z,T)=>{const Q=Ce("client-only"),q=me;return _(),p(M,null,[z(e(we),null,{default:X(()=>[r("title",null,h(e(n)("sliding_puzzle"))+" | "+h(e(n)("jon_ganebskis_blog")),1)]),_:1}),r("div",Rt,[r("h1",{class:"text-3xl md:text-5xl",onClick:T[0]||(T[0]=(...i)=>e(P)&&e(P)(...i))},h(e(n)("sliding_puzzle")),1),z(St,{modelValue:e(C),"onUpdate:modelValue":T[1]||(T[1]=i=>ze(C)?C.value=i:null),images:e(Y)},null,8,["modelValue","images"]),z(kt,{class:"min-h-20","shuffle-count":e(s),"clicks-count":e(g),time:e($),score:e(y)},null,8,["shuffle-count","clicks-count","time","score"])]),z(Q,null,{default:X(()=>[r("div",{class:"relative grid gap-px transition-all duration-1000 ease-linear",style:j({gridTemplateRows:`auto repeat(${e(f)}, ${e(c)}px) auto`})},[r("div",{class:F(["absolute top-0 left-1/2 transform -translate-x-1/2 z-1 pointer-events-none",[e(b)==="done"?"shadow-2xl":"shadow"]]),style:j({width:`${e(m)*e(c)+e(m)}px`,height:`${e(f)*e(c)+e(f)}px`})},[r("div",{class:F(["absolute top-0 left-0 z-1 w-full h-full bg-white opacity-0",{"done__anim-mask":e(b)==="done"}])},null,2),r("div",{class:F(["w-full h-full bg-cover",[e(b)==="done"?"done__anim-image opacity-100":"opacity-0"]]),style:j({backgroundImage:`url(${e(C)})`})},null,6)],6),(_(!0),p(M,null,D(e(v),(i,a)=>(_(),p("div",{key:a,class:"grid gap-px transition-all duration-1000 ease-linear",style:j({gridTemplateColumns:`auto repeat(${e(m)}, ${e(c)}px) auto`})},[(_(!0),p(M,null,D(i,(l,d)=>(_(),p("div",{key:l},[l===0?(_(),p("div",Tt)):l===-1?(_(),p("div",{key:1,id:"void","data-rowIdx":a,"data-colIdx":d,style:j({width:`${e(c)}px`,height:`${e(c)}px`})},null,12,Vt)):(_(),p("button",{key:2,id:l.toString(),"data-rowIdx":a,"data-colIdx":d,class:"text-white",style:j({width:`${e(c)}px`,height:`${e(c)}px`,backgroundImage:`url(${e(C)})`,backgroundSize:`${e(c)*e(m)}px ${e(c)*e(f)}px`,backgroundPosition:e(k)(l),transform:"translate(0px)"}),onClick:x=>e(w)(x,a,d)},[r("div",Ft,h(e(b)==="done"?"":l),1)],12,jt))]))),128))],4))),128))],4)]),_:1}),e(t)?U("",!0):(_(),p("div",Lt,h(e(n)("games_auth_warning")),1)),z(He,{"selected-image":e(O)(e(C))},null,8,["selected-image"]),z(ht),z(q)],64)}}});var Ot=ae(Mt,[["__scopeId","data-v-2034d7e1"]]);export{Ot as default};
