import{r as T,p as P,d as X,av as E,j as _,R as Y,t as C,v as i,m as d,F,W as y,y as $,n as j,h as g,x as K}from"./vendor.45184b27.js";import{r as U}from"./app.0121565c.js";var G=(l=>(l[l.WALL=0]="WALL",l[l.BIRTH=1]="BIRTH",l[l.VOID=2]="VOID",l[l.FOSSIL_I=3]="FOSSIL_I",l[l.FOSSIL_J=4]="FOSSIL_J",l[l.FOSSIL_L=5]="FOSSIL_L",l[l.FOSSIL_O=6]="FOSSIL_O",l[l.FOSSIL_S=7]="FOSSIL_S",l[l.FOSSIL_T=8]="FOSSIL_T",l[l.FOSSIL_Z=9]="FOSSIL_Z",l[l.I=10]="I",l[l.J=11]="J",l[l.L=12]="L",l[l.O=13]="O",l[l.S=14]="S",l[l.T=15]="T",l[l.Z=16]="Z",l))(G||{});const q=30,H=9,A=20,W=4,Q=T(x());function x(){return Array.from({length:A},(l,n)=>n===A-1?Array.from({length:H},()=>0):Array.from({length:H},(r,f)=>f===0||f===H-1?0:n<=W-1?1:2))}const M=T(w()),Z=T(w());function w(){return U(1,[10,13])[0]}function D(){M.value=Z.value,Z.value=w()}function z(){return{nodes:Q,NODE_SIZE:q,TOP_RESERVE:W,NODE:G,currNode:M,nextNode:Z,switchNode:D,X_SIZE:H,Y_SIZE:A}}function N(){const{nodes:l,NODE:n,TOP_RESERVE:r}=z(),f=Object.freeze([[0,4],[1,4],[2,4],[3,4]]),u=T([...f]),S=T(0),h=P(()=>u.value.map(([t,e])=>[t+1,e])),R=P(B);function B(){let t=!1,e=0;for(;!t;){e++;for(let a=0;a<u.value.length;a++){const[o,b]=u.value[a];if(!(l.value[o+e][b]===n.BIRTH||l.value[o+e][b]===n.VOID||l.value[o+e][b]===n.I)){t=!0;break}}}return u.value.map(([a,o])=>[a+e-1,o])}function V(){S.value=0,u.value=[...f],u.value.forEach(([t,e])=>l.value[t][e]=n.I)}function s(){let t=!1;for(let e=0;e<h.value.length;e++){const[a,o]=h.value[e];if(!(l.value[a][o]===n.BIRTH||l.value[a][o]===n.VOID||l.value[a][o]===n.I)){t=!0;break}}return t?(u.value.forEach(([e,a])=>l.value[e][a]=n.FOSSIL_I),!1):(u.value.forEach(([e,a])=>{l.value[e][a]=e<=r-1?n.BIRTH:n.VOID}),h.value.forEach(([e,a])=>{l.value[e][a]=n.I}),u.value=h.value,!0)}function p(){let t=!1;u.value.forEach(([e,a])=>{l.value[e][a+1]!==n.VOID&&l.value[e][a+1]!==n.BIRTH&&l.value[e][a+1]!==n.I&&(t=!0)}),!t&&(u.value.forEach(([e,a],o)=>{l.value[e][a]=e<=r-1?n.BIRTH:n.VOID,u.value[o]=[e,a+1]}),u.value.forEach(([e,a])=>{l.value[e][a]=n.I}))}function O(){let t=!1;u.value.forEach(([e,a])=>{l.value[e][a-1]!==n.VOID&&l.value[e][a-1]!==n.BIRTH&&l.value[e][a-1]!==n.I&&(t=!0)}),!t&&(u.value.forEach(([e,a],o)=>{l.value[e][a]=e<=r-1?n.BIRTH:n.VOID,u.value[o]=[e,a-1]}),u.value.forEach(([e,a])=>{l.value[e][a]=n.I}))}function v(){u.value.forEach(([t,e])=>{l.value[t][e]=t<=r-1?n.BIRTH:n.VOID}),S.value===0?(u.value.forEach(([t,e],a,o)=>{a===0&&(u.value[a]=[o[2][0],o[2][1]-2]),a===1&&(u.value[a]=[o[2][0],o[2][1]-1]),a===2&&(u.value[a]=[t,e]),a===3&&(u.value[a]=[o[2][0],o[2][1]+1])}),S.value=1):(u.value.forEach(([t,e],a,o)=>{a===0&&(u.value[a]=[o[2][0]-2,o[2][1]]),a===1&&(u.value[a]=[o[2][0]-1,o[2][1]]),a===2&&(u.value[a]=[t,e]),a===3&&(u.value[a]=[o[2][0]+1,o[2][1]])}),S.value=0),u.value.forEach(([t,e])=>{l.value[t][e]=n.I})}return{defaultPosition:f,nextPosition:h,endPosition:R,position:u,shape:S,prepare:V,fall:s,moveRight:p,moveLeft:O,changeShape:v}}function ee(){const{nodes:l,NODE:n,TOP_RESERVE:r}=z(),f=Object.freeze([[2,3],[2,4],[3,3],[3,4]]),u=T([...f]),S=T(0),h=P(()=>u.value.map(([v,t])=>[v+1,t])),R=P(B);function B(){let v=!1,t=0;for(;!v;){t++;for(let e=0;e<u.value.length;e++){const[a,o]=u.value[e];if(!(l.value[a+t][o]===n.BIRTH||l.value[a+t][o]===n.VOID||l.value[a+t][o]===n.O)){v=!0;break}}}return u.value.map(([e,a])=>[e+t-1,a])}function V(){S.value=0,u.value=[...f],u.value.forEach(([v,t])=>l.value[v][t]=n.O)}function s(){let v=!1;for(let t=0;t<h.value.length;t++){const[e,a]=h.value[t];if(!(l.value[e][a]===n.BIRTH||l.value[e][a]===n.VOID||l.value[e][a]===n.O)){v=!0;break}}return v?(u.value.forEach(([t,e])=>l.value[t][e]=n.FOSSIL_O),!1):(u.value.forEach(([t,e])=>{l.value[t][e]=t<=r-1?n.BIRTH:n.VOID}),h.value.forEach(([t,e])=>{l.value[t][e]=n.O}),u.value=h.value,!0)}function p(){let v=!1;u.value.forEach(([t,e])=>{l.value[t][e+1]!==n.VOID&&l.value[t][e+1]!==n.BIRTH&&l.value[t][e+1]!==n.O&&(v=!0)}),!v&&(u.value.forEach(([t,e],a)=>{l.value[t][e]=t<=r-1?n.BIRTH:n.VOID,u.value[a]=[t,e+1]}),u.value.forEach(([t,e])=>{l.value[t][e]=n.O}))}function O(){let v=!1;u.value.forEach(([t,e],a)=>{l.value[t][e-1]!==n.VOID&&l.value[t][e-1]!==n.BIRTH&&l.value[t][e-1]!==n.O&&(v=!0)}),!v&&(u.value.forEach(([t,e],a)=>{l.value[t][e]=t<=r-1?n.BIRTH:n.VOID,u.value[a]=[t,e-1]}),u.value.forEach(([t,e])=>{l.value[t][e]=n.O}))}return{prepare:V,fall:s,moveRight:p,moveLeft:O,position:u,endPosition:R}}const le=d("div",null,"Tetris",-1),ae={class:"mx-auto flex"},te={key:0,class:"grid gap-px"},ue={key:1,class:"grid gap-px grid-cols-2"},ne={class:"flex justify-center items-center"},ve=X({setup(l){const{nodes:n,NODE:r,NODE_SIZE:f,currNode:u,nextNode:S,switchNode:h,X_SIZE:R,Y_SIZE:B,TOP_RESERVE:V}=z(),s=N(),p=ee(),O=700;let v;const t=T(O);function e(){u.value===r.I?s.prepare():u.value===r.O&&p.prepare(),a()}function a(){clearTimeout(v),v=setTimeout(()=>{if(u.value===r.I?!s.fall():!p.fall()){if(clearTimeout(v),!o()){window.alert("Game Over!");return}h(),u.value===r.I?s.prepare():p.prepare()}a()},t.value)}function o(){const c=u.value===r.I?s.position.value:p.position.value;for(let m=0;m<c.length;m++){const[I]=c[m];if(I<V)return!1}return!0}E("ArrowUp",c=>{c.preventDefault(),u.value===r.I&&s.changeShape()}),E("ArrowRight",c=>{c.preventDefault(),u.value===r.I?s.moveRight():p.moveRight()}),E("ArrowLeft",c=>{c.preventDefault(),u.value===r.I?s.moveLeft():p.moveLeft()}),E("ArrowDown",c=>{c.preventDefault(),t.value=0,a(),t.value=O});function b(c,m){return u.value===r.I?!!s.endPosition.value.find(([I,L])=>I===c&&L===m):p.endPosition.value.find(([I,L])=>I===c&&L===m)}return(c,m)=>(g(),_(F,null,[le,Y(" "+C(i(s).endPosition)+" ",1),d("button",{onClick:e},"Start"),d("button",{onClick:m[0]||(m[0]=(...I)=>i(s).fall&&i(s).fall(...I))},"Fall"),d("div",null,[d("p",null,"Current Node: "+C(i(u)),1)]),d("div",ae,[i(S)===i(r).I?(g(),_("div",te,[(g(),_(F,null,y(4,I=>d("div",{key:I,class:"w-8 h-8 bg-blue-200"})),64))])):$("",!0),i(S)===i(r).O?(g(),_("div",ue,[(g(),_(F,null,y(4,I=>d("div",{key:I,class:"w-8 h-8 bg-red-200"})),64))])):$("",!0)]),d("div",ne,[d("div",{class:"grid gap-px bg-black",style:j({width:`${i(f)*i(R)+8}px`,height:`${i(f)*i(B)+14}px`})},[(g(!0),_(F,null,y(i(n),(I,L)=>(g(),_("div",{key:L,class:"grid grid-cols-9 gap-px bg-black"},[(g(!0),_(F,null,y(I,(k,J)=>(g(),_("div",{key:J,class:K(["bg-white border border-transparent",{"bg-blue-200":k===i(r).I||k===i(r).FOSSIL_I,"bg-red-200":k===i(r).O||k===i(r).FOSSIL_O,"border-red-700":b(L,J)}]),style:j({width:`${i(f)}px`,height:`${i(f)}px`})},C(k),7))),128))]))),128))],4)])],64))}});export{ve as default};
