var ue=Object.defineProperty,ie=Object.defineProperties;var ce=Object.getOwnPropertyDescriptors;var ee=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var te=(l,t,n)=>t in l?ue(l,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[t]=n,ae=(l,t)=>{for(var n in t||(t={}))de.call(t,n)&&te(l,n,t[n]);if(ee)for(var n of ee(t))pe.call(t,n)&&te(l,n,t[n]);return l},se=(l,t)=>ie(l,ce(t));import{s as Y,_ as le,u as Z,h as ne,d as oe,e as me,r as _e,a as ge}from"./app.dba611e8.js";import{P as ve,d as D,h as d,j as v,m as b,t as p,x as O,y as R,v as e,T as J,p as B,R as he,S as K,w as A,W as X,F as H,r as T,$ as fe,a0 as ye,aq as $e,o as be,ar as ke,as as ze,N as Ce,s as j,H as xe,at as Se,ac as we,q as Ee,n as M}from"./vendor.1a6f5219.js";import{b as Ne,a as Ue,_ as Re}from"./records.57ae6996.js";const Te=1e3*60*60;function je(){return ve("sliding-puzzle-records",async()=>(await Y.from("sliding-puzzle-records").select("*, user: user_id (user_name, avatar_url)").order("score",{ascending:!0}).limit(100)).data,{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,staleTime:Te,retry:!1})}const Ve={class:"mt-4 px-2 text-center"},Fe={key:0,class:"text-sm text-gray-700 dark:text-gray-300"},Le=J(" Photo by "),Me=["href"],Oe={key:1,class:"text-sm text-gray-700 dark:text-gray-300"},Be=J(" on "),Ze=["href"],Pe={class:"text-xs text-gray-500"},He=D({props:{selectedImage:null},setup(l){const t=l,{t:n}=Z();return(o,m)=>{var c,f,_,S,g,k,y,$,z,E;return d(),v("div",Ve,[((c=t.selectedImage)==null?void 0:c.creator)?(d(),v("span",Fe,[Le,b("a",{class:O([((f=t.selectedImage)==null?void 0:f.creator.url)?"link__active":"link__inactive"]),href:(_=t.selectedImage)==null?void 0:_.creator.url,target:"_blank",rel:"noopener"},p((g=(S=t.selectedImage)==null?void 0:S.creator)==null?void 0:g.name),11,Me)])):R("",!0),((k=t.selectedImage)==null?void 0:k.provider)?(d(),v("span",Oe,[Be,b("a",{class:O([((y=t.selectedImage)==null?void 0:y.provider.url)?"link__active":"link__inactive"]),href:($=t.selectedImage)==null?void 0:$.provider.url,target:"_blank",rel:"noopener"},p((E=(z=t.selectedImage)==null?void 0:z.provider)==null?void 0:E.name),11,Ze)])):R("",!0),b("p",Pe,p(e(n)("all_rights_of_the_image_belong_to_the_creator")),1)])}}});var De=le(He,[["__scopeId","data-v-176f9680"]]);const Ye={class:"text-sm"},Ae={key:0,class:""},Xe={key:0},Qe={key:1},qe={key:2},Ie={key:1},Ge=D({props:{clicksCount:null,shuffleCount:null,score:null,time:null},setup(l){const t=l,{t:n}=Z(),o=B(()=>{if(!t.time)return null;const m=Math.floor(t.time/(1e3*60)),c=Math.floor((t.time-m*1e3*60)/1e3),f=t.time-m*1e3*60-c*1e3;return{minutes:m,seconds:c,milliseconds:f}});return(m,c)=>(d(),v("div",Ye,[b("span",null,[J(p(e(n)("move",2))+": ",1),b("span",{class:O([t.clicksCount<=t.shuffleCount?"text-green-500":t.clicksCount<t.shuffleCount*2?"text-yellow-500":"text-red-500"])},p(t.clicksCount),3)]),e(o)?(d(),v("p",Ae,[b("span",null,p(e(n)("time"))+": ",1),e(o).minutes?(d(),v("span",Xe,p(e(o).minutes)+" "+p(e(n)("minutes").toLowerCase())+" "+p(" "),1)):R("",!0),e(o).seconds?(d(),v("span",Qe,p(e(o).seconds)+" "+p(e(n)("seconds").toLowerCase())+" "+p(" "),1)):R("",!0),e(o).milliseconds?(d(),v("span",qe,p(e(o).milliseconds)+" "+p(e(n)("milliseconds").toLowerCase()),1)):R("",!0)])):R("",!0),l.score?(d(),v("p",Ie,p(e(n)("score"))+": "+p(l.score),1)):R("",!0)]))}}),We={class:"mt-2 text-sm"},Ke={class:"pl-2 font-bold"},Je={display:"mt-1 grid"},et=D({props:{categoryName:null},setup(l){const t=l;return(n,o)=>(d(),v("div",We,[b("span",Ke,p(t.categoryName),1),b("div",Je,[he(n.$slots,"default")])]))}}),tt=D({props:{modelValue:null,images:null},emits:["update:modelValue"],setup(l,{emit:t}){const n=l,{t:o}=Z();return(m,c)=>{const f=Ne,_=et,S=Ue;return d(),K(S,{"model-value":n.modelValue,label:e(o)("image"),class:"w-72","onUpdate:modelValue":c[0]||(c[0]=g=>t("update:modelValue",g.toString()))},{default:A(()=>[(d(!0),v(H,null,X(n.images,({categoryName:g,options:k})=>(d(),K(_,{key:g,"category-name":g,class:"text-dark-500"},{default:A(()=>[(d(!0),v(H,null,X(k,y=>(d(),K(f,{key:y.url,value:y.url,label:y.label},null,8,["value","label"]))),128))]),_:2},1032,["category-name"]))),128))]),_:1},8,["model-value","label"])}}}),C="https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images",x="utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText";function at(){const{t:l}=Z(),t=20,n=T(!1),o=T(0),m=B(()=>100-Math.min(100,o.value/t*100)),c=B(()=>n.value?[{categoryName:l("fate_series"),options:[{label:l("jeanne_alter"),url:`${C}/jean-alter.jpg`},{label:l("rider_5th"),url:`${C}/rider-5th.jpg`}]},{categoryName:l("eighty_six"),options:[{label:l("vladilena_milize"),url:`${C}/vladilena-milize.jpg`}]},{categoryName:l("attack_on_titan"),options:[{label:l("eren_yeager"),url:`${C}/eren-yeager.jpg`},{label:l("sasha_braus"),url:`${C}/sasha-braus.jpg`}]},{categoryName:l("evangelion"),options:[{label:l("asuka_langley_sohryu"),url:`${C}/asuka-langley-soryu.jpg`},{label:l("rei_ayanami"),url:`${C}/rei-ayanami.png`}]}]:[{categoryName:l("nature"),options:[{label:"Kamran Ch",url:`${C}/mountain.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/t/act-for-nature?${x}`},creator:{name:"Kamran Ch",url:`https://unsplash.com/@kamranch?${x}`}},{label:"David Scanlon",url:`${C}/gorilla.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/t/nature?${x}`},creator:{name:"David Scanlon",url:`https://unsplash.com/@dsartwork?${x}`}},{label:"In\xE9s \xC1lvarez Fdez",url:`${C}/wave.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/s/photos/ocean?${x}`},creator:{name:"In\xE9s \xC1lvarez Fdez",url:`https://unsplash.com/@powwpic?${x}`}}]},{categoryName:l("cat",2),options:[{label:"Pacto Visual",url:`${C}/cat_pacto-visual.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/s/photos/cat?${x}`},creator:{name:"Pacto Visual",url:`https://unsplash.com/@pactovisual?${x}`}},{label:"Georgi Benev",url:`${C}/cat_georgi-benev.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/s/photos/cat-box?${x}`},creator:{name:"georgi benev",url:`https://unsplash.com/@georgibenev97?${x}`}},{label:"Michael Sum",url:`${C}/cat_michael-sum.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/s/photos/cat?${x}`},creator:{name:"Michael Sum",url:`https://unsplash.com/@michaelsum1228?${x}`}}]}]),f=T(_());function _(){const y=ne(0,c.value.length-1),$=ne(0,c.value[y].options.length-1);return c.value[y].options[$].url}let S;function g(){n.value||(o.value+=1,clearTimeout(S),S=setTimeout(()=>o.value=0,200),o.value===t&&(n.value=!n.value,f.value=_()))}function k(y){for(let $=0;$<c.value.length;$++)for(let z=0;z<c.value[$].options.length;z++)if(c.value[$].options[z].url===y)return c.value[$].options[z]}return{worshipRatioReverse:m,selectedImageUrl:f,images:c,findImageByUrl:k,worship:g}}function st(){const l=ye(),{data:t}=oe();return fe(async({score:n})=>{if(!t.value)return null;const{data:o}=await Y.from("sliding-puzzle-records").select("*").eq("user_id",t.value.id).order("score",{ascending:!0});if(!o)return null;switch(o.length<=10){case!0:return(await Y.from("sliding-puzzle-records").insert({score:n,user_id:t.value.id}).single()).data;case!1:{const m=o[o.length-1];return m.score<n?null:(await Y.from("sliding-puzzle-records").update({id:m.id,score:n}).single()).data}}},{onSuccess:n=>{if(!t.value)return;const{user_name:o=t.value.email,avatar_url:m=""}=t.value.user_metadata;if(!n)return;const c=l.getQueryData("sliding-puzzle-records");!c||l.setQueryData("sliding-puzzle-records",()=>[...c,se(ae({},n),{user:{user_name:o,avatar_url:m}})].sort((f,_)=>f.score-_.score))}})}function nt(){const o=T("shuffle"),m=$e(ze),c=m.greater("sm"),f=m.greater("lg"),_=B(()=>f.value?140:c.value?100:60),S=st(),{openIssueModal:g}=me(),{t:k}=Z(),y=T(0),$=T(null),z=T(null),E=B(()=>!$.value||!z.value?null:z.value-$.value),V=B(()=>E.value?y.value+Math.floor(E.value/1e3):null),r=T([[0,0,0,0,0,0,0],[0,1,2,3,4,5,0],[0,6,7,8,9,10,0],[0,11,12,13,14,15,0],[0,16,17,18,19,20,0],[0,21,22,23,24,25,0],[0,0,0,0,0,-1,0],[0,0,0,0,0,0,0]]);be(async()=>w());function Q(i,a,s){let u=[];const h=r.value[i-1][a],N=r.value[i+1][a],U=r.value[i][a+1],W=r.value[i][a-1];return 0<h&&h!==s&&u.push(h),0<N&&N!==s&&u.push(N),0<U&&U!==s&&u.push(U),0<W&&W!==s&&u.push(W),s&&(u=u.filter(re=>re!==25)),_e(1,u)[0]}async function w(){$.value=null,z.value=null,r.value=[[0,0,0,0,0,0,0],[0,1,2,3,4,5,0],[0,6,7,8,9,10,0],[0,11,12,13,14,15,0],[0,16,17,18,19,20,0],[0,21,22,23,24,25,0],[0,0,0,0,0,-1,0],[0,0,0,0,0,0,0]],await ke(),y.value=0,o.value="shuffle";let i;for(let a=0;a<50;a++){const s=document.getElementById("void");if(!s)return;const u=Number(s.dataset.rowidx),h=Number(s.dataset.colidx),N=Q(u,h,i),U=document.getElementById(N.toString());if(!U)return;await P(U,Number(U.dataset.rowidx),Number(U.dataset.colidx),!1),i=N}o.value="ready"}function q(){let a=0;for(let s=0;s<r.value.length;s++)for(let u=0;u<r.value[s].length;u++){const h=r.value[s][u];if(h!==0){if(a===25&&h===-1)return!0;if(a+1!==h)return!1;a++}}return!0}async function P(i,a,s,u=!0){const h=I(a,s);return u&&(i.style.transition="transform linear 0.1s"),h==="top"&&(u&&(i.style.transform=`translateY(-${_.value}px)`,await F(100)),[r.value[a][s],r.value[a-1][s]]=[r.value[a-1][s],r.value[a][s]]),h==="bottom"&&(u&&(i.style.transform=`translateY(${_.value}px)`,await F(100)),[r.value[a][s],r.value[a+1][s]]=[r.value[a+1][s],r.value[a][s]]),h==="right"&&(u&&(i.style.transform=`translateX(${_.value}px)`,await F(100)),[r.value[a][s],r.value[a][s+1]]=[r.value[a][s+1],r.value[a][s]]),h==="left"&&(u&&(i.style.transform=`translateX(-${_.value}px)`,await F(100)),[r.value[a][s],r.value[a][s-1]]=[r.value[a][s-1],r.value[a][s]]),u&&(i.style.transition=""),!!h}async function F(i){await new Promise(a=>setTimeout(()=>a(!0),i))}function I(i,a){return r.value[i-1][a]===-1?"top":r.value[i+1][a]===-1?"bottom":r.value[i][a+1]===-1?"right":r.value[i][a-1]===-1?"left":null}async function L(i,a,s){if(o.value==="shuffle"||o.value==="done")return;const u=i.currentTarget;!u||!await P(u,a,s)||($.value||($.value=new Date().getTime()),y.value+=1,o.value==="ready"&&(o.value="playing"),!!q()&&(o.value="done",z.value=new Date().getTime(),!!V.value&&(console.log(V.value),S.mutate({score:V.value},{onError:()=>g({title:k("record_mutation_failed.title"),content:k("record_mutation_failed.content")})}))))}function G(i){const a=(i-1)%5*_.value*-1,s=Math.floor((i-1)/5)*_.value*-1;return`${a}px ${s}px`}return{SHUFFLE_COUNT:50,nodeSize:_,SIZE_X:5,SIZE_Y:5,clicksCount:y,status:o,nodes:r,score:V,time:E,computeBgPosition:G,onClickNode:L,initialize:w}}const lt={class:"mt-20 grid gap-12 place-items-center text-dark-500 dark:text-light-500"},ot={class:"inline-block worship__inactive"},rt={class:"inline-block worship__active","aria-hidden":"true"},ut={key:0,class:"w-0 h-0"},it=["data-rowIdx","data-colIdx"],ct=["id","data-rowIdx","data-colIdx","onClick"],dt={class:"absolute inset-0 bg-black bg-opacity-50 grid place-items-center"},pt={key:0,class:"mt-2 text-center text-rose-500 text-sm"},mt=D({setup(l){we(I=>({"79b2ae73":e(Q)+"%"}));const{data:t}=oe(),{data:n,isLoading:o}=je(),{t:m}=Z(),{SHUFFLE_COUNT:c,SIZE_X:f,SIZE_Y:_,clicksCount:S,nodeSize:g,status:k,nodes:y,score:$,time:z,computeBgPosition:E,onClickNode:V,initialize:r}=nt(),{worshipRatioReverse:Q,selectedImageUrl:w,findImageByUrl:q,worship:P,images:F}=at();return Ce(()=>w.value,()=>r()),(I,L)=>{const G=Ee("client-only"),i=ge;return d(),v(H,null,[j(e(xe),null,{default:A(()=>[b("title",null,p(e(m)("sliding_puzzle"))+" | "+p(e(m)("jon_ganebskis_blog")),1)]),_:1}),b("div",lt,[b("h1",{class:"relative select-none text-3xl md:text-5xl",onClick:L[0]||(L[0]=(...a)=>e(P)&&e(P)(...a))},[b("span",ot,p(e(m)("sliding_puzzle")),1),b("span",rt,p(e(m)("sliding_puzzle")),1)]),j(tt,{modelValue:e(w),"onUpdate:modelValue":L[1]||(L[1]=a=>Se(w)?w.value=a:null),images:e(F)},null,8,["modelValue","images"]),j(Ge,{class:"min-h-20","shuffle-count":e(c),"clicks-count":e(S),time:e(z),score:e($)},null,8,["shuffle-count","clicks-count","time","score"])]),j(G,null,{default:A(()=>[b("div",{class:"relative grid gap-px transition-all duration-1000 ease-linear",style:M({gridTemplateRows:`auto repeat(${e(_)}, ${e(g)}px) auto`})},[b("div",{class:O(["absolute top-0 left-1/2 transform -translate-x-1/2 z-1 pointer-events-none",[e(k)==="done"?"shadow-2xl":"shadow"]]),style:M({width:`${e(f)*e(g)+e(f)}px`,height:`${e(_)*e(g)+e(_)}px`})},[b("div",{class:O(["absolute top-0 left-0 z-1 w-full h-full bg-white opacity-0",{"done__anim-mask":e(k)==="done"}])},null,2),b("div",{class:O(["w-full h-full bg-cover",[e(k)==="done"?"done__anim-image opacity-100":"opacity-0"]]),style:M({backgroundImage:`url(${e(w)})`})},null,6)],6),(d(!0),v(H,null,X(e(y),(a,s)=>(d(),v("div",{key:s,class:"grid gap-px transition-all duration-1000 ease-linear",style:M({gridTemplateColumns:`auto repeat(${e(f)}, ${e(g)}px) auto`})},[(d(!0),v(H,null,X(a,(u,h)=>(d(),v("div",{key:u},[u===0?(d(),v("div",ut)):u===-1?(d(),v("div",{key:1,id:"void","data-rowIdx":s,"data-colIdx":h,style:M({width:`${e(g)}px`,height:`${e(g)}px`})},null,12,it)):(d(),v("button",{key:2,id:u.toString(),"data-rowIdx":s,"data-colIdx":h,class:"text-white",style:M({width:`${e(g)}px`,height:`${e(g)}px`,backgroundImage:`url(${e(w)})`,backgroundSize:`${e(g)*e(f)}px ${e(g)*e(_)}px`,backgroundPosition:e(E)(u),transform:"translate(0px)"}),onClick:N=>e(V)(N,s,h)},[b("div",dt,p(e(k)==="done"?"":u),1)],12,ct))]))),128))],4))),128))],4)]),_:1}),e(t)?R("",!0):(d(),v("div",pt,p(e(m)("games_auth_warning")),1)),j(De,{"selected-image":e(q)(e(w))},null,8,["selected-image"]),j(Re,{"is-loading":e(o),data:e(n)},null,8,["is-loading","data"]),j(i)],64)}}});var ft=le(mt,[["__scopeId","data-v-e684e000"]]);export{ft as default};
