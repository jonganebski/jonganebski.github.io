import{S as se,aq as ne,U as I,d as Z,t as O,c as _,B as ee,a as b,z as m,q as M,i as E,h as e,o as p,_ as H,f as B,an as le,g as J,m as q,A as G,F as A,r as R,j as te,at as oe,au as re,av as ie,Z as ue,aw as ce,a0 as pe,ai as me,$ as de,as as _e,ap as ge,I as ve,l as fe,y as U,aE as he,H as ye,n as L,D as be}from"./app-1e86ebc7.js";import{R as ke,A as $e}from"./records-d85cecd6.js";import{a as ze,_ as Se}from"./option-f5785676.js";function Ce(){return se(["sliding-puzzle-records"],async()=>(await I.from("sliding-puzzle-records").select("*, user: user_id (user_name, avatar_url)").order("score",{ascending:!0}).limit(100)).data,{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,staleTime:ne,retry:!1})}const we={class:"mt-4 px-2 text-center"},xe={key:0,class:"text-sm text-gray-700 dark:text-gray-300"},Ue=["href"],je={key:1,class:"text-sm text-gray-700 dark:text-gray-300"},Ne=["href"],Re={class:"text-xs text-gray-500"},Ee=Z({__name:"copy-right",props:{selectedImage:{type:null,required:!1}},setup(r){const n=r,{t:i}=O();return(s,v)=>{var u,f,g,d,$,w,h,y,z,j;return p(),_("div",we,[(u=n.selectedImage)!=null&&u.creator?(p(),_("span",xe,[ee(" Photo by "),b("a",{class:M([(f=n.selectedImage)!=null&&f.creator.url?"link__active":"link__inactive"]),href:(g=n.selectedImage)==null?void 0:g.creator.url,rel:"noopener noreferrer",target:"_blank"},m(($=(d=n.selectedImage)==null?void 0:d.creator)==null?void 0:$.name),11,Ue)])):E("v-if",!0),(w=n.selectedImage)!=null&&w.provider?(p(),_("span",je,[ee(" on "),b("a",{class:M([(h=n.selectedImage)!=null&&h.provider.url?"link__active":"link__inactive"]),href:(y=n.selectedImage)==null?void 0:y.provider.url,rel:"noopener noreferrer",target:"_blank"},m((j=(z=n.selectedImage)==null?void 0:z.provider)==null?void 0:j.name),11,Ne)])):E("v-if",!0),b("p",Re,m(e(i)("all_rights_of_the_image_belong_to_the_creator")),1)])}}});const Te=H(Ee,[["__scopeId","data-v-1f083561"],["__file","/Users/jinseok.bang/Documents/github.me/jonganebski.github.io/src/pages/games/sliding-puzzle/components/copy-right.vue"]]),De={class:"text-sm"},Ve={key:0,class:""},Fe={key:0},Le={key:1},Me={key:2},Be={key:1},Oe=Z({__name:"score",props:{clicksCount:{type:Number,required:!0},shuffleCount:{type:Number,required:!0},score:{type:[Number,null],required:!0},time:{type:[Number,null],required:!0}},setup(r){const n=r,{t:i}=O(),s=B(()=>{if(!n.time)return null;const v=Math.floor(n.time/(1e3*60)),u=Math.floor((n.time-v*1e3*60)/1e3),f=n.time-v*1e3*60-u*1e3;return{minutes:v,seconds:u,milliseconds:f}});return(v,u)=>(p(),_("div",De,[b("span",null,[ee(m(e(i)("move",2))+": ",1),b("span",{class:M([n.clicksCount<=n.shuffleCount?"text-green-500":n.clicksCount<n.shuffleCount*2?"text-yellow-500":"text-red-500"])},m(n.clicksCount),3)]),e(s)?(p(),_("p",Ve,[b("span",null,m(e(i)("time"))+": ",1),e(s).minutes?(p(),_("span",Fe,m(e(s).minutes)+" "+m(e(i)("minutes").toLowerCase())+" "+m(" "),1)):E("v-if",!0),e(s).seconds?(p(),_("span",Le,m(e(s).seconds)+" "+m(e(i)("seconds").toLowerCase())+" "+m(" "),1)):E("v-if",!0),e(s).milliseconds?(p(),_("span",Me,m(e(s).milliseconds)+" "+m(e(i)("milliseconds").toLowerCase()),1)):E("v-if",!0)])):E("v-if",!0),r.score?(p(),_("p",Be,m(e(i)("score"))+": "+m(r.score),1)):E("v-if",!0)]))}}),qe=H(Oe,[["__file","/Users/jinseok.bang/Documents/github.me/jonganebski.github.io/src/pages/games/sliding-puzzle/components/score.vue"]]),Ae={class:"mt-2 text-sm"},Ze={class:"pl-2 font-bold"},He={display:"mt-1 grid"},Pe=Z({__name:"option-group",props:{categoryName:{type:String,required:!0}},setup(r){const n=r;return(i,s)=>(p(),_("div",Ae,[b("span",Ze,m(n.categoryName),1),b("div",He,[le(i.$slots,"default")])]))}}),Ye=H(Pe,[["__file","/Users/jinseok.bang/Documents/github.me/jonganebski.github.io/src/components/ui/option-group.vue"]]),Qe=Z({__name:"select-image",props:{modelValue:{type:String,required:!0},images:{type:Array,required:!0}},emits:["update:modelValue"],setup(r,{emit:n}){const i=r,{t:s}=O();return(v,u)=>{const f=Se,g=Ye,d=ze;return p(),J(d,{"model-value":i.modelValue,label:e(s)("image"),class:"w-72","onUpdate:modelValue":u[0]||(u[0]=$=>n("update:modelValue",$.toString()))},{default:q(()=>[(p(!0),_(A,null,G(i.images,({categoryName:$,options:w})=>(p(),J(g,{key:$,"category-name":$,class:"text-dark-500"},{default:q(()=>[(p(!0),_(A,null,G(w,h=>(p(),J(f,{key:h.url,value:h.url,label:h.label},null,8,["value","label"]))),128))]),_:2},1032,["category-name"]))),128))]),_:1},8,["model-value","label"])}}}),Xe=H(Qe,[["__file","/Users/jinseok.bang/Documents/github.me/jonganebski.github.io/src/pages/games/sliding-puzzle/components/select-image.vue"]]),S="https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images",C="utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText";function Ie(){const{t:r}=O(),n=20,i=R(!1),s=R(0),v=B(()=>100-Math.min(100,s.value/n*100)),u=B(()=>i.value?[{categoryName:r("fate_series"),options:[{label:r("jeanne_alter"),url:`${S}/jean-alter.jpg`},{label:r("rider_5th"),url:`${S}/rider-5th.jpg`}]},{categoryName:r("eighty_six"),options:[{label:r("vladilena_milize"),url:`${S}/vladilena-milize.jpg`}]},{categoryName:r("attack_on_titan"),options:[{label:r("eren_yeager"),url:`${S}/eren-yeager.jpg`},{label:r("sasha_braus"),url:`${S}/sasha-braus.jpg`}]},{categoryName:r("evangelion"),options:[{label:r("asuka_langley_sohryu"),url:`${S}/asuka-langley-soryu.jpg`},{label:r("rei_ayanami"),url:`${S}/rei-ayanami.png`}]}]:[{categoryName:r("nature"),options:[{label:"Kamran Ch",url:`${S}/mountain.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/t/act-for-nature?${C}`},creator:{name:"Kamran Ch",url:`https://unsplash.com/@kamranch?${C}`}},{label:"David Scanlon",url:`${S}/gorilla.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/t/nature?${C}`},creator:{name:"David Scanlon",url:`https://unsplash.com/@dsartwork?${C}`}},{label:"Inés Álvarez Fdez",url:`${S}/wave.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/s/photos/ocean?${C}`},creator:{name:"Inés Álvarez Fdez",url:`https://unsplash.com/@powwpic?${C}`}}]},{categoryName:r("cat",2),options:[{label:"Pacto Visual",url:`${S}/cat_pacto-visual.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/s/photos/cat?${C}`},creator:{name:"Pacto Visual",url:`https://unsplash.com/@pactovisual?${C}`}},{label:"Georgi Benev",url:`${S}/cat_georgi-benev.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/s/photos/cat-box?${C}`},creator:{name:"georgi benev",url:`https://unsplash.com/@georgibenev97?${C}`}},{label:"Michael Sum",url:`${S}/cat_michael-sum.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/s/photos/cat?${C}`},creator:{name:"Michael Sum",url:`https://unsplash.com/@michaelsum1228?${C}`}}]}]),f=R(g());function g(){const h=te(0,u.value.length-1),y=te(0,u.value[h].options.length-1);return u.value[h].options[y].url}let d;function $(){i.value||(s.value+=1,clearTimeout(d),d=setTimeout(()=>s.value=0,200),s.value===n&&(i.value=!i.value,f.value=g()))}function w(h){for(let y=0;y<u.value.length;y++)for(let z=0;z<u.value[y].options.length;z++)if(u.value[y].options[z].url===h)return u.value[y].options[z]}return{worshipRatioReverse:v,selectedImageUrl:f,images:u,findImageByUrl:w,worship:$}}function Ge(){const r=oe(),{data:n}=re();return ie(async({score:i})=>{if(!n.value)return null;const{data:s}=await I.from("sliding-puzzle-records").select("*").eq("user_id",n.value.id).order("score",{ascending:!0});if(!s)return null;switch(s.length<=10){case!0:return(await I.from("sliding-puzzle-records").insert({score:i,user_id:n.value.id}).single()).data;case!1:{const v=s[s.length-1];return v.score<i?null:(await I.from("sliding-puzzle-records").update({id:v.id,score:i}).single()).data}}},{onSuccess:i=>{if(!n.value)return;const{user_name:s=n.value.email,avatar_url:v=""}=n.value.user_metadata;if(!i)return;const u=r.getQueryData(["sliding-puzzle-records"]);u&&r.setQueryData(["sliding-puzzle-records"],()=>[...u,{...i,user:{user_name:s,avatar_url:v}}].sort((f,g)=>f.score-g.score))}})}function We(){const s=R("shuffle"),v=ue(de),u=v.greater("sm"),f=v.greater("lg"),g=B(()=>f.value?140:u.value?100:60),d=Ge(),{openIssueModal:$}=ce(),{t:w}=O(),h=R(0),y=R(null),z=R(null),j=B(()=>!y.value||!z.value?null:z.value-y.value),T=B(()=>j.value?h.value+Math.floor(j.value/1e3):null),o=R([[0,0,0,0,0,0,0],[0,1,2,3,4,5,0],[0,6,7,8,9,10,0],[0,11,12,13,14,15,0],[0,16,17,18,19,20,0],[0,21,22,23,24,25,0],[0,0,0,0,0,-1,0],[0,0,0,0,0,0,0]]);pe(async()=>P());function x(l,t,a){let c=[];const k=o.value[l-1][t],F=o.value[l+1][t],N=o.value[l][t+1],K=o.value[l][t-1];return 0<k&&k!==a&&c.push(k),0<F&&F!==a&&c.push(F),0<N&&N!==a&&c.push(N),0<K&&K!==a&&c.push(K),a&&(c=c.filter(ae=>ae!==25)),_e(1,c)[0]}async function P(){y.value=null,z.value=null,o.value=[[0,0,0,0,0,0,0],[0,1,2,3,4,5,0],[0,6,7,8,9,10,0],[0,11,12,13,14,15,0],[0,16,17,18,19,20,0],[0,21,22,23,24,25,0],[0,0,0,0,0,-1,0],[0,0,0,0,0,0,0]],await me(),h.value=0,s.value="shuffle";let l;for(let t=0;t<2;t++){const a=document.getElementById("void");if(!a)return;const c=Number(a.dataset.rowidx),k=Number(a.dataset.colidx),F=x(c,k,l),N=document.getElementById(F.toString());if(!N)return;await Q(N,Number(N.dataset.rowidx),Number(N.dataset.colidx),!1),l=F}s.value="ready"}function Y(){let t=0;for(let a=0;a<o.value.length;a++)for(let c=0;c<o.value[a].length;c++){const k=o.value[a][c];if(k!==0){if(t===25&&k===-1)return!0;if(t+1!==k)return!1;t++}}return!0}async function Q(l,t,a,c=!0){const k=V(t,a);return c&&(l.style.transition="transform linear 0.1s"),k==="top"&&(c&&(l.style.transform=`translateY(-${g.value}px)`,await D(100)),[o.value[t][a],o.value[t-1][a]]=[o.value[t-1][a],o.value[t][a]]),k==="bottom"&&(c&&(l.style.transform=`translateY(${g.value}px)`,await D(100)),[o.value[t][a],o.value[t+1][a]]=[o.value[t+1][a],o.value[t][a]]),k==="right"&&(c&&(l.style.transform=`translateX(${g.value}px)`,await D(100)),[o.value[t][a],o.value[t][a+1]]=[o.value[t][a+1],o.value[t][a]]),k==="left"&&(c&&(l.style.transform=`translateX(-${g.value}px)`,await D(100)),[o.value[t][a],o.value[t][a-1]]=[o.value[t][a-1],o.value[t][a]]),c&&(l.style.transition=""),!!k}async function D(l){await new Promise(t=>setTimeout(()=>t(!0),l))}function V(l,t){return o.value[l-1][t]===-1?"top":o.value[l+1][t]===-1?"bottom":o.value[l][t+1]===-1?"right":o.value[l][t-1]===-1?"left":null}async function X(l,t,a){if(s.value==="shuffle"||s.value==="done")return;const c=l.currentTarget;c&&await Q(c,t,a)&&(y.value||(y.value=new Date().getTime()),h.value+=1,s.value==="ready"&&(s.value="playing"),Y()&&(s.value="done",z.value=new Date().getTime(),T.value&&(console.log(T.value),d.mutate({score:T.value},{onError:()=>$({title:w("record_mutation_failed.title"),content:w("record_mutation_failed.content")})}))))}function W(l){const t=(l-1)%5*g.value*-1,a=Math.floor((l-1)/5)*g.value*-1;return`${t}px ${a}px`}return{SHUFFLE_COUNT:2,nodeSize:g,SIZE_X:5,SIZE_Y:5,clicksCount:h,status:s,nodes:o,score:T,time:j,computeBgPosition:W,onClickNode:X,initialize:P}}const Ke={class:"mt-20 grid gap-12 place-items-center text-dark-500 dark:text-light-500"},Je={class:"py-2 inline-block worship__inactive"},et={class:"py-2 inline-block worship__active","aria-hidden":"true"},tt={key:0,class:"w-0 h-0"},at=["data-rowIdx","data-colIdx"],st=["id","data-rowIdx","data-colIdx","onClick"],nt={class:"absolute inset-0 bg-black bg-opacity-50 grid place-items-center"},lt=Z({__name:"index",setup(r){ge(D=>({"62b785a8-worshipRatioReverse + '%'":e(o)+"%"}));const{data:n,isLoading:i}=Ce(),{t:s}=O(),{SHUFFLE_COUNT:v,SIZE_X:u,SIZE_Y:f,clicksCount:g,nodeSize:d,status:$,nodes:w,score:h,time:y,computeBgPosition:z,onClickNode:j,initialize:T}=We(),{worshipRatioReverse:o,selectedImageUrl:x,findImageByUrl:P,worship:Y,images:Q}=Ie();return ve(()=>x.value,()=>T()),(D,V)=>{const X=fe("client-only"),W=be;return p(),_(A,null,[U(e(ye),null,{default:q(()=>[b("title",null,m(e(s)("sliding_puzzle"))+" | "+m(e(s)("jon_ganebskis_blog")),1)]),_:1}),b("div",Ke,[b("h1",{class:"relative select-none text-3xl md:text-5xl",onClick:V[0]||(V[0]=(...l)=>e(Y)&&e(Y)(...l))},[b("span",Je,m(e(s)("sliding_puzzle")),1),b("span",et,m(e(s)("sliding_puzzle")),1)]),U(Xe,{modelValue:e(x),"onUpdate:modelValue":V[1]||(V[1]=l=>he(x)?x.value=l:null),images:e(Q)},null,8,["modelValue","images"]),U(qe,{class:"min-h-20","shuffle-count":e(v),"clicks-count":e(g),time:e(y),score:e(h)},null,8,["shuffle-count","clicks-count","time","score"])]),U(X,null,{default:q(()=>[b("div",{class:"relative grid gap-px transition-all duration-1000 ease-linear",style:L({gridTemplateRows:`auto repeat(${e(f)}, ${e(d)}px) auto`})},[b("div",{class:M(["absolute top-0 left-1/2 transform -translate-x-1/2 z-1 pointer-events-none",[e($)==="done"?"shadow-2xl":"shadow"]]),style:L({width:`${e(u)*e(d)+e(u)}px`,height:`${e(f)*e(d)+e(f)}px`})},[b("div",{class:M(["absolute top-0 left-0 z-1 w-full h-full bg-white opacity-0",{"done__anim-mask":e($)==="done"}])},null,2),b("div",{class:M(["w-full h-full bg-cover",[e($)==="done"?"done__anim-image opacity-100":"opacity-0"]]),style:L({backgroundImage:`url(${e(x)})`})},null,6)],6),(p(!0),_(A,null,G(e(w),(l,t)=>(p(),_("div",{key:t,class:"grid gap-px transition-all duration-1000 ease-linear",style:L({gridTemplateColumns:`auto repeat(${e(u)}, ${e(d)}px) auto`})},[(p(!0),_(A,null,G(l,(a,c)=>(p(),_("div",{key:a},[a===0?(p(),_("div",tt)):a===-1?(p(),_("div",{key:1,id:"void","data-rowIdx":t,"data-colIdx":c,style:L({width:`${e(d)}px`,height:`${e(d)}px`})},null,12,at)):(p(),_("button",{key:2,id:a.toString(),"data-rowIdx":t,"data-colIdx":c,class:"text-white",style:L({width:`${e(d)}px`,height:`${e(d)}px`,backgroundImage:`url(${e(x)})`,backgroundSize:`${e(d)*e(u)}px ${e(d)*e(f)}px`,backgroundPosition:e(z)(a),transform:"translate(0px)"}),onClick:k=>e(j)(k,t,c)},[b("div",nt,m(e($)==="done"?"":a),1)],12,st))]))),128))],4))),128))],4)]),_:1}),U($e,{class:"mt-2 text-center"}),U(Te,{"selected-image":e(P)(e(x))},null,8,["selected-image"]),U(ke,{"is-loading":e(i),data:e(n)},null,8,["is-loading","data"]),U(X,null,{default:q(()=>[U(W)]),_:1})],64)}}});const ut=H(lt,[["__scopeId","data-v-62b785a8"],["__file","/Users/jinseok.bang/Documents/github.me/jonganebski.github.io/src/pages/games/sliding-puzzle/index.vue"]]);export{ut as default};
