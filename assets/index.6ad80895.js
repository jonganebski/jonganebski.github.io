var oe=Object.defineProperty,re=Object.defineProperties;var ue=Object.getOwnPropertyDescriptors;var K=Object.getOwnPropertySymbols;var ie=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var I=(r,t,l)=>t in r?oe(r,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):r[t]=l,W=(r,t)=>{for(var l in t||(t={}))ie.call(t,l)&&I(r,l,t[l]);if(K)for(var l of K(t))ce.call(t,l)&&I(r,l,t[l]);return r},J=(r,t)=>re(r,ue(t));import{_ as ae,e as D,s as P,c as _e,f as de,g as ee,u as ne,r as pe,a as me}from"./app.54880ce4.js";import{_ as he,a as ve,b as fe}from"./list-numbered.62f0329b.js";import{d as O,h as d,j as p,m as o,v as f,Q as ge,s as Z,y as R,t as e,S as G,N as ye,p as B,w as E,F as L,U as V,r as T,$ as $e,a0 as be,al as ke,o as xe,ad as we,am as Ce,L as ze,an as Se,x as te,n as F,R as se}from"./vendor.d9c22db7.js";const Ee={class:"mt-2 text-sm"},Ne={class:"pl-2 font-bold"},Ue={display:"mt-1 grid"},Re=O({props:{categoryName:null},setup(r){const t=r;return(l,a)=>(d(),p("div",Ee,[o("span",Ne,f(t.categoryName),1),o("div",Ue,[ge(l.$slots,"default")])]))}});const Te={class:"mt-4 px-2 text-center"},je={key:0,class:"text-sm text-gray-700 dark:text-gray-300"},Fe=G(" Photo by "),Le=["href"],Ze={key:1,class:"text-sm text-gray-700 dark:text-gray-300"},Be=G(" on "),Me=["href"],Ve={class:"text-xs text-gray-500"},De=O({props:{selectedImage:null},setup(r){const t=r,{t:l}=D();return(a,c)=>{var g,m,x,v,y,$,k,b,w,u;return d(),p("div",Te,[((g=t.selectedImage)==null?void 0:g.creator)?(d(),p("span",je,[Fe,o("a",{class:Z([((m=t.selectedImage)==null?void 0:m.creator.url)?"link__active":"link__inactive"]),href:(x=t.selectedImage)==null?void 0:x.creator.url,target:"_blank",rel:"noopener"},f((y=(v=t.selectedImage)==null?void 0:v.creator)==null?void 0:y.name),11,Le)])):R("",!0),(($=t.selectedImage)==null?void 0:$.provider)?(d(),p("span",Ze,[Be,o("a",{class:Z([((k=t.selectedImage)==null?void 0:k.provider.url)?"link__active":"link__inactive"]),href:(b=t.selectedImage)==null?void 0:b.provider.url,target:"_blank",rel:"noopener"},f((u=(w=t.selectedImage)==null?void 0:w.provider)==null?void 0:u.name),11,Me)])):R("",!0),o("p",Ve,f(e(l)("all_rights_of_the_image_belong_to_the_creator")),1)])}}});var Oe=ae(De,[["__scopeId","data-v-176f9680"]]);const He={width:"1.2em",height:"1.2em",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 32 32"},Ye=o("circle",{cx:"9.5",cy:"9.5",r:"2.5",fill:"currentColor"},null,-1),Ae=o("circle",{cx:"9.5",cy:"22.5",r:"2.5",fill:"currentColor"},null,-1),Pe=o("circle",{cx:"22.5",cy:"22.5",r:"2.5",fill:"currentColor"},null,-1),Qe=o("path",{d:"M28 2H4a2.002 2.002 0 0 0-2 2v24a2.002 2.002 0 0 0 2 2h24a2.002 2.002 0 0 0 2-2V4a2.002 2.002 0 0 0-2-2zm0 13H17V4h11zM15 4v11H4V4zM4 17h11v11H4zm13 11V17h11v11z",fill:"currentColor"},null,-1),Xe=[Ye,Ae,Pe,Qe];function qe(r,t){return d(),p("svg",He,Xe)}var Ge={name:"carbon-scatter-matrix",render:qe};const Ke=1e3*60*60;function Ie(){return ye("sliding-puzzle-records",async()=>(await P.from("sliding-puzzle-records").select("*, user: user_id (user_name, avatar_url)").order("score",{ascending:!0}).limit(100)).data,{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,staleTime:Ke,retry:!1})}const We={class:"mt-30 p-4 mx-auto max-w-xl rounded shadow-lg"},Je={class:"mx-auto w-full text-sm table-fixed"},et={class:"pb-5"},tt={class:"pb-5 w-[80%]"},st={class:"pb-5"},at={class:"w-full"},nt={key:0},lt=o("td",{colspan:"3",class:"py-10 text-center"},"Loading...",-1),ot=[lt],rt={key:1},ut=o("td",{colspan:"3",class:"py-10 text-center"},"No Data",-1),it=[ut],ct={class:"py-2"},_t={class:"py-2 px-4"},dt={class:"w-full flex items-center justify-start gap-3"},pt={class:"relative"},mt={class:"absolute top-0 right-0 text-xl pointer-events-none"},ht={class:"overflow-ellipsis overflow-hidden whitespace-nowrap"},vt={class:"py-2 text-right"},ft=O({setup(r){const{t}=D(),{isLoading:l,data:a}=Ie(),c=B(g);function g(){var x;const m=[];if(!a.value)return m;for(let v=0;v<((x=a.value)==null?void 0:x.length);v++){const{score:y}=a.value[v];if(m.length===0){m.push(y);continue}if(m[m.length-1]!==y&&(m.push(y),m.length===3))break}return m}return(m,x)=>{const v=he,y=_e,$=Ge,k=de;return d(),p("div",We,[o("table",Je,[o("thead",null,[o("tr",null,[o("th",et,[E(v)]),o("th",tt,[E(y,{class:"mx-auto"})]),o("th",st,[E($,{class:"ml-auto"})])])]),o("tbody",at,[e(l)?(d(),p("tr",nt,ot)):!e(a)||e(a).length===0?(d(),p("tr",rt,it)):(d(!0),p(L,{key:2},V(e(a),(b,w)=>(d(),p("tr",{key:b.id,class:"w-full"},[o("td",ct,f(w+1),1),o("td",_t,[o("div",dt,[o("div",pt,[E(k,{src:b.user.avatar_url,width:40,height:40,alt:e(t)("the_avatar_of",{user_name:b.user.user_name})},null,8,["src","alt"]),o("span",mt,f(b.score===e(c)[0]?"\u{1F947}":b.score===e(c)[1]?"\u{1F948}":b.score===e(c)[2]?"\u{1F949}":""),1)]),o("span",ht,f(b.user.user_name),1)])]),o("td",vt,f(b.score),1)]))),128))])])])}}}),gt={class:"text-sm"},yt={key:0,class:""},$t={key:0},bt={key:1},kt={key:2},xt={key:1},wt=O({props:{clicksCount:null,shuffleCount:null,score:null,time:null},setup(r){const t=r,{t:l}=D(),a=B(()=>{if(!t.time)return null;const c=Math.floor(t.time/(1e3*60)),g=Math.floor((t.time-c*1e3*60)/1e3),m=t.time-c*1e3*60-g*1e3;return{minutes:c,seconds:g,milliseconds:m}});return(c,g)=>(d(),p("div",gt,[o("span",null,[G(f(e(l)("move",2))+": ",1),o("span",{class:Z([t.clicksCount<=t.shuffleCount?"text-green-500":t.clicksCount<t.shuffleCount*2?"text-yellow-500":"text-red-500"])},f(t.clicksCount),3)]),e(a)?(d(),p("p",yt,[o("span",null,f(e(l)("time"))+": ",1),e(a).minutes?(d(),p("span",$t,f(e(a).minutes)+" "+f(e(l)("minutes").toLowerCase())+" "+f(" "),1)):R("",!0),e(a).seconds?(d(),p("span",bt,f(e(a).seconds)+" "+f(e(l)("seconds").toLowerCase())+" "+f(" "),1)):R("",!0),e(a).milliseconds?(d(),p("span",kt,f(e(a).milliseconds)+" "+f(e(l)("milliseconds").toLowerCase()),1)):R("",!0)])):R("",!0),r.score?(d(),p("p",xt,f(e(l)("score"))+": "+f(r.score),1)):R("",!0)]))}}),N="https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images",U="utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText";function Ct(){const{t:r}=D(),t=T(!1),l=T(0),a=B(()=>t.value?[{categoryName:r("fate_series"),options:[{label:r("jean_alter"),url:`${N}/jean-alter.jpg`},{label:r("rider_5th"),url:`${N}/rider-5th.jpg`}]},{categoryName:r("eighty_six"),options:[{label:r("vladilena_milize"),url:`${N}/vladilena-milize.jpg`}]},{categoryName:r("attack_on_titan"),options:[{label:r("eren_yeager"),url:`${N}/eren-yeager.jpg`}]}]:[{categoryName:r("nature"),options:[{label:"Kamran Ch",url:`${N}/mountain.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/t/act-for-nature?${U}`},creator:{name:"Kamran Ch",url:`https://unsplash.com/@kamranch?${U}`}},{label:"David Scanlon",url:`${N}/gorilla.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/t/nature?${U}`},creator:{name:"David Scanlon",url:`https://unsplash.com/@dsartwork?${U}`}}]},{categoryName:r("cat",2),options:[{label:"Pacto Visual",url:`${N}/cat_pacto-visual.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/s/photos/cat?${U}`},creator:{name:"Pacto Visual",url:`https://unsplash.com/@pactovisual?${U}`}},{label:"Georgi Benev",url:`${N}/cat_georgi-benev.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/s/photos/cat-box?${U}`},creator:{name:"georgi benev",url:`https://unsplash.com/@georgibenev97?${U}`}}]}]),c=T(g());function g(){const y=ee(0,a.value.length-1),$=ee(0,a.value[y].options.length-1);return a.value[y].options[$].url}let m;function x(){l.value+=1,clearTimeout(m),m=setTimeout(()=>l.value=0,200),l.value===10&&(t.value=!t.value,c.value=g())}function v(y){for(let $=0;$<a.value.length;$++)for(let k=0;k<a.value[$].options.length;k++)if(a.value[$].options[k].url===y)return a.value[$].options[k]}return{selectedImageUrl:c,images:a,findImageByUrl:v,worship:x}}function zt(){const r=be(),{data:t}=ne();return $e(async({score:l})=>{if(!t.value)return null;const{data:a}=await P.from("sliding-puzzle-records").select("*").eq("user_id",t.value.id).order("score",{ascending:!0});if(!a)return null;switch(a.length<=10){case!0:return(await P.from("sliding-puzzle-records").insert({score:l,user_id:t.value.id}).single()).data;case!1:{const c=a[a.length-1];return c.score<l?null:(await P.from("sliding-puzzle-records").update({id:c.id,score:l}).single()).data}}},{onSuccess:l=>{if(!t.value)return;const{user_name:a=t.value.email,avatar_url:c=""}=t.value.user_metadata;if(!l)return;const g=r.getQueryData("sliding-puzzle-records");!g||r.setQueryData("sliding-puzzle-records",()=>(g.push(J(W({},l),{user:{user_name:a,avatar_url:c}})),g.sort((m,x)=>m.score-x.score)))}})}function St(){const a=B(()=>x.value?140:m.value?100:60),c=zt(),g=ke(Ce),m=g.greater("sm"),x=g.greater("lg"),v=T("shuffle"),y=T(0),$=T(null),k=T(null),b=B(()=>!$.value||!k.value?null:k.value-$.value),w=B(()=>b.value?y.value*b.value/1e3:null),u=T([[0,0,0,0,0,0,0],[0,1,2,3,4,5,0],[0,6,7,8,9,10,0],[0,11,12,13,14,15,0],[0,16,17,18,19,20,0],[0,21,22,23,24,25,0],[0,0,0,0,0,-1,0],[0,0,0,0,0,0,0]]);xe(async()=>H());function S(_,n,s){let i=[];const h=u.value[_-1][n],C=u.value[_+1][n],z=u.value[_][n+1],q=u.value[_][n-1];return 0<h&&h!==s&&i.push(h),0<C&&C!==s&&i.push(C),0<z&&z!==s&&i.push(z),0<q&&q!==s&&i.push(q),s&&(i=i.filter(le=>le!==16)),pe(1,i)[0]}async function H(){$.value=null,k.value=null,u.value=[[0,0,0,0,0,0,0],[0,1,2,3,4,5,0],[0,6,7,8,9,10,0],[0,11,12,13,14,15,0],[0,16,17,18,19,20,0],[0,21,22,23,24,25,0],[0,0,0,0,0,-1,0],[0,0,0,0,0,0,0]],await we(),y.value=0,v.value="shuffle";let _;for(let n=0;n<50;n++){const s=document.getElementById("void");if(!s)return;const i=Number(s.dataset.rowidx),h=Number(s.dataset.colidx),C=S(i,h,_),z=document.getElementById(C.toString());if(!z)return;await A(z,Number(z.dataset.rowidx),Number(z.dataset.colidx),!1),_=C}v.value="ready"}function Y(){let n=0;for(let s=0;s<u.value.length;s++)for(let i=0;i<u.value[s].length;i++){const h=u.value[s][i];if(h!==0){if(n===25&&h===-1)return!0;if(n+1!==h)return!1;n++}}return!0}async function A(_,n,s,i=!0){const h=j(n,s);return i&&(_.style.transition="transform linear 0.1s"),h==="top"&&(i&&(_.style.transform=`translateY(-${a.value}px)`,await M(100)),[u.value[n][s],u.value[n-1][s]]=[u.value[n-1][s],u.value[n][s]]),h==="bottom"&&(i&&(_.style.transform=`translateY(${a.value}px)`,await M(100)),[u.value[n][s],u.value[n+1][s]]=[u.value[n+1][s],u.value[n][s]]),h==="right"&&(i&&(_.style.transform=`translateX(${a.value}px)`,await M(100)),[u.value[n][s],u.value[n][s+1]]=[u.value[n][s+1],u.value[n][s]]),h==="left"&&(i&&(_.style.transform=`translateX(-${a.value}px)`,await M(100)),[u.value[n][s],u.value[n][s-1]]=[u.value[n][s-1],u.value[n][s]]),i&&(_.style.transition=""),!!h}async function M(_){await new Promise(n=>setTimeout(()=>n(!0),_))}function j(_,n){return u.value[_-1][n]===-1?"top":u.value[_+1][n]===-1?"bottom":u.value[_][n+1]===-1?"right":u.value[_][n-1]===-1?"left":null}async function Q(_,n,s){if(v.value==="shuffle"||v.value==="done")return;const i=_.currentTarget;!i||!await A(i,n,s)||($.value||($.value=new Date().getTime()),y.value+=1,v.value==="ready"&&(v.value="playing"),!!Y()&&(v.value="done",k.value=new Date().getTime(),!!w.value&&(console.log(w.value),c.mutate({score:w.value}))))}function X(_){const n=(_-1)%5*a.value*-1,s=Math.floor((_-1)/5)*a.value*-1;return`${n}px ${s}px`}return{SHUFFLE_COUNT:50,SIZE_NODE:a,SIZE_X:5,SIZE_Y:5,clickCount:y,status:v,nodes:u,score:w,time:b,computeBgPosition:X,onClickNode:Q,initialize:H}}const Et={class:"my-4 grid gap-12 place-items-center"},Nt={class:"w-52"},Ut={class:"min-h-20"},Rt={key:0,class:"w-0 h-0"},Tt=["data-rowIdx","data-colIdx"],jt=["id","data-rowIdx","data-colIdx","onClick"],Ft={class:"absolute inset-0 bg-black bg-opacity-50 grid place-items-center"},Lt={key:0,class:"mt-2 text-center text-rose-500 text-sm"},Zt=O({setup(r){const{data:t}=ne(),{t:l}=D(),{SHUFFLE_COUNT:a,SIZE_NODE:c,SIZE_X:g,SIZE_Y:m,clickCount:x,status:v,nodes:y,score:$,time:k,computeBgPosition:b,onClickNode:w,initialize:u}=St(),{selectedImageUrl:S,findImageByUrl:H,worship:Y,images:A}=Ct();return ze(()=>S.value,()=>u()),(M,j)=>{const Q=fe,X=Re,_=ve,n=me;return d(),p(L,null,[o("div",Et,[o("h1",{class:"text-3xl md:text-5xl",onClick:j[0]||(j[0]=(...s)=>e(Y)&&e(Y)(...s))},f(e(l)("sliding_puzzle")),1),o("div",Nt,[E(_,{modelValue:e(S),"onUpdate:modelValue":j[1]||(j[1]=s=>Se(S)?S.value=s:null),label:e(l)("image"),class:"w-56"},{default:te(()=>[(d(!0),p(L,null,V(e(A),({categoryName:s,options:i})=>(d(),se(X,{key:s,"category-name":s},{default:te(()=>[(d(!0),p(L,null,V(i,h=>(d(),se(Q,{key:h.url,value:h.url,label:h.label},null,8,["value","label"]))),128))]),_:2},1032,["category-name"]))),128))]),_:1},8,["modelValue","label"])]),o("div",Ut,[E(wt,{"shuffle-count":e(a),"clicks-count":e(x),time:e(k),score:e($)},null,8,["shuffle-count","clicks-count","time","score"])])]),o("div",{class:"relative grid gap-px transition-all duration-1000 ease-linear",style:F({gridTemplateRows:`auto repeat(${e(m)}, ${e(c)}px) auto`})},[o("div",{class:Z(["absolute top-0 left-1/2 transform -translate-x-1/2 z-1 pointer-events-none",[e(v)==="done"?"shadow-2xl":"shadow"]]),style:F({width:`${e(g)*e(c)+e(g)}px`,height:`${e(m)*e(c)+e(m)}px`})},[o("div",{class:Z(["absolute top-0 left-0 z-1 w-full h-full bg-white opacity-0",{"done__anim-mask":e(v)==="done"}])},null,2),o("div",{class:Z(["w-full h-full bg-cover",[e(v)==="done"?"done__anim-image opacity-100":"opacity-0"]]),style:F({backgroundImage:`url(${e(S)})`})},null,6)],6),(d(!0),p(L,null,V(e(y),(s,i)=>(d(),p("div",{key:i,class:"grid gap-px transition-all duration-1000 ease-linear",style:F({gridTemplateColumns:`auto repeat(${e(g)}, ${e(c)}px) auto`})},[(d(!0),p(L,null,V(s,(h,C)=>(d(),p("div",{key:h},[h===0?(d(),p("div",Rt)):h===-1?(d(),p("div",{key:1,id:"void","data-rowIdx":i,"data-colIdx":C,style:F({width:`${e(c)}px`,height:`${e(c)}px`})},null,12,Tt)):(d(),p("button",{key:2,id:h.toString(),"data-rowIdx":i,"data-colIdx":C,class:"text-white",style:F({width:`${e(c)}px`,height:`${e(c)}px`,backgroundImage:`url(${e(S)})`,backgroundSize:`${e(c)*e(g)}px ${e(c)*e(m)}px`,backgroundPosition:e(b)(h),transform:"translate(0px)"}),onClick:z=>e(w)(z,i,C)},[o("div",Ft,f(e(v)==="done"?"":h),1)],12,jt))]))),128))],4))),128))],4),e(t)?R("",!0):(d(),p("div",Lt,f(e(l)("games_auth_warning")),1)),E(Oe,{"selected-image":e(H)(e(S))},null,8,["selected-image"]),E(ft),E(n)],64)}}});var Ot=ae(Zt,[["__scopeId","data-v-a80a7d80"]]);export{Ot as default};
