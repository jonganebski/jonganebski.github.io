var re=Object.defineProperty,ue=Object.defineProperties;var ie=Object.getOwnPropertyDescriptors;var ee=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,de=Object.prototype.propertyIsEnumerable;var te=(l,t,n)=>t in l?re(l,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[t]=n,ae=(l,t)=>{for(var n in t||(t={}))ce.call(t,n)&&te(l,n,t[n]);if(ee)for(var n of ee(t))de.call(t,n)&&te(l,n,t[n]);return l},se=(l,t)=>ue(l,ie(t));import{y as pe,O as me,A as X,_ as le,d as H,u as Z,h as d,c as _,f as $,t as p,M as O,N as j,e,x as J,p as B,R as _e,s as W,w as Q,i as I,F as D,r as R,a7 as ne,B as ge,C as ve,D as fe,a8 as he,a9 as ye,E as $e,o as be,aa as ke,ab as ze,I as Ce,b as U,H as xe,ac as Se,j as we,k as Ee,n as L,l as Ne}from"./app.6ecfdf72.js";import{_ as Ue,a as Re}from"./records.5f4b75de.js";import{a as je,_ as Te}from"./option.f10d20da.js";function Me(){return pe("sliding-puzzle-records",async()=>(await X.from("sliding-puzzle-records").select("*, user: user_id (user_name, avatar_url)").order("score",{ascending:!0}).limit(100)).data,{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,staleTime:me,retry:!1})}const Ve={class:"mt-4 px-2 text-center"},Fe={key:0,class:"text-sm text-gray-700 dark:text-gray-300"},Le=J(" Photo by "),Oe=["href"],Be={key:1,class:"text-sm text-gray-700 dark:text-gray-300"},Ze=J(" on "),De=["href"],He={class:"text-xs text-gray-500"},Pe=H({props:{selectedImage:null},setup(l){const t=l,{t:n}=Z();return(o,v)=>{var i,f,g,m,k,S,h,y,z,E;return d(),_("div",Ve,[(i=t.selectedImage)!=null&&i.creator?(d(),_("span",Fe,[Le,$("a",{class:O([(f=t.selectedImage)!=null&&f.creator.url?"link__active":"link__inactive"]),href:(g=t.selectedImage)==null?void 0:g.creator.url,rel:"noopener noreferrer",target:"_blank"},p((k=(m=t.selectedImage)==null?void 0:m.creator)==null?void 0:k.name),11,Oe)])):j("",!0),(S=t.selectedImage)!=null&&S.provider?(d(),_("span",Be,[Ze,$("a",{class:O([(h=t.selectedImage)!=null&&h.provider.url?"link__active":"link__inactive"]),href:(y=t.selectedImage)==null?void 0:y.provider.url,rel:"noopener noreferrer",target:"_blank"},p((E=(z=t.selectedImage)==null?void 0:z.provider)==null?void 0:E.name),11,De)])):j("",!0),$("p",He,p(e(n)("all_rights_of_the_image_belong_to_the_creator")),1)])}}});var Ae=le(Pe,[["__scopeId","data-v-a201b528"]]);const Ye={class:"text-sm"},Xe={key:0,class:""},Qe={key:0},Ie={key:1},Ge={key:2},qe={key:1},Ke=H({props:{clicksCount:null,shuffleCount:null,score:null,time:null},setup(l){const t=l,{t:n}=Z(),o=B(()=>{if(!t.time)return null;const v=Math.floor(t.time/(1e3*60)),i=Math.floor((t.time-v*1e3*60)/1e3),f=t.time-v*1e3*60-i*1e3;return{minutes:v,seconds:i,milliseconds:f}});return(v,i)=>(d(),_("div",Ye,[$("span",null,[J(p(e(n)("move",2))+": ",1),$("span",{class:O([t.clicksCount<=t.shuffleCount?"text-green-500":t.clicksCount<t.shuffleCount*2?"text-yellow-500":"text-red-500"])},p(t.clicksCount),3)]),e(o)?(d(),_("p",Xe,[$("span",null,p(e(n)("time"))+": ",1),e(o).minutes?(d(),_("span",Qe,p(e(o).minutes)+" "+p(e(n)("minutes").toLowerCase())+" "+p(" "),1)):j("",!0),e(o).seconds?(d(),_("span",Ie,p(e(o).seconds)+" "+p(e(n)("seconds").toLowerCase())+" "+p(" "),1)):j("",!0),e(o).milliseconds?(d(),_("span",Ge,p(e(o).milliseconds)+" "+p(e(n)("milliseconds").toLowerCase()),1)):j("",!0)])):j("",!0),l.score?(d(),_("p",qe,p(e(n)("score"))+": "+p(l.score),1)):j("",!0)]))}}),We={class:"mt-2 text-sm"},Je={class:"pl-2 font-bold"},et={display:"mt-1 grid"},tt=H({props:{categoryName:null},setup(l){const t=l;return(n,o)=>(d(),_("div",We,[$("span",Je,p(t.categoryName),1),$("div",et,[_e(n.$slots,"default")])]))}}),at=H({props:{modelValue:null,images:null},emits:["update:modelValue"],setup(l,{emit:t}){const n=l,{t:o}=Z();return(v,i)=>{const f=je,g=tt,m=Te;return d(),W(m,{"model-value":n.modelValue,label:e(o)("image"),class:"w-72","onUpdate:modelValue":i[0]||(i[0]=k=>t("update:modelValue",k.toString()))},{default:Q(()=>[(d(!0),_(D,null,I(n.images,({categoryName:k,options:S})=>(d(),W(g,{key:k,"category-name":k,class:"text-dark-500"},{default:Q(()=>[(d(!0),_(D,null,I(S,h=>(d(),W(f,{key:h.url,value:h.url,label:h.label},null,8,["value","label"]))),128))]),_:2},1032,["category-name"]))),128))]),_:1},8,["model-value","label"])}}}),C="https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images",x="utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText";function st(){const{t:l}=Z(),t=20,n=R(!1),o=R(0),v=B(()=>100-Math.min(100,o.value/t*100)),i=B(()=>n.value?[{categoryName:l("fate_series"),options:[{label:l("jeanne_alter"),url:`${C}/jean-alter.jpg`},{label:l("rider_5th"),url:`${C}/rider-5th.jpg`}]},{categoryName:l("eighty_six"),options:[{label:l("vladilena_milize"),url:`${C}/vladilena-milize.jpg`}]},{categoryName:l("attack_on_titan"),options:[{label:l("eren_yeager"),url:`${C}/eren-yeager.jpg`},{label:l("sasha_braus"),url:`${C}/sasha-braus.jpg`}]},{categoryName:l("evangelion"),options:[{label:l("asuka_langley_sohryu"),url:`${C}/asuka-langley-soryu.jpg`},{label:l("rei_ayanami"),url:`${C}/rei-ayanami.png`}]}]:[{categoryName:l("nature"),options:[{label:"Kamran Ch",url:`${C}/mountain.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/t/act-for-nature?${x}`},creator:{name:"Kamran Ch",url:`https://unsplash.com/@kamranch?${x}`}},{label:"David Scanlon",url:`${C}/gorilla.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/t/nature?${x}`},creator:{name:"David Scanlon",url:`https://unsplash.com/@dsartwork?${x}`}},{label:"In\xE9s \xC1lvarez Fdez",url:`${C}/wave.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/s/photos/ocean?${x}`},creator:{name:"In\xE9s \xC1lvarez Fdez",url:`https://unsplash.com/@powwpic?${x}`}}]},{categoryName:l("cat",2),options:[{label:"Pacto Visual",url:`${C}/cat_pacto-visual.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/s/photos/cat?${x}`},creator:{name:"Pacto Visual",url:`https://unsplash.com/@pactovisual?${x}`}},{label:"Georgi Benev",url:`${C}/cat_georgi-benev.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/s/photos/cat-box?${x}`},creator:{name:"georgi benev",url:`https://unsplash.com/@georgibenev97?${x}`}},{label:"Michael Sum",url:`${C}/cat_michael-sum.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/s/photos/cat?${x}`},creator:{name:"Michael Sum",url:`https://unsplash.com/@michaelsum1228?${x}`}}]}]),f=R(g());function g(){const h=ne(0,i.value.length-1),y=ne(0,i.value[h].options.length-1);return i.value[h].options[y].url}let m;function k(){n.value||(o.value+=1,clearTimeout(m),m=setTimeout(()=>o.value=0,200),o.value===t&&(n.value=!n.value,f.value=g()))}function S(h){for(let y=0;y<i.value.length;y++)for(let z=0;z<i.value[y].options.length;z++)if(i.value[y].options[z].url===h)return i.value[y].options[z]}return{worshipRatioReverse:v,selectedImageUrl:f,images:i,findImageByUrl:S,worship:k}}function nt(){const l=ve(),{data:t}=fe();return ge(async({score:n})=>{if(!t.value)return null;const{data:o}=await X.from("sliding-puzzle-records").select("*").eq("user_id",t.value.id).order("score",{ascending:!0});if(!o)return null;switch(o.length<=10){case!0:return(await X.from("sliding-puzzle-records").insert({score:n,user_id:t.value.id}).single()).data;case!1:{const v=o[o.length-1];return v.score<n?null:(await X.from("sliding-puzzle-records").update({id:v.id,score:n}).single()).data}}},{onSuccess:n=>{if(!t.value)return;const{user_name:o=t.value.email,avatar_url:v=""}=t.value.user_metadata;if(!n)return;const i=l.getQueryData("sliding-puzzle-records");!i||l.setQueryData("sliding-puzzle-records",()=>[...i,se(ae({},n),{user:{user_name:o,avatar_url:v}})].sort((f,g)=>f.score-g.score))}})}function lt(){const o=R("shuffle"),v=he(ye),i=v.greater("sm"),f=v.greater("lg"),g=B(()=>f.value?140:i.value?100:60),m=nt(),{openIssueModal:k}=$e(),{t:S}=Z(),h=R(0),y=R(null),z=R(null),E=B(()=>!y.value||!z.value?null:z.value-y.value),T=B(()=>E.value?h.value+Math.floor(E.value/1e3):null),u=R([[0,0,0,0,0,0,0],[0,1,2,3,4,5,0],[0,6,7,8,9,10,0],[0,11,12,13,14,15,0],[0,16,17,18,19,20,0],[0,21,22,23,24,25,0],[0,0,0,0,0,-1,0],[0,0,0,0,0,0,0]]);be(async()=>P());function w(r,a,s){let c=[];const b=u.value[r-1][a],F=u.value[r+1][a],N=u.value[r][a+1],K=u.value[r][a-1];return 0<b&&b!==s&&c.push(b),0<F&&F!==s&&c.push(F),0<N&&N!==s&&c.push(N),0<K&&K!==s&&c.push(K),s&&(c=c.filter(oe=>oe!==25)),ze(1,c)[0]}async function P(){y.value=null,z.value=null,u.value=[[0,0,0,0,0,0,0],[0,1,2,3,4,5,0],[0,6,7,8,9,10,0],[0,11,12,13,14,15,0],[0,16,17,18,19,20,0],[0,21,22,23,24,25,0],[0,0,0,0,0,-1,0],[0,0,0,0,0,0,0]],await ke(),h.value=0,o.value="shuffle";let r;for(let a=0;a<50;a++){const s=document.getElementById("void");if(!s)return;const c=Number(s.dataset.rowidx),b=Number(s.dataset.colidx),F=w(c,b,r),N=document.getElementById(F.toString());if(!N)return;await Y(N,Number(N.dataset.rowidx),Number(N.dataset.colidx),!1),r=F}o.value="ready"}function A(){let a=0;for(let s=0;s<u.value.length;s++)for(let c=0;c<u.value[s].length;c++){const b=u.value[s][c];if(b!==0){if(a===25&&b===-1)return!0;if(a+1!==b)return!1;a++}}return!0}async function Y(r,a,s,c=!0){const b=V(a,s);return c&&(r.style.transition="transform linear 0.1s"),b==="top"&&(c&&(r.style.transform=`translateY(-${g.value}px)`,await M(100)),[u.value[a][s],u.value[a-1][s]]=[u.value[a-1][s],u.value[a][s]]),b==="bottom"&&(c&&(r.style.transform=`translateY(${g.value}px)`,await M(100)),[u.value[a][s],u.value[a+1][s]]=[u.value[a+1][s],u.value[a][s]]),b==="right"&&(c&&(r.style.transform=`translateX(${g.value}px)`,await M(100)),[u.value[a][s],u.value[a][s+1]]=[u.value[a][s+1],u.value[a][s]]),b==="left"&&(c&&(r.style.transform=`translateX(-${g.value}px)`,await M(100)),[u.value[a][s],u.value[a][s-1]]=[u.value[a][s-1],u.value[a][s]]),c&&(r.style.transition=""),!!b}async function M(r){await new Promise(a=>setTimeout(()=>a(!0),r))}function V(r,a){return u.value[r-1][a]===-1?"top":u.value[r+1][a]===-1?"bottom":u.value[r][a+1]===-1?"right":u.value[r][a-1]===-1?"left":null}async function G(r,a,s){if(o.value==="shuffle"||o.value==="done")return;const c=r.currentTarget;!c||!await Y(c,a,s)||(y.value||(y.value=new Date().getTime()),h.value+=1,o.value==="ready"&&(o.value="playing"),A()&&(o.value="done",z.value=new Date().getTime(),T.value&&(console.log(T.value),m.mutate({score:T.value},{onError:()=>k({title:S("record_mutation_failed.title"),content:S("record_mutation_failed.content")})}))))}function q(r){const a=(r-1)%5*g.value*-1,s=Math.floor((r-1)/5)*g.value*-1;return`${a}px ${s}px`}return{SHUFFLE_COUNT:50,nodeSize:g,SIZE_X:5,SIZE_Y:5,clicksCount:h,status:o,nodes:u,score:T,time:E,computeBgPosition:q,onClickNode:G,initialize:P}}const ot={class:"mt-20 grid gap-12 place-items-center text-dark-500 dark:text-light-500"},rt={class:"py-2 inline-block worship__inactive"},ut={class:"py-2 inline-block worship__active","aria-hidden":"true"},it={key:0,class:"w-0 h-0"},ct=["data-rowIdx","data-colIdx"],dt=["id","data-rowIdx","data-colIdx","onClick"],pt={class:"absolute inset-0 bg-black bg-opacity-50 grid place-items-center"},mt=H({setup(l){we(M=>({"631d5cda":e(u)+"%"}));const{data:t,isLoading:n}=Me(),{t:o}=Z(),{SHUFFLE_COUNT:v,SIZE_X:i,SIZE_Y:f,clicksCount:g,nodeSize:m,status:k,nodes:S,score:h,time:y,computeBgPosition:z,onClickNode:E,initialize:T}=lt(),{worshipRatioReverse:u,selectedImageUrl:w,findImageByUrl:P,worship:A,images:Y}=st();return Ce(()=>w.value,()=>T()),(M,V)=>{const G=Ee("client-only"),q=Ne;return d(),_(D,null,[U(e(xe),null,{default:Q(()=>[$("title",null,p(e(o)("sliding_puzzle"))+" | "+p(e(o)("jon_ganebskis_blog")),1)]),_:1}),$("div",ot,[$("h1",{class:"relative select-none text-3xl md:text-5xl",onClick:V[0]||(V[0]=(...r)=>e(A)&&e(A)(...r))},[$("span",rt,p(e(o)("sliding_puzzle")),1),$("span",ut,p(e(o)("sliding_puzzle")),1)]),U(at,{modelValue:e(w),"onUpdate:modelValue":V[1]||(V[1]=r=>Se(w)?w.value=r:null),images:e(Y)},null,8,["modelValue","images"]),U(Ke,{class:"min-h-20","shuffle-count":e(v),"clicks-count":e(g),time:e(y),score:e(h)},null,8,["shuffle-count","clicks-count","time","score"])]),U(G,null,{default:Q(()=>[$("div",{class:"relative grid gap-px transition-all duration-1000 ease-linear",style:L({gridTemplateRows:`auto repeat(${e(f)}, ${e(m)}px) auto`})},[$("div",{class:O(["absolute top-0 left-1/2 transform -translate-x-1/2 z-1 pointer-events-none",[e(k)==="done"?"shadow-2xl":"shadow"]]),style:L({width:`${e(i)*e(m)+e(i)}px`,height:`${e(f)*e(m)+e(f)}px`})},[$("div",{class:O(["absolute top-0 left-0 z-1 w-full h-full bg-white opacity-0",{"done__anim-mask":e(k)==="done"}])},null,2),$("div",{class:O(["w-full h-full bg-cover",[e(k)==="done"?"done__anim-image opacity-100":"opacity-0"]]),style:L({backgroundImage:`url(${e(w)})`})},null,6)],6),(d(!0),_(D,null,I(e(S),(r,a)=>(d(),_("div",{key:a,class:"grid gap-px transition-all duration-1000 ease-linear",style:L({gridTemplateColumns:`auto repeat(${e(i)}, ${e(m)}px) auto`})},[(d(!0),_(D,null,I(r,(s,c)=>(d(),_("div",{key:s},[s===0?(d(),_("div",it)):s===-1?(d(),_("div",{key:1,id:"void","data-rowIdx":a,"data-colIdx":c,style:L({width:`${e(m)}px`,height:`${e(m)}px`})},null,12,ct)):(d(),_("button",{key:2,id:s.toString(),"data-rowIdx":a,"data-colIdx":c,class:"text-white",style:L({width:`${e(m)}px`,height:`${e(m)}px`,backgroundImage:`url(${e(w)})`,backgroundSize:`${e(m)*e(i)}px ${e(m)*e(f)}px`,backgroundPosition:e(z)(s),transform:"translate(0px)"}),onClick:b=>e(E)(b,a,c)},[$("div",pt,p(e(k)==="done"?"":s),1)],12,dt))]))),128))],4))),128))],4)]),_:1}),U(Re,{class:"mt-2 text-center"}),U(Ae,{"selected-image":e(P)(e(w))},null,8,["selected-image"]),U(Ue,{"is-loading":e(n),data:e(t)},null,8,["is-loading","data"]),U(q)],64)}}});var ht=le(mt,[["__scopeId","data-v-24a63184"]]);export{ht as default};
