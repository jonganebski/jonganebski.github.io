import{R as se,ap as ne,T as Q,d as Z,s as A,c as _,A as ee,a as b,y as m,p as M,i as E,h as e,o as p,_ as q,f as O,am as le,g as J,l as X,z as G,F as B,r as R,ar as oe,as as re,at as ie,Y as ue,au as ce,$ as pe,ah as me,Z as de,ao as _e,G as ge,k as ve,x as j,aC as fe,H as he,n as L,C as ye}from"./app-75b96817.js";import{R as be,A as ke}from"./records-d23e92ca.js";import{a as $e,_ as ze}from"./option-7fadf791.js";import{c as te,r as Ce}from"./random-7bb4a1e6.js";function Se(){return se(["sliding-puzzle-records"],async()=>(await Q.from("sliding-puzzle-records").select("*, user: user_id (user_name, avatar_url)").order("score",{ascending:!0}).limit(100)).data,{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,staleTime:ne,retry:!1})}const we={class:"mt-4 px-2 text-center"},xe={key:0,class:"text-sm text-gray-700 dark:text-gray-300"},Ue=["href"],Ne={key:1,class:"text-sm text-gray-700 dark:text-gray-300"},je=["href"],Re={class:"text-xs text-gray-500"},Ee=Z({__name:"copy-right",props:{selectedImage:{type:null,required:!1}},setup(r){const n=r,{t:i}=A();return(s,v)=>{var u,f,g,d,$,w,h,y,z,U;return p(),_("div",we,[(u=n.selectedImage)!=null&&u.creator?(p(),_("span",xe,[ee(" Photo by "),b("a",{class:M([(f=n.selectedImage)!=null&&f.creator.url?"link__active":"link__inactive"]),href:(g=n.selectedImage)==null?void 0:g.creator.url,rel:"noopener noreferrer",target:"_blank"},m(($=(d=n.selectedImage)==null?void 0:d.creator)==null?void 0:$.name),11,Ue)])):E("v-if",!0),(w=n.selectedImage)!=null&&w.provider?(p(),_("span",Ne,[ee(" on "),b("a",{class:M([(h=n.selectedImage)!=null&&h.provider.url?"link__active":"link__inactive"]),href:(y=n.selectedImage)==null?void 0:y.provider.url,rel:"noopener noreferrer",target:"_blank"},m((U=(z=n.selectedImage)==null?void 0:z.provider)==null?void 0:U.name),11,je)])):E("v-if",!0),b("p",Re,m(e(i)("all_rights_of_the_image_belong_to_the_creator")),1)])}}});const Te=q(Ee,[["__scopeId","data-v-1f083561"],["__file","/Users/jinseok.bang/Documents/github.me/jonganebski.github.io/src/pages/games/sliding-puzzle/components/copy-right.vue"]]),Ve={class:"text-sm"},De={key:0,class:""},Fe={key:0},Le={key:1},Me={key:2},Oe={key:1},Ae=Z({__name:"score",props:{clicksCount:{type:Number,required:!0},shuffleCount:{type:Number,required:!0},score:{type:[Number,null],required:!0},time:{type:[Number,null],required:!0}},setup(r){const n=r,{t:i}=A(),s=O(()=>{if(!n.time)return null;const v=Math.floor(n.time/(1e3*60)),u=Math.floor((n.time-v*1e3*60)/1e3),f=n.time-v*1e3*60-u*1e3;return{minutes:v,seconds:u,milliseconds:f}});return(v,u)=>(p(),_("div",Ve,[b("span",null,[ee(m(e(i)("move",2))+": ",1),b("span",{class:M([n.clicksCount<=n.shuffleCount?"text-green-500":n.clicksCount<n.shuffleCount*2?"text-yellow-500":"text-red-500"])},m(n.clicksCount),3)]),e(s)?(p(),_("p",De,[b("span",null,m(e(i)("time"))+": ",1),e(s).minutes?(p(),_("span",Fe,m(e(s).minutes)+" "+m(e(i)("minutes").toLowerCase())+" "+m(" "),1)):E("v-if",!0),e(s).seconds?(p(),_("span",Le,m(e(s).seconds)+" "+m(e(i)("seconds").toLowerCase())+" "+m(" "),1)):E("v-if",!0),e(s).milliseconds?(p(),_("span",Me,m(e(s).milliseconds)+" "+m(e(i)("milliseconds").toLowerCase()),1)):E("v-if",!0)])):E("v-if",!0),r.score?(p(),_("p",Oe,m(e(i)("score"))+": "+m(r.score),1)):E("v-if",!0)]))}}),Be=q(Ae,[["__file","/Users/jinseok.bang/Documents/github.me/jonganebski.github.io/src/pages/games/sliding-puzzle/components/score.vue"]]),Ze={class:"mt-2 text-sm"},qe={class:"pl-2 font-bold"},He={display:"mt-1 grid"},Pe=Z({__name:"option-group",props:{categoryName:{type:String,required:!0}},setup(r){const n=r;return(i,s)=>(p(),_("div",Ze,[b("span",qe,m(n.categoryName),1),b("div",He,[le(i.$slots,"default")])]))}}),Ye=q(Pe,[["__file","/Users/jinseok.bang/Documents/github.me/jonganebski.github.io/src/components/ui/option-group.vue"]]),Qe=Z({__name:"select-image",props:{modelValue:{type:String,required:!0},images:{type:Array,required:!0}},emits:["update:modelValue"],setup(r,{emit:n}){const i=r,{t:s}=A();return(v,u)=>{const f=ze,g=Ye,d=$e;return p(),J(d,{"model-value":i.modelValue,label:e(s)("image"),class:"w-72","onUpdate:modelValue":u[0]||(u[0]=$=>n("update:modelValue",$.toString()))},{default:X(()=>[(p(!0),_(B,null,G(i.images,({categoryName:$,options:w})=>(p(),J(g,{key:$,"category-name":$,class:"text-dark-500"},{default:X(()=>[(p(!0),_(B,null,G(w,h=>(p(),J(f,{key:h.url,value:h.url,label:h.label},null,8,["value","label"]))),128))]),_:2},1032,["category-name"]))),128))]),_:1},8,["model-value","label"])}}}),Xe=q(Qe,[["__file","/Users/jinseok.bang/Documents/github.me/jonganebski.github.io/src/pages/games/sliding-puzzle/components/select-image.vue"]]),C="https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images",S="utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText";function Ge(){const{t:r}=A(),n=20,i=R(!1),s=R(0),v=O(()=>100-Math.min(100,s.value/n*100)),u=O(()=>i.value?[{categoryName:r("fate_series"),options:[{label:r("jeanne_alter"),url:`${C}/jean-alter.jpg`},{label:r("rider_5th"),url:`${C}/rider-5th.jpg`}]},{categoryName:r("eighty_six"),options:[{label:r("vladilena_milize"),url:`${C}/vladilena-milize.jpg`}]},{categoryName:r("attack_on_titan"),options:[{label:r("eren_yeager"),url:`${C}/eren-yeager.jpg`},{label:r("sasha_braus"),url:`${C}/sasha-braus.jpg`}]},{categoryName:r("evangelion"),options:[{label:r("asuka_langley_sohryu"),url:`${C}/asuka-langley-soryu.jpg`},{label:r("rei_ayanami"),url:`${C}/rei-ayanami.png`}]}]:[{categoryName:r("nature"),options:[{label:"Kamran Ch",url:`${C}/mountain.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/t/act-for-nature?${S}`},creator:{name:"Kamran Ch",url:`https://unsplash.com/@kamranch?${S}`}},{label:"David Scanlon",url:`${C}/gorilla.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/t/nature?${S}`},creator:{name:"David Scanlon",url:`https://unsplash.com/@dsartwork?${S}`}},{label:"Inés Álvarez Fdez",url:`${C}/wave.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/s/photos/ocean?${S}`},creator:{name:"Inés Álvarez Fdez",url:`https://unsplash.com/@powwpic?${S}`}}]},{categoryName:r("cat",2),options:[{label:"Pacto Visual",url:`${C}/cat_pacto-visual.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/s/photos/cat?${S}`},creator:{name:"Pacto Visual",url:`https://unsplash.com/@pactovisual?${S}`}},{label:"Georgi Benev",url:`${C}/cat_georgi-benev.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/s/photos/cat-box?${S}`},creator:{name:"georgi benev",url:`https://unsplash.com/@georgibenev97?${S}`}},{label:"Michael Sum",url:`${C}/cat_michael-sum.jpg`,provider:{name:"Unsplash",url:`https://unsplash.com/s/photos/cat?${S}`},creator:{name:"Michael Sum",url:`https://unsplash.com/@michaelsum1228?${S}`}}]}]),f=R(g());function g(){const h=te(0,u.value.length-1),y=te(0,u.value[h].options.length-1);return u.value[h].options[y].url}let d;function $(){i.value||(s.value+=1,clearTimeout(d),d=setTimeout(()=>s.value=0,200),s.value===n&&(i.value=!i.value,f.value=g()))}function w(h){for(let y=0;y<u.value.length;y++)for(let z=0;z<u.value[y].options.length;z++)if(u.value[y].options[z].url===h)return u.value[y].options[z]}return{worshipRatioReverse:v,selectedImageUrl:f,images:u,findImageByUrl:w,worship:$}}function Ie(){const r=oe(),{data:n}=re();return ie(async({score:i})=>{if(!n.value)return null;const{data:s}=await Q.from("sliding-puzzle-records").select("*").eq("user_id",n.value.id).order("score",{ascending:!0});if(!s)return null;switch(s.length<=10){case!0:return(await Q.from("sliding-puzzle-records").insert({score:i,user_id:n.value.id}).single()).data;case!1:{const v=s[s.length-1];return v.score<i?null:(await Q.from("sliding-puzzle-records").update({id:v.id,score:i}).single()).data}}},{onSuccess:i=>{if(!n.value)return;const{user_name:s=n.value.email,avatar_url:v=""}=n.value.user_metadata;if(!i)return;const u=r.getQueryData(["sliding-puzzle-records"]);u&&r.setQueryData(["sliding-puzzle-records"],()=>[...u,{...i,user:{user_name:s,avatar_url:v}}].sort((f,g)=>f.score-g.score))}})}function We(){const s=R("shuffle"),v=ue(de),u=v.greater("sm"),f=v.greater("lg"),g=O(()=>f.value?140:u.value?100:60),d=Ie(),{openIssueModal:$}=ce(),{t:w}=A(),h=R(0),y=R(null),z=R(null),U=O(()=>!y.value||!z.value?null:z.value-y.value),T=O(()=>U.value?h.value+Math.floor(U.value/1e3):null),o=R([[0,0,0,0,0,0,0],[0,1,2,3,4,5,0],[0,6,7,8,9,10,0],[0,11,12,13,14,15,0],[0,16,17,18,19,20,0],[0,21,22,23,24,25,0],[0,0,0,0,0,-1,0],[0,0,0,0,0,0,0]]);pe(async()=>H());function x(l,t,a){let c=[];const k=o.value[l-1][t],F=o.value[l+1][t],N=o.value[l][t+1],K=o.value[l][t-1];return 0<k&&k!==a&&c.push(k),0<F&&F!==a&&c.push(F),0<N&&N!==a&&c.push(N),0<K&&K!==a&&c.push(K),a&&(c=c.filter(ae=>ae!==25)),Ce(1,c)[0]}async function H(){y.value=null,z.value=null,o.value=[[0,0,0,0,0,0,0],[0,1,2,3,4,5,0],[0,6,7,8,9,10,0],[0,11,12,13,14,15,0],[0,16,17,18,19,20,0],[0,21,22,23,24,25,0],[0,0,0,0,0,-1,0],[0,0,0,0,0,0,0]],await me(),h.value=0,s.value="shuffle";let l;for(let t=0;t<2;t++){const a=document.getElementById("void");if(!a)return;const c=Number(a.dataset.rowidx),k=Number(a.dataset.colidx),F=x(c,k,l),N=document.getElementById(F.toString());if(!N)return;await Y(N,Number(N.dataset.rowidx),Number(N.dataset.colidx),!1),l=F}s.value="ready"}function P(){let t=0;for(let a=0;a<o.value.length;a++)for(let c=0;c<o.value[a].length;c++){const k=o.value[a][c];if(k!==0){if(t===25&&k===-1)return!0;if(t+1!==k)return!1;t++}}return!0}async function Y(l,t,a,c=!0){const k=D(t,a);return c&&(l.style.transition="transform linear 0.1s"),k==="top"&&(c&&(l.style.transform=`translateY(-${g.value}px)`,await V(100)),[o.value[t][a],o.value[t-1][a]]=[o.value[t-1][a],o.value[t][a]]),k==="bottom"&&(c&&(l.style.transform=`translateY(${g.value}px)`,await V(100)),[o.value[t][a],o.value[t+1][a]]=[o.value[t+1][a],o.value[t][a]]),k==="right"&&(c&&(l.style.transform=`translateX(${g.value}px)`,await V(100)),[o.value[t][a],o.value[t][a+1]]=[o.value[t][a+1],o.value[t][a]]),k==="left"&&(c&&(l.style.transform=`translateX(-${g.value}px)`,await V(100)),[o.value[t][a],o.value[t][a-1]]=[o.value[t][a-1],o.value[t][a]]),c&&(l.style.transition=""),!!k}async function V(l){await new Promise(t=>setTimeout(()=>t(!0),l))}function D(l,t){return o.value[l-1][t]===-1?"top":o.value[l+1][t]===-1?"bottom":o.value[l][t+1]===-1?"right":o.value[l][t-1]===-1?"left":null}async function I(l,t,a){if(s.value==="shuffle"||s.value==="done")return;const c=l.currentTarget;c&&await Y(c,t,a)&&(y.value||(y.value=new Date().getTime()),h.value+=1,s.value==="ready"&&(s.value="playing"),P()&&(s.value="done",z.value=new Date().getTime(),T.value&&(console.log(T.value),d.mutate({score:T.value},{onError:()=>$({title:w("record_mutation_failed.title"),content:w("record_mutation_failed.content")})}))))}function W(l){const t=(l-1)%5*g.value*-1,a=Math.floor((l-1)/5)*g.value*-1;return`${t}px ${a}px`}return{SHUFFLE_COUNT:2,nodeSize:g,SIZE_X:5,SIZE_Y:5,clicksCount:h,status:s,nodes:o,score:T,time:U,computeBgPosition:W,onClickNode:I,initialize:H}}const Ke={class:"mt-20 grid gap-12 place-items-center text-dark-500 dark:text-light-500"},Je={class:"py-2 inline-block worship__inactive"},et={class:"py-2 inline-block worship__active","aria-hidden":"true"},tt={key:0,class:"w-0 h-0"},at=["data-rowIdx","data-colIdx"],st=["id","data-rowIdx","data-colIdx","onClick"],nt={class:"absolute inset-0 bg-black bg-opacity-50 grid place-items-center"},lt=Z({__name:"index",setup(r){_e(V=>({"62b785a8-worshipRatioReverse + '%'":e(o)+"%"}));const{data:n,isLoading:i}=Se(),{t:s}=A(),{SHUFFLE_COUNT:v,SIZE_X:u,SIZE_Y:f,clicksCount:g,nodeSize:d,status:$,nodes:w,score:h,time:y,computeBgPosition:z,onClickNode:U,initialize:T}=We(),{worshipRatioReverse:o,selectedImageUrl:x,findImageByUrl:H,worship:P,images:Y}=Ge();return ge(()=>x.value,()=>T()),(V,D)=>{const I=ve("client-only"),W=ye;return p(),_(B,null,[j(e(he),null,{default:X(()=>[b("title",null,m(e(s)("sliding_puzzle"))+" | "+m(e(s)("jon_ganebskis_blog")),1)]),_:1}),b("div",Ke,[b("h1",{class:"relative select-none text-3xl md:text-5xl",onClick:D[0]||(D[0]=(...l)=>e(P)&&e(P)(...l))},[b("span",Je,m(e(s)("sliding_puzzle")),1),b("span",et,m(e(s)("sliding_puzzle")),1)]),j(Xe,{modelValue:e(x),"onUpdate:modelValue":D[1]||(D[1]=l=>fe(x)?x.value=l:null),images:e(Y)},null,8,["modelValue","images"]),j(Be,{class:"min-h-20","shuffle-count":e(v),"clicks-count":e(g),time:e(y),score:e(h)},null,8,["shuffle-count","clicks-count","time","score"])]),j(I,null,{default:X(()=>[b("div",{class:"relative grid gap-px transition-all duration-1000 ease-linear",style:L({gridTemplateRows:`auto repeat(${e(f)}, ${e(d)}px) auto`})},[b("div",{class:M(["absolute top-0 left-1/2 transform -translate-x-1/2 z-1 pointer-events-none",[e($)==="done"?"shadow-2xl":"shadow"]]),style:L({width:`${e(u)*e(d)+e(u)}px`,height:`${e(f)*e(d)+e(f)}px`})},[b("div",{class:M(["absolute top-0 left-0 z-1 w-full h-full bg-white opacity-0",{"done__anim-mask":e($)==="done"}])},null,2),b("div",{class:M(["w-full h-full bg-cover",[e($)==="done"?"done__anim-image opacity-100":"opacity-0"]]),style:L({backgroundImage:`url(${e(x)})`})},null,6)],6),(p(!0),_(B,null,G(e(w),(l,t)=>(p(),_("div",{key:t,class:"grid gap-px transition-all duration-1000 ease-linear",style:L({gridTemplateColumns:`auto repeat(${e(u)}, ${e(d)}px) auto`})},[(p(!0),_(B,null,G(l,(a,c)=>(p(),_("div",{key:a},[a===0?(p(),_("div",tt)):a===-1?(p(),_("div",{key:1,id:"void","data-rowIdx":t,"data-colIdx":c,style:L({width:`${e(d)}px`,height:`${e(d)}px`})},null,12,at)):(p(),_("button",{key:2,id:a.toString(),"data-rowIdx":t,"data-colIdx":c,class:"text-white",style:L({width:`${e(d)}px`,height:`${e(d)}px`,backgroundImage:`url(${e(x)})`,backgroundSize:`${e(d)*e(u)}px ${e(d)*e(f)}px`,backgroundPosition:e(z)(a),transform:"translate(0px)"}),onClick:k=>e(U)(k,t,c)},[b("div",nt,m(e($)==="done"?"":a),1)],12,st))]))),128))],4))),128))],4)]),_:1}),j(ke,{class:"mt-2 text-center"}),j(Te,{"selected-image":e(H)(e(x))},null,8,["selected-image"]),j(be,{"is-loading":e(i),data:e(n)},null,8,["is-loading","data"]),j(W)],64)}}});const ct=q(lt,[["__scopeId","data-v-62b785a8"],["__file","/Users/jinseok.bang/Documents/github.me/jonganebski.github.io/src/pages/games/sliding-puzzle/index.vue"]]);export{ct as default};
