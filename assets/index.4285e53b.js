var ae=Object.defineProperty,se=Object.defineProperties;var ne=Object.getOwnPropertyDescriptors;var Q=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var A=(u,e,o)=>e in u?ae(u,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):u[e]=o,q=(u,e)=>{for(var o in e||(e={}))re.call(e,o)&&A(u,o,e[o]);if(Q)for(var o of Q(e))le.call(e,o)&&A(u,o,e[o]);return u},K=(u,e)=>se(u,ne(e));import{_ as J,e as M,r as P,u as I,s as V,a as ue}from"./app.dbd89cd9.js";import{_ as oe,a as ie}from"./option.959a9e71.js";import{d as Z,h as m,j as g,m as f,v as z,Q as ce,s as S,y as O,t as a,S as ee,r as T,p as X,L as Y,$ as pe,a0 as me,aj as de,ak as _e,o as ve,ad as ge,w as D,al as fe,x as G,n as x,F as N,U as F,R as W}from"./vendor.bea6da78.js";const he={class:"mt-2 text-sm"},ye={class:"pl-2 font-bold"},be={display:"mt-1 grid"},ke=Z({props:{categoryName:null},setup(u){const e=u;return(o,i)=>(m(),g("div",he,[f("span",ye,z(e.categoryName),1),f("div",be,[ce(o.$slots,"default")])]))}});const ze={class:"mt-4 px-2 text-center"},$e={key:0,class:"text-sm text-gray-700 dark:text-gray-300"},Ce=ee(" Photo by "),we=["href"],xe={key:1,class:"text-sm text-gray-700 dark:text-gray-300"},Se=ee(" on "),je=["href"],Ee={class:"text-xs text-gray-500"},Ne=Z({props:{selectedImage:null},setup(u){const e=u,{t:o}=M();return(i,c)=>{var d,h;return m(),g("div",ze,[e.selectedImage.creator?(m(),g("span",$e,[Ce,f("a",{class:S([e.selectedImage.creator.url?"link__active":"link__inactive"]),href:e.selectedImage.creator.url,target:"_blank",rel:"noopener"},z((d=e.selectedImage.creator)==null?void 0:d.name),11,we)])):O("",!0),e.selectedImage.provider?(m(),g("span",xe,[Se,f("a",{class:S([e.selectedImage.provider.url?"link__active":"link__inactive"]),href:e.selectedImage.provider.url,target:"_blank",rel:"noopener"},z((h=e.selectedImage.provider)==null?void 0:h.name),11,je)])):O("",!0),f("p",Ee,z(a(o)("all_rights_of_the_image_belong_to_the_creator")),1)])}}});var Te=J(Ne,[["__scopeId","data-v-cfde1d4e"]]);const Ue=Z({props:{shuffleCount:null,clickCount:null,score:null},setup(u){const e=u;return(o,i)=>(m(),g("div",null,[f("div",null,z(e.clickCount),1),f("div",{class:S([e.score<0?"text-green-500":e.score<e.shuffleCount?"text-yellow-500":"text-red-500"])},z(e.score>0?`+${e.score}`:e.score)+" moves ",3)]))}});function Be(){const{t:u,locale:e}=M(),o=T(!1),i=X(()=>o.value?[{categoryName:u("fate_series"),options:[{label:u("jean_alter"),url:"https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images/jean-alter.jpg"},{label:"",url:""}]},{categoryName:u("eighty_six"),options:[{label:u("vladilena_milize"),url:"https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images/vladilena-milize.jpg"}]},{categoryName:u("attack_on_titan"),options:[{label:u("eren_yeager"),url:"https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images/eren-yeager.jpg"}]}]:[{categoryName:u("nature"),options:[{label:"Kamran Ch",url:"https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images/mountain.jpg",provider:{name:"Unsplash",url:"https://unsplash.com/t/act-for-nature?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"},creator:{name:"Kamran Ch",url:"https://unsplash.com/@kamranch?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"}},{label:"David Scanlon",url:"https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images/gorilla.jpg",provider:{name:"Unsplash",url:"https://unsplash.com/t/nature?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"},creator:{name:"David Scanlon",url:"https://unsplash.com/@dsartwork?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"}}]},{categoryName:u("cat",2),options:[{label:"Pacto Visual",url:"https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images/cat_pacto-visual.jpg",provider:{name:"Unsplash",url:"https://unsplash.com/s/photos/cat?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"},creator:{name:"Pacto Visual",url:"https://unsplash.com/@pactovisual?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"}},{label:"Georgi Benev",url:"https://ijivzwfsihdcvwrntdpe.supabase.co/storage/v1/object/public/sliding-puzzle-images/cat_georgi-benev.jpg",provider:{name:"Unsplash",url:"https://unsplash.com/s/photos/cat-box?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"},creator:{name:"georgi benev",url:"https://unsplash.com/@georgibenev97?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText"}}]}]),c=T(d());function d(){return P(1,P(1,i.value)[0].options)[0]}function h(){o.value=!0}return Y(o,()=>{c.value=d()}),Y(e,()=>{const k=i.value.flatMap(({options:_})=>_).find(({url:_})=>_===c.value.url);!k||(c.value=k)}),{selectedImage:c,images:i,openBackDoor:h}}function De(){const u=me(),{data:e}=I();return pe(async({score:o})=>{if(!e.value)return null;const{data:i}=await V.from("sliding-puzzle-records").select("*").eq("user_id",e.value.id).order("score",{ascending:!0});if(!i)return null;switch(i.length<=10){case!0:return(await V.from("sliding-puzzle-records").insert({score:o,user_id:e.value.id}).single()).data;case!1:{const c=i[i.length-1];return c.score<o?null:(await V.from("sliding-puzzle-records").update({id:c.id,score:o}).single()).data}}},{onSuccess:o=>{if(!e.value)return;const{user_name:i=e.value.email,avatar_url:c=""}=e.value.user_metadata;if(!o)return;const d=u.getQueryData("sliding-puzzle-records");!d||u.setQueryData("sliding-puzzle-records",()=>(d.push(K(q({},o),{user:{user_name:i,avatar_url:c}})),d.sort((h,k)=>h.score-k.score)))}})}function Fe(){const i=X(()=>k.value?160:h.value?120:80),c=De(),d=de(_e),h=d.greater("sm"),k=d.greater("lg"),_=T("shuffle"),$=T(0),U=X(()=>$.value-32),l=T([[0,0,0,0,0,0],[0,1,2,3,4,0],[0,5,6,7,8,0],[0,9,10,11,12,0],[0,13,14,15,16,0],[0,0,0,0,-1,0],[0,0,0,0,0,0]]);ve(async()=>B());function L(r,t,s){let n=[];const p=l.value[r-1][t],v=l.value[r+1][t],y=l.value[r][t+1],E=l.value[r][t-1];return 0<p&&p!==s&&n.push(p),0<v&&v!==s&&n.push(v),0<y&&y!==s&&n.push(y),0<E&&E!==s&&n.push(E),s&&(n=n.filter(te=>te!==16)),P(1,n)[0]}async function B(){l.value=[[0,0,0,0,0,0],[0,1,2,3,4,0],[0,5,6,7,8,0],[0,9,10,11,12,0],[0,13,14,15,16,0],[0,0,0,0,-1,0],[0,0,0,0,0,0]],await ge(),$.value=0,_.value="shuffle";let r;for(let t=0;t<32;t++){const s=document.getElementById("void");if(!s)return;const n=Number(s.dataset.rowidx),p=Number(s.dataset.colidx),v=L(n,p,r),y=document.getElementById(v.toString());if(!y)return;await j(y,Number(y.dataset.rowidx),Number(y.dataset.colidx),!1),r=v}_.value="ready"}function b(){let r=0;for(let t=0;t<l.value.length;t++)for(let s=0;s<l.value[t].length;s++){const n=l.value[t][s];if(n!==0){if(r===16&&n===-1)return!0;if(r+1!==n)return!1;r++}}return!0}async function j(r,t,s,n=!0){const p=H(t,s);return n&&(r.style.transition="transform linear 0.1s"),p==="top"&&(n&&(r.style.transform=`translateY(-${i.value}px)`,await C(100)),[l.value[t][s],l.value[t-1][s]]=[l.value[t-1][s],l.value[t][s]]),p==="bottom"&&(n&&(r.style.transform=`translateY(${i.value}px)`,await C(100)),[l.value[t][s],l.value[t+1][s]]=[l.value[t+1][s],l.value[t][s]]),p==="right"&&(n&&(r.style.transform=`translateX(${i.value}px)`,await C(100)),[l.value[t][s],l.value[t][s+1]]=[l.value[t][s+1],l.value[t][s]]),p==="left"&&(n&&(r.style.transform=`translateX(-${i.value}px)`,await C(100)),[l.value[t][s],l.value[t][s-1]]=[l.value[t][s-1],l.value[t][s]]),n&&(r.style.transition=""),!!p}async function C(r){await new Promise(t=>setTimeout(()=>t(!0),r))}function H(r,t){return l.value[r-1][t]===-1?"top":l.value[r+1][t]===-1?"bottom":l.value[r][t+1]===-1?"right":l.value[r][t-1]===-1?"left":null}async function w(r,t,s){if(_.value==="shuffle"||_.value==="done")return;const n=r.currentTarget;!n||(await j(n,t,s)&&($.value+=1),_.value==="ready"&&(_.value="playing"),!!b()&&(_.value="done",c.mutate({score:U.value})))}function R(r){const t=(r-1)%4*i.value*-1,s=Math.floor((r-1)/4)*i.value*-1;return`${t}px ${s}px`}return{SHUFFLE_COUNT:32,SIZE_NODE:i,SIZE_X:4,SIZE_Y:4,clickCount:$,status:_,nodes:l,score:U,computeBgPosition:R,onClickNode:w,initialize:B}}const Ze={class:"my-10 grid gap-5 place-items-center"},Le={class:"w-52"},Re={key:0,class:"w-0 h-0"},Ve=["data-rowIdx","data-colIdx"],Pe=["id","data-rowIdx","data-colIdx","onClick"],Oe={key:0,class:"mt-2 text-center text-rose-500 text-sm"},Xe=Z({setup(u){const{data:e}=I(),{t:o}=M(),{SHUFFLE_COUNT:i,SIZE_NODE:c,SIZE_X:d,SIZE_Y:h,clickCount:k,status:_,nodes:$,score:U,computeBgPosition:l,onClickNode:L,initialize:B}=Fe(),{selectedImage:b,openBackDoor:j,images:C}=Be();return Y(()=>b.value.url,()=>B(),{deep:!0}),(H,w)=>{const R=ie,r=ke,t=oe,s=ue;return m(),g(N,null,[f("div",Ze,[f("button",{onClick:w[0]||(w[0]=(...n)=>a(j)&&a(j)(...n))},"Back Door"),f("div",Le,[D(t,{modelValue:a(b),"onUpdate:modelValue":w[1]||(w[1]=n=>fe(b)?b.value=n:null),label:"Image",class:"w-56"},{default:G(()=>[(m(!0),g(N,null,F(a(C),({categoryName:n,options:p})=>(m(),W(r,{key:n,"category-name":n},{default:G(()=>[(m(!0),g(N,null,F(p,v=>(m(),W(R,{key:v.url,value:v},null,8,["value"]))),128))]),_:2},1032,["category-name"]))),128))]),_:1},8,["modelValue"])]),D(Ue,{"shuffle-count":a(i),"click-count":a(k),score:a(U)},null,8,["shuffle-count","click-count","score"])]),f("div",{class:"relative grid gap-px transition-all duration-1000 ease-linear",style:x({gridTemplateRows:`auto repeat(${a(h)}, ${a(c)}px) auto`})},[f("div",{class:S(["absolute top-0 left-1/2 transform -translate-x-1/2 z-1 pointer-events-none",[a(_)==="done"?"shadow-2xl":"shadow"]]),style:x({width:`${a(d)*a(c)+a(d)}px`,height:`${a(h)*a(c)+a(h)}px`})},[f("div",{class:S(["absolute top-0 left-0 z-1 w-full h-full bg-white opacity-0",{"done__anim-mask":a(_)==="done"}])},null,2),f("div",{class:S(["w-full h-full bg-cover",[a(_)==="done"?"done__anim-image opacity-100":"opacity-0"]]),style:x({backgroundImage:`url(${a(b).url})`})},null,6)],6),(m(!0),g(N,null,F(a($),(n,p)=>(m(),g("div",{key:p,class:"grid gap-px transition-all duration-1000 ease-linear",style:x({gridTemplateColumns:`auto repeat(${a(d)}, ${a(c)}px) auto`})},[(m(!0),g(N,null,F(n,(v,y)=>(m(),g("div",{key:v},[v===0?(m(),g("div",Re)):v===-1?(m(),g("div",{key:1,id:"void","data-rowIdx":p,"data-colIdx":y,style:x({width:`${a(c)}px`,height:`${a(c)}px`})},null,12,Ve)):(m(),g("button",{key:2,id:v.toString(),"data-rowIdx":p,"data-colIdx":y,class:"text-white",style:x({width:`${a(c)}px`,height:`${a(c)}px`,backgroundImage:`url(${a(b).url})`,backgroundSize:`${a(c)*a(d)}px ${a(c)*a(h)}px`,backgroundPosition:a(l)(v),transform:"translate(0px)"}),onClick:E=>a(L)(E,p,y)},z(a(_)==="done"?"":v),13,Pe))]))),128))],4))),128))],4),a(e)?O("",!0):(m(),g("div",Oe,z(a(o)("games_auth_warning")),1)),D(Te,{"selected-image":a(b)},null,8,["selected-image"]),D(s)],64)}}});var Ae=J(Xe,[["__scopeId","data-v-975e908a"]]);export{Ae as default};
